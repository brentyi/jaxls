{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "cell-0",
   "metadata": {},
   "source": [
    "# Beam Bending\n",
    "\n",
    "A 2D cantilever beam bending problem: finding the equilibrium shape of a beam fixed at one end with a point load applied at the tip.\n",
    "\n",
    "Features used:\n",
    "- {class}`~jaxls.Var` subclassing for custom variable types\n",
    "- {func}`@jaxls.Cost.factory <jaxls.Cost.factory>` for defining elastic energy costs\n",
    "- Equality constraints (`constraint_eq_zero`) for fixed-end boundary conditions\n",
    "- Batched cost construction for efficiency\n",
    "\n",
    "We model a steel ruler (1 m \u00d7 30 mm \u00d7 3 mm) clamped at one end with a small weight hanging from the tip."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "cell-1",
   "metadata": {
    "tags": [
     "hide-input"
    ]
   },
   "outputs": [],
   "source": [
    "import sys\n",
    "from loguru import logger\n",
    "\n",
    "logger.remove()\n",
    "logger.add(sys.stdout, format=\"<level>{level: <8}</level> | {message}\");"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "cell-2",
   "metadata": {},
   "outputs": [],
   "source": [
    "import jax\n",
    "import jax.numpy as jnp\n",
    "import jaxls"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "cell-3",
   "metadata": {},
   "source": [
    "## Variables and costs\n",
    "\n",
    "We model the beam as a series of nodes along its length. Each node has a 2D position that we want to solve for. The beam is discretized into segments, and we minimize the elastic bending energy while constraining the fixed end."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "cell-4",
   "metadata": {},
   "outputs": [],
   "source": [
    "class NodeVar(jaxls.Var[jax.Array], default_factory=lambda: jnp.zeros(2)):\n",
    "    \"\"\"A 2D node position variable.\"\"\""
   ]
  },
  {
   "cell_type": "markdown",
   "id": "cell-5",
   "metadata": {},
   "source": [
    "Cost functions define the physics of the beam based on Euler-Bernoulli beam theory:\n",
    "\n",
    "1. Bending energy: $E_b = \\frac{1}{2} EI \\int \\kappa^2 \\, ds$ where $\\kappa$ is curvature\n",
    "2. Stretching energy: $E_s = \\frac{1}{2} EA \\int \\epsilon^2 \\, ds$ where $\\epsilon$ is axial strain  \n",
    "3. Tip displacement constraint: We constrain the tip to the analytical deflection $\\delta = \\frac{FL^3}{3EI}$\n",
    "4. Fixed-end constraints: Position and slope at the clamped end"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "cell-6",
   "metadata": {},
   "outputs": [],
   "source": [
    "@jaxls.Cost.factory\n",
    "def bending_cost(\n",
    "    vals: jaxls.VarValues,\n",
    "    node_a: NodeVar,\n",
    "    node_b: NodeVar,\n",
    "    node_c: NodeVar,\n",
    "    EI: float,\n",
    "    ds: float,\n",
    ") -> jax.Array:\n",
    "    \"\"\"Discrete bending energy: EI * kappa^2 * ds.\n",
    "\n",
    "    Curvature kappa is approximated by the angle change between segments\n",
    "    divided by segment length.\n",
    "    \"\"\"\n",
    "    p_a = vals[node_a]\n",
    "    p_b = vals[node_b]\n",
    "    p_c = vals[node_c]\n",
    "\n",
    "    # Vectors along segments.\n",
    "    v1 = p_b - p_a\n",
    "    v2 = p_c - p_b\n",
    "\n",
    "    # Angle between segments (sin approximation for small angles)\n",
    "    cross = v1[0] * v2[1] - v1[1] * v2[0]\n",
    "    len1 = jnp.sqrt(jnp.sum(v1**2) + 1e-12)\n",
    "    len2 = jnp.sqrt(jnp.sum(v2**2) + 1e-12)\n",
    "    sin_theta = cross / (len1 * len2)\n",
    "\n",
    "    # Curvature \u2248 theta / ds.\n",
    "    kappa = sin_theta / ds\n",
    "\n",
    "    # Bending energy contribution: sqrt(EI * ds) * kappa (squared by solver)\n",
    "    return jnp.sqrt(EI * ds) * kappa\n",
    "\n",
    "\n",
    "@jaxls.Cost.factory\n",
    "def stretching_cost(\n",
    "    vals: jaxls.VarValues,\n",
    "    node_a: NodeVar,\n",
    "    node_b: NodeVar,\n",
    "    rest_length: float,\n",
    "    EA: float,\n",
    "    ds: float,\n",
    ") -> jax.Array:\n",
    "    \"\"\"Discrete stretching energy: EA * strain^2 * ds.\"\"\"\n",
    "    diff = vals[node_b] - vals[node_a]\n",
    "    length = jnp.sqrt(jnp.sum(diff**2) + 1e-12)\n",
    "    strain = (length - rest_length) / rest_length\n",
    "    return jnp.sqrt(EA * ds) * strain\n",
    "\n",
    "\n",
    "@jaxls.Cost.factory(kind=\"constraint_eq_zero\")\n",
    "def fixed_position_constraint(\n",
    "    vals: jaxls.VarValues,\n",
    "    node: NodeVar,\n",
    "    target: jax.Array,\n",
    ") -> jax.Array:\n",
    "    \"\"\"Pin a node to a fixed position.\"\"\"\n",
    "    return vals[node] - target\n",
    "\n",
    "\n",
    "@jaxls.Cost.factory(kind=\"constraint_eq_zero\")\n",
    "def fixed_angle_constraint(\n",
    "    vals: jaxls.VarValues,\n",
    "    node_a: NodeVar,\n",
    "    node_b: NodeVar,\n",
    "    target_direction: jax.Array,\n",
    ") -> jax.Array:\n",
    "    \"\"\"Constrain the angle of a segment to match a target direction.\"\"\"\n",
    "    segment = vals[node_b] - vals[node_a]\n",
    "    seg_norm = segment / (jnp.sqrt(jnp.sum(segment**2)) + 1e-12)\n",
    "    cross = seg_norm[0] * target_direction[1] - seg_norm[1] * target_direction[0]\n",
    "    return cross\n",
    "\n",
    "\n",
    "@jaxls.Cost.factory(kind=\"constraint_eq_zero\")\n",
    "def tip_displacement_constraint(\n",
    "    vals: jaxls.VarValues,\n",
    "    node: NodeVar,\n",
    "    target_y: float,\n",
    ") -> jax.Array:\n",
    "    \"\"\"Constrain the tip to a specific vertical displacement.\"\"\"\n",
    "    return vals[node][1] - target_y"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "cell-7",
   "metadata": {},
   "source": [
    "## Physical parameters\n",
    "\n",
    "We model a thin steel ruler:\n",
    "- Length: 1 m\n",
    "- Cross-section: 30 mm wide x 3 mm thick\n",
    "- Material: Steel (E = 200 GPa)\n",
    "- Tip load: 3 N (approximately 300 gram weight)\n",
    "\n",
    "The analytical tip deflection for a cantilever beam is $\\delta = \\frac{FL^3}{3EI}$."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "cell-8",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Beam: L = 1.0 m, 30 mm \u00d7 3 mm\n",
      "Bending stiffness EI = 13.50 N\u00b7m\u00b2\n",
      "Tip load F = 3.0 N\n",
      "Analytical tip deflection: 74.07 mm\n"
     ]
    }
   ],
   "source": [
    "# Geometry.\n",
    "num_nodes = 21\n",
    "beam_length = 1.0  # [m]\n",
    "segment_length = beam_length / (num_nodes - 1)\n",
    "\n",
    "# Material properties: steel.\n",
    "E = 200e9  # Young's modulus [Pa]\n",
    "width = 0.030  # [m] = 30 mm\n",
    "thickness = 0.003  # [m] = 3 mm\n",
    "A = width * thickness  # Cross-sectional area [m^2]\n",
    "I = width * thickness**3 / 12  # Second moment of area [m^4]\n",
    "\n",
    "# Stiffnesses.\n",
    "EI = E * I  # Bending stiffness [N\u00b7m^2]\n",
    "EA = E * A  # Axial stiffness [N]\n",
    "\n",
    "# Applied load.\n",
    "tip_force = 3.0  # [N]\n",
    "\n",
    "# Analytical solution for comparison.\n",
    "delta_analytical = tip_force * beam_length**3 / (3 * EI)\n",
    "\n",
    "print(f\"Beam: L = {beam_length} m, {width * 1000:.0f} mm \u00d7 {thickness * 1000:.0f} mm\")\n",
    "print(f\"Bending stiffness EI = {EI:.2f} N\u00b7m\u00b2\")\n",
    "print(f\"Tip load F = {tip_force} N\")\n",
    "print(f\"Analytical tip deflection: {delta_analytical * 1000:.2f} mm\")\n",
    "\n",
    "# Initial configuration: straight horizontal beam.\n",
    "initial_positions = jnp.array([[i * segment_length, 0.0] for i in range(num_nodes)])"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "cell-9",
   "metadata": {},
   "source": [
    "## Problem construction\n",
    "\n",
    "We use batched construction for efficiency: creating arrays of indices and passing them to cost factories in a single call."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "cell-10",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Created 5 cost objects\n"
     ]
    }
   ],
   "source": [
    "# Create batched node variables.\n",
    "node_vars = NodeVar(id=jnp.arange(num_nodes))\n",
    "\n",
    "# Indices for bending costs (triplets of consecutive nodes)\n",
    "bending_a = jnp.arange(num_nodes - 2)\n",
    "bending_b = jnp.arange(1, num_nodes - 1)\n",
    "bending_c = jnp.arange(2, num_nodes)\n",
    "\n",
    "# Indices for stretching costs (pairs of consecutive nodes)\n",
    "stretch_a = jnp.arange(num_nodes - 1)\n",
    "stretch_b = jnp.arange(1, num_nodes)\n",
    "\n",
    "# Build costs using batched construction.\n",
    "costs: list[jaxls.Cost] = [\n",
    "    # Bending energy at interior nodes.\n",
    "    bending_cost(\n",
    "        NodeVar(id=bending_a),\n",
    "        NodeVar(id=bending_b),\n",
    "        NodeVar(id=bending_c),\n",
    "        EI,\n",
    "        segment_length,\n",
    "    ),\n",
    "    # Stretching energy for all segments.\n",
    "    stretching_cost(\n",
    "        NodeVar(id=stretch_a),\n",
    "        NodeVar(id=stretch_b),\n",
    "        segment_length,\n",
    "        EA,\n",
    "        segment_length,\n",
    "    ),\n",
    "    # Fixed position at clamped end.\n",
    "    fixed_position_constraint(NodeVar(id=0), initial_positions[0]),\n",
    "    # Fixed angle: first segment must be horizontal.\n",
    "    fixed_angle_constraint(\n",
    "        NodeVar(id=0),\n",
    "        NodeVar(id=1),\n",
    "        jnp.array([1.0, 0.0]),\n",
    "    ),\n",
    "    # Tip displacement from analytical solution.\n",
    "    tip_displacement_constraint(NodeVar(id=num_nodes - 1), -delta_analytical),\n",
    "]\n",
    "\n",
    "print(f\"Created {len(costs)} cost objects\")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "cell-11",
   "metadata": {},
   "source": [
    "## Solving"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "cell-12",
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\u001b[1mINFO    \u001b[0m | Building optimization problem with 42 terms and 21 variables: 39 costs, 3 eq_zero, 0 leq_zero, 0 geq_zero\n",
      "\u001b[1mINFO    \u001b[0m | Vectorizing group with 20 costs, 2 variables each: stretching_cost\n",
      "\u001b[1mINFO    \u001b[0m | Vectorizing group with 19 costs, 3 variables each: bending_cost\n",
      "\u001b[1mINFO    \u001b[0m | Vectorizing constraint group with 1 constraints (constraint_eq_zero), 1 variables each: augmented_tip_displacement_constraint\n",
      "\u001b[1mINFO    \u001b[0m | Vectorizing constraint group with 1 constraints (constraint_eq_zero), 1 variables each: augmented_fixed_position_constraint\n",
      "\u001b[1mINFO    \u001b[0m | Vectorizing constraint group with 1 constraints (constraint_eq_zero), 2 variables each: augmented_fixed_angle_constraint\n",
      "\u001b[1mINFO    \u001b[0m | Augmented Lagrangian: initial snorm=7.4074e-02, csupn=7.4074e-02, max_rho=1.0000e+01, constraint_dim=4\n",
      "\u001b[1mINFO    \u001b[0m |  step #1: cost=0.0549 lambd=0.0005 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - stretching_cost(20): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - bending_cost(19): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_tip_displacement_constraint(1): 0.05487 (avg 0.05487)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_position_constraint(1): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_angle_constraint(1): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |  step #2: cost=0.0549 lambd=0.0010 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - stretching_cost(20): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - bending_cost(19): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_tip_displacement_constraint(1): 0.05487 (avg 0.05487)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_position_constraint(1): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_angle_constraint(1): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |  step #3: cost=0.0549 lambd=0.0020 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - stretching_cost(20): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - bending_cost(19): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_tip_displacement_constraint(1): 0.05487 (avg 0.05487)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_position_constraint(1): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_angle_constraint(1): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |  step #4: cost=0.0549 lambd=0.0040 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - stretching_cost(20): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - bending_cost(19): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_tip_displacement_constraint(1): 0.05487 (avg 0.05487)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_position_constraint(1): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_angle_constraint(1): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |  step #5: cost=0.0549 lambd=0.0080 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - stretching_cost(20): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - bending_cost(19): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_tip_displacement_constraint(1): 0.05487 (avg 0.05487)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_position_constraint(1): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_angle_constraint(1): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |  step #6: cost=0.0549 lambd=0.0160 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - stretching_cost(20): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - bending_cost(19): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_tip_displacement_constraint(1): 0.05487 (avg 0.05487)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_position_constraint(1): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_angle_constraint(1): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |  step #7: cost=0.0549 lambd=0.0320 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - stretching_cost(20): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - bending_cost(19): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_tip_displacement_constraint(1): 0.05487 (avg 0.05487)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_position_constraint(1): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_angle_constraint(1): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |  step #8: cost=0.0549 lambd=0.0640 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - stretching_cost(20): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - bending_cost(19): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_tip_displacement_constraint(1): 0.05487 (avg 0.05487)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_position_constraint(1): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_angle_constraint(1): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |  step #9: cost=0.0549 lambd=0.1280 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - stretching_cost(20): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - bending_cost(19): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_tip_displacement_constraint(1): 0.05487 (avg 0.05487)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_position_constraint(1): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_angle_constraint(1): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |  step #10: cost=0.0549 lambd=0.2560 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - stretching_cost(20): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - bending_cost(19): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_tip_displacement_constraint(1): 0.05487 (avg 0.05487)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_position_constraint(1): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_angle_constraint(1): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |  step #11: cost=0.0549 lambd=0.5120 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - stretching_cost(20): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - bending_cost(19): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_tip_displacement_constraint(1): 0.05487 (avg 0.05487)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_position_constraint(1): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_angle_constraint(1): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |  step #12: cost=0.0549 lambd=1.0240 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - stretching_cost(20): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - bending_cost(19): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_tip_displacement_constraint(1): 0.05487 (avg 0.05487)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_position_constraint(1): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_angle_constraint(1): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |  step #13: cost=0.0549 lambd=2.0480 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - stretching_cost(20): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - bending_cost(19): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_tip_displacement_constraint(1): 0.05487 (avg 0.05487)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_position_constraint(1): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_angle_constraint(1): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |  step #14: cost=0.0549 lambd=4.0960 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - stretching_cost(20): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - bending_cost(19): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_tip_displacement_constraint(1): 0.05487 (avg 0.05487)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_position_constraint(1): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_angle_constraint(1): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |  step #15: cost=0.0549 lambd=8.1920 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - stretching_cost(20): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - bending_cost(19): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_tip_displacement_constraint(1): 0.05487 (avg 0.05487)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_position_constraint(1): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_angle_constraint(1): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |  step #16: cost=0.0549 lambd=16.3840 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - stretching_cost(20): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - bending_cost(19): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_tip_displacement_constraint(1): 0.05487 (avg 0.05487)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_position_constraint(1): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_angle_constraint(1): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |  step #17: cost=0.0549 lambd=32.7680 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - stretching_cost(20): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - bending_cost(19): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_tip_displacement_constraint(1): 0.05487 (avg 0.05487)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_position_constraint(1): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_angle_constraint(1): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |  step #18: cost=0.0549 lambd=65.5360 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - stretching_cost(20): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - bending_cost(19): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_tip_displacement_constraint(1): 0.05487 (avg 0.05487)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_position_constraint(1): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_angle_constraint(1): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=4.85e+01 cost_prev=0.0549 cost_new=0.0538\n",
      "\u001b[1mINFO    \u001b[0m |  AL update: snorm=7.2321e-02, csupn=7.2321e-02, max_rho=1.0000e+01, al_update=False\n",
      "\u001b[1mINFO    \u001b[0m |  step #19: cost=0.0538 lambd=32.7680 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - stretching_cost(20): 0.00096 (avg 0.00005)\n",
      "\u001b[1mINFO    \u001b[0m |      - bending_cost(19): 0.00051 (avg 0.00003)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_tip_displacement_constraint(1): 0.05230 (avg 0.05230)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_position_constraint(1): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_angle_constraint(1): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=2.35e+02 cost_prev=0.0538 cost_new=0.0512\n",
      "\u001b[1mINFO    \u001b[0m |  AL update: snorm=6.9470e-02, csupn=6.9470e-02, max_rho=1.0000e+01, al_update=False\n",
      "\u001b[1mINFO    \u001b[0m |  step #20: cost=0.0512 lambd=16.3840 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - stretching_cost(20): 0.00237 (avg 0.00012)\n",
      "\u001b[1mINFO    \u001b[0m |      - bending_cost(19): 0.00028 (avg 0.00001)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_tip_displacement_constraint(1): 0.04826 (avg 0.04826)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_position_constraint(1): 0.00004 (avg 0.00002)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_angle_constraint(1): 0.00025 (avg 0.00025)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=2.81e+02 cost_prev=0.0512 cost_new=0.0482\n",
      "\u001b[1mINFO    \u001b[0m |  AL update: snorm=6.7960e-02, csupn=6.7960e-02, max_rho=1.0000e+01, al_update=False\n",
      "\u001b[1mINFO    \u001b[0m |  step #21: cost=0.0482 lambd=8.1920 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - stretching_cost(20): 0.00036 (avg 0.00002)\n",
      "\u001b[1mINFO    \u001b[0m |      - bending_cost(19): 0.00146 (avg 0.00008)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_tip_displacement_constraint(1): 0.04619 (avg 0.04619)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_position_constraint(1): 0.00003 (avg 0.00001)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_angle_constraint(1): 0.00013 (avg 0.00013)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=1.55e+02 cost_prev=0.0482 cost_new=0.0476\n",
      "\u001b[1mINFO    \u001b[0m |  AL update: snorm=6.6360e-02, csupn=6.6360e-02, max_rho=1.0000e+01, al_update=False\n",
      "\u001b[1mINFO    \u001b[0m |  step #22: cost=0.0476 lambd=4.0960 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - stretching_cost(20): 0.00157 (avg 0.00008)\n",
      "\u001b[1mINFO    \u001b[0m |      - bending_cost(19): 0.00112 (avg 0.00006)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_tip_displacement_constraint(1): 0.04404 (avg 0.04404)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_position_constraint(1): 0.00010 (avg 0.00005)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_angle_constraint(1): 0.00074 (avg 0.00074)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=2.81e+02 cost_prev=0.0476 cost_new=0.0448\n",
      "\u001b[1mINFO    \u001b[0m |  AL update: snorm=6.5045e-02, csupn=6.5045e-02, max_rho=1.0000e+01, al_update=False\n",
      "\u001b[1mINFO    \u001b[0m |  step #23: cost=0.0448 lambd=2.0480 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - stretching_cost(20): 0.00020 (avg 0.00001)\n",
      "\u001b[1mINFO    \u001b[0m |      - bending_cost(19): 0.00176 (avg 0.00009)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_tip_displacement_constraint(1): 0.04231 (avg 0.04231)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_position_constraint(1): 0.00008 (avg 0.00004)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_angle_constraint(1): 0.00046 (avg 0.00046)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=1.04e+02 cost_prev=0.0448 cost_new=0.0440\n",
      "\u001b[1mINFO    \u001b[0m |  AL update: snorm=6.5095e-02, csupn=6.5095e-02, max_rho=1.0000e+01, al_update=False\n",
      "\u001b[1mINFO    \u001b[0m |  step #24: cost=0.0440 lambd=1.0240 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - stretching_cost(20): 0.00013 (avg 0.00001)\n",
      "\u001b[1mINFO    \u001b[0m |      - bending_cost(19): 0.00049 (avg 0.00003)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_tip_displacement_constraint(1): 0.04237 (avg 0.04237)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_position_constraint(1): 0.00013 (avg 0.00006)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_angle_constraint(1): 0.00091 (avg 0.00091)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=9.96e+01 cost_prev=0.0440 cost_new=0.0435\n",
      "\u001b[1mINFO    \u001b[0m |  AL update: snorm=6.3751e-02, csupn=6.3751e-02, max_rho=1.0000e+01, al_update=False\n",
      "\u001b[1mINFO    \u001b[0m |  step #25: cost=0.0435 lambd=0.5120 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - stretching_cost(20): 0.00024 (avg 0.00001)\n",
      "\u001b[1mINFO    \u001b[0m |      - bending_cost(19): 0.00179 (avg 0.00009)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_tip_displacement_constraint(1): 0.04064 (avg 0.04064)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_position_constraint(1): 0.00011 (avg 0.00005)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_angle_constraint(1): 0.00070 (avg 0.00070)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=1.28e+02 cost_prev=0.0435 cost_new=0.0427\n",
      "\u001b[1mINFO    \u001b[0m |  AL update: snorm=6.3848e-02, csupn=6.3848e-02, max_rho=1.0000e+01, al_update=False\n",
      "\u001b[1mINFO    \u001b[0m |  step #26: cost=0.0427 lambd=0.2560 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - stretching_cost(20): 0.00008 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - bending_cost(19): 0.00063 (avg 0.00003)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_tip_displacement_constraint(1): 0.04077 (avg 0.04077)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_position_constraint(1): 0.00015 (avg 0.00008)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_angle_constraint(1): 0.00111 (avg 0.00111)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=7.76e+01 cost_prev=0.0427 cost_new=0.0423\n",
      "\u001b[1mINFO    \u001b[0m |  AL update: snorm=6.2704e-02, csupn=6.2704e-02, max_rho=4.0000e+01, al_update=True\n",
      "\u001b[1mINFO    \u001b[0m |  step #27: cost=0.1667 lambd=0.1280 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - stretching_cost(20): 0.00019 (avg 0.00001)\n",
      "\u001b[1mINFO    \u001b[0m |      - bending_cost(19): 0.00159 (avg 0.00008)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_tip_displacement_constraint(1): 0.15727 (avg 0.15727)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_position_constraint(1): 0.00088 (avg 0.00044)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_angle_constraint(1): 0.00676 (avg 0.00676)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=1.14e+02 cost_prev=0.1667 cost_new=0.1642\n",
      "\u001b[1mINFO    \u001b[0m |  AL update: snorm=6.1424e-02, csupn=6.1424e-02, max_rho=4.0000e+01, al_update=False\n",
      "\u001b[1mINFO    \u001b[0m |  step #28: cost=0.1642 lambd=0.0640 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - stretching_cost(20): 0.00157 (avg 0.00008)\n",
      "\u001b[1mINFO    \u001b[0m |      - bending_cost(19): 0.00638 (avg 0.00034)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_tip_displacement_constraint(1): 0.15408 (avg 0.15408)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_position_constraint(1): 0.00048 (avg 0.00024)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_angle_constraint(1): 0.00173 (avg 0.00173)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=4.41e+02 cost_prev=0.1642 cost_new=0.1624\n",
      "\u001b[1mINFO    \u001b[0m |  AL update: snorm=5.9766e-02, csupn=5.9766e-02, max_rho=4.0000e+01, al_update=False\n",
      "\u001b[1mINFO    \u001b[0m |  step #29: cost=0.1624 lambd=0.0320 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - stretching_cost(20): 0.00240 (avg 0.00012)\n",
      "\u001b[1mINFO    \u001b[0m |      - bending_cost(19): 0.00337 (avg 0.00018)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_tip_displacement_constraint(1): 0.14999 (avg 0.14999)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_position_constraint(1): 0.00086 (avg 0.00043)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_angle_constraint(1): 0.00581 (avg 0.00581)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=3.17e+02 cost_prev=0.1624 cost_new=0.1586\n",
      "\u001b[1mINFO    \u001b[0m |  AL update: snorm=5.8589e-02, csupn=5.8589e-02, max_rho=4.0000e+01, al_update=False\n",
      "\u001b[1mINFO    \u001b[0m |  step #30: cost=0.1586 lambd=0.0160 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - stretching_cost(20): 0.00076 (avg 0.00004)\n",
      "\u001b[1mINFO    \u001b[0m |      - bending_cost(19): 0.00746 (avg 0.00039)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_tip_displacement_constraint(1): 0.14712 (avg 0.14712)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_position_constraint(1): 0.00051 (avg 0.00025)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_angle_constraint(1): 0.00271 (avg 0.00271)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=2.46e+02 cost_prev=0.1586 cost_new=0.1555\n",
      "\u001b[1mINFO    \u001b[0m |  AL update: snorm=5.6100e-02, csupn=5.6100e-02, max_rho=4.0000e+01, al_update=False\n",
      "\u001b[1mINFO    \u001b[0m |  step #31: cost=0.1555 lambd=0.0080 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - stretching_cost(20): 0.00136 (avg 0.00007)\n",
      "\u001b[1mINFO    \u001b[0m |      - bending_cost(19): 0.00542 (avg 0.00029)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_tip_displacement_constraint(1): 0.14114 (avg 0.14114)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_position_constraint(1): 0.00065 (avg 0.00033)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_angle_constraint(1): 0.00695 (avg 0.00695)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=2.79e+02 cost_prev=0.1555 cost_new=0.1528\n",
      "\u001b[1mINFO    \u001b[0m |  AL update: snorm=5.5418e-02, csupn=5.5418e-02, max_rho=4.0000e+01, al_update=False\n",
      "\u001b[1mINFO    \u001b[0m |  step #32: cost=0.1528 lambd=0.0040 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - stretching_cost(20): 0.00025 (avg 0.00001)\n",
      "\u001b[1mINFO    \u001b[0m |      - bending_cost(19): 0.00866 (avg 0.00046)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_tip_displacement_constraint(1): 0.13953 (avg 0.13953)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_position_constraint(1): 0.00041 (avg 0.00021)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_angle_constraint(1): 0.00392 (avg 0.00392)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=1.51e+02 cost_prev=0.1528 cost_new=0.1513\n",
      "\u001b[1mINFO    \u001b[0m |  AL update: snorm=5.4065e-02, csupn=5.4065e-02, max_rho=1.6000e+02, al_update=True\n",
      "\u001b[1mINFO    \u001b[0m |  step #33: cost=0.3288 lambd=0.0020 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - stretching_cost(20): 0.00030 (avg 0.00001)\n",
      "\u001b[1mINFO    \u001b[0m |      - bending_cost(19): 0.00792 (avg 0.00042)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_tip_displacement_constraint(1): 0.29184 (avg 0.29184)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_position_constraint(1): 0.00119 (avg 0.00060)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_angle_constraint(1): 0.02758 (avg 0.02758)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=1.11e+02 cost_prev=0.3288 cost_new=0.3160\n",
      "\u001b[1mINFO    \u001b[0m |  AL update: snorm=5.2670e-02, csupn=5.2670e-02, max_rho=1.6000e+02, al_update=False\n",
      "\u001b[1mINFO    \u001b[0m |  step #34: cost=0.3160 lambd=0.0010 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - stretching_cost(20): 0.00527 (avg 0.00026)\n",
      "\u001b[1mINFO    \u001b[0m |      - bending_cost(19): 0.02070 (avg 0.00109)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_tip_displacement_constraint(1): 0.28710 (avg 0.28710)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_position_constraint(1): 0.00052 (avg 0.00026)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_angle_constraint(1): 0.00242 (avg 0.00242)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=8.82e+02 cost_prev=0.3160 cost_new=0.3082\n",
      "\u001b[1mINFO    \u001b[0m |  AL update: snorm=5.0781e-02, csupn=5.0781e-02, max_rho=1.6000e+02, al_update=False\n",
      "\u001b[1mINFO    \u001b[0m |  step #35: cost=0.3082 lambd=0.0005 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - stretching_cost(20): 0.00158 (avg 0.00008)\n",
      "\u001b[1mINFO    \u001b[0m |      - bending_cost(19): 0.01972 (avg 0.00104)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_tip_displacement_constraint(1): 0.28073 (avg 0.28073)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_position_constraint(1): 0.00048 (avg 0.00024)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_angle_constraint(1): 0.00573 (avg 0.00573)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=2.09e+02 cost_prev=0.3082 cost_new=0.3039\n",
      "\u001b[1mINFO    \u001b[0m |  AL update: snorm=4.9496e-02, csupn=4.9496e-02, max_rho=1.6000e+02, al_update=False\n",
      "\u001b[1mINFO    \u001b[0m |  step #36: cost=0.3039 lambd=0.0003 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - stretching_cost(20): 0.00090 (avg 0.00004)\n",
      "\u001b[1mINFO    \u001b[0m |      - bending_cost(19): 0.02304 (avg 0.00121)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_tip_displacement_constraint(1): 0.27644 (avg 0.27644)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_position_constraint(1): 0.00023 (avg 0.00012)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_angle_constraint(1): 0.00329 (avg 0.00329)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=2.32e+02 cost_prev=0.3039 cost_new=0.2996\n",
      "\u001b[1mINFO    \u001b[0m |  AL update: snorm=4.6832e-02, csupn=4.6832e-02, max_rho=1.6000e+02, al_update=False\n",
      "\u001b[1mINFO    \u001b[0m |  step #37: cost=0.2996 lambd=0.0001 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - stretching_cost(20): 0.00217 (avg 0.00011)\n",
      "\u001b[1mINFO    \u001b[0m |      - bending_cost(19): 0.02266 (avg 0.00119)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_tip_displacement_constraint(1): 0.26765 (avg 0.26765)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_position_constraint(1): 0.00006 (avg 0.00003)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_angle_constraint(1): 0.00707 (avg 0.00707)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=2.54e+02 cost_prev=0.2996 cost_new=0.2940\n",
      "\u001b[1mINFO    \u001b[0m |  AL update: snorm=4.5509e-02, csupn=4.5509e-02, max_rho=1.6000e+02, al_update=False\n",
      "\u001b[1mINFO    \u001b[0m |  step #38: cost=0.2940 lambd=0.0001 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - stretching_cost(20): 0.00137 (avg 0.00007)\n",
      "\u001b[1mINFO    \u001b[0m |      - bending_cost(19): 0.02549 (avg 0.00134)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_tip_displacement_constraint(1): 0.26334 (avg 0.26334)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_position_constraint(1): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_angle_constraint(1): 0.00375 (avg 0.00375)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=2.72e+02 cost_prev=0.2940 cost_new=0.2915\n",
      "\u001b[1mINFO    \u001b[0m |  AL update: snorm=3.5956e-02, csupn=3.5956e-02, max_rho=1.6000e+02, al_update=True\n",
      "\u001b[1mINFO    \u001b[0m |  step #39: cost=0.4565 lambd=0.0000 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - stretching_cost(20): 0.01560 (avg 0.00078)\n",
      "\u001b[1mINFO    \u001b[0m |      - bending_cost(19): 0.02809 (avg 0.00148)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_tip_displacement_constraint(1): 0.35601 (avg 0.35601)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_position_constraint(1): 0.02264 (avg 0.01132)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_angle_constraint(1): 0.03419 (avg 0.03419)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=7.16e+02 cost_prev=0.4565 cost_new=0.4505\n",
      "\u001b[1mINFO    \u001b[0m |  AL update: snorm=3.3203e-02, csupn=3.3203e-02, max_rho=1.6000e+02, al_update=False\n",
      "\u001b[1mINFO    \u001b[0m |  step #40: cost=0.4505 lambd=0.0000 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - stretching_cost(20): 0.02579 (avg 0.00129)\n",
      "\u001b[1mINFO    \u001b[0m |      - bending_cost(19): 0.03775 (avg 0.00199)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_tip_displacement_constraint(1): 0.34569 (avg 0.34569)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_position_constraint(1): 0.02936 (avg 0.01468)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_angle_constraint(1): 0.01196 (avg 0.01196)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=1.44e+03 cost_prev=0.4505 cost_new=0.4260\n",
      "\u001b[1mINFO    \u001b[0m |  AL update: snorm=3.0653e-02, csupn=3.0653e-02, max_rho=1.6000e+02, al_update=False\n",
      "\u001b[1mINFO    \u001b[0m |  step #41: cost=0.4260 lambd=0.0000 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - stretching_cost(20): 0.00482 (avg 0.00024)\n",
      "\u001b[1mINFO    \u001b[0m |      - bending_cost(19): 0.05163 (avg 0.00272)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_tip_displacement_constraint(1): 0.33628 (avg 0.33628)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_position_constraint(1): 0.02190 (avg 0.01095)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_angle_constraint(1): 0.01136 (avg 0.01136)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=3.32e+02 cost_prev=0.4260 cost_new=0.4195\n",
      "\u001b[1mINFO    \u001b[0m |  AL update: snorm=3.0038e-02, csupn=3.0038e-02, max_rho=1.6000e+02, al_update=False\n",
      "\u001b[1mINFO    \u001b[0m |  step #42: cost=0.4195 lambd=0.0000 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - stretching_cost(20): 0.00013 (avg 0.00001)\n",
      "\u001b[1mINFO    \u001b[0m |      - bending_cost(19): 0.04911 (avg 0.00258)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_tip_displacement_constraint(1): 0.33403 (avg 0.33403)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_position_constraint(1): 0.02109 (avg 0.01054)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_angle_constraint(1): 0.01515 (avg 0.01515)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=9.34e+01 cost_prev=0.4195 cost_new=0.4190\n",
      "\u001b[1mINFO    \u001b[0m |  AL update: snorm=2.8847e-02, csupn=2.8847e-02, max_rho=6.4000e+02, al_update=True\n",
      "\u001b[1mINFO    \u001b[0m |  step #43: cost=0.6510 lambd=0.0000 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - stretching_cost(20): 0.00032 (avg 0.00002)\n",
      "\u001b[1mINFO    \u001b[0m |      - bending_cost(19): 0.05515 (avg 0.00290)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_tip_displacement_constraint(1): 0.44276 (avg 0.44276)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_position_constraint(1): 0.10073 (avg 0.05036)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_angle_constraint(1): 0.05204 (avg 0.05204)\n",
      "\u001b[1mINFO    \u001b[0m |  step #44: cost=0.6510 lambd=0.0000 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - stretching_cost(20): 0.00032 (avg 0.00002)\n",
      "\u001b[1mINFO    \u001b[0m |      - bending_cost(19): 0.05515 (avg 0.00290)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_tip_displacement_constraint(1): 0.44276 (avg 0.44276)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_position_constraint(1): 0.10073 (avg 0.05036)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_angle_constraint(1): 0.05204 (avg 0.05204)\n",
      "\u001b[1mINFO    \u001b[0m |  step #45: cost=0.6510 lambd=0.0000 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - stretching_cost(20): 0.00032 (avg 0.00002)\n",
      "\u001b[1mINFO    \u001b[0m |      - bending_cost(19): 0.05515 (avg 0.00290)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_tip_displacement_constraint(1): 0.44276 (avg 0.44276)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_position_constraint(1): 0.10073 (avg 0.05036)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_angle_constraint(1): 0.05204 (avg 0.05204)\n",
      "\u001b[1mINFO    \u001b[0m |  step #46: cost=0.6510 lambd=0.0001 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - stretching_cost(20): 0.00032 (avg 0.00002)\n",
      "\u001b[1mINFO    \u001b[0m |      - bending_cost(19): 0.05515 (avg 0.00290)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_tip_displacement_constraint(1): 0.44276 (avg 0.44276)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_position_constraint(1): 0.10073 (avg 0.05036)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_angle_constraint(1): 0.05204 (avg 0.05204)\n",
      "\u001b[1mINFO    \u001b[0m |  step #47: cost=0.6510 lambd=0.0002 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - stretching_cost(20): 0.00032 (avg 0.00002)\n",
      "\u001b[1mINFO    \u001b[0m |      - bending_cost(19): 0.05515 (avg 0.00290)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_tip_displacement_constraint(1): 0.44276 (avg 0.44276)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_position_constraint(1): 0.10073 (avg 0.05036)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_angle_constraint(1): 0.05204 (avg 0.05204)\n",
      "\u001b[1mINFO    \u001b[0m |  step #48: cost=0.6510 lambd=0.0003 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - stretching_cost(20): 0.00032 (avg 0.00002)\n",
      "\u001b[1mINFO    \u001b[0m |      - bending_cost(19): 0.05515 (avg 0.00290)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_tip_displacement_constraint(1): 0.44276 (avg 0.44276)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_position_constraint(1): 0.10073 (avg 0.05036)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_angle_constraint(1): 0.05204 (avg 0.05204)\n",
      "\u001b[1mINFO    \u001b[0m |  step #49: cost=0.6510 lambd=0.0006 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - stretching_cost(20): 0.00032 (avg 0.00002)\n",
      "\u001b[1mINFO    \u001b[0m |      - bending_cost(19): 0.05515 (avg 0.00290)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_tip_displacement_constraint(1): 0.44276 (avg 0.44276)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_position_constraint(1): 0.10073 (avg 0.05036)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_angle_constraint(1): 0.05204 (avg 0.05204)\n",
      "\u001b[1mINFO    \u001b[0m |  step #50: cost=0.6510 lambd=0.0013 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - stretching_cost(20): 0.00032 (avg 0.00002)\n",
      "\u001b[1mINFO    \u001b[0m |      - bending_cost(19): 0.05515 (avg 0.00290)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_tip_displacement_constraint(1): 0.44276 (avg 0.44276)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_position_constraint(1): 0.10073 (avg 0.05036)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_angle_constraint(1): 0.05204 (avg 0.05204)\n",
      "\u001b[1mINFO    \u001b[0m |  step #51: cost=0.6510 lambd=0.0026 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - stretching_cost(20): 0.00032 (avg 0.00002)\n",
      "\u001b[1mINFO    \u001b[0m |      - bending_cost(19): 0.05515 (avg 0.00290)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_tip_displacement_constraint(1): 0.44276 (avg 0.44276)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_position_constraint(1): 0.10073 (avg 0.05036)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_angle_constraint(1): 0.05204 (avg 0.05204)\n",
      "\u001b[1mINFO    \u001b[0m |  step #52: cost=0.6510 lambd=0.0051 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - stretching_cost(20): 0.00032 (avg 0.00002)\n",
      "\u001b[1mINFO    \u001b[0m |      - bending_cost(19): 0.05515 (avg 0.00290)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_tip_displacement_constraint(1): 0.44276 (avg 0.44276)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_position_constraint(1): 0.10073 (avg 0.05036)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_angle_constraint(1): 0.05204 (avg 0.05204)\n",
      "\u001b[1mINFO    \u001b[0m |  step #53: cost=0.6510 lambd=0.0102 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - stretching_cost(20): 0.00032 (avg 0.00002)\n",
      "\u001b[1mINFO    \u001b[0m |      - bending_cost(19): 0.05515 (avg 0.00290)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_tip_displacement_constraint(1): 0.44276 (avg 0.44276)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_position_constraint(1): 0.10073 (avg 0.05036)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_angle_constraint(1): 0.05204 (avg 0.05204)\n",
      "\u001b[1mINFO    \u001b[0m |  step #54: cost=0.6510 lambd=0.0205 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - stretching_cost(20): 0.00032 (avg 0.00002)\n",
      "\u001b[1mINFO    \u001b[0m |      - bending_cost(19): 0.05515 (avg 0.00290)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_tip_displacement_constraint(1): 0.44276 (avg 0.44276)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_position_constraint(1): 0.10073 (avg 0.05036)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_angle_constraint(1): 0.05204 (avg 0.05204)\n",
      "\u001b[1mINFO    \u001b[0m |  step #55: cost=0.6510 lambd=0.0410 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - stretching_cost(20): 0.00032 (avg 0.00002)\n",
      "\u001b[1mINFO    \u001b[0m |      - bending_cost(19): 0.05515 (avg 0.00290)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_tip_displacement_constraint(1): 0.44276 (avg 0.44276)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_position_constraint(1): 0.10073 (avg 0.05036)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_angle_constraint(1): 0.05204 (avg 0.05204)\n",
      "\u001b[1mINFO    \u001b[0m |  step #56: cost=0.6510 lambd=0.0819 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - stretching_cost(20): 0.00032 (avg 0.00002)\n",
      "\u001b[1mINFO    \u001b[0m |      - bending_cost(19): 0.05515 (avg 0.00290)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_tip_displacement_constraint(1): 0.44276 (avg 0.44276)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_position_constraint(1): 0.10073 (avg 0.05036)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_angle_constraint(1): 0.05204 (avg 0.05204)\n",
      "\u001b[1mINFO    \u001b[0m |  step #57: cost=0.6510 lambd=0.1638 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - stretching_cost(20): 0.00032 (avg 0.00002)\n",
      "\u001b[1mINFO    \u001b[0m |      - bending_cost(19): 0.05515 (avg 0.00290)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_tip_displacement_constraint(1): 0.44276 (avg 0.44276)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_position_constraint(1): 0.10073 (avg 0.05036)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_angle_constraint(1): 0.05204 (avg 0.05204)\n",
      "\u001b[1mINFO    \u001b[0m |  step #58: cost=0.6510 lambd=0.3277 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - stretching_cost(20): 0.00032 (avg 0.00002)\n",
      "\u001b[1mINFO    \u001b[0m |      - bending_cost(19): 0.05515 (avg 0.00290)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_tip_displacement_constraint(1): 0.44276 (avg 0.44276)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_position_constraint(1): 0.10073 (avg 0.05036)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_angle_constraint(1): 0.05204 (avg 0.05204)\n",
      "\u001b[1mINFO    \u001b[0m |  step #59: cost=0.6510 lambd=0.6554 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - stretching_cost(20): 0.00032 (avg 0.00002)\n",
      "\u001b[1mINFO    \u001b[0m |      - bending_cost(19): 0.05515 (avg 0.00290)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_tip_displacement_constraint(1): 0.44276 (avg 0.44276)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_position_constraint(1): 0.10073 (avg 0.05036)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_angle_constraint(1): 0.05204 (avg 0.05204)\n",
      "\u001b[1mINFO    \u001b[0m |  step #60: cost=0.6510 lambd=1.3107 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - stretching_cost(20): 0.00032 (avg 0.00002)\n",
      "\u001b[1mINFO    \u001b[0m |      - bending_cost(19): 0.05515 (avg 0.00290)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_tip_displacement_constraint(1): 0.44276 (avg 0.44276)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_position_constraint(1): 0.10073 (avg 0.05036)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_angle_constraint(1): 0.05204 (avg 0.05204)\n",
      "\u001b[1mINFO    \u001b[0m |  step #61: cost=0.6510 lambd=2.6214 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - stretching_cost(20): 0.00032 (avg 0.00002)\n",
      "\u001b[1mINFO    \u001b[0m |      - bending_cost(19): 0.05515 (avg 0.00290)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_tip_displacement_constraint(1): 0.44276 (avg 0.44276)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_position_constraint(1): 0.10073 (avg 0.05036)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_angle_constraint(1): 0.05204 (avg 0.05204)\n",
      "\u001b[1mINFO    \u001b[0m |  step #62: cost=0.6510 lambd=5.2429 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - stretching_cost(20): 0.00032 (avg 0.00002)\n",
      "\u001b[1mINFO    \u001b[0m |      - bending_cost(19): 0.05515 (avg 0.00290)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_tip_displacement_constraint(1): 0.44276 (avg 0.44276)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_position_constraint(1): 0.10073 (avg 0.05036)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_angle_constraint(1): 0.05204 (avg 0.05204)\n",
      "\u001b[1mINFO    \u001b[0m |  step #63: cost=0.6510 lambd=10.4858 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - stretching_cost(20): 0.00032 (avg 0.00002)\n",
      "\u001b[1mINFO    \u001b[0m |      - bending_cost(19): 0.05515 (avg 0.00290)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_tip_displacement_constraint(1): 0.44276 (avg 0.44276)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_position_constraint(1): 0.10073 (avg 0.05036)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_angle_constraint(1): 0.05204 (avg 0.05204)\n",
      "\u001b[1mINFO    \u001b[0m |  step #64: cost=0.6510 lambd=20.9715 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - stretching_cost(20): 0.00032 (avg 0.00002)\n",
      "\u001b[1mINFO    \u001b[0m |      - bending_cost(19): 0.05515 (avg 0.00290)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_tip_displacement_constraint(1): 0.44276 (avg 0.44276)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_position_constraint(1): 0.10073 (avg 0.05036)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_angle_constraint(1): 0.05204 (avg 0.05204)\n",
      "\u001b[1mINFO    \u001b[0m |  step #65: cost=0.6510 lambd=41.9430 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - stretching_cost(20): 0.00032 (avg 0.00002)\n",
      "\u001b[1mINFO    \u001b[0m |      - bending_cost(19): 0.05515 (avg 0.00290)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_tip_displacement_constraint(1): 0.44276 (avg 0.44276)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_position_constraint(1): 0.10073 (avg 0.05036)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_angle_constraint(1): 0.05204 (avg 0.05204)\n",
      "\u001b[1mINFO    \u001b[0m |  step #66: cost=0.6510 lambd=83.8861 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - stretching_cost(20): 0.00032 (avg 0.00002)\n",
      "\u001b[1mINFO    \u001b[0m |      - bending_cost(19): 0.05515 (avg 0.00290)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_tip_displacement_constraint(1): 0.44276 (avg 0.44276)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_position_constraint(1): 0.10073 (avg 0.05036)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_angle_constraint(1): 0.05204 (avg 0.05204)\n",
      "\u001b[1mINFO    \u001b[0m |  step #67: cost=0.6510 lambd=167.7722 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - stretching_cost(20): 0.00032 (avg 0.00002)\n",
      "\u001b[1mINFO    \u001b[0m |      - bending_cost(19): 0.05515 (avg 0.00290)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_tip_displacement_constraint(1): 0.44276 (avg 0.44276)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_position_constraint(1): 0.10073 (avg 0.05036)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_angle_constraint(1): 0.05204 (avg 0.05204)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=1.32e+02 cost_prev=0.6510 cost_new=0.6382\n",
      "\u001b[1mINFO    \u001b[0m |  AL update: snorm=2.9214e-02, csupn=2.9214e-02, max_rho=6.4000e+02, al_update=False\n",
      "\u001b[1mINFO    \u001b[0m |  step #68: cost=0.6382 lambd=83.8861 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - stretching_cost(20): 0.02127 (avg 0.00106)\n",
      "\u001b[1mINFO    \u001b[0m |      - bending_cost(19): 0.03760 (avg 0.00198)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_tip_displacement_constraint(1): 0.44431 (avg 0.44431)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_position_constraint(1): 0.04885 (avg 0.02443)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_angle_constraint(1): 0.08618 (avg 0.08618)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=1.09e+03 cost_prev=0.6382 cost_new=0.6095\n",
      "\u001b[1mINFO    \u001b[0m |  AL update: snorm=2.5871e-02, csupn=2.5871e-02, max_rho=6.4000e+02, al_update=False\n",
      "\u001b[1mINFO    \u001b[0m |  step #69: cost=0.6095 lambd=41.9430 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - stretching_cost(20): 0.01619 (avg 0.00081)\n",
      "\u001b[1mINFO    \u001b[0m |      - bending_cost(19): 0.04851 (avg 0.00255)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_tip_displacement_constraint(1): 0.43033 (avg 0.43033)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_position_constraint(1): 0.01958 (avg 0.00979)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_angle_constraint(1): 0.09490 (avg 0.09490)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=8.38e+02 cost_prev=0.6095 cost_new=0.5957\n",
      "\u001b[1mINFO    \u001b[0m |  AL update: snorm=2.3134e-02, csupn=2.3134e-02, max_rho=6.4000e+02, al_update=False\n",
      "\u001b[1mINFO    \u001b[0m |  step #70: cost=0.5957 lambd=20.9715 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - stretching_cost(20): 0.00900 (avg 0.00045)\n",
      "\u001b[1mINFO    \u001b[0m |      - bending_cost(19): 0.06840 (avg 0.00360)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_tip_displacement_constraint(1): 0.41905 (avg 0.41905)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_position_constraint(1): 0.01811 (avg 0.00905)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_angle_constraint(1): 0.08114 (avg 0.08114)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=8.58e+02 cost_prev=0.5957 cost_new=0.5843\n",
      "\u001b[1mINFO    \u001b[0m |  AL update: snorm=2.3056e-02, csupn=2.3056e-02, max_rho=6.4000e+02, al_update=False\n",
      "\u001b[1mINFO    \u001b[0m |  step #71: cost=0.5843 lambd=10.4858 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - stretching_cost(20): 0.00036 (avg 0.00002)\n",
      "\u001b[1mINFO    \u001b[0m |      - bending_cost(19): 0.06473 (avg 0.00341)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_tip_displacement_constraint(1): 0.41873 (avg 0.41873)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_position_constraint(1): 0.00990 (avg 0.00495)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_angle_constraint(1): 0.09062 (avg 0.09062)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=1.08e+02 cost_prev=0.5843 cost_new=0.5833\n",
      "\u001b[1mINFO    \u001b[0m |  AL update: snorm=2.1662e-02, csupn=2.1662e-02, max_rho=6.4000e+02, al_update=True\n",
      "\u001b[1mINFO    \u001b[0m |  step #72: cost=0.6723 lambd=5.2429 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - stretching_cost(20): 0.00074 (avg 0.00004)\n",
      "\u001b[1mINFO    \u001b[0m |      - bending_cost(19): 0.07487 (avg 0.00394)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_tip_displacement_constraint(1): 0.50578 (avg 0.50578)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_position_constraint(1): 0.01863 (avg 0.00932)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_angle_constraint(1): 0.07225 (avg 0.07225)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=2.50e+02 cost_prev=0.6723 cost_new=0.6656\n",
      "\u001b[1mINFO    \u001b[0m |  AL update: snorm=1.9406e-02, csupn=1.9406e-02, max_rho=6.4000e+02, al_update=False\n",
      "\u001b[1mINFO    \u001b[0m |  step #73: cost=0.6656 lambd=2.6214 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - stretching_cost(20): 0.00623 (avg 0.00031)\n",
      "\u001b[1mINFO    \u001b[0m |      - bending_cost(19): 0.11228 (avg 0.00591)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_tip_displacement_constraint(1): 0.49569 (avg 0.49569)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_position_constraint(1): 0.01931 (avg 0.00965)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_angle_constraint(1): 0.03210 (avg 0.03210)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=8.04e+02 cost_prev=0.6656 cost_new=0.6581\n",
      "\u001b[1mINFO    \u001b[0m |  AL update: snorm=1.9537e-02, csupn=1.9537e-02, max_rho=6.4000e+02, al_update=False\n",
      "\u001b[1mINFO    \u001b[0m |  step #74: cost=0.6581 lambd=1.3107 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - stretching_cost(20): 0.00009 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - bending_cost(19): 0.11305 (avg 0.00595)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_tip_displacement_constraint(1): 0.49627 (avg 0.49627)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_position_constraint(1): 0.01417 (avg 0.00709)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_angle_constraint(1): 0.03451 (avg 0.03451)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=6.04e+01 cost_prev=0.6581 cost_new=0.6575\n",
      "\u001b[1mINFO    \u001b[0m |  AL update: snorm=1.8824e-02, csupn=1.8824e-02, max_rho=6.4000e+02, al_update=True\n",
      "\u001b[1mINFO    \u001b[0m |  step #75: cost=0.7617 lambd=0.6554 inexact_tol=5.1e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - stretching_cost(20): 0.00005 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - bending_cost(19): 0.11825 (avg 0.00622)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_tip_displacement_constraint(1): 0.58024 (avg 0.58024)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_position_constraint(1): 0.01602 (avg 0.00801)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_angle_constraint(1): 0.04712 (avg 0.04712)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=7.40e+01 cost_prev=0.7617 cost_new=0.7603\n",
      "\u001b[1mINFO    \u001b[0m |  AL update: snorm=1.8411e-02, csupn=1.8411e-02, max_rho=6.4000e+02, al_update=False\n",
      "\u001b[1mINFO    \u001b[0m |  step #76: cost=0.7603 lambd=0.3277 inexact_tol=5.1e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - stretching_cost(20): 0.00008 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - bending_cost(19): 0.12885 (avg 0.00678)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_tip_displacement_constraint(1): 0.57826 (avg 0.57826)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_position_constraint(1): 0.01321 (avg 0.00661)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_angle_constraint(1): 0.03991 (avg 0.03991)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=7.16e+01 cost_prev=0.7603 cost_new=0.7600\n",
      "\u001b[1mINFO    \u001b[0m |  AL update: snorm=1.7996e-02, csupn=1.7996e-02, max_rho=1.6000e+02, al_update=True\n",
      "\u001b[1mINFO    \u001b[0m |  step #77: cost=0.4741 lambd=0.1638 inexact_tol=5.1e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - stretching_cost(20): 0.00003 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - bending_cost(19): 0.13102 (avg 0.00690)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_tip_displacement_constraint(1): 0.24342 (avg 0.24342)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_position_constraint(1): 0.05270 (avg 0.02635)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_angle_constraint(1): 0.04693 (avg 0.04693)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=6.03e+01 cost_prev=0.4741 cost_new=0.4729\n",
      "\u001b[1mINFO    \u001b[0m |  AL update: snorm=1.6321e-02, csupn=1.6321e-02, max_rho=1.6000e+02, al_update=False\n",
      "\u001b[1mINFO    \u001b[0m |  step #78: cost=0.4729 lambd=0.0819 inexact_tol=5.1e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - stretching_cost(20): 0.00067 (avg 0.00003)\n",
      "\u001b[1mINFO    \u001b[0m |      - bending_cost(19): 0.14681 (avg 0.00773)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_tip_displacement_constraint(1): 0.23308 (avg 0.23308)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_position_constraint(1): 0.05410 (avg 0.02705)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_angle_constraint(1): 0.03825 (avg 0.03825)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=2.93e+02 cost_prev=0.4729 cost_new=0.4711\n",
      "\u001b[1mINFO    \u001b[0m |  AL update: snorm=1.5923e-02, csupn=1.5923e-02, max_rho=6.4000e+02, al_update=True\n",
      "\u001b[1mINFO    \u001b[0m |  step #79: cost=0.5429 lambd=0.0410 inexact_tol=5.1e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - stretching_cost(20): 0.00013 (avg 0.00001)\n",
      "\u001b[1mINFO    \u001b[0m |      - bending_cost(19): 0.14717 (avg 0.00775)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_tip_displacement_constraint(1): 0.33753 (avg 0.33753)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_position_constraint(1): 0.00861 (avg 0.00430)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_angle_constraint(1): 0.04943 (avg 0.04943)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=7.34e+01 cost_prev=0.5429 cost_new=0.5410\n",
      "\u001b[1mINFO    \u001b[0m |  AL update: snorm=1.4053e-02, csupn=1.4053e-02, max_rho=6.4000e+02, al_update=False\n",
      "\u001b[1mINFO    \u001b[0m |  step #80: cost=0.5410 lambd=0.0205 inexact_tol=5.1e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - stretching_cost(20): 0.00139 (avg 0.00007)\n",
      "\u001b[1mINFO    \u001b[0m |      - bending_cost(19): 0.16444 (avg 0.00865)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_tip_displacement_constraint(1): 0.32392 (avg 0.32392)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_position_constraint(1): 0.01145 (avg 0.00573)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_angle_constraint(1): 0.03979 (avg 0.03979)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=3.89e+02 cost_prev=0.5410 cost_new=0.5378\n",
      "\u001b[1mINFO    \u001b[0m |  AL update: snorm=1.3247e-02, csupn=1.3247e-02, max_rho=2.5600e+03, al_update=True\n",
      "\u001b[1mINFO    \u001b[0m |  step #81: cost=0.6320 lambd=0.0102 inexact_tol=5.1e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - stretching_cost(20): 0.00035 (avg 0.00002)\n",
      "\u001b[1mINFO    \u001b[0m |      - bending_cost(19): 0.16886 (avg 0.00889)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_tip_displacement_constraint(1): 0.41967 (avg 0.41967)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_position_constraint(1): 0.00019 (avg 0.00009)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_angle_constraint(1): 0.04290 (avg 0.04290)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=1.24e+02 cost_prev=0.6320 cost_new=0.6270\n",
      "\u001b[1mINFO    \u001b[0m |  AL update: snorm=1.1783e-02, csupn=1.1783e-02, max_rho=2.5600e+03, al_update=False\n",
      "\u001b[1mINFO    \u001b[0m |  step #82: cost=0.6270 lambd=0.0051 inexact_tol=5.1e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - stretching_cost(20): 0.00079 (avg 0.00004)\n",
      "\u001b[1mINFO    \u001b[0m |      - bending_cost(19): 0.17964 (avg 0.00945)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_tip_displacement_constraint(1): 0.40776 (avg 0.40776)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_position_constraint(1): 0.00113 (avg 0.00056)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_angle_constraint(1): 0.03765 (avg 0.03765)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=3.42e+02 cost_prev=0.6270 cost_new=0.6231\n",
      "\u001b[1mINFO    \u001b[0m |  AL update: snorm=9.5067e-03, csupn=9.5067e-03, max_rho=1.0240e+04, al_update=True\n",
      "\u001b[1mINFO    \u001b[0m |  step #83: cost=0.6794 lambd=0.0026 inexact_tol=5.1e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - stretching_cost(20): 0.00063 (avg 0.00003)\n",
      "\u001b[1mINFO    \u001b[0m |      - bending_cost(19): 0.19030 (avg 0.01002)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_tip_displacement_constraint(1): 0.46826 (avg 0.46826)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_position_constraint(1): 0.01069 (avg 0.00535)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_angle_constraint(1): 0.00953 (avg 0.00953)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=1.52e+02 cost_prev=0.6794 cost_new=0.6635\n",
      "\u001b[1mINFO    \u001b[0m |  AL update: snorm=8.4886e-03, csupn=8.4886e-03, max_rho=1.0240e+04, al_update=False\n",
      "\u001b[1mINFO    \u001b[0m |  step #84: cost=0.6635 lambd=0.0013 inexact_tol=5.1e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - stretching_cost(20): 0.00038 (avg 0.00002)\n",
      "\u001b[1mINFO    \u001b[0m |      - bending_cost(19): 0.19498 (avg 0.01026)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_tip_displacement_constraint(1): 0.45949 (avg 0.45949)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_position_constraint(1): 0.00005 (avg 0.00002)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_angle_constraint(1): 0.00865 (avg 0.00865)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=2.37e+02 cost_prev=0.6635 cost_new=0.6586\n",
      "\u001b[1mINFO    \u001b[0m |  AL update: snorm=7.4633e-03, csupn=7.4633e-03, max_rho=1.0240e+04, al_update=True\n",
      "\u001b[1mINFO    \u001b[0m |  step #85: cost=0.7255 lambd=0.0006 inexact_tol=5.1e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - stretching_cost(20): 0.00027 (avg 0.00001)\n",
      "\u001b[1mINFO    \u001b[0m |      - bending_cost(19): 0.19653 (avg 0.01034)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_tip_displacement_constraint(1): 0.51635 (avg 0.51635)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_position_constraint(1): 0.00199 (avg 0.00100)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_angle_constraint(1): 0.01032 (avg 0.01032)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=2.03e+02 cost_prev=0.7255 cost_new=0.7201\n",
      "\u001b[1mINFO    \u001b[0m |  AL update: snorm=5.9570e-03, csupn=5.9570e-03, max_rho=1.0240e+04, al_update=False\n",
      "\u001b[1mINFO    \u001b[0m |  step #86: cost=0.7201 lambd=0.0003 inexact_tol=5.1e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - stretching_cost(20): 0.00155 (avg 0.00008)\n",
      "\u001b[1mINFO    \u001b[0m |      - bending_cost(19): 0.20594 (avg 0.01084)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_tip_displacement_constraint(1): 0.50275 (avg 0.50275)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_position_constraint(1): 0.00026 (avg 0.00013)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_angle_constraint(1): 0.00966 (avg 0.00966)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=4.75e+02 cost_prev=0.7201 cost_new=0.7146\n",
      "\u001b[1mINFO    \u001b[0m |  AL update: snorm=3.9215e-03, csupn=3.9215e-03, max_rho=1.0240e+04, al_update=True\n",
      "\u001b[1mINFO    \u001b[0m |  step #87: cost=0.7422 lambd=0.0002 inexact_tol=5.1e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - stretching_cost(20): 0.00084 (avg 0.00004)\n",
      "\u001b[1mINFO    \u001b[0m |      - bending_cost(19): 0.21973 (avg 0.01156)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_tip_displacement_constraint(1): 0.51980 (avg 0.51980)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_position_constraint(1): 0.00104 (avg 0.00052)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_angle_constraint(1): 0.00078 (avg 0.00078)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=1.79e+02 cost_prev=0.7422 cost_new=0.7368\n",
      "\u001b[1mINFO    \u001b[0m |  AL update: snorm=2.7477e-03, csupn=2.7477e-03, max_rho=1.0240e+04, al_update=False\n",
      "\u001b[1mINFO    \u001b[0m |  step #88: cost=0.7368 lambd=0.0001 inexact_tol=5.1e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - stretching_cost(20): 0.00041 (avg 0.00002)\n",
      "\u001b[1mINFO    \u001b[0m |      - bending_cost(19): 0.22399 (avg 0.01179)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_tip_displacement_constraint(1): 0.50915 (avg 0.50915)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_position_constraint(1): 0.00047 (avg 0.00023)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_angle_constraint(1): 0.00272 (avg 0.00272)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=2.49e+02 cost_prev=0.7368 cost_new=0.7326\n",
      "\u001b[1mINFO    \u001b[0m |  AL update: snorm=3.8385e-04, csupn=3.8385e-04, max_rho=4.0960e+04, al_update=True\n",
      "\u001b[1mINFO    \u001b[0m |  step #89: cost=2.2071 lambd=0.0000 inexact_tol=5.1e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - stretching_cost(20): 0.00163 (avg 0.00008)\n",
      "\u001b[1mINFO    \u001b[0m |      - bending_cost(19): 0.23988 (avg 0.01263)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_tip_displacement_constraint(1): 1.95556 (avg 1.95556)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_position_constraint(1): 0.00104 (avg 0.00052)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_angle_constraint(1): 0.00897 (avg 0.00897)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=3.04e+02 cost_prev=2.2071 cost_new=2.2026\n",
      "\u001b[1mINFO    \u001b[0m |  AL update: snorm=8.0416e-04, csupn=8.0416e-04, max_rho=4.0960e+04, al_update=False\n",
      "\u001b[1mINFO    \u001b[0m |  step #90: cost=2.2026 lambd=0.0000 inexact_tol=5.1e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - stretching_cost(20): 0.00013 (avg 0.00001)\n",
      "\u001b[1mINFO    \u001b[0m |      - bending_cost(19): 0.23996 (avg 0.01263)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_tip_displacement_constraint(1): 1.94811 (avg 1.94811)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_position_constraint(1): 0.00126 (avg 0.00063)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_angle_constraint(1): 0.01316 (avg 0.01316)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=1.32e+02 cost_prev=2.2026 cost_new=2.2003\n",
      "\u001b[1mINFO    \u001b[0m |  AL update: snorm=2.1305e-03, csupn=2.1305e-03, max_rho=1.6384e+05, al_update=True\n",
      "\u001b[1mINFO    \u001b[0m |  step #91: cost=0.7300 lambd=0.0000 inexact_tol=5.1e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - stretching_cost(20): 0.00025 (avg 0.00001)\n",
      "\u001b[1mINFO    \u001b[0m |      - bending_cost(19): 0.25344 (avg 0.01334)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_tip_displacement_constraint(1): 0.46479 (avg 0.46479)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_position_constraint(1): 0.00468 (avg 0.00234)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_angle_constraint(1): 0.00686 (avg 0.00686)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=2.89e+02 cost_prev=0.7300 cost_new=0.7270\n",
      "\u001b[1mINFO    \u001b[0m |  AL update: snorm=3.4043e-03, csupn=3.4043e-03, max_rho=1.6384e+05, al_update=False\n",
      "\u001b[1mINFO    \u001b[0m |  step #92: cost=0.7270 lambd=0.0000 inexact_tol=5.1e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - stretching_cost(20): 0.00063 (avg 0.00003)\n",
      "\u001b[1mINFO    \u001b[0m |      - bending_cost(19): 0.26512 (avg 0.01395)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_tip_displacement_constraint(1): 0.45387 (avg 0.45387)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_position_constraint(1): 0.00392 (avg 0.00196)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_angle_constraint(1): 0.00347 (avg 0.00347)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=2.06e+02 cost_prev=0.7270 cost_new=0.7260\n",
      "\u001b[1mINFO    \u001b[0m |  AL update: snorm=3.3836e-03, csupn=3.3836e-03, max_rho=6.5536e+05, al_update=True\n",
      "\u001b[1mINFO    \u001b[0m |  step #93: cost=0.3793 lambd=0.0000 inexact_tol=5.1e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - stretching_cost(20): 0.00002 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - bending_cost(19): 0.26495 (avg 0.01394)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_tip_displacement_constraint(1): 0.08650 (avg 0.08650)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_position_constraint(1): 0.01495 (avg 0.00748)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_angle_constraint(1): 0.01288 (avg 0.01288)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=8.55e+01 cost_prev=0.3793 cost_new=0.3747\n",
      "\u001b[1mINFO    \u001b[0m |  AL update: snorm=2.8456e-03, csupn=2.8456e-03, max_rho=6.5536e+05, al_update=False\n",
      "\u001b[1mINFO    \u001b[0m |  step #94: cost=0.3747 lambd=0.0000 inexact_tol=5.1e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - stretching_cost(20): 0.00107 (avg 0.00005)\n",
      "\u001b[1mINFO    \u001b[0m |      - bending_cost(19): 0.26684 (avg 0.01404)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_tip_displacement_constraint(1): 0.09055 (avg 0.09055)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_position_constraint(1): 0.00616 (avg 0.00308)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_angle_constraint(1): 0.01009 (avg 0.01009)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=1.94e+02 cost_prev=0.3747 cost_new=0.3723\n",
      "\u001b[1mINFO    \u001b[0m |  AL update: snorm=3.0135e-03, csupn=3.0135e-03, max_rho=6.5536e+05, al_update=True\n",
      "\u001b[1mINFO    \u001b[0m |  step #95: cost=0.3608 lambd=0.0000 inexact_tol=5.1e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - stretching_cost(20): 0.00005 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - bending_cost(19): 0.26421 (avg 0.01391)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_tip_displacement_constraint(1): 0.06795 (avg 0.06795)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_position_constraint(1): 0.01613 (avg 0.00806)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_angle_constraint(1): 0.01247 (avg 0.01247)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=1.68e+02 cost_prev=0.3608 cost_new=0.3509\n",
      "\u001b[1mINFO    \u001b[0m |  AL update: snorm=3.6381e-05, csupn=3.6381e-05, max_rho=6.5536e+05, al_update=False\n",
      "\u001b[1mINFO    \u001b[0m |  step #96: cost=0.3509 lambd=0.0000 inexact_tol=5.1e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - stretching_cost(20): 0.00265 (avg 0.00013)\n",
      "\u001b[1mINFO    \u001b[0m |      - bending_cost(19): 0.24280 (avg 0.01278)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_tip_displacement_constraint(1): 0.08956 (avg 0.08956)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_position_constraint(1): 0.00350 (avg 0.00175)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_angle_constraint(1): 0.01244 (avg 0.01244)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=7.85e+02 cost_prev=0.3509 cost_new=0.3475\n",
      "\u001b[1mINFO    \u001b[0m |  AL update: snorm=2.3238e-04, csupn=2.3238e-04, max_rho=6.5536e+05, al_update=True\n",
      "\u001b[1mINFO    \u001b[0m |  step #97: cost=0.5970 lambd=0.0000 inexact_tol=5.1e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - stretching_cost(20): 0.00006 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - bending_cost(19): 0.24433 (avg 0.01286)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_tip_displacement_constraint(1): 0.34839 (avg 0.34839)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_position_constraint(1): 0.00131 (avg 0.00066)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_angle_constraint(1): 0.00286 (avg 0.00286)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=6.33e+01 cost_prev=0.5970 cost_new=0.5962\n",
      "\u001b[1mINFO    \u001b[0m |  AL update: snorm=2.7203e-04, csupn=2.7203e-04, max_rho=6.5536e+05, al_update=False\n",
      "\u001b[1mINFO    \u001b[0m |  step #98: cost=0.5962 lambd=0.0000 inexact_tol=5.1e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - stretching_cost(20): 0.00010 (avg 0.00001)\n",
      "\u001b[1mINFO    \u001b[0m |      - bending_cost(19): 0.23999 (avg 0.01263)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_tip_displacement_constraint(1): 0.35217 (avg 0.35217)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_position_constraint(1): 0.00114 (avg 0.00057)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_angle_constraint(1): 0.00281 (avg 0.00281)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=9.47e+01 cost_prev=0.5962 cost_new=0.5957\n",
      "\u001b[1mINFO    \u001b[0m |  AL update: snorm=8.0943e-05, csupn=8.0943e-05, max_rho=2.6214e+06, al_update=True\n",
      "\u001b[1mINFO    \u001b[0m |  step #99: cost=0.5933 lambd=0.0000 inexact_tol=5.1e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - stretching_cost(20): 0.00002 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - bending_cost(19): 0.24115 (avg 0.01269)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_tip_displacement_constraint(1): 0.34967 (avg 0.34967)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_position_constraint(1): 0.00101 (avg 0.00051)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_angle_constraint(1): 0.00144 (avg 0.00144)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=1.05e+02 cost_prev=0.5933 cost_new=0.5918\n",
      "\u001b[1mINFO    \u001b[0m |  AL update: snorm=1.9535e-05, csupn=1.9535e-05, max_rho=2.6214e+06, al_update=True\n",
      "\u001b[1mINFO    \u001b[0m |  step #100: cost=0.5922 lambd=0.0000 inexact_tol=5.1e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - stretching_cost(20): 0.00003 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - bending_cost(19): 0.24070 (avg 0.01267)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_tip_displacement_constraint(1): 0.35019 (avg 0.35019)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_position_constraint(1): 0.00019 (avg 0.00010)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_fixed_angle_constraint(1): 0.00107 (avg 0.00107)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=6.05e+01 cost_prev=0.5922 cost_new=0.5916\n",
      "\u001b[1mINFO    \u001b[0m |  AL update: snorm=3.0537e-04, csupn=3.0537e-04, max_rho=2.6214e+06, al_update=True\n",
      "\u001b[1mINFO    \u001b[0m | Terminated @ iteration #100: cost=0.3285 criteria=[0 0 0 1], term_deltas=8.5e-03,3.6e+01,2.4e-05\n"
     ]
    }
   ],
   "source": [
    "# Create initial values.\n",
    "initial_vals = jaxls.VarValues.make([node_vars.with_value(initial_positions)])\n",
    "\n",
    "# Build and solve.\n",
    "problem = jaxls.LeastSquaresProblem(costs, [node_vars]).analyze()\n",
    "solution = problem.solve(initial_vals)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "cell-13",
   "metadata": {},
   "source": [
    "## Visualization"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "cell-14",
   "metadata": {
    "tags": [
     "hide-input"
    ]
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Tip deflection: -74.38 mm\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>                        <script type=\"text/javascript\">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>\n",
       "        <script charset=\"utf-8\" src=\"https://cdn.plot.ly/plotly-3.1.0.min.js\" integrity=\"sha256-Ei4740bWZhaUTQuD6q9yQlgVCMPBz6CZWhevDYPv93A=\" crossorigin=\"anonymous\"></script>                <div id=\"61c09c6c-c6bc-4c82-8488-3a93f34e2fef\" class=\"plotly-graph-div\" style=\"height:400px; width:100%;\"></div>            <script type=\"text/javascript\">                window.PLOTLYENV=window.PLOTLYENV || {};                                if (document.getElementById(\"61c09c6c-c6bc-4c82-8488-3a93f34e2fef\")) {                    Plotly.newPlot(                        \"61c09c6c-c6bc-4c82-8488-3a93f34e2fef\",                        [{\"line\":{\"color\":\"lightgray\",\"dash\":\"dash\",\"width\":3},\"marker\":{\"color\":\"lightgray\",\"size\":5},\"mode\":\"lines+markers\",\"name\":\"Initial (straight)\",\"x\":[0.0,50.00000074505806,100.00000149011612,150.00000596046448,200.00000298023224,250.0,300.00001192092896,349.9999940395355,400.0000059604645,449.99998807907104,500.0,550.000011920929,600.0000238418579,649.9999761581421,699.999988079071,750.0,800.000011920929,850.0000238418579,899.9999761581421,949.999988079071,1000.0],\"y\":[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],\"type\":\"scatter\"},{\"line\":{\"color\":\"steelblue\",\"width\":4},\"marker\":{\"color\":\"steelblue\",\"size\":6},\"mode\":\"lines+markers\",\"name\":\"Deflected\",\"x\":[0.0013573742307926295,50.00133812427521,99.99832510948181,149.98655021190643,199.96102154254913,249.91726875305176,299.8521327972412,349.7634530067444,399.64982867240906,449.5104253292084,499.3448853492737,549.1535663604736,598.9375114440918,648.6984491348267,698.4381675720215,748.1587529182434,797.8624701499939,847.5522994995117,897.2318172454834,946.9043612480164,996.5729713439941],\"y\":[-0.0019853791854984593,-0.002115011739078909,-0.5504199070855975,-1.6302716685459018,-3.224264597520232,-5.310417618602514,-7.858702912926674,-10.833965614438057,-14.202360063791275,-17.93391816318035,-22.00072444975376,-26.371577754616737,-31.014643609523773,-35.898081958293915,-40.99200293421745,-46.269990503787994,-51.70491710305214,-57.265639305114746,-62.918178737163544,-68.63231211900711,-74.37944412231445],\"type\":\"scatter\"},{\"marker\":{\"color\":\"crimson\",\"size\":15,\"symbol\":\"square\"},\"mode\":\"markers\",\"name\":\"Fixed end\",\"x\":[0],\"y\":[0],\"type\":\"scatter\"}],                        {\"template\":{\"data\":{\"histogram2dcontour\":[{\"type\":\"histogram2dcontour\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"choropleth\":[{\"type\":\"choropleth\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}],\"histogram2d\":[{\"type\":\"histogram2d\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"heatmap\":[{\"type\":\"heatmap\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"contourcarpet\":[{\"type\":\"contourcarpet\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}],\"contour\":[{\"type\":\"contour\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"surface\":[{\"type\":\"surface\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"mesh3d\":[{\"type\":\"mesh3d\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}],\"scatter\":[{\"fillpattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2},\"type\":\"scatter\"}],\"parcoords\":[{\"type\":\"parcoords\",\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scatterpolargl\":[{\"type\":\"scatterpolargl\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"bar\":[{\"error_x\":{\"color\":\"#2a3f5f\"},\"error_y\":{\"color\":\"#2a3f5f\"},\"marker\":{\"line\":{\"color\":\"#E5ECF6\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"bar\"}],\"scattergeo\":[{\"type\":\"scattergeo\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scatterpolar\":[{\"type\":\"scatterpolar\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"histogram\":[{\"marker\":{\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"histogram\"}],\"scattergl\":[{\"type\":\"scattergl\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scatter3d\":[{\"type\":\"scatter3d\",\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scattermap\":[{\"type\":\"scattermap\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scattermapbox\":[{\"type\":\"scattermapbox\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scatterternary\":[{\"type\":\"scatterternary\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scattercarpet\":[{\"type\":\"scattercarpet\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"carpet\":[{\"aaxis\":{\"endlinecolor\":\"#2a3f5f\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"minorgridcolor\":\"white\",\"startlinecolor\":\"#2a3f5f\"},\"baxis\":{\"endlinecolor\":\"#2a3f5f\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"minorgridcolor\":\"white\",\"startlinecolor\":\"#2a3f5f\"},\"type\":\"carpet\"}],\"table\":[{\"cells\":{\"fill\":{\"color\":\"#EBF0F8\"},\"line\":{\"color\":\"white\"}},\"header\":{\"fill\":{\"color\":\"#C8D4E3\"},\"line\":{\"color\":\"white\"}},\"type\":\"table\"}],\"barpolar\":[{\"marker\":{\"line\":{\"color\":\"#E5ECF6\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"barpolar\"}],\"pie\":[{\"automargin\":true,\"type\":\"pie\"}]},\"layout\":{\"autotypenumbers\":\"strict\",\"colorway\":[\"#636efa\",\"#EF553B\",\"#00cc96\",\"#ab63fa\",\"#FFA15A\",\"#19d3f3\",\"#FF6692\",\"#B6E880\",\"#FF97FF\",\"#FECB52\"],\"font\":{\"color\":\"#2a3f5f\"},\"hovermode\":\"closest\",\"hoverlabel\":{\"align\":\"left\"},\"paper_bgcolor\":\"white\",\"plot_bgcolor\":\"#E5ECF6\",\"polar\":{\"bgcolor\":\"#E5ECF6\",\"angularaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"},\"radialaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"}},\"ternary\":{\"bgcolor\":\"#E5ECF6\",\"aaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"},\"baxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"},\"caxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"}},\"coloraxis\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"colorscale\":{\"sequential\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"sequentialminus\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"diverging\":[[0,\"#8e0152\"],[0.1,\"#c51b7d\"],[0.2,\"#de77ae\"],[0.3,\"#f1b6da\"],[0.4,\"#fde0ef\"],[0.5,\"#f7f7f7\"],[0.6,\"#e6f5d0\"],[0.7,\"#b8e186\"],[0.8,\"#7fbc41\"],[0.9,\"#4d9221\"],[1,\"#276419\"]]},\"xaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"white\",\"automargin\":true,\"zerolinewidth\":2},\"yaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"white\",\"automargin\":true,\"zerolinewidth\":2},\"scene\":{\"xaxis\":{\"backgroundcolor\":\"#E5ECF6\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"white\",\"gridwidth\":2},\"yaxis\":{\"backgroundcolor\":\"#E5ECF6\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"white\",\"gridwidth\":2},\"zaxis\":{\"backgroundcolor\":\"#E5ECF6\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"white\",\"gridwidth\":2}},\"shapedefaults\":{\"line\":{\"color\":\"#2a3f5f\"}},\"annotationdefaults\":{\"arrowcolor\":\"#2a3f5f\",\"arrowhead\":0,\"arrowwidth\":1},\"geo\":{\"bgcolor\":\"white\",\"landcolor\":\"#E5ECF6\",\"subunitcolor\":\"white\",\"showland\":true,\"showlakes\":true,\"lakecolor\":\"white\"},\"title\":{\"x\":0.05},\"mapbox\":{\"style\":\"light\"}}},\"annotations\":[{\"arrowcolor\":\"orange\",\"arrowhead\":2,\"arrowsize\":1.5,\"arrowwidth\":3,\"ax\":0,\"axref\":\"pixel\",\"ay\":-40,\"ayref\":\"pixel\",\"showarrow\":true,\"x\":996.5729713439941,\"xref\":\"x\",\"y\":-74.37944412231445,\"yref\":\"y\"}],\"yaxis\":{\"title\":{\"text\":\"y [mm]\"},\"scaleanchor\":\"x\",\"scaleratio\":1},\"legend\":{\"orientation\":\"h\",\"yanchor\":\"bottom\",\"y\":1.02,\"xanchor\":\"center\",\"x\":0.5},\"margin\":{\"t\":80,\"b\":50,\"l\":50,\"r\":50},\"title\":{\"text\":\"Cantilever Beam: 3.0 N Tip Load \u2192 74.4 mm Deflection\"},\"xaxis\":{\"title\":{\"text\":\"x [mm]\"}},\"height\":400,\"showlegend\":true},                        {\"responsive\": true}                    )                };            </script>        </div>"
      ],
      "text/plain": [
       "<IPython.core.display.HTML object>"
      ]
     },
     "execution_count": 8,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "import plotly.graph_objects as go\n",
    "from IPython.display import HTML\n",
    "\n",
    "# Extract positions.\n",
    "initial_pos = initial_vals[node_vars]\n",
    "final_pos = solution[node_vars]\n",
    "\n",
    "# Compute tip deflection.\n",
    "tip_deflection = float(final_pos[-1, 1])\n",
    "print(f\"Tip deflection: {tip_deflection * 1000:.2f} mm\")\n",
    "\n",
    "# Create visualization (convert to mm)\n",
    "fig = go.Figure()\n",
    "\n",
    "# Initial (straight) beam.\n",
    "fig.add_trace(\n",
    "    go.Scatter(\n",
    "        x=[float(p) * 1000 for p in initial_pos[:, 0]],\n",
    "        y=[float(p) * 1000 for p in initial_pos[:, 1]],\n",
    "        mode=\"lines+markers\",\n",
    "        name=\"Initial (straight)\",\n",
    "        line=dict(color=\"lightgray\", width=3, dash=\"dash\"),\n",
    "        marker=dict(size=5, color=\"lightgray\"),\n",
    "    )\n",
    ")\n",
    "\n",
    "# Deflected beam.\n",
    "fig.add_trace(\n",
    "    go.Scatter(\n",
    "        x=[float(p) * 1000 for p in final_pos[:, 0]],\n",
    "        y=[float(p) * 1000 for p in final_pos[:, 1]],\n",
    "        mode=\"lines+markers\",\n",
    "        name=\"Deflected\",\n",
    "        line=dict(color=\"steelblue\", width=4),\n",
    "        marker=dict(size=6, color=\"steelblue\"),\n",
    "    )\n",
    ")\n",
    "\n",
    "# Fixed end indicator.\n",
    "fig.add_trace(\n",
    "    go.Scatter(\n",
    "        x=[0],\n",
    "        y=[0],\n",
    "        mode=\"markers\",\n",
    "        name=\"Fixed end\",\n",
    "        marker=dict(size=15, color=\"crimson\", symbol=\"square\"),\n",
    "    )\n",
    ")\n",
    "\n",
    "# Tip load indicator (arrow)\n",
    "fig.add_annotation(\n",
    "    x=float(final_pos[-1, 0]) * 1000,\n",
    "    y=float(final_pos[-1, 1]) * 1000,\n",
    "    ax=0,\n",
    "    ay=-40,\n",
    "    xref=\"x\",\n",
    "    yref=\"y\",\n",
    "    axref=\"pixel\",\n",
    "    ayref=\"pixel\",\n",
    "    showarrow=True,\n",
    "    arrowhead=2,\n",
    "    arrowsize=1.5,\n",
    "    arrowwidth=3,\n",
    "    arrowcolor=\"orange\",\n",
    ")\n",
    "\n",
    "fig.update_layout(\n",
    "    title=f\"Cantilever Beam: {tip_force} N Tip Load \u2192 {abs(tip_deflection) * 1000:.1f} mm Deflection\",\n",
    "    xaxis=dict(title=\"x [mm]\"),\n",
    "    yaxis=dict(title=\"y [mm]\", scaleanchor=\"x\", scaleratio=1),\n",
    "    height=400,\n",
    "    showlegend=True,\n",
    "    legend=dict(orientation=\"h\", yanchor=\"bottom\", y=1.02, xanchor=\"center\", x=0.5),\n",
    "    margin=dict(t=80, b=50, l=50, r=50),\n",
    ")\n",
    "\n",
    "HTML(fig.to_html(full_html=False, include_plotlyjs=\"cdn\"))"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "cell-15",
   "metadata": {},
   "source": [
    "## Varying load animation\n",
    "\n",
    "We can visualize how the beam responds to increasing load by solving for a range of tip forces. Using `jax.lax.scan`, we solve sequentially while using each solution as the initial guess for the next (warm-starting), which helps convergence for larger deflections:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "5oiusermo29",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\u001b[1mINFO    \u001b[0m | Building optimization problem with 42 terms and 21 variables: 39 costs, 3 eq_zero, 0 leq_zero, 0 geq_zero\n",
      "\u001b[1mINFO    \u001b[0m | Vectorizing group with 19 costs, 3 variables each: bending_cost\n",
      "\u001b[1mINFO    \u001b[0m | Vectorizing group with 20 costs, 2 variables each: stretching_cost\n",
      "\u001b[1mINFO    \u001b[0m | Vectorizing constraint group with 1 constraints (constraint_eq_zero), 1 variables each: augmented_fixed_position_constraint\n",
      "\u001b[1mINFO    \u001b[0m | Vectorizing constraint group with 1 constraints (constraint_eq_zero), 2 variables each: augmented_fixed_angle_constraint\n",
      "\u001b[1mINFO    \u001b[0m | Vectorizing constraint group with 1 constraints (constraint_eq_zero), 1 variables each: augmented_tip_displacement_constraint\n",
      "Generated 15 frames with shape (15, 21, 2)\n"
     ]
    }
   ],
   "source": [
    "# Solve for a range of tip forces using scan with warm-starting.\n",
    "n_frames = 15\n",
    "tip_forces = jnp.linspace(0.0, tip_force, n_frames)\n",
    "deltas = tip_forces * beam_length**3 / (3 * EI)\n",
    "\n",
    "\n",
    "def solve_for_delta(\n",
    "    current_vals: jaxls.VarValues, delta: jax.Array\n",
    ") -> tuple[jaxls.VarValues, jax.Array]:\n",
    "    \"\"\"Solve beam problem for a given tip displacement, using current_vals as warm start.\"\"\"\n",
    "    costs_f: list[jaxls.Cost] = [\n",
    "        bending_cost(\n",
    "            NodeVar(id=bending_a),\n",
    "            NodeVar(id=bending_b),\n",
    "            NodeVar(id=bending_c),\n",
    "            EI,\n",
    "            segment_length,\n",
    "        ),\n",
    "        stretching_cost(\n",
    "            NodeVar(id=stretch_a),\n",
    "            NodeVar(id=stretch_b),\n",
    "            segment_length,\n",
    "            EA,\n",
    "            segment_length,\n",
    "        ),\n",
    "        fixed_position_constraint(NodeVar(id=0), initial_positions[0]),\n",
    "        fixed_angle_constraint(NodeVar(id=0), NodeVar(id=1), jnp.array([1.0, 0.0])),\n",
    "        tip_displacement_constraint(NodeVar(id=num_nodes - 1), -delta),\n",
    "    ]\n",
    "    problem_f = jaxls.LeastSquaresProblem(costs_f, [node_vars]).analyze()\n",
    "    solution = problem_f.solve(current_vals, verbose=False)\n",
    "    return solution, solution[node_vars]\n",
    "\n",
    "\n",
    "# Solve all frames sequentially with warm-starting.\n",
    "_, frame_solutions = jax.lax.scan(solve_for_delta, initial_vals, deltas)\n",
    "print(f\"Generated {len(frame_solutions)} frames with shape {frame_solutions.shape}\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "we84m16dii",
   "metadata": {
    "tags": [
     "hide-input"
    ]
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>                        <script type=\"text/javascript\">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>\n",
       "        <script charset=\"utf-8\" src=\"https://cdn.plot.ly/plotly-3.1.0.min.js\" integrity=\"sha256-Ei4740bWZhaUTQuD6q9yQlgVCMPBz6CZWhevDYPv93A=\" crossorigin=\"anonymous\"></script>                <div id=\"f65c1f56-d103-4fee-b298-52ca3b4f8283\" class=\"plotly-graph-div\" style=\"height:400px; width:100%;\"></div>            <script type=\"text/javascript\">                window.PLOTLYENV=window.PLOTLYENV || {};                                if (document.getElementById(\"f65c1f56-d103-4fee-b298-52ca3b4f8283\")) {                    Plotly.newPlot(                        \"f65c1f56-d103-4fee-b298-52ca3b4f8283\",                        [{\"line\":{\"color\":\"steelblue\",\"width\":4},\"marker\":{\"color\":\"steelblue\",\"size\":6},\"mode\":\"lines+markers\",\"name\":\"Beam\",\"x\":[0.0,50.00000074505806,100.00000149011612,150.00000596046448,200.00000298023224,250.0,300.00001192092896,349.9999940395355,400.0000059604645,449.99998807907104,500.0,550.000011920929,600.0000238418579,649.9999761581421,699.999988079071,750.0,800.000011920929,850.0000238418579,899.9999761581421,949.999988079071,1000.0],\"y\":[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],\"type\":\"scatter\"},{\"marker\":{\"color\":\"crimson\",\"size\":15,\"symbol\":\"square\"},\"mode\":\"markers\",\"name\":\"Fixed end\",\"x\":[0],\"y\":[0],\"type\":\"scatter\"}],                        {\"height\":400,\"margin\":{\"b\":80,\"t\":80},\"showlegend\":false,\"sliders\":[{\"active\":0,\"currentvalue\":{\"prefix\":\"Force: \",\"suffix\":\" N\",\"visible\":true,\"xanchor\":\"center\"},\"len\":0.8,\"pad\":{\"b\":10,\"t\":50},\"steps\":[{\"args\":[[\"0\"],{\"frame\":{\"duration\":0,\"redraw\":true},\"mode\":\"immediate\",\"transition\":{\"duration\":0}}],\"label\":\"0.0\",\"method\":\"animate\"},{\"args\":[[\"1\"],{\"frame\":{\"duration\":0,\"redraw\":true},\"mode\":\"immediate\",\"transition\":{\"duration\":0}}],\"label\":\"0.2\",\"method\":\"animate\"},{\"args\":[[\"2\"],{\"frame\":{\"duration\":0,\"redraw\":true},\"mode\":\"immediate\",\"transition\":{\"duration\":0}}],\"label\":\"0.4\",\"method\":\"animate\"},{\"args\":[[\"3\"],{\"frame\":{\"duration\":0,\"redraw\":true},\"mode\":\"immediate\",\"transition\":{\"duration\":0}}],\"label\":\"0.6\",\"method\":\"animate\"},{\"args\":[[\"4\"],{\"frame\":{\"duration\":0,\"redraw\":true},\"mode\":\"immediate\",\"transition\":{\"duration\":0}}],\"label\":\"0.9\",\"method\":\"animate\"},{\"args\":[[\"5\"],{\"frame\":{\"duration\":0,\"redraw\":true},\"mode\":\"immediate\",\"transition\":{\"duration\":0}}],\"label\":\"1.1\",\"method\":\"animate\"},{\"args\":[[\"6\"],{\"frame\":{\"duration\":0,\"redraw\":true},\"mode\":\"immediate\",\"transition\":{\"duration\":0}}],\"label\":\"1.3\",\"method\":\"animate\"},{\"args\":[[\"7\"],{\"frame\":{\"duration\":0,\"redraw\":true},\"mode\":\"immediate\",\"transition\":{\"duration\":0}}],\"label\":\"1.5\",\"method\":\"animate\"},{\"args\":[[\"8\"],{\"frame\":{\"duration\":0,\"redraw\":true},\"mode\":\"immediate\",\"transition\":{\"duration\":0}}],\"label\":\"1.7\",\"method\":\"animate\"},{\"args\":[[\"9\"],{\"frame\":{\"duration\":0,\"redraw\":true},\"mode\":\"immediate\",\"transition\":{\"duration\":0}}],\"label\":\"1.9\",\"method\":\"animate\"},{\"args\":[[\"10\"],{\"frame\":{\"duration\":0,\"redraw\":true},\"mode\":\"immediate\",\"transition\":{\"duration\":0}}],\"label\":\"2.1\",\"method\":\"animate\"},{\"args\":[[\"11\"],{\"frame\":{\"duration\":0,\"redraw\":true},\"mode\":\"immediate\",\"transition\":{\"duration\":0}}],\"label\":\"2.4\",\"method\":\"animate\"},{\"args\":[[\"12\"],{\"frame\":{\"duration\":0,\"redraw\":true},\"mode\":\"immediate\",\"transition\":{\"duration\":0}}],\"label\":\"2.6\",\"method\":\"animate\"},{\"args\":[[\"13\"],{\"frame\":{\"duration\":0,\"redraw\":true},\"mode\":\"immediate\",\"transition\":{\"duration\":0}}],\"label\":\"2.8\",\"method\":\"animate\"},{\"args\":[[\"14\"],{\"frame\":{\"duration\":0,\"redraw\":true},\"mode\":\"immediate\",\"transition\":{\"duration\":0}}],\"label\":\"3.0\",\"method\":\"animate\"}],\"x\":0.1,\"xanchor\":\"left\",\"y\":0,\"yanchor\":\"top\"}],\"title\":{\"text\":\"Tip Load: 0.0 N \u2192 Deflection: 0.0 mm\"},\"updatemenus\":[{\"buttons\":[{\"args\":[null,{\"frame\":{\"duration\":150,\"redraw\":true},\"fromcurrent\":true,\"transition\":{\"duration\":50}}],\"label\":\"Play\",\"method\":\"animate\"},{\"args\":[[null],{\"frame\":{\"duration\":0,\"redraw\":false},\"mode\":\"immediate\"}],\"label\":\"Pause\",\"method\":\"animate\"}],\"showactive\":false,\"type\":\"buttons\",\"x\":0.5,\"xanchor\":\"center\",\"y\":1.15}],\"xaxis\":{\"range\":[-50,1050],\"title\":{\"text\":\"x [mm]\"}},\"yaxis\":{\"range\":[-100,20],\"scaleanchor\":\"x\",\"scaleratio\":1,\"title\":{\"text\":\"y [mm]\"}},\"template\":{\"data\":{\"histogram2dcontour\":[{\"type\":\"histogram2dcontour\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"choropleth\":[{\"type\":\"choropleth\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}],\"histogram2d\":[{\"type\":\"histogram2d\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"heatmap\":[{\"type\":\"heatmap\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"contourcarpet\":[{\"type\":\"contourcarpet\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}],\"contour\":[{\"type\":\"contour\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"surface\":[{\"type\":\"surface\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"mesh3d\":[{\"type\":\"mesh3d\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}],\"scatter\":[{\"fillpattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2},\"type\":\"scatter\"}],\"parcoords\":[{\"type\":\"parcoords\",\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scatterpolargl\":[{\"type\":\"scatterpolargl\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"bar\":[{\"error_x\":{\"color\":\"#2a3f5f\"},\"error_y\":{\"color\":\"#2a3f5f\"},\"marker\":{\"line\":{\"color\":\"#E5ECF6\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"bar\"}],\"scattergeo\":[{\"type\":\"scattergeo\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scatterpolar\":[{\"type\":\"scatterpolar\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"histogram\":[{\"marker\":{\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"histogram\"}],\"scattergl\":[{\"type\":\"scattergl\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scatter3d\":[{\"type\":\"scatter3d\",\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scattermap\":[{\"type\":\"scattermap\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scattermapbox\":[{\"type\":\"scattermapbox\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scatterternary\":[{\"type\":\"scatterternary\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scattercarpet\":[{\"type\":\"scattercarpet\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"carpet\":[{\"aaxis\":{\"endlinecolor\":\"#2a3f5f\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"minorgridcolor\":\"white\",\"startlinecolor\":\"#2a3f5f\"},\"baxis\":{\"endlinecolor\":\"#2a3f5f\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"minorgridcolor\":\"white\",\"startlinecolor\":\"#2a3f5f\"},\"type\":\"carpet\"}],\"table\":[{\"cells\":{\"fill\":{\"color\":\"#EBF0F8\"},\"line\":{\"color\":\"white\"}},\"header\":{\"fill\":{\"color\":\"#C8D4E3\"},\"line\":{\"color\":\"white\"}},\"type\":\"table\"}],\"barpolar\":[{\"marker\":{\"line\":{\"color\":\"#E5ECF6\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"barpolar\"}],\"pie\":[{\"automargin\":true,\"type\":\"pie\"}]},\"layout\":{\"autotypenumbers\":\"strict\",\"colorway\":[\"#636efa\",\"#EF553B\",\"#00cc96\",\"#ab63fa\",\"#FFA15A\",\"#19d3f3\",\"#FF6692\",\"#B6E880\",\"#FF97FF\",\"#FECB52\"],\"font\":{\"color\":\"#2a3f5f\"},\"hovermode\":\"closest\",\"hoverlabel\":{\"align\":\"left\"},\"paper_bgcolor\":\"white\",\"plot_bgcolor\":\"#E5ECF6\",\"polar\":{\"bgcolor\":\"#E5ECF6\",\"angularaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"},\"radialaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"}},\"ternary\":{\"bgcolor\":\"#E5ECF6\",\"aaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"},\"baxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"},\"caxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"}},\"coloraxis\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"colorscale\":{\"sequential\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"sequentialminus\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"diverging\":[[0,\"#8e0152\"],[0.1,\"#c51b7d\"],[0.2,\"#de77ae\"],[0.3,\"#f1b6da\"],[0.4,\"#fde0ef\"],[0.5,\"#f7f7f7\"],[0.6,\"#e6f5d0\"],[0.7,\"#b8e186\"],[0.8,\"#7fbc41\"],[0.9,\"#4d9221\"],[1,\"#276419\"]]},\"xaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"white\",\"automargin\":true,\"zerolinewidth\":2},\"yaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"white\",\"automargin\":true,\"zerolinewidth\":2},\"scene\":{\"xaxis\":{\"backgroundcolor\":\"#E5ECF6\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"white\",\"gridwidth\":2},\"yaxis\":{\"backgroundcolor\":\"#E5ECF6\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"white\",\"gridwidth\":2},\"zaxis\":{\"backgroundcolor\":\"#E5ECF6\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"white\",\"gridwidth\":2}},\"shapedefaults\":{\"line\":{\"color\":\"#2a3f5f\"}},\"annotationdefaults\":{\"arrowcolor\":\"#2a3f5f\",\"arrowhead\":0,\"arrowwidth\":1},\"geo\":{\"bgcolor\":\"white\",\"landcolor\":\"#E5ECF6\",\"subunitcolor\":\"white\",\"showland\":true,\"showlakes\":true,\"lakecolor\":\"white\"},\"title\":{\"x\":0.05},\"mapbox\":{\"style\":\"light\"}}}},                        {\"responsive\": true}                    ).then(function(){\n",
       "                            Plotly.addFrames('f65c1f56-d103-4fee-b298-52ca3b4f8283', [{\"data\":[{\"line\":{\"color\":\"steelblue\",\"width\":4},\"marker\":{\"color\":\"steelblue\",\"size\":6},\"mode\":\"lines+markers\",\"x\":[0.0,50.00000074505806,100.00000149011612,150.00000596046448,200.00000298023224,250.0,300.00001192092896,349.9999940395355,400.0000059604645,449.99998807907104,500.0,550.000011920929,600.0000238418579,649.9999761581421,699.999988079071,750.0,800.000011920929,850.0000238418579,899.9999761581421,949.999988079071,1000.0],\"y\":[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],\"type\":\"scatter\"},{\"marker\":{\"color\":\"crimson\",\"size\":15,\"symbol\":\"square\"},\"mode\":\"markers\",\"x\":[0],\"y\":[0],\"type\":\"scatter\"}],\"layout\":{\"title\":{\"text\":\"Tip Load: 0.0 N \u2192 Deflection: 0.0 mm\"}},\"name\":\"0\"},{\"data\":[{\"line\":{\"color\":\"steelblue\",\"width\":4},\"marker\":{\"color\":\"steelblue\",\"size\":6},\"mode\":\"lines+markers\",\"x\":[-0.000925773690596543,49.99907314777374,99.99905526638031,149.9989926815033,199.9988555908203,249.99862909317017,299.99828338623047,349.9978184700012,399.9972343444824,449.9965310096741,499.9956786632538,549.994707107544,599.9935865402222,649.9923467636108,699.99098777771,749.9895691871643,799.9880909919739,849.9864935874939,899.9848961830139,949.9831795692444,999.9815225601196],\"y\":[-0.0076685282692778856,-0.007687433935643639,-0.04846340016229078,-0.12800034892279655,-0.2442631812300533,-0.3951579856220633,-0.5785268731415272,-0.7922790246084332,-1.0342781897634268,-1.3023253995925188,-1.5941872261464596,-1.9076422322541475,-2.2404026240110397,-2.590299118310213,-2.955203875899315,-3.332969732582569,-3.721460932865739,-4.118553828448057,-4.522072151303291,-4.929837305098772,-5.33974077552557],\"type\":\"scatter\"},{\"marker\":{\"color\":\"crimson\",\"size\":15,\"symbol\":\"square\"},\"mode\":\"markers\",\"x\":[0],\"y\":[0],\"type\":\"scatter\"}],\"layout\":{\"title\":{\"text\":\"Tip Load: 0.2 N \u2192 Deflection: 5.3 mm\"}},\"name\":\"1\"},{\"data\":[{\"line\":{\"color\":\"steelblue\",\"width\":4},\"marker\":{\"color\":\"steelblue\",\"size\":6},\"mode\":\"lines+markers\",\"x\":[-0.0016971492868833593,49.99830201268196,99.99823570251465,149.99797940254211,199.9974548816681,249.99654293060303,299.99521374702454,349.99343752861023,399.99112486839294,449.98830556869507,499.9849796295166,549.9811172485352,599.9767780303955,649.9719619750977,699.9667286872864,749.9611377716064,799.9551892280579,849.9490022659302,899.9425768852234,949.936032295227,999.9294281005859],\"y\":[-0.00003580722562901428,-0.000031438133873962215,-0.08143187005771324,-0.23997954849619418,-0.4713944799732417,-0.771370658185333,-1.1355857132002711,-1.559698604978621,-2.03937035985291,-2.5702829007059336,-3.148147137835622,-3.7687027361243963,-4.4277021661400795,-5.12089766561985,-5.844044964760542,-6.59291073679924,-7.363258861005306,-8.150842972099781,-8.951418101787567,-9.76070761680603,-10.574381798505783],\"type\":\"scatter\"},{\"marker\":{\"color\":\"crimson\",\"size\":15,\"symbol\":\"square\"},\"mode\":\"markers\",\"x\":[0],\"y\":[0],\"type\":\"scatter\"}],\"layout\":{\"title\":{\"text\":\"Tip Load: 0.4 N \u2192 Deflection: 10.6 mm\"}},\"name\":\"2\"},{\"data\":[{\"line\":{\"color\":\"steelblue\",\"width\":4},\"marker\":{\"color\":\"steelblue\",\"size\":6},\"mode\":\"lines+markers\",\"x\":[0.0037762765714433044,50.0037781894207,100.00361502170563,150.00303089618683,200.0018060207367,249.9997764825821,299.9968230724335,349.9928414821625,399.98772740364075,449.9814510345459,499.97401237487793,549.9654412269592,599.9557375907898,649.945080280304,699.9334096908569,749.9209642410278,799.9077439308167,849.8938679695129,899.8793363571167,949.8642683029175,999.8488426208496],\"y\":[-0.004077355697518215,-0.004104547770111822,-0.13234578364063054,-0.3757565573323518,-0.7254444644786417,-1.17491593118757,-1.7185898032039404,-2.350927796214819,-3.0661022756248713,-3.857981413602829,-4.720228258520365,-5.646389909088612,-6.629925686866045,-7.664266042411327,-8.742907084524632,-9.859716519713402,-11.00937370210886,-12.187829241156578,-13.392225839197636,-14.619537629187107,-15.863053500652313],\"type\":\"scatter\"},{\"marker\":{\"color\":\"crimson\",\"size\":15,\"symbol\":\"square\"},\"mode\":\"markers\",\"x\":[0],\"y\":[0],\"type\":\"scatter\"}],\"layout\":{\"title\":{\"text\":\"Tip Load: 0.6 N \u2192 Deflection: 15.9 mm\"}},\"name\":\"3\"},{\"data\":[{\"line\":{\"color\":\"steelblue\",\"width\":4},\"marker\":{\"color\":\"steelblue\",\"size\":6},\"mode\":\"lines+markers\",\"x\":[0.005211947154748486,50.00521242618561,100.00494867563248,150.00395476818085,200.0018209218979,249.99824166297913,299.99294877052307,349.9857783317566,399.97658133506775,449.96532797813416,499.95195865631104,549.9365329742432,599.9191403388977,649.8998999595642,699.8789310455322,749.8564124107361,799.8326420783997,849.8077392578125,899.7820615768433,949.7557878494263,999.7292160987854],\"y\":[-0.0008744822821427078,-0.0008328823355441273,-0.16321949078701437,-0.47952349996194243,-0.9412459912709892,-1.539886579848826,-2.2669497411698103,-3.113937797024846,-4.072351381182671,-5.133687052875757,-6.28942996263504,-7.531061302870512,-8.850046433508396,-10.237840004265308,-11.685884557664394,-13.185600750148296,-14.728405512869358,-16.305696219205856,-17.908867448568344,-19.529301673173904,-21.1583711206913],\"type\":\"scatter\"},{\"marker\":{\"color\":\"crimson\",\"size\":15,\"symbol\":\"square\"},\"mode\":\"markers\",\"x\":[0],\"y\":[0],\"type\":\"scatter\"}],\"layout\":{\"title\":{\"text\":\"Tip Load: 0.9 N \u2192 Deflection: 21.2 mm\"}},\"name\":\"4\"},{\"data\":[{\"line\":{\"color\":\"steelblue\",\"width\":4},\"marker\":{\"color\":\"steelblue\",\"size\":6},\"mode\":\"lines+markers\",\"x\":[0.007670158083783463,50.00767111778259,100.00713914632797,150.00522136688232,200.00125467777252,249.99482929706573,299.9856472015381,349.9734401702881,399.9581038951874,449.9395489692688,499.9178647994995,549.8932600021362,599.865972995758,649.8362421989441,699.8044848442078,749.7707605361938,799.735426902771,849.6986627578735,899.6607661247253,949.6220946311951,999.5830655097961],\"y\":[0.07569168519694358,0.07367390935542062,-0.1579303207108751,-0.598457467276603,-1.2293332256376743,-2.031395910307765,-2.9911946039646864,-4.095274023711681,-5.333710461854935,-6.694733630865812,-8.166036568582058,-9.734420105814934,-11.385730467736721,-13.10836710035801,-14.891122467815876,-16.726214438676834,-18.606234341859818,-20.52367851138115,-22.470926865935326,-24.43663403391838,-26.412561535835266],\"type\":\"scatter\"},{\"marker\":{\"color\":\"crimson\",\"size\":15,\"symbol\":\"square\"},\"mode\":\"markers\",\"x\":[0],\"y\":[0],\"type\":\"scatter\"}],\"layout\":{\"title\":{\"text\":\"Tip Load: 1.1 N \u2192 Deflection: 26.4 mm\"}},\"name\":\"5\"},{\"data\":[{\"line\":{\"color\":\"steelblue\",\"width\":4},\"marker\":{\"color\":\"steelblue\",\"size\":6},\"mode\":\"lines+markers\",\"x\":[-0.0029457492018991616,49.997054040431976,99.99644756317139,149.9941498041153,199.98927414417267,249.981090426445,299.96904730796814,349.95272755622864,399.9319076538086,449.9063491821289,499.87611174583435,549.8412251472473,599.8018383979797,649.7582793235779,699.7109055519104,749.6601343154907,799.606442451477,849.5503067970276,899.4923233985901,949.4331479072571,999.3733167648315],\"y\":[-0.010693162948882673,-0.010883713002840523,-0.2569612115621567,-0.7358005968853831,-1.434178208000958,-2.33877869322896,-3.4362359438091516,-4.713346716016531,-6.157194264233112,-7.755096536129713,-9.494461119174957,-11.36253122240305,-13.346345163881779,-15.432803891599178,-17.608867958188057,-19.861707463860512,-22.17864617705345,-24.547038599848747,-26.95406600832939,-29.386738315224648,-31.83208778500557],\"type\":\"scatter\"},{\"marker\":{\"color\":\"crimson\",\"size\":15,\"symbol\":\"square\"},\"mode\":\"markers\",\"x\":[0],\"y\":[0],\"type\":\"scatter\"}],\"layout\":{\"title\":{\"text\":\"Tip Load: 1.3 N \u2192 Deflection: 31.8 mm\"}},\"name\":\"6\"},{\"data\":[{\"line\":{\"color\":\"steelblue\",\"width\":4},\"marker\":{\"color\":\"steelblue\",\"size\":6},\"mode\":\"lines+markers\",\"x\":[0.006239609319891315,50.00624433159828,100.00541061162949,150.00228583812714,199.99560713768005,249.98442828655243,299.9679744243622,349.94566440582275,399.9171853065491,449.8823285102844,499.8410940170288,549.7936010360718,599.7400283813477,649.6809124946594,699.6166110038757,749.5477199554443,799.4748950004578,849.3988513946533,899.3203639984131,949.2402672767639,999.1592764854431],\"y\":[-0.007452244972228073,-0.007486021786462516,-0.29536482179537416,-0.8554160594940186,-1.6720076091587543,-2.729546744376421,-4.012490622699261,-5.5053625255823135,-7.192753721028566,-9.059338830411434,-11.08986884355545,-13.269162736833096,-15.582103282213211,-18.013624474406242,-20.54871991276741,-23.172441869974136,-25.869887322187424,-28.62621657550335,-31.426627188920975,-34.25636887550354,-37.10075095295906],\"type\":\"scatter\"},{\"marker\":{\"color\":\"crimson\",\"size\":15,\"symbol\":\"square\"},\"mode\":\"markers\",\"x\":[0],\"y\":[0],\"type\":\"scatter\"}],\"layout\":{\"title\":{\"text\":\"Tip Load: 1.5 N \u2192 Deflection: 37.1 mm\"}},\"name\":\"7\"},{\"data\":[{\"line\":{\"color\":\"steelblue\",\"width\":4},\"marker\":{\"color\":\"steelblue\",\"size\":6},\"mode\":\"lines+markers\",\"x\":[0.0774717191234231,50.077468156814575,100.0765711069107,150.0730961561203,200.0654637813568,250.0523030757904,300.03249645233154,350.00506043434143,399.9693989753723,449.9250054359436,499.871701002121,549.809455871582,599.7384786605835,649.659276008606,699.5723843574524,749.4788765907288,799.3796467781067,849.2756485939026,899.1680145263672,949.0576982498169,998.9460110664368],\"y\":[0.6393676740117371,0.6411155918613076,0.3434049431234598,-0.2464803692419082,-1.120955334044993,-2.2688531316816807,-3.6775588523596525,-5.33354701474309,-7.22161028534174,-9.327473118901253,-11.634787544608116,-14.128299430012703,-16.79104194045067,-19.60495486855507,-22.551486268639565,-25.60952678322792,-28.760643675923347,-31.98554739356041,-35.267431288957596,-38.58921304345131,-41.93131998181343],\"type\":\"scatter\"},{\"marker\":{\"color\":\"crimson\",\"size\":15,\"symbol\":\"square\"},\"mode\":\"markers\",\"x\":[0],\"y\":[0],\"type\":\"scatter\"}],\"layout\":{\"title\":{\"text\":\"Tip Load: 1.7 N \u2192 Deflection: 41.9 mm\"}},\"name\":\"8\"},{\"data\":[{\"line\":{\"color\":\"steelblue\",\"width\":4},\"marker\":{\"color\":\"steelblue\",\"size\":6},\"mode\":\"lines+markers\",\"x\":[0.12380449334159493,50.12382194399834,100.12252628803253,150.11759102344513,200.10721683502197,250.09003281593323,300.0650703907013,350.0315546989441,399.98894929885864,449.9368965625763,499.8752176761627,549.8040318489075,599.7235774993896,649.6344208717346,699.5371580123901,749.4326829910278,799.3218898773193,849.2058515548706,899.0858197212219,948.9631056785583,998.8390803337097],\"y\":[1.2070878874510527,1.2065598275512457,0.839615473523736,0.1307344064116478,-0.8941604755818844,-2.210136968642473,-3.7949616089463234,-5.629301071166992,-7.696389686316252,-9.980486705899239,-12.46583554893732,-15.135987661778927,-17.97359436750412,-20.96100151538849,-24.080349132418633,-27.313843369483948,-30.643405392766,-34.050364047288895,-37.51538321375847,-41.01864993572235,-44.540613889694214],\"type\":\"scatter\"},{\"marker\":{\"color\":\"crimson\",\"size\":15,\"symbol\":\"square\"},\"mode\":\"markers\",\"x\":[0],\"y\":[0],\"type\":\"scatter\"}],\"layout\":{\"title\":{\"text\":\"Tip Load: 1.9 N \u2192 Deflection: 44.5 mm\"}},\"name\":\"9\"},{\"data\":[{\"line\":{\"color\":\"steelblue\",\"width\":4},\"marker\":{\"color\":\"steelblue\",\"size\":6},\"mode\":\"lines+markers\",\"x\":[0.04180680844001472,50.0418059527874,100.04031658172607,150.034561753273,200.0221163034439,250.0009834766388,299.9696135520935,349.9269187450409,399.8721241950989,449.804812669754,499.72477555274963,549.63219165802,599.5274186134338,649.4112014770508,699.2844343185425,749.1482496261597,799.0038394927979,848.8526940345764,898.6963629722595,948.5365152359009,998.3749389648438],\"y\":[0.036399371310835704,0.04068932685186155,-0.3440662694629282,-1.101712347008288,-2.216337714344263,-3.6694519221782684,-5.440290085971355,-7.507055532187223,-9.847620502114296,-12.441949918866158,-15.269915573298931,-18.311867490410805,-21.547134965658188,-24.954326450824738,-28.512675315141678,-32.20071643590927,-35.99794581532478,-39.88267853856087,-43.83334517478943,-47.82824590802193,-51.84506252408028],\"type\":\"scatter\"},{\"marker\":{\"color\":\"crimson\",\"size\":15,\"symbol\":\"square\"},\"mode\":\"markers\",\"x\":[0],\"y\":[0],\"type\":\"scatter\"}],\"layout\":{\"title\":{\"text\":\"Tip Load: 2.1 N \u2192 Deflection: 51.8 mm\"}},\"name\":\"10\"},{\"data\":[{\"line\":{\"color\":\"steelblue\",\"width\":4},\"marker\":{\"color\":\"steelblue\",\"size\":6},\"mode\":\"lines+markers\",\"x\":[0.005507892183231888,50.005506724119186,100.00349581241608,149.9958634376526,199.97960329055786,249.9522864818573,299.9120056629181,349.8574197292328,399.7875452041626,449.7019350528717,499.60049986839294,549.4835376739502,599.3516445159912,649.2056846618652,699.0469098091125,748.876690864563,798.6966967582703,848.5085964202881,898.314356803894,948.1159448623657,997.9154467582703],\"y\":[0.007691169230383821,0.0077788990893168375,-0.4409397079143673,-1.3147036079317331,-2.589734271168709,-4.242241382598877,-6.248431280255318,-8.584519848227501,-11.226743459701538,-14.151360839605331,-17.33465865254402,-20.75294777750969,-24.382570758461952,-28.199907392263412,-32.181378453969955,-36.30343824625015,-40.5426025390625,-44.875409454107285,-49.27845671772957,-53.72835323214531,-58.20169299840927],\"type\":\"scatter\"},{\"marker\":{\"color\":\"crimson\",\"size\":15,\"symbol\":\"square\"},\"mode\":\"markers\",\"x\":[0],\"y\":[0],\"type\":\"scatter\"}],\"layout\":{\"title\":{\"text\":\"Tip Load: 2.4 N \u2192 Deflection: 58.2 mm\"}},\"name\":\"11\"},{\"data\":[{\"line\":{\"color\":\"steelblue\",\"width\":4},\"marker\":{\"color\":\"steelblue\",\"size\":6},\"mode\":\"lines+markers\",\"x\":[-0.17652045062277466,49.82321336865425,99.8181626200676,149.80360865592957,199.77641105651855,249.7347891330719,299.6777296066284,349.6047556400299,399.5155096054077,449.4099020957947,499.2881119251251,549.150824546814,598.9993810653687,648.8357782363892,698.6622214317322,748.4810948371887,798.2944250106812,848.1036424636841,897.9097604751587,947.7134346961975,997.5154995918274],\"y\":[-1.3333793031051755,-1.493901596404612,-2.208666643127799,-3.424279624596238,-5.083894822746515,-7.1341474540531635,-9.530707262456417,-12.23738957196474,-15.22730104625225,-18.477704375982285,-21.966446191072464,-25.669602677226067,-29.557809233665466,-33.599209040403366,-37.76067867875099,-42.01161116361618,-46.32790759205818,-50.691667944192886,-55.09220063686371,-59.52148512005806,-63.968725502491],\"type\":\"scatter\"},{\"marker\":{\"color\":\"crimson\",\"size\":15,\"symbol\":\"square\"},\"mode\":\"markers\",\"x\":[0],\"y\":[0],\"type\":\"scatter\"}],\"layout\":{\"title\":{\"text\":\"Tip Load: 2.6 N \u2192 Deflection: 64.0 mm\"}},\"name\":\"12\"},{\"data\":[{\"line\":{\"color\":\"steelblue\",\"width\":4},\"marker\":{\"color\":\"steelblue\",\"size\":6},\"mode\":\"lines+markers\",\"x\":[-0.06466936611104757,49.935273826122284,99.93252903223038,149.9221920967102,199.9000757932663,249.86286461353302,299.80793595314026,349.7331738471985,399.6370732784271,449.5188295841217,499.3782937526703,549.2159128189087,599.0322828292847,648.8284468650818,698.6057162284851,748.366117477417,798.1119155883789,847.8456735610962,897.5701332092285,947.2882151603699,997.0031976699829],\"y\":[0.004110049758310197,0.005395935204433044,-0.5116395186632872,-1.5255158068612218,-3.0107891652733088,-4.939046688377857,-7.282321806997061,-10.01556683331728,-13.114162720739841,-16.55089296400547,-20.296825096011162,-24.32333305478096,-28.604058548808098,-33.114418387413025,-37.82825171947479,-42.71722957491875,-47.75257781147957,-52.9056191444397,-58.14770981669426,-63.449569046497345,-68.78102570772171],\"type\":\"scatter\"},{\"marker\":{\"color\":\"crimson\",\"size\":15,\"symbol\":\"square\"},\"mode\":\"markers\",\"x\":[0],\"y\":[0],\"type\":\"scatter\"}],\"layout\":{\"title\":{\"text\":\"Tip Load: 2.8 N \u2192 Deflection: 68.8 mm\"}},\"name\":\"13\"},{\"data\":[{\"line\":{\"color\":\"steelblue\",\"width\":4},\"marker\":{\"color\":\"steelblue\",\"size\":6},\"mode\":\"lines+markers\",\"x\":[-0.2056011144304648,49.79444667696953,99.79058802127838,149.77656304836273,199.74790513515472,249.70124661922455,299.63418841362,349.5449125766754,399.43191409111023,449.2943286895752,499.13153052330017,548.943817615509,598.7318754196167,648.4974026679993,698.2426047325134,747.9701638221741,797.6832985877991,847.3854064941406,897.0798254013062,946.769654750824,996.4575171470642],\"y\":[-0.95828075427562,-0.9819184197112918,-1.6171447932720184,-2.8132947627454996,-4.517869558185339,-6.6883256658911705,-9.286686778068542,-12.281067669391632,-15.64602181315422,-19.355611875653267,-23.388242349028587,-27.717065066099167,-32.3161818087101,-37.154413759708405,-42.19964146614075,-47.4175326526165,-52.77232825756073,-58.22960287332535,-63.756063580513,-69.32367384433746,-74.90913569927216],\"type\":\"scatter\"},{\"marker\":{\"color\":\"crimson\",\"size\":15,\"symbol\":\"square\"},\"mode\":\"markers\",\"x\":[0],\"y\":[0],\"type\":\"scatter\"}],\"layout\":{\"title\":{\"text\":\"Tip Load: 3.0 N \u2192 Deflection: 74.9 mm\"}},\"name\":\"14\"}]);\n",
       "                        })                };            </script>        </div>"
      ],
      "text/plain": [
       "<IPython.core.display.HTML object>"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Build animation frames (frame_solutions is now shape (n_frames, num_nodes, 2)).\n",
    "frames = []\n",
    "for i in range(n_frames):\n",
    "    pos = frame_solutions[i]\n",
    "    force_val = float(tip_forces[i])\n",
    "    deflection = float(pos[-1, 1]) * 1000\n",
    "    frames.append(\n",
    "        go.Frame(\n",
    "            data=[\n",
    "                go.Scatter(\n",
    "                    x=[float(p) * 1000 for p in pos[:, 0]],\n",
    "                    y=[float(p) * 1000 for p in pos[:, 1]],\n",
    "                    mode=\"lines+markers\",\n",
    "                    line=dict(color=\"steelblue\", width=4),\n",
    "                    marker=dict(size=6, color=\"steelblue\"),\n",
    "                ),\n",
    "                go.Scatter(\n",
    "                    x=[0],\n",
    "                    y=[0],\n",
    "                    mode=\"markers\",\n",
    "                    marker=dict(size=15, color=\"crimson\", symbol=\"square\"),\n",
    "                ),\n",
    "            ],\n",
    "            name=str(i),\n",
    "            layout=go.Layout(\n",
    "                title=f\"Tip Load: {force_val:.1f} N \u2192 Deflection: {abs(deflection):.1f} mm\"\n",
    "            ),\n",
    "        )\n",
    "    )\n",
    "\n",
    "# Initial frame.\n",
    "init_pos = frame_solutions[0]\n",
    "fig_anim = go.Figure(\n",
    "    data=[\n",
    "        go.Scatter(\n",
    "            x=[float(p) * 1000 for p in init_pos[:, 0]],\n",
    "            y=[float(p) * 1000 for p in init_pos[:, 1]],\n",
    "            mode=\"lines+markers\",\n",
    "            line=dict(color=\"steelblue\", width=4),\n",
    "            marker=dict(size=6, color=\"steelblue\"),\n",
    "            name=\"Beam\",\n",
    "        ),\n",
    "        go.Scatter(\n",
    "            x=[0],\n",
    "            y=[0],\n",
    "            mode=\"markers\",\n",
    "            marker=dict(size=15, color=\"crimson\", symbol=\"square\"),\n",
    "            name=\"Fixed end\",\n",
    "        ),\n",
    "    ],\n",
    "    frames=frames,\n",
    "    layout=go.Layout(\n",
    "        title=\"Tip Load: 0.0 N \u2192 Deflection: 0.0 mm\",\n",
    "        xaxis=dict(title=\"x [mm]\", range=[-50, 1050]),\n",
    "        yaxis=dict(title=\"y [mm]\", range=[-100, 20], scaleanchor=\"x\", scaleratio=1),\n",
    "        updatemenus=[\n",
    "            dict(\n",
    "                type=\"buttons\",\n",
    "                showactive=False,\n",
    "                y=1.15,\n",
    "                x=0.5,\n",
    "                xanchor=\"center\",\n",
    "                buttons=[\n",
    "                    dict(\n",
    "                        label=\"Play\",\n",
    "                        method=\"animate\",\n",
    "                        args=[\n",
    "                            None,\n",
    "                            dict(\n",
    "                                frame=dict(duration=150, redraw=True),\n",
    "                                fromcurrent=True,\n",
    "                                transition=dict(duration=50),\n",
    "                            ),\n",
    "                        ],\n",
    "                    ),\n",
    "                    dict(\n",
    "                        label=\"Pause\",\n",
    "                        method=\"animate\",\n",
    "                        args=[\n",
    "                            [None],\n",
    "                            dict(\n",
    "                                frame=dict(duration=0, redraw=False), mode=\"immediate\"\n",
    "                            ),\n",
    "                        ],\n",
    "                    ),\n",
    "                ],\n",
    "            )\n",
    "        ],\n",
    "        sliders=[\n",
    "            dict(\n",
    "                active=0,\n",
    "                yanchor=\"top\",\n",
    "                xanchor=\"left\",\n",
    "                currentvalue=dict(\n",
    "                    prefix=\"Force: \", suffix=\" N\", visible=True, xanchor=\"center\"\n",
    "                ),\n",
    "                pad=dict(b=10, t=50),\n",
    "                steps=[\n",
    "                    dict(\n",
    "                        args=[\n",
    "                            [str(i)],\n",
    "                            dict(\n",
    "                                frame=dict(duration=0, redraw=True),\n",
    "                                mode=\"immediate\",\n",
    "                                transition=dict(duration=0),\n",
    "                            ),\n",
    "                        ],\n",
    "                        label=f\"{float(tip_forces[i]):.1f}\",\n",
    "                        method=\"animate\",\n",
    "                    )\n",
    "                    for i in range(n_frames)\n",
    "                ],\n",
    "                x=0.1,\n",
    "                y=0,\n",
    "                len=0.8,\n",
    "            )\n",
    "        ],\n",
    "        height=400,\n",
    "        showlegend=False,\n",
    "        margin=dict(t=80, b=80),\n",
    "    ),\n",
    ")\n",
    "HTML(fig_anim.to_html(full_html=False, include_plotlyjs=\"cdn\", auto_play=False))"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "d2hngvgylh7",
   "metadata": {},
   "source": [
    "The animation shows how the beam deflects as the tip load increases from 0 to 3 N. The deflection is proportional to the applied force, consistent with the linear Euler-Bernoulli beam theory for small deflections.\n",
    "\n",
    "Key observations:\n",
    "- Fixed end (red square): Position and slope are constrained\n",
    "- Smooth deflection curve: The bending stiffness EI resists curvature\n",
    "- Linear response: Tip deflection $\\delta = \\frac{FL^3}{3EI}$ is proportional to load\n",
    "\n",
    "For more details on the solver, see {class}`jaxls.LeastSquaresProblem`."
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.12.4"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
