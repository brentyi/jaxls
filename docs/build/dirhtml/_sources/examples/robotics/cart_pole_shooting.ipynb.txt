{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "cell-0",
   "metadata": {},
   "source": [
    "# Cart-Pole (Shooting)\n",
    "\n",
    "Trajectory optimization using single shooting for swinging a pole from hanging down to balancing upright.\n",
    "\n",
    "```{note}\n",
    "This notebook demonstrates the shooting method, where we optimize only the control trajectory\n",
    "and compute states by forward simulation. For contrast, see {doc}`cart_pole_collocation`, which uses\n",
    "direct collocation to optimize both states and controls with dynamics as constraints.\n",
    "```\n",
    "\n",
    "Key difference from direct collocation:\n",
    "- Shooting: Optimizes only controls; states are computed by simulating dynamics forward\n",
    "- Direct collocation: Optimizes both states and controls, with dynamics enforced as equality constraints\n",
    "\n",
    "Shooting is simpler but can struggle with long time horizons due to sensitivity of the initial value problem.\n",
    "\n",
    "Features used:\n",
    "- {class}`~jaxls.Var` for control trajectory (single variable containing all controls)\n",
    "- {func}`@jaxls.Cost.factory <jaxls.Cost.factory>` for terminal state cost and control regularization\n",
    "- Forward simulation with `jax.lax.scan`"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "cell-1",
   "metadata": {
    "tags": [
     "hide-input"
    ]
   },
   "outputs": [],
   "source": [
    "import sys\n",
    "from loguru import logger\n",
    "\n",
    "logger.remove()\n",
    "logger.add(sys.stdout, format=\"<level>{level: <8}</level> | {message}\");"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "cell-2",
   "metadata": {},
   "outputs": [],
   "source": [
    "import jax\n",
    "import jax.numpy as jnp\n",
    "import jaxls"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "cell-3",
   "metadata": {},
   "source": [
    "## Cart-pole dynamics\n",
    "\n",
    "The cart-pole system has state $[x, \\theta, \\dot{x}, \\dot{\\theta}]$ where $x$ is cart position and $\\theta$ is pole angle (0 = hanging down, $\\pi$ = upright). The control input is a horizontal force on the cart."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "cell-4",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Total trajectory time: 3.00s (50 swing + 10 hold)\n"
     ]
    }
   ],
   "source": [
    "# Physical parameters.\n",
    "m_cart = 1.0  # Cart mass (kg)\n",
    "m_pole = 0.1  # Pole mass (kg)\n",
    "length = 0.5  # Pole half-length (m)\n",
    "gravity = 9.81  # Gravitational acceleration (m/s^2)\n",
    "\n",
    "# Trajectory parameters.\n",
    "n_swing = 50  # Timesteps for swing-up phase\n",
    "n_hold = 10  # Timesteps to hold upright position\n",
    "n_steps = n_swing + n_hold  # Total timesteps\n",
    "dt = 0.05  # Time step (s)\n",
    "total_time = n_steps * dt\n",
    "print(f\"Total trajectory time: {total_time:.2f}s ({n_swing} swing + {n_hold} hold)\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "cell-5",
   "metadata": {},
   "outputs": [],
   "source": [
    "@jax.jit\n",
    "def cart_pole_dynamics(state: jax.Array, force: jax.Array) -> jax.Array:\n",
    "    \"\"\"Compute state derivatives for the cart-pole system.\n",
    "\n",
    "    State: [x, theta, x_dot, theta_dot]\n",
    "    theta = 0: pole hanging down, theta = pi: pole upright\n",
    "\n",
    "    Args:\n",
    "        state: Current state [x, theta, x_dot, theta_dot]\n",
    "        force: Control force [f]\n",
    "\n",
    "    Returns:\n",
    "        State derivatives [x_dot, theta_dot, x_ddot, theta_ddot]\n",
    "    \"\"\"\n",
    "    x, theta, x_dot, theta_dot = state\n",
    "    f = force[0]\n",
    "\n",
    "    sin_th = jnp.sin(theta)\n",
    "    cos_th = jnp.cos(theta)\n",
    "\n",
    "    # Total mass.\n",
    "    total_mass = m_cart + m_pole\n",
    "    pole_mass_length = m_pole * length\n",
    "\n",
    "    # Equations of motion for theta=0 being DOWN (stable equilibrium)\n",
    "    temp = (f + pole_mass_length * theta_dot**2 * sin_th) / total_mass\n",
    "    theta_ddot = (-gravity * sin_th - cos_th * temp) / (\n",
    "        length * (4.0 / 3.0 - m_pole * cos_th**2 / total_mass)\n",
    "    )\n",
    "    x_ddot = temp - pole_mass_length * theta_ddot * cos_th / total_mass\n",
    "\n",
    "    return jnp.array([x_dot, theta_dot, x_ddot, theta_ddot])\n",
    "\n",
    "\n",
    "@jax.jit\n",
    "def rk4_step(state: jax.Array, force: jax.Array, dt: float) -> jax.Array:\n",
    "    \"\"\"Runge-Kutta 4th order integration step.\n",
    "\n",
    "    Args:\n",
    "        state: Current state [x, theta, x_dot, theta_dot]\n",
    "        force: Control force [f]\n",
    "        dt: Time step\n",
    "\n",
    "    Returns:\n",
    "        Next state after integration\n",
    "    \"\"\"\n",
    "    k1 = cart_pole_dynamics(state, force)\n",
    "    k2 = cart_pole_dynamics(state + 0.5 * dt * k1, force)\n",
    "    k3 = cart_pole_dynamics(state + 0.5 * dt * k2, force)\n",
    "    k4 = cart_pole_dynamics(state + dt * k3, force)\n",
    "    return state + (dt / 6.0) * (k1 + 2 * k2 + 2 * k3 + k4)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "cell-6",
   "metadata": {},
   "source": [
    "## Forward simulation\n",
    "\n",
    "The key difference from direct collocation: we simulate the entire trajectory forward using `jax.lax.scan`. Given a control sequence, we compute all states by integrating the dynamics."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "cell-7",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Trajectory shape: (61, 4)\n",
      "Final state with zero controls: [0. 0. 0. 0.]\n"
     ]
    }
   ],
   "source": [
    "# Initial and target states.\n",
    "initial_state = jnp.array([0.0, 0.0, 0.0, 0.0])  # x=0, theta=0 (down), zero velocity\n",
    "target_state = jnp.array([0.0, jnp.pi, 0.0, 0.0])  # x=0, theta=pi (up), zero velocity\n",
    "\n",
    "\n",
    "@jax.jit\n",
    "def simulate_trajectory(controls: jax.Array) -> jax.Array:\n",
    "    \"\"\"Simulate the cart-pole system forward given a control sequence.\n",
    "\n",
    "    Args:\n",
    "        controls: Control forces, shape (n_steps, 1)\n",
    "\n",
    "    Returns:\n",
    "        State trajectory, shape (n_steps + 1, 4)\n",
    "    \"\"\"\n",
    "\n",
    "    def step(state: jax.Array, control: jax.Array) -> tuple[jax.Array, jax.Array]:\n",
    "        next_state = rk4_step(state, control, dt)\n",
    "        return next_state, next_state\n",
    "\n",
    "    _, trajectory = jax.lax.scan(step, initial_state, controls)\n",
    "    # Prepend initial state.\n",
    "    return jnp.concatenate([initial_state[None, :], trajectory], axis=0)\n",
    "\n",
    "\n",
    "# Test forward simulation with zero controls.\n",
    "test_controls = jnp.zeros((n_steps, 1))\n",
    "test_trajectory = simulate_trajectory(test_controls)\n",
    "print(f\"Trajectory shape: {test_trajectory.shape}\")\n",
    "print(f\"Final state with zero controls: {test_trajectory[-1]}\")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "cell-8",
   "metadata": {},
   "source": [
    "## Control variable and costs\n",
    "\n",
    "In the shooting method, we optimize a single variable containing the entire control trajectory. The costs include:\n",
    "1. Terminal cost: Penalize deviation from upright position at final time\n",
    "2. Control regularization: Penalize large control inputs"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "cell-9",
   "metadata": {},
   "outputs": [],
   "source": [
    "class ControlTrajectoryVar(\n",
    "    jaxls.Var[jax.Array], default_factory=lambda: jnp.zeros((n_steps, 1))\n",
    "):\n",
    "    \"\"\"Control trajectory variable: (n_steps, 1) array of forces.\"\"\"\n",
    "\n",
    "\n",
    "control_var = ControlTrajectoryVar(id=0)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "cell-10",
   "metadata": {},
   "outputs": [],
   "source": [
    "@jaxls.Cost.factory\n",
    "def terminal_cost(\n",
    "    vals: jaxls.VarValues,\n",
    "    var: ControlTrajectoryVar,\n",
    "    target: jax.Array,\n",
    ") -> jax.Array:\n",
    "    \"\"\"Penalize deviation from target state at final time.\n",
    "\n",
    "    Forward simulate the trajectory, then compute error at final state.\n",
    "    \"\"\"\n",
    "    controls = vals[var]\n",
    "    trajectory = simulate_trajectory(controls)\n",
    "    final_state = trajectory[-1]\n",
    "    # Weight position and angle errors more heavily.\n",
    "    weights = jnp.array([10.0, 20.0, 5.0, 5.0])\n",
    "    return (final_state - target) * weights\n",
    "\n",
    "\n",
    "@jaxls.Cost.factory\n",
    "def hold_cost(\n",
    "    vals: jaxls.VarValues,\n",
    "    var: ControlTrajectoryVar,\n",
    "    target: jax.Array,\n",
    ") -> jax.Array:\n",
    "    \"\"\"Penalize deviation from upright during the hold phase.\"\"\"\n",
    "    controls = vals[var]\n",
    "    trajectory = simulate_trajectory(controls)\n",
    "    # Get states during hold phase (use static slice with captured n_swing)\n",
    "    hold_states = jax.lax.slice_in_dim(trajectory, n_swing, n_steps + 1, axis=0)\n",
    "    # Penalize deviation from target for each hold state.\n",
    "    weights = jnp.array([5.0, 10.0, 2.0, 2.0])\n",
    "    errors = (hold_states - target) * weights\n",
    "    return errors.flatten()\n",
    "\n",
    "\n",
    "@jaxls.Cost.factory\n",
    "def control_regularization(\n",
    "    vals: jaxls.VarValues,\n",
    "    var: ControlTrajectoryVar,\n",
    ") -> jax.Array:\n",
    "    \"\"\"Penalize control effort (L2 regularization).\"\"\"\n",
    "    controls = vals[var]\n",
    "    return controls.flatten() * 0.1"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "cell-11",
   "metadata": {},
   "source": [
    "## Solving"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "cell-12",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Created 3 cost functions\n",
      "Control variable shape: (60, 1)\n"
     ]
    }
   ],
   "source": [
    "costs: list[jaxls.Cost] = [\n",
    "    terminal_cost(control_var, target_state),\n",
    "    hold_cost(control_var, target_state),\n",
    "    control_regularization(control_var),\n",
    "]\n",
    "\n",
    "print(f\"Created {len(costs)} cost functions\")\n",
    "print(f\"Control variable shape: ({n_steps}, 1)\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "cell-13",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\u001b[1mINFO    \u001b[0m | Building optimization problem with 3 terms and 1 variables: 3 costs, 0 eq_zero, 0 leq_zero, 0 geq_zero\n",
      "\u001b[1mINFO    \u001b[0m | Vectorizing group with 1 costs, 1 variables each: terminal_cost\n",
      "\u001b[1mINFO    \u001b[0m | Vectorizing group with 1 costs, 1 variables each: hold_cost\n",
      "\u001b[1mINFO    \u001b[0m | Vectorizing group with 1 costs, 1 variables each: control_regularization\n"
     ]
    }
   ],
   "source": [
    "# Initial guess: small random controls to break symmetry.\n",
    "key = jax.random.PRNGKey(42)\n",
    "initial_controls = jax.random.normal(key, (n_steps, 1)) * 0.1\n",
    "\n",
    "initial_vals = jaxls.VarValues.make([control_var.with_value(initial_controls)])\n",
    "\n",
    "# Create and analyze problem.\n",
    "problem = jaxls.LeastSquaresProblem(costs, [control_var]).analyze()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "cell-14",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\u001b[1mINFO    \u001b[0m |  step #1: cost=14820.0186 lambd=0.0001 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 3938.88013 (avg 984.72003)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   10881.13477 (avg 247.29852)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 0.00345 (avg 0.00006)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=5.20e+02 cost_prev=14820.0186 cost_new=10042.1592\n",
      "\u001b[1mINFO    \u001b[0m |  step #2: cost=10042.1592 lambd=0.0000 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 624.16711 (avg 156.04178)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   9335.54883 (avg 212.17157)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 82.44377 (avg 1.37406)\n",
      "\u001b[1mINFO    \u001b[0m |  step #3: cost=10042.1592 lambd=0.0001 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 624.16711 (avg 156.04178)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   9335.54883 (avg 212.17157)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 82.44377 (avg 1.37406)\n",
      "\u001b[1mINFO    \u001b[0m |  step #4: cost=10042.1592 lambd=0.0002 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 624.16711 (avg 156.04178)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   9335.54883 (avg 212.17157)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 82.44377 (avg 1.37406)\n",
      "\u001b[1mINFO    \u001b[0m |  step #5: cost=10042.1592 lambd=0.0004 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 624.16711 (avg 156.04178)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   9335.54883 (avg 212.17157)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 82.44377 (avg 1.37406)\n",
      "\u001b[1mINFO    \u001b[0m |  step #6: cost=10042.1592 lambd=0.0008 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 624.16711 (avg 156.04178)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   9335.54883 (avg 212.17157)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 82.44377 (avg 1.37406)\n",
      "\u001b[1mINFO    \u001b[0m |  step #7: cost=10042.1592 lambd=0.0016 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 624.16711 (avg 156.04178)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   9335.54883 (avg 212.17157)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 82.44377 (avg 1.37406)\n",
      "\u001b[1mINFO    \u001b[0m |  step #8: cost=10042.1592 lambd=0.0032 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 624.16711 (avg 156.04178)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   9335.54883 (avg 212.17157)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 82.44377 (avg 1.37406)\n",
      "\u001b[1mINFO    \u001b[0m |  step #9: cost=10042.1592 lambd=0.0064 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 624.16711 (avg 156.04178)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   9335.54883 (avg 212.17157)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 82.44377 (avg 1.37406)\n",
      "\u001b[1mINFO    \u001b[0m |  step #10: cost=10042.1592 lambd=0.0128 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 624.16711 (avg 156.04178)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   9335.54883 (avg 212.17157)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 82.44377 (avg 1.37406)\n",
      "\u001b[1mINFO    \u001b[0m |  step #11: cost=10042.1592 lambd=0.0256 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 624.16711 (avg 156.04178)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   9335.54883 (avg 212.17157)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 82.44377 (avg 1.37406)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=2.84e+03 cost_prev=10042.1592 cost_new=8948.4053\n",
      "\u001b[1mINFO    \u001b[0m |  step #12: cost=8948.4053 lambd=0.0128 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 2198.11011 (avg 549.52753)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   6554.60742 (avg 148.96835)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 195.68822 (avg 3.26147)\n",
      "\u001b[1mINFO    \u001b[0m |  step #13: cost=8948.4053 lambd=0.0256 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 2198.11011 (avg 549.52753)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   6554.60742 (avg 148.96835)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 195.68822 (avg 3.26147)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=4.81e+03 cost_prev=8948.4053 cost_new=4117.7603\n",
      "\u001b[1mINFO    \u001b[0m |  step #14: cost=4117.7603 lambd=0.0128 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 264.71594 (avg 66.17899)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   3516.34790 (avg 79.91700)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 336.69666 (avg 5.61161)\n",
      "\u001b[1mINFO    \u001b[0m |  step #15: cost=4117.7603 lambd=0.0256 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 264.71594 (avg 66.17899)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   3516.34790 (avg 79.91700)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 336.69666 (avg 5.61161)\n",
      "\u001b[1mINFO    \u001b[0m |  step #16: cost=4117.7603 lambd=0.0512 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 264.71594 (avg 66.17899)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   3516.34790 (avg 79.91700)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 336.69666 (avg 5.61161)\n",
      "\u001b[1mINFO    \u001b[0m |  step #17: cost=4117.7603 lambd=0.1024 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 264.71594 (avg 66.17899)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   3516.34790 (avg 79.91700)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 336.69666 (avg 5.61161)\n",
      "\u001b[1mINFO    \u001b[0m |  step #18: cost=4117.7603 lambd=0.2048 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 264.71594 (avg 66.17899)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   3516.34790 (avg 79.91700)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 336.69666 (avg 5.61161)\n",
      "\u001b[1mINFO    \u001b[0m |  step #19: cost=4117.7603 lambd=0.4096 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 264.71594 (avg 66.17899)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   3516.34790 (avg 79.91700)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 336.69666 (avg 5.61161)\n",
      "\u001b[1mINFO    \u001b[0m |  step #20: cost=4117.7603 lambd=0.8192 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 264.71594 (avg 66.17899)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   3516.34790 (avg 79.91700)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 336.69666 (avg 5.61161)\n",
      "\u001b[1mINFO    \u001b[0m |  step #21: cost=4117.7603 lambd=1.6384 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 264.71594 (avg 66.17899)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   3516.34790 (avg 79.91700)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 336.69666 (avg 5.61161)\n",
      "\u001b[1mINFO    \u001b[0m |  step #22: cost=4117.7603 lambd=3.2768 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 264.71594 (avg 66.17899)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   3516.34790 (avg 79.91700)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 336.69666 (avg 5.61161)\n",
      "\u001b[1mINFO    \u001b[0m |  step #23: cost=4117.7603 lambd=6.5536 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 264.71594 (avg 66.17899)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   3516.34790 (avg 79.91700)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 336.69666 (avg 5.61161)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=4.17e+02 cost_prev=4117.7603 cost_new=3924.7383\n",
      "\u001b[1mINFO    \u001b[0m |  step #24: cost=3924.7383 lambd=3.2768 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 225.91519 (avg 56.47880)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   3365.79004 (avg 76.49523)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 333.03323 (avg 5.55055)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=4.53e+02 cost_prev=3924.7383 cost_new=3817.2568\n",
      "\u001b[1mINFO    \u001b[0m |  step #25: cost=3817.2568 lambd=1.6384 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 218.38220 (avg 54.59555)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   3274.89014 (avg 74.42932)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 323.98431 (avg 5.39974)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=7.41e+02 cost_prev=3817.2568 cost_new=3596.2273\n",
      "\u001b[1mINFO    \u001b[0m |  step #26: cost=3596.2273 lambd=0.8192 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 183.90935 (avg 45.97734)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   3107.65747 (avg 70.62858)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 304.66043 (avg 5.07767)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=9.01e+02 cost_prev=3596.2273 cost_new=3277.5325\n",
      "\u001b[1mINFO    \u001b[0m |  step #27: cost=3277.5325 lambd=0.4096 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 159.23341 (avg 39.80835)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   2853.63672 (avg 64.85538)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 264.66220 (avg 4.41104)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=1.12e+03 cost_prev=3277.5325 cost_new=3041.1362\n",
      "\u001b[1mINFO    \u001b[0m |  step #28: cost=3041.1362 lambd=0.2048 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 396.21222 (avg 99.05305)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   2453.08398 (avg 55.75191)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 191.84000 (avg 3.19733)\n",
      "\u001b[1mINFO    \u001b[0m |  step #29: cost=3041.1362 lambd=0.4096 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 396.21222 (avg 99.05305)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   2453.08398 (avg 55.75191)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 191.84000 (avg 3.19733)\n",
      "\u001b[1mINFO    \u001b[0m |  step #30: cost=3041.1362 lambd=0.8192 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 396.21222 (avg 99.05305)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   2453.08398 (avg 55.75191)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 191.84000 (avg 3.19733)\n",
      "\u001b[1mINFO    \u001b[0m |  step #31: cost=3041.1362 lambd=1.6384 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 396.21222 (avg 99.05305)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   2453.08398 (avg 55.75191)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 191.84000 (avg 3.19733)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=1.34e+03 cost_prev=3041.1362 cost_new=2923.7471\n",
      "\u001b[1mINFO    \u001b[0m |  step #32: cost=2923.7471 lambd=0.8192 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 751.96552 (avg 187.99138)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   2001.08911 (avg 45.47930)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 170.69211 (avg 2.84487)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=5.05e+02 cost_prev=2923.7471 cost_new=1425.1332\n",
      "\u001b[1mINFO    \u001b[0m |  step #33: cost=1425.1332 lambd=0.4096 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 150.45517 (avg 37.61379)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   1150.15698 (avg 26.13993)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 124.52102 (avg 2.07535)\n",
      "\u001b[1mINFO    \u001b[0m |  step #34: cost=1425.1332 lambd=0.8192 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 150.45517 (avg 37.61379)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   1150.15698 (avg 26.13993)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 124.52102 (avg 2.07535)\n",
      "\u001b[1mINFO    \u001b[0m |  step #35: cost=1425.1332 lambd=1.6384 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 150.45517 (avg 37.61379)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   1150.15698 (avg 26.13993)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 124.52102 (avg 2.07535)\n",
      "\u001b[1mINFO    \u001b[0m |  step #36: cost=1425.1332 lambd=3.2768 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 150.45517 (avg 37.61379)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   1150.15698 (avg 26.13993)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 124.52102 (avg 2.07535)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=1.93e+02 cost_prev=1425.1332 cost_new=1397.6416\n",
      "\u001b[1mINFO    \u001b[0m |  step #37: cost=1397.6416 lambd=1.6384 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 289.60635 (avg 72.40159)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   986.69586 (avg 22.42491)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 121.33943 (avg 2.02232)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=5.10e+02 cost_prev=1397.6416 cost_new=881.2084\n",
      "\u001b[1mINFO    \u001b[0m |  step #38: cost=881.2084 lambd=0.8192 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 125.37883 (avg 31.34471)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   643.40491 (avg 14.62284)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 112.42456 (avg 1.87374)\n",
      "\u001b[1mINFO    \u001b[0m |  step #39: cost=881.2084 lambd=1.6384 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 125.37883 (avg 31.34471)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   643.40491 (avg 14.62284)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 112.42456 (avg 1.87374)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=4.51e+02 cost_prev=881.2084 cost_new=740.6924\n",
      "\u001b[1mINFO    \u001b[0m |  step #40: cost=740.6924 lambd=0.8192 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 119.19889 (avg 29.79972)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   517.25269 (avg 11.75574)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 104.24097 (avg 1.73735)\n",
      "\u001b[1mINFO    \u001b[0m |  step #41: cost=740.6924 lambd=1.6384 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 119.19889 (avg 29.79972)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   517.25269 (avg 11.75574)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 104.24097 (avg 1.73735)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=5.04e+02 cost_prev=740.6924 cost_new=516.7752\n",
      "\u001b[1mINFO    \u001b[0m |  step #42: cost=516.7752 lambd=0.8192 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 37.26056 (avg 9.31514)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   382.73923 (avg 8.69862)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 96.77538 (avg 1.61292)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=3.05e+02 cost_prev=516.7752 cost_new=511.5909\n",
      "\u001b[1mINFO    \u001b[0m |  step #43: cost=511.5909 lambd=0.4096 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 105.06722 (avg 26.26681)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   321.56403 (avg 7.30827)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 84.95968 (avg 1.41599)\n",
      "\u001b[1mINFO    \u001b[0m |  step #44: cost=511.5909 lambd=0.8192 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 105.06722 (avg 26.26681)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   321.56403 (avg 7.30827)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 84.95968 (avg 1.41599)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=5.41e+02 cost_prev=511.5909 cost_new=307.1215\n",
      "\u001b[1mINFO    \u001b[0m |  step #45: cost=307.1215 lambd=0.4096 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 29.43790 (avg 7.35948)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   201.11079 (avg 4.57070)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 76.57280 (avg 1.27621)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=2.98e+02 cost_prev=307.1215 cost_new=251.4243\n",
      "\u001b[1mINFO    \u001b[0m |  step #46: cost=251.4243 lambd=0.2048 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 50.17997 (avg 12.54499)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   136.01393 (avg 3.09123)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 65.23045 (avg 1.08717)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=3.98e+02 cost_prev=251.4243 cost_new=243.6935\n",
      "\u001b[1mINFO    \u001b[0m |  step #47: cost=243.6935 lambd=0.1024 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 90.46957 (avg 22.61739)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   98.35617 (avg 2.23537)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 54.86771 (avg 0.91446)\n",
      "\u001b[1mINFO    \u001b[0m |  step #48: cost=243.6935 lambd=0.2048 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 90.46957 (avg 22.61739)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   98.35617 (avg 2.23537)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 54.86771 (avg 0.91446)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=5.55e+02 cost_prev=243.6935 cost_new=91.4855\n",
      "\u001b[1mINFO    \u001b[0m |  step #49: cost=91.4855 lambd=0.1024 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 14.22025 (avg 3.55506)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   27.16010 (avg 0.61728)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 50.10514 (avg 0.83509)\n",
      "\u001b[1mINFO    \u001b[0m |  step #50: cost=91.4855 lambd=0.2048 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 14.22025 (avg 3.55506)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   27.16010 (avg 0.61728)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 50.10514 (avg 0.83509)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=2.28e+02 cost_prev=91.4855 cost_new=64.7146\n",
      "\u001b[1mINFO    \u001b[0m |  step #51: cost=64.7146 lambd=0.1024 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 4.90705 (avg 1.22676)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   12.71152 (avg 0.28890)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 47.09599 (avg 0.78493)\n",
      "\u001b[1mINFO    \u001b[0m |  step #52: cost=64.7146 lambd=0.2048 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 4.90705 (avg 1.22676)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   12.71152 (avg 0.28890)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 47.09599 (avg 0.78493)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=1.36e+02 cost_prev=64.7146 cost_new=54.2909\n",
      "\u001b[1mINFO    \u001b[0m |  step #53: cost=54.2909 lambd=0.1024 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 2.13407 (avg 0.53352)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   7.40299 (avg 0.16825)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 44.75386 (avg 0.74590)\n",
      "\u001b[1mINFO    \u001b[0m |  step #54: cost=54.2909 lambd=0.2048 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 2.13407 (avg 0.53352)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   7.40299 (avg 0.16825)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 44.75386 (avg 0.74590)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=8.99e+01 cost_prev=54.2909 cost_new=49.2121\n",
      "\u001b[1mINFO    \u001b[0m |  step #55: cost=49.2121 lambd=0.1024 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 1.24524 (avg 0.31131)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   5.23234 (avg 0.11892)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 42.73453 (avg 0.71224)\n",
      "\u001b[1mINFO    \u001b[0m |  step #56: cost=49.2121 lambd=0.2048 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 1.24524 (avg 0.31131)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   5.23234 (avg 0.11892)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 42.73453 (avg 0.71224)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=6.82e+01 cost_prev=49.2121 cost_new=46.0718\n",
      "\u001b[1mINFO    \u001b[0m |  step #57: cost=46.0718 lambd=0.1024 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.90780 (avg 0.22695)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   4.23703 (avg 0.09630)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 40.92698 (avg 0.68212)\n",
      "\u001b[1mINFO    \u001b[0m |  step #58: cost=46.0718 lambd=0.2048 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.90780 (avg 0.22695)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   4.23703 (avg 0.09630)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 40.92698 (avg 0.68212)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=5.80e+01 cost_prev=46.0718 cost_new=43.8041\n",
      "\u001b[1mINFO    \u001b[0m |  step #59: cost=43.8041 lambd=0.1024 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.76805 (avg 0.19201)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   3.74768 (avg 0.08517)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 39.28839 (avg 0.65481)\n",
      "\u001b[1mINFO    \u001b[0m |  step #60: cost=43.8041 lambd=0.2048 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.76805 (avg 0.19201)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   3.74768 (avg 0.08517)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 39.28839 (avg 0.65481)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=5.36e+01 cost_prev=43.8041 cost_new=42.0232\n",
      "\u001b[1mINFO    \u001b[0m |  step #61: cost=42.0232 lambd=0.1024 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.72392 (avg 0.18098)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   3.48862 (avg 0.07929)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 37.81066 (avg 0.63018)\n",
      "\u001b[1mINFO    \u001b[0m |  step #62: cost=42.0232 lambd=0.2048 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.72392 (avg 0.18098)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   3.48862 (avg 0.07929)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 37.81066 (avg 0.63018)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=5.29e+01 cost_prev=42.0232 cost_new=40.4789\n",
      "\u001b[1mINFO    \u001b[0m |  step #63: cost=40.4789 lambd=0.1024 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.68197 (avg 0.17049)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   3.35185 (avg 0.07618)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 36.44508 (avg 0.60742)\n",
      "\u001b[1mINFO    \u001b[0m |  step #64: cost=40.4789 lambd=0.2048 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.68197 (avg 0.17049)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   3.35185 (avg 0.07618)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 36.44508 (avg 0.60742)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=5.21e+01 cost_prev=40.4789 cost_new=39.2266\n",
      "\u001b[1mINFO    \u001b[0m |  step #65: cost=39.2266 lambd=0.1024 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.72281 (avg 0.18070)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   3.31490 (avg 0.07534)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 35.18892 (avg 0.58648)\n",
      "\u001b[1mINFO    \u001b[0m |  step #66: cost=39.2266 lambd=0.2048 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.72281 (avg 0.18070)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   3.31490 (avg 0.07534)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 35.18892 (avg 0.58648)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=5.51e+01 cost_prev=39.2266 cost_new=38.0098\n",
      "\u001b[1mINFO    \u001b[0m |  step #67: cost=38.0098 lambd=0.1024 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.70123 (avg 0.17531)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   3.27706 (avg 0.07448)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 34.03149 (avg 0.56719)\n",
      "\u001b[1mINFO    \u001b[0m |  step #68: cost=38.0098 lambd=0.2048 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.70123 (avg 0.17531)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   3.27706 (avg 0.07448)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 34.03149 (avg 0.56719)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=5.51e+01 cost_prev=38.0098 cost_new=36.9099\n",
      "\u001b[1mINFO    \u001b[0m |  step #69: cost=36.9099 lambd=0.1024 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.68804 (avg 0.17201)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   3.25710 (avg 0.07403)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 32.96477 (avg 0.54941)\n",
      "\u001b[1mINFO    \u001b[0m |  step #70: cost=36.9099 lambd=0.2048 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.68804 (avg 0.17201)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   3.25710 (avg 0.07403)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 32.96477 (avg 0.54941)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=5.55e+01 cost_prev=36.9099 cost_new=35.9027\n",
      "\u001b[1mINFO    \u001b[0m |  step #71: cost=35.9027 lambd=0.1024 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.67963 (avg 0.16991)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   3.24503 (avg 0.07375)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 31.97800 (avg 0.53297)\n",
      "\u001b[1mINFO    \u001b[0m |  step #72: cost=35.9027 lambd=0.2048 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.67963 (avg 0.16991)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   3.24503 (avg 0.07375)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 31.97800 (avg 0.53297)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=5.60e+01 cost_prev=35.9027 cost_new=34.9267\n",
      "\u001b[1mINFO    \u001b[0m |  step #73: cost=34.9267 lambd=0.1024 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.64705 (avg 0.16176)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   3.21947 (avg 0.07317)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 31.06017 (avg 0.51767)\n",
      "\u001b[1mINFO    \u001b[0m |  step #74: cost=34.9267 lambd=0.2048 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.64705 (avg 0.16176)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   3.21947 (avg 0.07317)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 31.06017 (avg 0.51767)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=5.52e+01 cost_prev=34.9267 cost_new=34.0633\n",
      "\u001b[1mINFO    \u001b[0m |  step #75: cost=34.0633 lambd=0.1024 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.64699 (avg 0.16175)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   3.21236 (avg 0.07301)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 30.20398 (avg 0.50340)\n",
      "\u001b[1mINFO    \u001b[0m |  step #76: cost=34.0633 lambd=0.2048 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.64699 (avg 0.16175)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   3.21236 (avg 0.07301)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 30.20398 (avg 0.50340)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=5.61e+01 cost_prev=34.0633 cost_new=33.2578\n",
      "\u001b[1mINFO    \u001b[0m |  step #77: cost=33.2578 lambd=0.1024 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.65167 (avg 0.16292)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   3.20890 (avg 0.07293)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 29.39719 (avg 0.48995)\n",
      "\u001b[1mINFO    \u001b[0m |  step #78: cost=33.2578 lambd=0.2048 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.65167 (avg 0.16292)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   3.20890 (avg 0.07293)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 29.39719 (avg 0.48995)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=5.72e+01 cost_prev=33.2578 cost_new=32.4966\n",
      "\u001b[1mINFO    \u001b[0m |  step #79: cost=32.4966 lambd=0.1024 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.65581 (avg 0.16395)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   3.20531 (avg 0.07285)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 28.63545 (avg 0.47726)\n",
      "\u001b[1mINFO    \u001b[0m |  step #80: cost=32.4966 lambd=0.2048 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.65581 (avg 0.16395)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   3.20531 (avg 0.07285)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 28.63545 (avg 0.47726)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=5.84e+01 cost_prev=32.4966 cost_new=31.7757\n",
      "\u001b[1mINFO    \u001b[0m |  step #81: cost=31.7757 lambd=0.1024 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.66165 (avg 0.16541)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   3.20192 (avg 0.07277)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 27.91212 (avg 0.46520)\n",
      "\u001b[1mINFO    \u001b[0m |  step #82: cost=31.7757 lambd=0.2048 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.66165 (avg 0.16541)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   3.20192 (avg 0.07277)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 27.91212 (avg 0.46520)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=5.96e+01 cost_prev=31.7757 cost_new=31.0876\n",
      "\u001b[1mINFO    \u001b[0m |  step #83: cost=31.0876 lambd=0.1024 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.66678 (avg 0.16669)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   3.19805 (avg 0.07268)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 27.22277 (avg 0.45371)\n",
      "\u001b[1mINFO    \u001b[0m |  step #84: cost=31.0876 lambd=0.2048 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.66678 (avg 0.16669)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   3.19805 (avg 0.07268)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 27.22277 (avg 0.45371)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=6.09e+01 cost_prev=31.0876 cost_new=30.4338\n",
      "\u001b[1mINFO    \u001b[0m |  step #85: cost=30.4338 lambd=0.1024 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.67527 (avg 0.16882)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   3.19249 (avg 0.07256)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 26.56601 (avg 0.44277)\n",
      "\u001b[1mINFO    \u001b[0m |  step #86: cost=30.4338 lambd=0.2048 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.67527 (avg 0.16882)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   3.19249 (avg 0.07256)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 26.56601 (avg 0.44277)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=6.23e+01 cost_prev=30.4338 cost_new=29.8019\n",
      "\u001b[1mINFO    \u001b[0m |  step #87: cost=29.8019 lambd=0.1024 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.68141 (avg 0.17035)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   3.18420 (avg 0.07237)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 25.93630 (avg 0.43227)\n",
      "\u001b[1mINFO    \u001b[0m |  step #88: cost=29.8019 lambd=0.2048 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.68141 (avg 0.17035)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   3.18420 (avg 0.07237)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 25.93630 (avg 0.43227)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=6.37e+01 cost_prev=29.8019 cost_new=29.1932\n",
      "\u001b[1mINFO    \u001b[0m |  step #89: cost=29.1932 lambd=0.1024 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.68635 (avg 0.17159)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   3.17250 (avg 0.07210)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 25.33438 (avg 0.42224)\n",
      "\u001b[1mINFO    \u001b[0m |  step #90: cost=29.1932 lambd=0.2048 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.68635 (avg 0.17159)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   3.17250 (avg 0.07210)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 25.33438 (avg 0.42224)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=6.50e+01 cost_prev=29.1932 cost_new=28.6104\n",
      "\u001b[1mINFO    \u001b[0m |  step #91: cost=28.6104 lambd=0.1024 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.69520 (avg 0.17380)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   3.16130 (avg 0.07185)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 24.75389 (avg 0.41256)\n",
      "\u001b[1mINFO    \u001b[0m |  step #92: cost=28.6104 lambd=0.2048 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.69520 (avg 0.17380)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   3.16130 (avg 0.07185)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 24.75389 (avg 0.41256)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=6.66e+01 cost_prev=28.6104 cost_new=28.0454\n",
      "\u001b[1mINFO    \u001b[0m |  step #93: cost=28.0454 lambd=0.1024 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.70343 (avg 0.17586)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   3.14722 (avg 0.07153)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 24.19471 (avg 0.40325)\n",
      "\u001b[1mINFO    \u001b[0m |  step #94: cost=28.0454 lambd=0.2048 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.70343 (avg 0.17586)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   3.14722 (avg 0.07153)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 24.19471 (avg 0.40325)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=6.82e+01 cost_prev=28.0454 cost_new=27.4948\n",
      "\u001b[1mINFO    \u001b[0m |  step #95: cost=27.4948 lambd=0.1024 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.70935 (avg 0.17734)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   3.12942 (avg 0.07112)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 23.65602 (avg 0.39427)\n",
      "\u001b[1mINFO    \u001b[0m |  step #96: cost=27.4948 lambd=0.2048 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.70935 (avg 0.17734)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   3.12942 (avg 0.07112)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 23.65602 (avg 0.39427)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=6.98e+01 cost_prev=27.4948 cost_new=26.9620\n",
      "\u001b[1mINFO    \u001b[0m |  step #97: cost=26.9620 lambd=0.1024 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.71633 (avg 0.17908)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   3.10901 (avg 0.07066)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 23.13668 (avg 0.38561)\n",
      "\u001b[1mINFO    \u001b[0m |  step #98: cost=26.9620 lambd=0.2048 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.71633 (avg 0.17908)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   3.10901 (avg 0.07066)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 23.13668 (avg 0.38561)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=7.14e+01 cost_prev=26.9620 cost_new=26.4424\n",
      "\u001b[1mINFO    \u001b[0m |  step #99: cost=26.4424 lambd=0.1024 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.72068 (avg 0.18017)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   3.08535 (avg 0.07012)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 22.63634 (avg 0.37727)\n",
      "\u001b[1mINFO    \u001b[0m |  step #100: cost=26.4424 lambd=0.2048 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.72068 (avg 0.18017)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   3.08535 (avg 0.07012)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 22.63634 (avg 0.37727)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=7.29e+01 cost_prev=26.4424 cost_new=25.9412\n",
      "\u001b[1mINFO    \u001b[0m |  step #101: cost=25.9412 lambd=0.1024 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.72865 (avg 0.18216)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   3.06140 (avg 0.06958)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 22.15115 (avg 0.36919)\n",
      "\u001b[1mINFO    \u001b[0m |  step #102: cost=25.9412 lambd=0.2048 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.72865 (avg 0.18216)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   3.06140 (avg 0.06958)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 22.15115 (avg 0.36919)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=7.47e+01 cost_prev=25.9412 cost_new=25.4459\n",
      "\u001b[1mINFO    \u001b[0m |  step #103: cost=25.4459 lambd=0.1024 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.72998 (avg 0.18250)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   3.03191 (avg 0.06891)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 21.68396 (avg 0.36140)\n",
      "\u001b[1mINFO    \u001b[0m |  step #104: cost=25.4459 lambd=0.2048 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.72998 (avg 0.18250)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   3.03191 (avg 0.06891)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 21.68396 (avg 0.36140)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=7.62e+01 cost_prev=25.4459 cost_new=24.9702\n",
      "\u001b[1mINFO    \u001b[0m |  step #105: cost=24.9702 lambd=0.1024 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.73568 (avg 0.18392)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   3.00203 (avg 0.06823)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 21.23254 (avg 0.35388)\n",
      "\u001b[1mINFO    \u001b[0m |  step #106: cost=24.9702 lambd=0.2048 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.73568 (avg 0.18392)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   3.00203 (avg 0.06823)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 21.23254 (avg 0.35388)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=7.79e+01 cost_prev=24.9702 cost_new=24.5070\n",
      "\u001b[1mINFO    \u001b[0m |  step #107: cost=24.5070 lambd=0.1024 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.73988 (avg 0.18497)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   2.96454 (avg 0.06738)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 20.80257 (avg 0.34671)\n",
      "\u001b[1mINFO    \u001b[0m |  step #108: cost=24.5070 lambd=0.2048 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.73988 (avg 0.18497)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   2.96454 (avg 0.06738)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 20.80257 (avg 0.34671)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=7.97e+01 cost_prev=24.5070 cost_new=24.0466\n",
      "\u001b[1mINFO    \u001b[0m |  step #109: cost=24.0466 lambd=0.1024 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.73680 (avg 0.18420)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   2.92645 (avg 0.06651)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 20.38332 (avg 0.33972)\n",
      "\u001b[1mINFO    \u001b[0m |  step #110: cost=24.0466 lambd=0.2048 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.73680 (avg 0.18420)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   2.92645 (avg 0.06651)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 20.38332 (avg 0.33972)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=8.10e+01 cost_prev=24.0466 cost_new=23.6030\n",
      "\u001b[1mINFO    \u001b[0m |  step #111: cost=23.6030 lambd=0.1024 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.73679 (avg 0.18420)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   2.88973 (avg 0.06568)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 19.97651 (avg 0.33294)\n",
      "\u001b[1mINFO    \u001b[0m |  step #112: cost=23.6030 lambd=0.2048 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.73679 (avg 0.18420)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   2.88973 (avg 0.06568)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 19.97651 (avg 0.33294)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=8.25e+01 cost_prev=23.6030 cost_new=23.1628\n",
      "\u001b[1mINFO    \u001b[0m |  step #113: cost=23.1628 lambd=0.1024 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.72944 (avg 0.18236)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   2.84933 (avg 0.06476)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 19.58403 (avg 0.32640)\n",
      "\u001b[1mINFO    \u001b[0m |  step #114: cost=23.1628 lambd=0.2048 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.72944 (avg 0.18236)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   2.84933 (avg 0.06476)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 19.58403 (avg 0.32640)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=8.35e+01 cost_prev=23.1628 cost_new=22.7715\n",
      "\u001b[1mINFO    \u001b[0m |  step #115: cost=22.7715 lambd=0.1024 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.74404 (avg 0.18601)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   2.80518 (avg 0.06375)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 19.22232 (avg 0.32037)\n",
      "\u001b[1mINFO    \u001b[0m |  step #116: cost=22.7715 lambd=0.2048 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.74404 (avg 0.18601)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   2.80518 (avg 0.06375)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 19.22232 (avg 0.32037)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=8.63e+01 cost_prev=22.7715 cost_new=22.3250\n",
      "\u001b[1mINFO    \u001b[0m |  step #117: cost=22.3250 lambd=0.1024 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.71639 (avg 0.17910)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   2.75927 (avg 0.06271)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 18.84938 (avg 0.31416)\n",
      "\u001b[1mINFO    \u001b[0m |  step #118: cost=22.3250 lambd=0.2048 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.71639 (avg 0.17910)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   2.75927 (avg 0.06271)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 18.84938 (avg 0.31416)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=8.58e+01 cost_prev=22.3250 cost_new=21.9357\n",
      "\u001b[1mINFO    \u001b[0m |  step #119: cost=21.9357 lambd=0.1024 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.71468 (avg 0.17867)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   2.71564 (avg 0.06172)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 18.50538 (avg 0.30842)\n",
      "\u001b[1mINFO    \u001b[0m |  step #120: cost=21.9357 lambd=0.2048 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.71468 (avg 0.17867)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   2.71564 (avg 0.06172)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 18.50538 (avg 0.30842)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=8.73e+01 cost_prev=21.9357 cost_new=21.5548\n",
      "\u001b[1mINFO    \u001b[0m |  step #121: cost=21.5548 lambd=0.1024 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.70900 (avg 0.17725)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   2.66719 (avg 0.06062)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 18.17860 (avg 0.30298)\n",
      "\u001b[1mINFO    \u001b[0m |  step #122: cost=21.5548 lambd=0.2048 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.70900 (avg 0.17725)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   2.66719 (avg 0.06062)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 18.17860 (avg 0.30298)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=8.85e+01 cost_prev=21.5548 cost_new=21.1784\n",
      "\u001b[1mINFO    \u001b[0m |  step #123: cost=21.1784 lambd=0.1024 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.69833 (avg 0.17458)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   2.61788 (avg 0.05950)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 17.86216 (avg 0.29770)\n",
      "\u001b[1mINFO    \u001b[0m |  step #124: cost=21.1784 lambd=0.2048 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.69833 (avg 0.17458)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   2.61788 (avg 0.05950)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 17.86216 (avg 0.29770)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=8.93e+01 cost_prev=21.1784 cost_new=20.8114\n",
      "\u001b[1mINFO    \u001b[0m |  step #125: cost=20.8114 lambd=0.1024 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.68489 (avg 0.17122)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   2.56761 (avg 0.05835)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 17.55891 (avg 0.29265)\n",
      "\u001b[1mINFO    \u001b[0m |  step #126: cost=20.8114 lambd=0.2048 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.68489 (avg 0.17122)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   2.56761 (avg 0.05835)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 17.55891 (avg 0.29265)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=8.99e+01 cost_prev=20.8114 cost_new=20.4543\n",
      "\u001b[1mINFO    \u001b[0m |  step #127: cost=20.4543 lambd=0.1024 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.66872 (avg 0.16718)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   2.51782 (avg 0.05722)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 17.26774 (avg 0.28780)\n",
      "\u001b[1mINFO    \u001b[0m |  step #128: cost=20.4543 lambd=0.2048 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.66872 (avg 0.16718)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   2.51782 (avg 0.05722)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 17.26774 (avg 0.28780)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=9.02e+01 cost_prev=20.4543 cost_new=20.1138\n",
      "\u001b[1mINFO    \u001b[0m |  step #129: cost=20.1138 lambd=0.1024 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.65500 (avg 0.16375)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   2.46871 (avg 0.05611)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 16.99012 (avg 0.28317)\n",
      "\u001b[1mINFO    \u001b[0m |  step #130: cost=20.1138 lambd=0.2048 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.65500 (avg 0.16375)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   2.46871 (avg 0.05611)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 16.99012 (avg 0.28317)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=9.07e+01 cost_prev=20.1138 cost_new=19.7848\n",
      "\u001b[1mINFO    \u001b[0m |  step #131: cost=19.7848 lambd=0.1024 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.63944 (avg 0.15986)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   2.41928 (avg 0.05498)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 16.72607 (avg 0.27877)\n",
      "\u001b[1mINFO    \u001b[0m |  step #132: cost=19.7848 lambd=0.2048 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.63944 (avg 0.15986)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   2.41928 (avg 0.05498)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 16.72607 (avg 0.27877)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=9.10e+01 cost_prev=19.7848 cost_new=19.4646\n",
      "\u001b[1mINFO    \u001b[0m |  step #133: cost=19.4646 lambd=0.1024 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.62173 (avg 0.15543)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   2.36923 (avg 0.05385)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 16.47367 (avg 0.27456)\n",
      "\u001b[1mINFO    \u001b[0m |  step #134: cost=19.4646 lambd=0.2048 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.62173 (avg 0.15543)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   2.36923 (avg 0.05385)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 16.47367 (avg 0.27456)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=9.10e+01 cost_prev=19.4646 cost_new=19.1581\n",
      "\u001b[1mINFO    \u001b[0m |  step #135: cost=19.1581 lambd=0.1024 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.60522 (avg 0.15131)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   2.32091 (avg 0.05275)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 16.23196 (avg 0.27053)\n",
      "\u001b[1mINFO    \u001b[0m |  step #136: cost=19.1581 lambd=0.2048 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.60522 (avg 0.15131)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   2.32091 (avg 0.05275)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 16.23196 (avg 0.27053)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=9.10e+01 cost_prev=19.1581 cost_new=18.8642\n",
      "\u001b[1mINFO    \u001b[0m |  step #137: cost=18.8642 lambd=0.1024 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.58837 (avg 0.14709)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   2.27269 (avg 0.05165)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 16.00317 (avg 0.26672)\n",
      "\u001b[1mINFO    \u001b[0m |  step #138: cost=18.8642 lambd=0.2048 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.58837 (avg 0.14709)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   2.27269 (avg 0.05165)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 16.00317 (avg 0.26672)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=9.09e+01 cost_prev=18.8642 cost_new=18.5770\n",
      "\u001b[1mINFO    \u001b[0m |  step #139: cost=18.5770 lambd=0.1024 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.56842 (avg 0.14210)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   2.22457 (avg 0.05056)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 15.78405 (avg 0.26307)\n",
      "\u001b[1mINFO    \u001b[0m |  step #140: cost=18.5770 lambd=0.2048 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.56842 (avg 0.14210)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   2.22457 (avg 0.05056)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 15.78405 (avg 0.26307)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=9.05e+01 cost_prev=18.5770 cost_new=18.3023\n",
      "\u001b[1mINFO    \u001b[0m |  step #141: cost=18.3023 lambd=0.1024 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.54868 (avg 0.13717)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   2.17772 (avg 0.04949)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 15.57594 (avg 0.25960)\n",
      "\u001b[1mINFO    \u001b[0m |  step #142: cost=18.3023 lambd=0.2048 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.54868 (avg 0.13717)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   2.17772 (avg 0.04949)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 15.57594 (avg 0.25960)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=8.99e+01 cost_prev=18.3023 cost_new=18.0436\n",
      "\u001b[1mINFO    \u001b[0m |  step #143: cost=18.0436 lambd=0.1024 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.53316 (avg 0.13329)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   2.13347 (avg 0.04849)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 15.37694 (avg 0.25628)\n",
      "\u001b[1mINFO    \u001b[0m |  step #144: cost=18.0436 lambd=0.2048 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.53316 (avg 0.13329)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   2.13347 (avg 0.04849)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 15.37694 (avg 0.25628)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=8.97e+01 cost_prev=18.0436 cost_new=17.7940\n",
      "\u001b[1mINFO    \u001b[0m |  step #145: cost=17.7940 lambd=0.1024 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.51695 (avg 0.12924)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   2.08957 (avg 0.04749)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 15.18752 (avg 0.25313)\n",
      "\u001b[1mINFO    \u001b[0m |  step #146: cost=17.7940 lambd=0.2048 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.51695 (avg 0.12924)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   2.08957 (avg 0.04749)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 15.18752 (avg 0.25313)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=8.94e+01 cost_prev=17.7940 cost_new=17.5480\n",
      "\u001b[1mINFO    \u001b[0m |  step #147: cost=17.5480 lambd=0.1024 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.49587 (avg 0.12397)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   2.04524 (avg 0.04648)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 15.00692 (avg 0.25012)\n",
      "\u001b[1mINFO    \u001b[0m |  step #148: cost=17.5480 lambd=0.2048 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.49587 (avg 0.12397)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   2.04524 (avg 0.04648)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 15.00692 (avg 0.25012)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=8.84e+01 cost_prev=17.5480 cost_new=17.3175\n",
      "\u001b[1mINFO    \u001b[0m |  step #149: cost=17.3175 lambd=0.1024 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.47835 (avg 0.11959)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   2.00262 (avg 0.04551)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 14.83648 (avg 0.24727)\n",
      "\u001b[1mINFO    \u001b[0m |  step #150: cost=17.3175 lambd=0.2048 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.47835 (avg 0.11959)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   2.00262 (avg 0.04551)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 14.83648 (avg 0.24727)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=8.78e+01 cost_prev=17.3175 cost_new=17.0932\n",
      "\u001b[1mINFO    \u001b[0m |  step #151: cost=17.0932 lambd=0.1024 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.45897 (avg 0.11474)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   1.96043 (avg 0.04456)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 14.67384 (avg 0.24456)\n",
      "\u001b[1mINFO    \u001b[0m |  step #152: cost=17.0932 lambd=0.2048 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.45897 (avg 0.11474)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   1.96043 (avg 0.04456)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 14.67384 (avg 0.24456)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=8.68e+01 cost_prev=17.0932 cost_new=16.8795\n",
      "\u001b[1mINFO    \u001b[0m |  step #153: cost=16.8795 lambd=0.1024 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.44070 (avg 0.11017)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   1.91974 (avg 0.04363)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 14.51904 (avg 0.24198)\n",
      "\u001b[1mINFO    \u001b[0m |  step #154: cost=16.8795 lambd=0.2048 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.44070 (avg 0.11017)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   1.91974 (avg 0.04363)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 14.51904 (avg 0.24198)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=8.57e+01 cost_prev=16.8795 cost_new=16.6772\n",
      "\u001b[1mINFO    \u001b[0m |  step #155: cost=16.6772 lambd=0.1024 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.42400 (avg 0.10600)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   1.88147 (avg 0.04276)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 14.37178 (avg 0.23953)\n",
      "\u001b[1mINFO    \u001b[0m |  step #156: cost=16.6772 lambd=0.2048 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.42400 (avg 0.10600)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   1.88147 (avg 0.04276)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 14.37178 (avg 0.23953)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=8.49e+01 cost_prev=16.6772 cost_new=16.4836\n",
      "\u001b[1mINFO    \u001b[0m |  step #157: cost=16.4836 lambd=0.1024 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.40795 (avg 0.10199)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   1.84339 (avg 0.04190)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 14.23231 (avg 0.23721)\n",
      "\u001b[1mINFO    \u001b[0m |  step #158: cost=16.4836 lambd=0.2048 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.40795 (avg 0.10199)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   1.84339 (avg 0.04190)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 14.23231 (avg 0.23721)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=8.40e+01 cost_prev=16.4836 cost_new=16.2953\n",
      "\u001b[1mINFO    \u001b[0m |  step #159: cost=16.2953 lambd=0.1024 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.38991 (avg 0.09748)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   1.80651 (avg 0.04106)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 14.09886 (avg 0.23498)\n",
      "\u001b[1mINFO    \u001b[0m |  step #160: cost=16.2953 lambd=0.2048 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.38991 (avg 0.09748)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   1.80651 (avg 0.04106)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 14.09886 (avg 0.23498)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=8.27e+01 cost_prev=16.2953 cost_new=16.1169\n",
      "\u001b[1mINFO    \u001b[0m |  step #161: cost=16.1169 lambd=0.1024 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.37365 (avg 0.09341)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   1.77088 (avg 0.04025)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 13.97235 (avg 0.23287)\n",
      "\u001b[1mINFO    \u001b[0m |  step #162: cost=16.1169 lambd=0.2048 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.37365 (avg 0.09341)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   1.77088 (avg 0.04025)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 13.97235 (avg 0.23287)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=8.15e+01 cost_prev=16.1169 cost_new=15.9476\n",
      "\u001b[1mINFO    \u001b[0m |  step #163: cost=15.9476 lambd=0.1024 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.35862 (avg 0.08966)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   1.73674 (avg 0.03947)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 13.85224 (avg 0.23087)\n",
      "\u001b[1mINFO    \u001b[0m |  step #164: cost=15.9476 lambd=0.2048 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.35862 (avg 0.08966)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   1.73674 (avg 0.03947)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 13.85224 (avg 0.23087)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=8.04e+01 cost_prev=15.9476 cost_new=15.7864\n",
      "\u001b[1mINFO    \u001b[0m |  step #165: cost=15.7864 lambd=0.1024 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.34444 (avg 0.08611)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   1.70348 (avg 0.03872)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 13.73847 (avg 0.22897)\n",
      "\u001b[1mINFO    \u001b[0m |  step #166: cost=15.7864 lambd=0.2048 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.34444 (avg 0.08611)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   1.70348 (avg 0.03872)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 13.73847 (avg 0.22897)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=7.93e+01 cost_prev=15.7864 cost_new=15.6309\n",
      "\u001b[1mINFO    \u001b[0m |  step #167: cost=15.6309 lambd=0.1024 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.33000 (avg 0.08250)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   1.67128 (avg 0.03798)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 13.62961 (avg 0.22716)\n",
      "\u001b[1mINFO    \u001b[0m |  step #168: cost=15.6309 lambd=0.2048 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.33000 (avg 0.08250)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   1.67128 (avg 0.03798)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 13.62961 (avg 0.22716)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=7.81e+01 cost_prev=15.6309 cost_new=15.4808\n",
      "\u001b[1mINFO    \u001b[0m |  step #169: cost=15.4808 lambd=0.1024 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.31524 (avg 0.07881)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   1.63968 (avg 0.03727)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 13.52583 (avg 0.22543)\n",
      "\u001b[1mINFO    \u001b[0m |  step #170: cost=15.4808 lambd=0.2048 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.31524 (avg 0.07881)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   1.63968 (avg 0.03727)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 13.52583 (avg 0.22543)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=7.66e+01 cost_prev=15.4808 cost_new=15.3398\n",
      "\u001b[1mINFO    \u001b[0m |  step #171: cost=15.3398 lambd=0.1024 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.30216 (avg 0.07554)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   1.61081 (avg 0.03661)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 13.42684 (avg 0.22378)\n",
      "\u001b[1mINFO    \u001b[0m |  step #172: cost=15.3398 lambd=0.2048 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.30216 (avg 0.07554)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   1.61081 (avg 0.03661)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 13.42684 (avg 0.22378)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=7.54e+01 cost_prev=15.3398 cost_new=15.1959\n",
      "\u001b[1mINFO    \u001b[0m |  step #173: cost=15.1959 lambd=0.1024 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.28403 (avg 0.07101)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   1.58909 (avg 0.03612)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 13.32280 (avg 0.22205)\n",
      "\u001b[1mINFO    \u001b[0m |  step #174: cost=15.1959 lambd=0.2048 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.28403 (avg 0.07101)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   1.58909 (avg 0.03612)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 13.32280 (avg 0.22205)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=7.30e+01 cost_prev=15.1959 cost_new=15.0854\n",
      "\u001b[1mINFO    \u001b[0m |  step #175: cost=15.0854 lambd=0.1024 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.28404 (avg 0.07101)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   1.56089 (avg 0.03547)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 13.24047 (avg 0.22067)\n",
      "\u001b[1mINFO    \u001b[0m |  step #176: cost=15.0854 lambd=0.2048 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.28404 (avg 0.07101)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   1.56089 (avg 0.03547)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 13.24047 (avg 0.22067)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=7.42e+01 cost_prev=15.0854 cost_new=14.9557\n",
      "\u001b[1mINFO    \u001b[0m |  step #177: cost=14.9557 lambd=0.1024 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.26839 (avg 0.06710)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   1.52955 (avg 0.03476)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 13.15779 (avg 0.21930)\n",
      "\u001b[1mINFO    \u001b[0m |  step #178: cost=14.9557 lambd=0.2048 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.26839 (avg 0.06710)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   1.52955 (avg 0.03476)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 13.15779 (avg 0.21930)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=7.21e+01 cost_prev=14.9557 cost_new=14.8364\n",
      "\u001b[1mINFO    \u001b[0m |  step #179: cost=14.8364 lambd=0.1024 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.25641 (avg 0.06410)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   1.50199 (avg 0.03414)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 13.07804 (avg 0.21797)\n",
      "\u001b[1mINFO    \u001b[0m |  step #180: cost=14.8364 lambd=0.2048 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.25641 (avg 0.06410)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   1.50199 (avg 0.03414)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 13.07804 (avg 0.21797)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=7.06e+01 cost_prev=14.8364 cost_new=14.7215\n",
      "\u001b[1mINFO    \u001b[0m |  step #181: cost=14.7215 lambd=0.1024 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.24381 (avg 0.06095)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   1.47695 (avg 0.03357)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 13.00072 (avg 0.21668)\n",
      "\u001b[1mINFO    \u001b[0m |  step #182: cost=14.7215 lambd=0.2048 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.24381 (avg 0.06095)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   1.47695 (avg 0.03357)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 13.00072 (avg 0.21668)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=6.89e+01 cost_prev=14.7215 cost_new=14.6151\n",
      "\u001b[1mINFO    \u001b[0m |  step #183: cost=14.6151 lambd=0.1024 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.23462 (avg 0.05866)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   1.45287 (avg 0.03302)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 12.92759 (avg 0.21546)\n",
      "\u001b[1mINFO    \u001b[0m |  step #184: cost=14.6151 lambd=0.2048 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.23462 (avg 0.05866)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   1.45287 (avg 0.03302)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 12.92759 (avg 0.21546)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=6.78e+01 cost_prev=14.6151 cost_new=14.5125\n",
      "\u001b[1mINFO    \u001b[0m |  step #185: cost=14.5125 lambd=0.1024 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.22522 (avg 0.05630)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   1.42940 (avg 0.03249)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 12.85791 (avg 0.21430)\n",
      "\u001b[1mINFO    \u001b[0m |  step #186: cost=14.5125 lambd=0.2048 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.22522 (avg 0.05630)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   1.42940 (avg 0.03249)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 12.85791 (avg 0.21430)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=6.65e+01 cost_prev=14.5125 cost_new=14.4151\n",
      "\u001b[1mINFO    \u001b[0m |  step #187: cost=14.4151 lambd=0.1024 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.21666 (avg 0.05417)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   1.40716 (avg 0.03198)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 12.79130 (avg 0.21319)\n",
      "\u001b[1mINFO    \u001b[0m |  step #188: cost=14.4151 lambd=0.2048 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.21666 (avg 0.05417)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   1.40716 (avg 0.03198)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 12.79130 (avg 0.21319)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=6.54e+01 cost_prev=14.4151 cost_new=14.3201\n",
      "\u001b[1mINFO    \u001b[0m |  step #189: cost=14.3201 lambd=0.1024 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.20683 (avg 0.05171)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   1.38584 (avg 0.03150)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 12.72741 (avg 0.21212)\n",
      "\u001b[1mINFO    \u001b[0m |  step #190: cost=14.3201 lambd=0.2048 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.20683 (avg 0.05171)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   1.38584 (avg 0.03150)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 12.72741 (avg 0.21212)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=6.39e+01 cost_prev=14.3201 cost_new=14.2319\n",
      "\u001b[1mINFO    \u001b[0m |  step #191: cost=14.2319 lambd=0.1024 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.19954 (avg 0.04989)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   1.36448 (avg 0.03101)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 12.66783 (avg 0.21113)\n",
      "\u001b[1mINFO    \u001b[0m |  step #192: cost=14.2319 lambd=0.2048 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.19954 (avg 0.04989)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   1.36448 (avg 0.03101)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 12.66783 (avg 0.21113)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=6.29e+01 cost_prev=14.2319 cost_new=14.1457\n",
      "\u001b[1mINFO    \u001b[0m |  step #193: cost=14.1457 lambd=0.1024 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.19145 (avg 0.04786)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   1.34460 (avg 0.03056)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 12.60969 (avg 0.21016)\n",
      "\u001b[1mINFO    \u001b[0m |  step #194: cost=14.1457 lambd=0.2048 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.19145 (avg 0.04786)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   1.34460 (avg 0.03056)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 12.60969 (avg 0.21016)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=6.16e+01 cost_prev=14.1457 cost_new=14.0647\n",
      "\u001b[1mINFO    \u001b[0m |  step #195: cost=14.0647 lambd=0.1024 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.18448 (avg 0.04612)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   1.32542 (avg 0.03012)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 12.55480 (avg 0.20925)\n",
      "\u001b[1mINFO    \u001b[0m |  step #196: cost=14.0647 lambd=0.2048 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.18448 (avg 0.04612)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   1.32542 (avg 0.03012)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 12.55480 (avg 0.20925)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=6.05e+01 cost_prev=14.0647 cost_new=13.9860\n",
      "\u001b[1mINFO    \u001b[0m |  step #197: cost=13.9860 lambd=0.1024 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.17710 (avg 0.04428)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   1.30683 (avg 0.02970)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 12.50204 (avg 0.20837)\n",
      "\u001b[1mINFO    \u001b[0m |  step #198: cost=13.9860 lambd=0.2048 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.17710 (avg 0.04428)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   1.30683 (avg 0.02970)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 12.50204 (avg 0.20837)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=5.91e+01 cost_prev=13.9860 cost_new=13.9112\n",
      "\u001b[1mINFO    \u001b[0m |  step #199: cost=13.9112 lambd=0.1024 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.17066 (avg 0.04267)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   1.28761 (avg 0.02926)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 12.45291 (avg 0.20755)\n",
      "\u001b[1mINFO    \u001b[0m |  step #200: cost=13.9112 lambd=0.2048 inexact_tol=6.8e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.17066 (avg 0.04267)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   1.28761 (avg 0.02926)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 12.45291 (avg 0.20755)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=5.79e+01 cost_prev=13.9112 cost_new=13.8397\n",
      "\u001b[1mINFO    \u001b[0m | Terminated @ iteration #200: cost=13.8397 criteria=[0 0 0 1], term_deltas=5.1e-03,1.3e+01,1.1e-02\n"
     ]
    }
   ],
   "source": [
    "solution = problem.solve(initial_vals)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "cell-15",
   "metadata": {},
   "source": [
    "## Visualization"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "cell-16",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Final state: x=-0.002, theta=3.148\n",
      "Target theta (pi): 3.142\n",
      "Terminal angle error: 0.0064 rad\n"
     ]
    }
   ],
   "source": [
    "# Extract solution.\n",
    "optimal_controls = solution[control_var]\n",
    "optimal_trajectory = simulate_trajectory(optimal_controls)\n",
    "\n",
    "times = jnp.linspace(0, total_time, n_steps + 1)\n",
    "control_times = jnp.linspace(0, total_time - dt, n_steps)\n",
    "\n",
    "print(\n",
    "    f\"Final state: x={float(optimal_trajectory[-1, 0]):.3f}, theta={float(optimal_trajectory[-1, 1]):.3f}\"\n",
    ")\n",
    "print(f\"Target theta (pi): {jnp.pi:.3f}\")\n",
    "print(f\"Terminal angle error: {abs(float(optimal_trajectory[-1, 1]) - jnp.pi):.4f} rad\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "cell-17",
   "metadata": {
    "tags": [
     "hide-input"
    ]
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>                        <script type=\"text/javascript\">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>\n",
       "        <script charset=\"utf-8\" src=\"https://cdn.plot.ly/plotly-3.1.0.min.js\" integrity=\"sha256-Ei4740bWZhaUTQuD6q9yQlgVCMPBz6CZWhevDYPv93A=\" crossorigin=\"anonymous\"></script>                <div id=\"062fc545-8a8f-4dd8-bf8a-d0986ecc09e3\" class=\"plotly-graph-div\" style=\"height:500px; width:100%;\"></div>            <script type=\"text/javascript\">                window.PLOTLYENV=window.PLOTLYENV || {};                                if (document.getElementById(\"062fc545-8a8f-4dd8-bf8a-d0986ecc09e3\")) {                    Plotly.newPlot(                        \"062fc545-8a8f-4dd8-bf8a-d0986ecc09e3\",                        [{\"fill\":\"toself\",\"fillcolor\":\"steelblue\",\"line\":{\"color\":\"darkblue\",\"width\":2},\"name\":\"Cart\",\"x\":[-0.2,0.2,0.2,-0.2,-0.2],\"y\":[1.125,1.125,1.275,1.275,1.125],\"type\":\"scatter\"},{\"line\":{\"color\":\"sienna\",\"width\":8},\"mode\":\"lines\",\"name\":\"Pole\",\"x\":[0.0,0.0],\"y\":[1.2,0.20000004768371582],\"type\":\"scatter\"},{\"marker\":{\"color\":\"sienna\",\"line\":{\"color\":\"black\",\"width\":1},\"size\":18},\"mode\":\"markers\",\"showlegend\":false,\"x\":[0.0],\"y\":[0.20000004768371582],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"showlegend\":false,\"x\":[-0.13333333333333333],\"y\":[1.075],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"showlegend\":false,\"x\":[0.13333333333333333],\"y\":[1.075],\"type\":\"scatter\"},{\"line\":{\"color\":\"gray\",\"width\":6},\"mode\":\"lines\",\"name\":\"Rail\",\"x\":[-2.5,2.5],\"y\":[1.025,1.025],\"type\":\"scatter\"}],                        {\"height\":500,\"margin\":{\"b\":100,\"t\":80},\"plot_bgcolor\":\"white\",\"showlegend\":false,\"sliders\":[{\"active\":0,\"currentvalue\":{\"offset\":20,\"prefix\":\"Time: \",\"suffix\":\"s\",\"visible\":true,\"xanchor\":\"center\"},\"len\":0.8,\"pad\":{\"b\":10,\"t\":60},\"steps\":[{\"args\":[[\"0\"],{\"frame\":{\"duration\":0,\"redraw\":true},\"mode\":\"immediate\",\"transition\":{\"duration\":0}}],\"label\":\"0.00\",\"method\":\"animate\"},{\"args\":[[\"2\"],{\"frame\":{\"duration\":0,\"redraw\":true},\"mode\":\"immediate\",\"transition\":{\"duration\":0}}],\"label\":\"0.10\",\"method\":\"animate\"},{\"args\":[[\"4\"],{\"frame\":{\"duration\":0,\"redraw\":true},\"mode\":\"immediate\",\"transition\":{\"duration\":0}}],\"label\":\"0.20\",\"method\":\"animate\"},{\"args\":[[\"6\"],{\"frame\":{\"duration\":0,\"redraw\":true},\"mode\":\"immediate\",\"transition\":{\"duration\":0}}],\"label\":\"0.30\",\"method\":\"animate\"},{\"args\":[[\"8\"],{\"frame\":{\"duration\":0,\"redraw\":true},\"mode\":\"immediate\",\"transition\":{\"duration\":0}}],\"label\":\"0.40\",\"method\":\"animate\"},{\"args\":[[\"10\"],{\"frame\":{\"duration\":0,\"redraw\":true},\"mode\":\"immediate\",\"transition\":{\"duration\":0}}],\"label\":\"0.50\",\"method\":\"animate\"},{\"args\":[[\"12\"],{\"frame\":{\"duration\":0,\"redraw\":true},\"mode\":\"immediate\",\"transition\":{\"duration\":0}}],\"label\":\"0.60\",\"method\":\"animate\"},{\"args\":[[\"14\"],{\"frame\":{\"duration\":0,\"redraw\":true},\"mode\":\"immediate\",\"transition\":{\"duration\":0}}],\"label\":\"0.70\",\"method\":\"animate\"},{\"args\":[[\"16\"],{\"frame\":{\"duration\":0,\"redraw\":true},\"mode\":\"immediate\",\"transition\":{\"duration\":0}}],\"label\":\"0.80\",\"method\":\"animate\"},{\"args\":[[\"18\"],{\"frame\":{\"duration\":0,\"redraw\":true},\"mode\":\"immediate\",\"transition\":{\"duration\":0}}],\"label\":\"0.90\",\"method\":\"animate\"},{\"args\":[[\"20\"],{\"frame\":{\"duration\":0,\"redraw\":true},\"mode\":\"immediate\",\"transition\":{\"duration\":0}}],\"label\":\"1.00\",\"method\":\"animate\"},{\"args\":[[\"22\"],{\"frame\":{\"duration\":0,\"redraw\":true},\"mode\":\"immediate\",\"transition\":{\"duration\":0}}],\"label\":\"1.10\",\"method\":\"animate\"},{\"args\":[[\"24\"],{\"frame\":{\"duration\":0,\"redraw\":true},\"mode\":\"immediate\",\"transition\":{\"duration\":0}}],\"label\":\"1.20\",\"method\":\"animate\"},{\"args\":[[\"26\"],{\"frame\":{\"duration\":0,\"redraw\":true},\"mode\":\"immediate\",\"transition\":{\"duration\":0}}],\"label\":\"1.30\",\"method\":\"animate\"},{\"args\":[[\"28\"],{\"frame\":{\"duration\":0,\"redraw\":true},\"mode\":\"immediate\",\"transition\":{\"duration\":0}}],\"label\":\"1.40\",\"method\":\"animate\"},{\"args\":[[\"30\"],{\"frame\":{\"duration\":0,\"redraw\":true},\"mode\":\"immediate\",\"transition\":{\"duration\":0}}],\"label\":\"1.50\",\"method\":\"animate\"},{\"args\":[[\"32\"],{\"frame\":{\"duration\":0,\"redraw\":true},\"mode\":\"immediate\",\"transition\":{\"duration\":0}}],\"label\":\"1.60\",\"method\":\"animate\"},{\"args\":[[\"34\"],{\"frame\":{\"duration\":0,\"redraw\":true},\"mode\":\"immediate\",\"transition\":{\"duration\":0}}],\"label\":\"1.70\",\"method\":\"animate\"},{\"args\":[[\"36\"],{\"frame\":{\"duration\":0,\"redraw\":true},\"mode\":\"immediate\",\"transition\":{\"duration\":0}}],\"label\":\"1.80\",\"method\":\"animate\"},{\"args\":[[\"38\"],{\"frame\":{\"duration\":0,\"redraw\":true},\"mode\":\"immediate\",\"transition\":{\"duration\":0}}],\"label\":\"1.90\",\"method\":\"animate\"},{\"args\":[[\"40\"],{\"frame\":{\"duration\":0,\"redraw\":true},\"mode\":\"immediate\",\"transition\":{\"duration\":0}}],\"label\":\"2.00\",\"method\":\"animate\"},{\"args\":[[\"42\"],{\"frame\":{\"duration\":0,\"redraw\":true},\"mode\":\"immediate\",\"transition\":{\"duration\":0}}],\"label\":\"2.10\",\"method\":\"animate\"},{\"args\":[[\"44\"],{\"frame\":{\"duration\":0,\"redraw\":true},\"mode\":\"immediate\",\"transition\":{\"duration\":0}}],\"label\":\"2.20\",\"method\":\"animate\"},{\"args\":[[\"46\"],{\"frame\":{\"duration\":0,\"redraw\":true},\"mode\":\"immediate\",\"transition\":{\"duration\":0}}],\"label\":\"2.30\",\"method\":\"animate\"},{\"args\":[[\"48\"],{\"frame\":{\"duration\":0,\"redraw\":true},\"mode\":\"immediate\",\"transition\":{\"duration\":0}}],\"label\":\"2.40\",\"method\":\"animate\"},{\"args\":[[\"50\"],{\"frame\":{\"duration\":0,\"redraw\":true},\"mode\":\"immediate\",\"transition\":{\"duration\":0}}],\"label\":\"2.50\",\"method\":\"animate\"},{\"args\":[[\"52\"],{\"frame\":{\"duration\":0,\"redraw\":true},\"mode\":\"immediate\",\"transition\":{\"duration\":0}}],\"label\":\"2.60\",\"method\":\"animate\"},{\"args\":[[\"54\"],{\"frame\":{\"duration\":0,\"redraw\":true},\"mode\":\"immediate\",\"transition\":{\"duration\":0}}],\"label\":\"2.70\",\"method\":\"animate\"},{\"args\":[[\"56\"],{\"frame\":{\"duration\":0,\"redraw\":true},\"mode\":\"immediate\",\"transition\":{\"duration\":0}}],\"label\":\"2.80\",\"method\":\"animate\"},{\"args\":[[\"58\"],{\"frame\":{\"duration\":0,\"redraw\":true},\"mode\":\"immediate\",\"transition\":{\"duration\":0}}],\"label\":\"2.90\",\"method\":\"animate\"},{\"args\":[[\"60\"],{\"frame\":{\"duration\":0,\"redraw\":true},\"mode\":\"immediate\",\"transition\":{\"duration\":0}}],\"label\":\"3.00\",\"method\":\"animate\"}],\"x\":0.1,\"xanchor\":\"left\",\"y\":0,\"yanchor\":\"top\"}],\"title\":{\"text\":\"Cart-Pole (Shooting)\"},\"updatemenus\":[{\"buttons\":[{\"args\":[null,{\"frame\":{\"duration\":50,\"redraw\":true},\"fromcurrent\":true,\"transition\":{\"duration\":0}}],\"label\":\"Play\",\"method\":\"animate\"},{\"args\":[[null],{\"frame\":{\"duration\":0,\"redraw\":false},\"mode\":\"immediate\"}],\"label\":\"Pause\",\"method\":\"animate\"}],\"showactive\":false,\"type\":\"buttons\",\"x\":0.5,\"xanchor\":\"center\",\"y\":1.15}],\"xaxis\":{\"constrain\":\"domain\",\"range\":[-2.5,2.5],\"showgrid\":false,\"title\":{\"text\":\"x (m)\"}},\"yaxis\":{\"range\":[-0.1,2.5],\"scaleanchor\":\"x\",\"scaleratio\":1,\"showgrid\":false,\"title\":{\"text\":\"y (m)\"}},\"template\":{\"data\":{\"histogram2dcontour\":[{\"type\":\"histogram2dcontour\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"choropleth\":[{\"type\":\"choropleth\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}],\"histogram2d\":[{\"type\":\"histogram2d\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"heatmap\":[{\"type\":\"heatmap\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"contourcarpet\":[{\"type\":\"contourcarpet\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}],\"contour\":[{\"type\":\"contour\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"surface\":[{\"type\":\"surface\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"mesh3d\":[{\"type\":\"mesh3d\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}],\"scatter\":[{\"fillpattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2},\"type\":\"scatter\"}],\"parcoords\":[{\"type\":\"parcoords\",\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scatterpolargl\":[{\"type\":\"scatterpolargl\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"bar\":[{\"error_x\":{\"color\":\"#2a3f5f\"},\"error_y\":{\"color\":\"#2a3f5f\"},\"marker\":{\"line\":{\"color\":\"#E5ECF6\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"bar\"}],\"scattergeo\":[{\"type\":\"scattergeo\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scatterpolar\":[{\"type\":\"scatterpolar\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"histogram\":[{\"marker\":{\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"histogram\"}],\"scattergl\":[{\"type\":\"scattergl\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scatter3d\":[{\"type\":\"scatter3d\",\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scattermap\":[{\"type\":\"scattermap\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scattermapbox\":[{\"type\":\"scattermapbox\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scatterternary\":[{\"type\":\"scatterternary\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scattercarpet\":[{\"type\":\"scattercarpet\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"carpet\":[{\"aaxis\":{\"endlinecolor\":\"#2a3f5f\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"minorgridcolor\":\"white\",\"startlinecolor\":\"#2a3f5f\"},\"baxis\":{\"endlinecolor\":\"#2a3f5f\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"minorgridcolor\":\"white\",\"startlinecolor\":\"#2a3f5f\"},\"type\":\"carpet\"}],\"table\":[{\"cells\":{\"fill\":{\"color\":\"#EBF0F8\"},\"line\":{\"color\":\"white\"}},\"header\":{\"fill\":{\"color\":\"#C8D4E3\"},\"line\":{\"color\":\"white\"}},\"type\":\"table\"}],\"barpolar\":[{\"marker\":{\"line\":{\"color\":\"#E5ECF6\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"barpolar\"}],\"pie\":[{\"automargin\":true,\"type\":\"pie\"}]},\"layout\":{\"autotypenumbers\":\"strict\",\"colorway\":[\"#636efa\",\"#EF553B\",\"#00cc96\",\"#ab63fa\",\"#FFA15A\",\"#19d3f3\",\"#FF6692\",\"#B6E880\",\"#FF97FF\",\"#FECB52\"],\"font\":{\"color\":\"#2a3f5f\"},\"hovermode\":\"closest\",\"hoverlabel\":{\"align\":\"left\"},\"paper_bgcolor\":\"white\",\"plot_bgcolor\":\"#E5ECF6\",\"polar\":{\"bgcolor\":\"#E5ECF6\",\"angularaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"},\"radialaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"}},\"ternary\":{\"bgcolor\":\"#E5ECF6\",\"aaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"},\"baxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"},\"caxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"}},\"coloraxis\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"colorscale\":{\"sequential\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"sequentialminus\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"diverging\":[[0,\"#8e0152\"],[0.1,\"#c51b7d\"],[0.2,\"#de77ae\"],[0.3,\"#f1b6da\"],[0.4,\"#fde0ef\"],[0.5,\"#f7f7f7\"],[0.6,\"#e6f5d0\"],[0.7,\"#b8e186\"],[0.8,\"#7fbc41\"],[0.9,\"#4d9221\"],[1,\"#276419\"]]},\"xaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"white\",\"automargin\":true,\"zerolinewidth\":2},\"yaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"white\",\"automargin\":true,\"zerolinewidth\":2},\"scene\":{\"xaxis\":{\"backgroundcolor\":\"#E5ECF6\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"white\",\"gridwidth\":2},\"yaxis\":{\"backgroundcolor\":\"#E5ECF6\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"white\",\"gridwidth\":2},\"zaxis\":{\"backgroundcolor\":\"#E5ECF6\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"white\",\"gridwidth\":2}},\"shapedefaults\":{\"line\":{\"color\":\"#2a3f5f\"}},\"annotationdefaults\":{\"arrowcolor\":\"#2a3f5f\",\"arrowhead\":0,\"arrowwidth\":1},\"geo\":{\"bgcolor\":\"white\",\"landcolor\":\"#E5ECF6\",\"subunitcolor\":\"white\",\"showland\":true,\"showlakes\":true,\"lakecolor\":\"white\"},\"title\":{\"x\":0.05},\"mapbox\":{\"style\":\"light\"}}}},                        {\"responsive\": true}                    ).then(function(){\n",
       "                            Plotly.addFrames('062fc545-8a8f-4dd8-bf8a-d0986ecc09e3', [{\"data\":[{\"fill\":\"toself\",\"fillcolor\":\"steelblue\",\"line\":{\"color\":\"darkblue\",\"width\":2},\"x\":[-0.2,0.2,0.2,-0.2,-0.2],\"y\":[1.125,1.125,1.275,1.275,1.125],\"type\":\"scatter\"},{\"line\":{\"color\":\"sienna\",\"width\":8},\"mode\":\"lines\",\"x\":[0.0,0.0],\"y\":[1.2,0.20000004768371582],\"type\":\"scatter\"},{\"marker\":{\"color\":\"sienna\",\"line\":{\"color\":\"black\",\"width\":1},\"size\":18},\"mode\":\"markers\",\"x\":[0.0],\"y\":[0.20000004768371582],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-0.13333333333333333],\"y\":[1.075],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[0.13333333333333333],\"y\":[1.075],\"type\":\"scatter\"}],\"name\":\"0\"},{\"data\":[{\"fill\":\"toself\",\"fillcolor\":\"steelblue\",\"line\":{\"color\":\"darkblue\",\"width\":2},\"x\":[-0.2459442473948002,0.15405575260519982,0.15405575260519982,-0.2459442473948002,-0.2459442473948002],\"y\":[1.125,1.125,1.275,1.275,1.125],\"type\":\"scatter\"},{\"line\":{\"color\":\"sienna\",\"width\":8},\"mode\":\"lines\",\"x\":[-0.045944247394800186,0.022038016468286514],\"y\":[1.2,0.20231354236602783],\"type\":\"scatter\"},{\"marker\":{\"color\":\"sienna\",\"line\":{\"color\":\"black\",\"width\":1},\"size\":18},\"mode\":\"markers\",\"x\":[0.022038016468286514],\"y\":[0.20231354236602783],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-0.17927758072813352],\"y\":[1.075],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[0.08738908593853315],\"y\":[1.075],\"type\":\"scatter\"}],\"name\":\"2\"},{\"data\":[{\"fill\":\"toself\",\"fillcolor\":\"steelblue\",\"line\":{\"color\":\"darkblue\",\"width\":2},\"x\":[-0.36148026287555696,0.038519737124443065,0.038519737124443065,-0.36148026287555696,-0.36148026287555696],\"y\":[1.125,1.125,1.275,1.275,1.125],\"type\":\"scatter\"},{\"line\":{\"color\":\"sienna\",\"width\":8},\"mode\":\"lines\",\"x\":[-0.16148026287555695,0.065505251288414],\"y\":[1.2,0.22610193490982056],\"type\":\"scatter\"},{\"marker\":{\"color\":\"sienna\",\"line\":{\"color\":\"black\",\"width\":1},\"size\":18},\"mode\":\"markers\",\"x\":[0.065505251288414],\"y\":[0.22610193490982056],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-0.29481359620889025],\"y\":[1.075],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-0.028146929542223614],\"y\":[1.075],\"type\":\"scatter\"}],\"name\":\"4\"},{\"data\":[{\"fill\":\"toself\",\"fillcolor\":\"steelblue\",\"line\":{\"color\":\"darkblue\",\"width\":2},\"x\":[-0.510467928647995,-0.11046792864799498,-0.11046792864799498,-0.510467928647995,-0.510467928647995],\"y\":[1.125,1.125,1.275,1.275,1.125],\"type\":\"scatter\"},{\"line\":{\"color\":\"sienna\",\"width\":8},\"mode\":\"lines\",\"x\":[-0.310467928647995,0.08401942253112793],\"y\":[1.2,0.2810986638069153],\"type\":\"scatter\"},{\"marker\":{\"color\":\"sienna\",\"line\":{\"color\":\"black\",\"width\":1},\"size\":18},\"mode\":\"markers\",\"x\":[0.08401942253112793],\"y\":[0.2810986638069153],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-0.4438012619813283],\"y\":[1.075],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-0.17713459531466166],\"y\":[1.075],\"type\":\"scatter\"}],\"name\":\"6\"},{\"data\":[{\"fill\":\"toself\",\"fillcolor\":\"steelblue\",\"line\":{\"color\":\"darkblue\",\"width\":2},\"x\":[-0.662377905845642,-0.2623779058456421,-0.2623779058456421,-0.662377905845642,-0.662377905845642],\"y\":[1.125,1.125,1.275,1.275,1.125],\"type\":\"scatter\"},{\"line\":{\"color\":\"sienna\",\"width\":8},\"mode\":\"lines\",\"x\":[-0.4623779058456421,0.04240548610687256],\"y\":[1.2,0.3367540240287781],\"type\":\"scatter\"},{\"marker\":{\"color\":\"sienna\",\"line\":{\"color\":\"black\",\"width\":1},\"size\":18},\"mode\":\"markers\",\"x\":[0.04240548610687256],\"y\":[0.3367540240287781],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-0.5957112391789754],\"y\":[1.075],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-0.3290445725123088],\"y\":[1.075],\"type\":\"scatter\"}],\"name\":\"8\"},{\"data\":[{\"fill\":\"toself\",\"fillcolor\":\"steelblue\",\"line\":{\"color\":\"darkblue\",\"width\":2},\"x\":[-0.795810055732727,-0.39581005573272704,-0.39581005573272704,-0.795810055732727,-0.795810055732727],\"y\":[1.125,1.125,1.275,1.275,1.125],\"type\":\"scatter\"},{\"line\":{\"color\":\"sienna\",\"width\":8},\"mode\":\"lines\",\"x\":[-0.595810055732727,-0.06827086210250854],\"y\":[1.2,0.35046935081481934],\"type\":\"scatter\"},{\"marker\":{\"color\":\"sienna\",\"line\":{\"color\":\"black\",\"width\":1},\"size\":18},\"mode\":\"markers\",\"x\":[-0.06827086210250854],\"y\":[0.35046935081481934],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-0.7291433890660604],\"y\":[1.075],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-0.46247672239939375],\"y\":[1.075],\"type\":\"scatter\"}],\"name\":\"10\"},{\"data\":[{\"fill\":\"toself\",\"fillcolor\":\"steelblue\",\"line\":{\"color\":\"darkblue\",\"width\":2},\"x\":[-0.8945541501045227,-0.4945541501045227,-0.4945541501045227,-0.8945541501045227,-0.8945541501045227],\"y\":[1.125,1.125,1.275,1.275,1.125],\"type\":\"scatter\"},{\"line\":{\"color\":\"sienna\",\"width\":8},\"mode\":\"lines\",\"x\":[-0.6945541501045227,-0.2493584156036377],\"y\":[1.2,0.30456680059432983],\"type\":\"scatter\"},{\"marker\":{\"color\":\"sienna\",\"line\":{\"color\":\"black\",\"width\":1},\"size\":18},\"mode\":\"markers\",\"x\":[-0.2493584156036377],\"y\":[0.30456680059432983],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-0.827887483437856],\"y\":[1.075],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-0.5612208167711894],\"y\":[1.075],\"type\":\"scatter\"}],\"name\":\"12\"},{\"data\":[{\"fill\":\"toself\",\"fillcolor\":\"steelblue\",\"line\":{\"color\":\"darkblue\",\"width\":2},\"x\":[-0.9435895204544067,-0.5435895204544068,-0.5435895204544068,-0.9435895204544067,-0.9435895204544067],\"y\":[1.125,1.125,1.275,1.275,1.125],\"type\":\"scatter\"},{\"line\":{\"color\":\"sienna\",\"width\":8},\"mode\":\"lines\",\"x\":[-0.7435895204544067,-0.5098243355751038],\"y\":[1.2,0.22770696878433228],\"type\":\"scatter\"},{\"marker\":{\"color\":\"sienna\",\"line\":{\"color\":\"black\",\"width\":1},\"size\":18},\"mode\":\"markers\",\"x\":[-0.5098243355751038],\"y\":[0.22770696878433228],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-0.87692285378774],\"y\":[1.075],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-0.6102561871210734],\"y\":[1.075],\"type\":\"scatter\"}],\"name\":\"14\"},{\"data\":[{\"fill\":\"toself\",\"fillcolor\":\"steelblue\",\"line\":{\"color\":\"darkblue\",\"width\":2},\"x\":[-0.9325528860092163,-0.5325528860092164,-0.5325528860092164,-0.9325528860092163,-0.9325528860092163],\"y\":[1.125,1.125,1.275,1.275,1.125],\"type\":\"scatter\"},{\"line\":{\"color\":\"sienna\",\"width\":8},\"mode\":\"lines\",\"x\":[-0.7325528860092163,-0.8418372273445129],\"y\":[1.2,0.2059895396232605],\"type\":\"scatter\"},{\"marker\":{\"color\":\"sienna\",\"line\":{\"color\":\"black\",\"width\":1},\"size\":18},\"mode\":\"markers\",\"x\":[-0.8418372273445129],\"y\":[0.2059895396232605],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-0.8658862193425496],\"y\":[1.075],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-0.599219552675883],\"y\":[1.075],\"type\":\"scatter\"}],\"name\":\"16\"},{\"data\":[{\"fill\":\"toself\",\"fillcolor\":\"steelblue\",\"line\":{\"color\":\"darkblue\",\"width\":2},\"x\":[-0.8674538850784301,-0.46745388507843016,-0.46745388507843016,-0.8674538850784301,-0.8674538850784301],\"y\":[1.125,1.125,1.275,1.275,1.125],\"type\":\"scatter\"},{\"line\":{\"color\":\"sienna\",\"width\":8},\"mode\":\"lines\",\"x\":[-0.6674538850784302,-1.1626886129379272],\"y\":[1.2,0.33124083280563354],\"type\":\"scatter\"},{\"marker\":{\"color\":\"sienna\",\"line\":{\"color\":\"black\",\"width\":1},\"size\":18},\"mode\":\"markers\",\"x\":[-1.1626886129379272],\"y\":[0.33124083280563354],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-0.8007872184117635],\"y\":[1.075],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-0.5341205517450969],\"y\":[1.075],\"type\":\"scatter\"}],\"name\":\"18\"},{\"data\":[{\"fill\":\"toself\",\"fillcolor\":\"steelblue\",\"line\":{\"color\":\"darkblue\",\"width\":2},\"x\":[-0.7728514194488525,-0.37285141944885253,-0.37285141944885253,-0.7728514194488525,-0.7728514194488525],\"y\":[1.125,1.125,1.275,1.275,1.125],\"type\":\"scatter\"},{\"line\":{\"color\":\"sienna\",\"width\":8},\"mode\":\"lines\",\"x\":[-0.5728514194488525,-1.352776050567627],\"y\":[1.2,0.5741266012191772],\"type\":\"scatter\"},{\"marker\":{\"color\":\"sienna\",\"line\":{\"color\":\"black\",\"width\":1},\"size\":18},\"mode\":\"markers\",\"x\":[-1.352776050567627],\"y\":[0.5741266012191772],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-0.7061847527821858],\"y\":[1.075],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-0.43951808611551924],\"y\":[1.075],\"type\":\"scatter\"}],\"name\":\"20\"},{\"data\":[{\"fill\":\"toself\",\"fillcolor\":\"steelblue\",\"line\":{\"color\":\"darkblue\",\"width\":2},\"x\":[-0.6722215831279754,-0.27222158312797545,-0.27222158312797545,-0.6722215831279754,-0.6722215831279754],\"y\":[1.125,1.125,1.275,1.275,1.125],\"type\":\"scatter\"},{\"line\":{\"color\":\"sienna\",\"width\":8},\"mode\":\"lines\",\"x\":[-0.47222158312797546,-1.3909169435501099],\"y\":[1.2,0.8050330877304077],\"type\":\"scatter\"},{\"marker\":{\"color\":\"sienna\",\"line\":{\"color\":\"black\",\"width\":1},\"size\":18},\"mode\":\"markers\",\"x\":[-1.3909169435501099],\"y\":[0.8050330877304077],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-0.6055549164613088],\"y\":[1.075],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-0.33888824979464216],\"y\":[1.075],\"type\":\"scatter\"}],\"name\":\"22\"},{\"data\":[{\"fill\":\"toself\",\"fillcolor\":\"steelblue\",\"line\":{\"color\":\"darkblue\",\"width\":2},\"x\":[-0.5733382225036621,-0.1733382225036621,-0.1733382225036621,-0.5733382225036621,-0.5733382225036621],\"y\":[1.125,1.125,1.275,1.275,1.125],\"type\":\"scatter\"},{\"line\":{\"color\":\"sienna\",\"width\":8},\"mode\":\"lines\",\"x\":[-0.3733382225036621,-1.336872935295105],\"y\":[1.2,0.9324167370796204],\"type\":\"scatter\"},{\"marker\":{\"color\":\"sienna\",\"line\":{\"color\":\"black\",\"width\":1},\"size\":18},\"mode\":\"markers\",\"x\":[-1.336872935295105],\"y\":[0.9324167370796204],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-0.5066715558369954],\"y\":[1.075],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-0.24000488917032878],\"y\":[1.075],\"type\":\"scatter\"}],\"name\":\"24\"},{\"data\":[{\"fill\":\"toself\",\"fillcolor\":\"steelblue\",\"line\":{\"color\":\"darkblue\",\"width\":2},\"x\":[-0.4732680141925812,-0.07326801419258117,-0.07326801419258117,-0.4732680141925812,-0.4732680141925812],\"y\":[1.125,1.125,1.275,1.275,1.125],\"type\":\"scatter\"},{\"line\":{\"color\":\"sienna\",\"width\":8},\"mode\":\"lines\",\"x\":[-0.2732680141925812,-1.2352681159973145],\"y\":[1.2,0.9269511103630066],\"type\":\"scatter\"},{\"marker\":{\"color\":\"sienna\",\"line\":{\"color\":\"black\",\"width\":1},\"size\":18},\"mode\":\"markers\",\"x\":[-1.2352681159973145],\"y\":[0.9269511103630066],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-0.4066013475259145],\"y\":[1.075],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-0.13993468085924785],\"y\":[1.075],\"type\":\"scatter\"}],\"name\":\"26\"},{\"data\":[{\"fill\":\"toself\",\"fillcolor\":\"steelblue\",\"line\":{\"color\":\"darkblue\",\"width\":2},\"x\":[-0.37061573266983033,0.02938426733016969,0.02938426733016969,-0.37061573266983033,-0.37061573266983033],\"y\":[1.125,1.125,1.275,1.275,1.125],\"type\":\"scatter\"},{\"line\":{\"color\":\"sienna\",\"width\":8},\"mode\":\"lines\",\"x\":[-0.17061573266983032,-1.082798719406128],\"y\":[1.2,0.7902167439460754],\"type\":\"scatter\"},{\"marker\":{\"color\":\"sienna\",\"line\":{\"color\":\"black\",\"width\":1},\"size\":18},\"mode\":\"markers\",\"x\":[-1.082798719406128],\"y\":[0.7902167439460754],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-0.3039490660031636],\"y\":[1.075],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-0.03728239933649699],\"y\":[1.075],\"type\":\"scatter\"}],\"name\":\"28\"},{\"data\":[{\"fill\":\"toself\",\"fillcolor\":\"steelblue\",\"line\":{\"color\":\"darkblue\",\"width\":2},\"x\":[-0.27640088349580766,0.12359911650419236,0.12359911650419236,-0.27640088349580766,-0.27640088349580766],\"y\":[1.125,1.125,1.275,1.275,1.125],\"type\":\"scatter\"},{\"line\":{\"color\":\"sienna\",\"width\":8},\"mode\":\"lines\",\"x\":[-0.07640088349580765,-0.8366221189498901],\"y\":[1.2,0.5503357648849487],\"type\":\"scatter\"},{\"marker\":{\"color\":\"sienna\",\"line\":{\"color\":\"black\",\"width\":1},\"size\":18},\"mode\":\"markers\",\"x\":[-0.8366221189498901],\"y\":[0.5503357648849487],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-0.20973421682914098],\"y\":[1.075],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[0.056932449837525684],\"y\":[1.075],\"type\":\"scatter\"}],\"name\":\"30\"},{\"data\":[{\"fill\":\"toself\",\"fillcolor\":\"steelblue\",\"line\":{\"color\":\"darkblue\",\"width\":2},\"x\":[-0.2188813451677561,0.18111865483224393,0.18111865483224393,-0.2188813451677561,-0.2188813451677561],\"y\":[1.125,1.125,1.275,1.275,1.125],\"type\":\"scatter\"},{\"line\":{\"color\":\"sienna\",\"width\":8},\"mode\":\"lines\",\"x\":[-0.01888134516775608,-0.43663597106933594],\"y\":[1.2,0.29144012928009033],\"type\":\"scatter\"},{\"marker\":{\"color\":\"sienna\",\"line\":{\"color\":\"black\",\"width\":1},\"size\":18},\"mode\":\"markers\",\"x\":[-0.43663597106933594],\"y\":[0.29144012928009033],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-0.1522146785010894],\"y\":[1.075],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[0.11445198816557725],\"y\":[1.075],\"type\":\"scatter\"}],\"name\":\"32\"},{\"data\":[{\"fill\":\"toself\",\"fillcolor\":\"steelblue\",\"line\":{\"color\":\"darkblue\",\"width\":2},\"x\":[-0.23321215137839318,0.16678784862160684,0.16678784862160684,-0.23321215137839318,-0.23321215137839318],\"y\":[1.125,1.125,1.275,1.275,1.125],\"type\":\"scatter\"},{\"line\":{\"color\":\"sienna\",\"width\":8},\"mode\":\"lines\",\"x\":[-0.03321215137839317,0.12412689626216888],\"y\":[1.2,0.2124553918838501],\"type\":\"scatter\"},{\"marker\":{\"color\":\"sienna\",\"line\":{\"color\":\"black\",\"width\":1},\"size\":18},\"mode\":\"markers\",\"x\":[0.12412689626216888],\"y\":[0.2124553918838501],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-0.1665454847117265],\"y\":[1.075],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[0.10012118195494016],\"y\":[1.075],\"type\":\"scatter\"}],\"name\":\"34\"},{\"data\":[{\"fill\":\"toself\",\"fillcolor\":\"steelblue\",\"line\":{\"color\":\"darkblue\",\"width\":2},\"x\":[-0.32269795686006547,0.07730204313993455,0.07730204313993455,-0.32269795686006547,-0.32269795686006547],\"y\":[1.125,1.125,1.275,1.275,1.125],\"type\":\"scatter\"},{\"line\":{\"color\":\"sienna\",\"width\":8},\"mode\":\"lines\",\"x\":[-0.12269795686006546,0.6166648864746094],\"y\":[1.2,0.526692807674408],\"type\":\"scatter\"},{\"marker\":{\"color\":\"sienna\",\"line\":{\"color\":\"black\",\"width\":1},\"size\":18},\"mode\":\"markers\",\"x\":[0.6166648864746094],\"y\":[0.526692807674408],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-0.25603129019339876],\"y\":[1.075],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[0.010635376473267871],\"y\":[1.075],\"type\":\"scatter\"}],\"name\":\"36\"},{\"data\":[{\"fill\":\"toself\",\"fillcolor\":\"steelblue\",\"line\":{\"color\":\"darkblue\",\"width\":2},\"x\":[-0.43417313396930696,-0.034173133969306935,-0.034173133969306935,-0.43417313396930696,-0.43417313396930696],\"y\":[1.125,1.125,1.275,1.275,1.125],\"type\":\"scatter\"},{\"line\":{\"color\":\"sienna\",\"width\":8},\"mode\":\"lines\",\"x\":[-0.23417313396930695,0.7561450004577637],\"y\":[1.2,1.0611835718154907],\"type\":\"scatter\"},{\"marker\":{\"color\":\"sienna\",\"line\":{\"color\":\"black\",\"width\":1},\"size\":18},\"mode\":\"markers\",\"x\":[0.7561450004577637],\"y\":[1.0611835718154907],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-0.36750646730264025],\"y\":[1.075],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-0.10083980063597361],\"y\":[1.075],\"type\":\"scatter\"}],\"name\":\"38\"},{\"data\":[{\"fill\":\"toself\",\"fillcolor\":\"steelblue\",\"line\":{\"color\":\"darkblue\",\"width\":2},\"x\":[-0.5069024384021759,-0.10690243840217589,-0.10690243840217589,-0.5069024384021759,-0.5069024384021759],\"y\":[1.125,1.125,1.275,1.275,1.125],\"type\":\"scatter\"},{\"line\":{\"color\":\"sienna\",\"width\":8},\"mode\":\"lines\",\"x\":[-0.3069024384021759,0.6437464952468872],\"y\":[1.2,1.5102686882019043],\"type\":\"scatter\"},{\"marker\":{\"color\":\"sienna\",\"line\":{\"color\":\"black\",\"width\":1},\"size\":18},\"mode\":\"markers\",\"x\":[0.6437464952468872],\"y\":[1.5102686882019043],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-0.4402357717355092],\"y\":[1.075],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-0.17356910506884257],\"y\":[1.075],\"type\":\"scatter\"}],\"name\":\"40\"},{\"data\":[{\"fill\":\"toself\",\"fillcolor\":\"steelblue\",\"line\":{\"color\":\"darkblue\",\"width\":2},\"x\":[-0.5123370110988616,-0.11233701109886168,-0.11233701109886168,-0.5123370110988616,-0.5123370110988616],\"y\":[1.125,1.125,1.275,1.275,1.125],\"type\":\"scatter\"},{\"line\":{\"color\":\"sienna\",\"width\":8},\"mode\":\"lines\",\"x\":[-0.3123370110988617,0.4758375585079193],\"y\":[1.2,1.8154518604278564],\"type\":\"scatter\"},{\"marker\":{\"color\":\"sienna\",\"line\":{\"color\":\"black\",\"width\":1},\"size\":18},\"mode\":\"markers\",\"x\":[0.4758375585079193],\"y\":[1.8154518604278564],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-0.445670344432195],\"y\":[1.075],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-0.17900367776552836],\"y\":[1.075],\"type\":\"scatter\"}],\"name\":\"42\"},{\"data\":[{\"fill\":\"toself\",\"fillcolor\":\"steelblue\",\"line\":{\"color\":\"darkblue\",\"width\":2},\"x\":[-0.45208407640457154,-0.05208407640457152,-0.05208407640457152,-0.45208407640457154,-0.45208407640457154],\"y\":[1.125,1.125,1.275,1.275,1.125],\"type\":\"scatter\"},{\"line\":{\"color\":\"sienna\",\"width\":8},\"mode\":\"lines\",\"x\":[-0.25208407640457153,0.3263320326805115],\"y\":[1.2,2.0157418251037598],\"type\":\"scatter\"},{\"marker\":{\"color\":\"sienna\",\"line\":{\"color\":\"black\",\"width\":1},\"size\":18},\"mode\":\"markers\",\"x\":[0.3263320326805115],\"y\":[2.0157418251037598],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-0.38541740973790484],\"y\":[1.075],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-0.1187507430712382],\"y\":[1.075],\"type\":\"scatter\"}],\"name\":\"44\"},{\"data\":[{\"fill\":\"toself\",\"fillcolor\":\"steelblue\",\"line\":{\"color\":\"darkblue\",\"width\":2},\"x\":[-0.34875036478042604,0.051249635219573986,0.051249635219573986,-0.34875036478042604,-0.34875036478042604],\"y\":[1.125,1.125,1.275,1.275,1.125],\"type\":\"scatter\"},{\"line\":{\"color\":\"sienna\",\"width\":8},\"mode\":\"lines\",\"x\":[-0.14875036478042603,0.20313072204589844],\"y\":[1.2,2.13604474067688],\"type\":\"scatter\"},{\"marker\":{\"color\":\"sienna\",\"line\":{\"color\":\"black\",\"width\":1},\"size\":18},\"mode\":\"markers\",\"x\":[0.20313072204589844],\"y\":[2.13604474067688],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-0.28208369811375933],\"y\":[1.075],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-0.015417031447092694],\"y\":[1.075],\"type\":\"scatter\"}],\"name\":\"46\"},{\"data\":[{\"fill\":\"toself\",\"fillcolor\":\"steelblue\",\"line\":{\"color\":\"darkblue\",\"width\":2},\"x\":[-0.2421668738126755,0.15783312618732454,0.15783312618732454,-0.2421668738126755,-0.2421668738126755],\"y\":[1.125,1.125,1.275,1.275,1.125],\"type\":\"scatter\"},{\"line\":{\"color\":\"sienna\",\"width\":8},\"mode\":\"lines\",\"x\":[-0.042166873812675476,0.10816772282123566],\"y\":[1.2,2.1886353492736816],\"type\":\"scatter\"},{\"marker\":{\"color\":\"sienna\",\"line\":{\"color\":\"black\",\"width\":1},\"size\":18},\"mode\":\"markers\",\"x\":[0.10816772282123566],\"y\":[2.1886353492736816],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-0.1755002071460088],\"y\":[1.075],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[0.09116645952065786],\"y\":[1.075],\"type\":\"scatter\"}],\"name\":\"48\"},{\"data\":[{\"fill\":\"toself\",\"fillcolor\":\"steelblue\",\"line\":{\"color\":\"darkblue\",\"width\":2},\"x\":[-0.18769951332360507,0.21230048667639495,0.21230048667639495,-0.18769951332360507,-0.18769951332360507],\"y\":[1.125,1.125,1.275,1.275,1.125],\"type\":\"scatter\"},{\"line\":{\"color\":\"sienna\",\"width\":8},\"mode\":\"lines\",\"x\":[0.01230048667639494,0.05521734058856964],\"y\":[1.2,2.1990785598754883],\"type\":\"scatter\"},{\"marker\":{\"color\":\"sienna\",\"line\":{\"color\":\"black\",\"width\":1},\"size\":18},\"mode\":\"markers\",\"x\":[0.05521734058856964],\"y\":[2.1990785598754883],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-0.12103284665693839],\"y\":[1.075],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[0.14563382000972827],\"y\":[1.075],\"type\":\"scatter\"}],\"name\":\"50\"},{\"data\":[{\"fill\":\"toself\",\"fillcolor\":\"steelblue\",\"line\":{\"color\":\"darkblue\",\"width\":2},\"x\":[-0.18781867790967227,0.21218132209032775,0.21218132209032775,-0.18781867790967227,-0.18781867790967227],\"y\":[1.125,1.125,1.275,1.275,1.125],\"type\":\"scatter\"},{\"line\":{\"color\":\"sienna\",\"width\":8},\"mode\":\"lines\",\"x\":[0.01218132209032774,0.036329735070466995],\"y\":[1.2,2.1997084617614746],\"type\":\"scatter\"},{\"marker\":{\"color\":\"sienna\",\"line\":{\"color\":\"black\",\"width\":1},\"size\":18},\"mode\":\"markers\",\"x\":[0.036329735070466995],\"y\":[2.1997084617614746],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-0.12115201124300559],\"y\":[1.075],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[0.14551465542366107],\"y\":[1.075],\"type\":\"scatter\"}],\"name\":\"52\"},{\"data\":[{\"fill\":\"toself\",\"fillcolor\":\"steelblue\",\"line\":{\"color\":\"darkblue\",\"width\":2},\"x\":[-0.19186988919973375,0.20813011080026628,0.20813011080026628,-0.19186988919973375,-0.19186988919973375],\"y\":[1.125,1.125,1.275,1.275,1.125],\"type\":\"scatter\"},{\"line\":{\"color\":\"sienna\",\"width\":8},\"mode\":\"lines\",\"x\":[0.008130110800266266,0.023039691150188446],\"y\":[1.2,2.1998889446258545],\"type\":\"scatter\"},{\"marker\":{\"color\":\"sienna\",\"line\":{\"color\":\"black\",\"width\":1},\"size\":18},\"mode\":\"markers\",\"x\":[0.023039691150188446],\"y\":[2.1998889446258545],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-0.12520322253306707],\"y\":[1.075],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[0.1414634441335996],\"y\":[1.075],\"type\":\"scatter\"}],\"name\":\"54\"},{\"data\":[{\"fill\":\"toself\",\"fillcolor\":\"steelblue\",\"line\":{\"color\":\"darkblue\",\"width\":2},\"x\":[-0.19568107631057502,0.204318923689425,0.204318923689425,-0.19568107631057502,-0.19568107631057502],\"y\":[1.125,1.125,1.275,1.275,1.125],\"type\":\"scatter\"},{\"line\":{\"color\":\"sienna\",\"width\":8},\"mode\":\"lines\",\"x\":[0.004318923689424992,0.011843494139611721],\"y\":[1.2,2.1999716758728027],\"type\":\"scatter\"},{\"marker\":{\"color\":\"sienna\",\"line\":{\"color\":\"black\",\"width\":1},\"size\":18},\"mode\":\"markers\",\"x\":[0.011843494139611721],\"y\":[2.1999716758728027],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-0.12901440964390834],\"y\":[1.075],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[0.13765225702275832],\"y\":[1.075],\"type\":\"scatter\"}],\"name\":\"56\"},{\"data\":[{\"fill\":\"toself\",\"fillcolor\":\"steelblue\",\"line\":{\"color\":\"darkblue\",\"width\":2},\"x\":[-0.19905698955990375,0.20094301044009627,0.20094301044009627,-0.19905698955990375,-0.19905698955990375],\"y\":[1.125,1.125,1.275,1.275,1.125],\"type\":\"scatter\"},{\"line\":{\"color\":\"sienna\",\"width\":8},\"mode\":\"lines\",\"x\":[0.0009430104400962591,0.0015420687850564718],\"y\":[1.2,2.1999998092651367],\"type\":\"scatter\"},{\"marker\":{\"color\":\"sienna\",\"line\":{\"color\":\"black\",\"width\":1},\"size\":18},\"mode\":\"markers\",\"x\":[0.0015420687850564718],\"y\":[2.1999998092651367],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-0.13239032289323707],\"y\":[1.075],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[0.1342763437734296],\"y\":[1.075],\"type\":\"scatter\"}],\"name\":\"58\"},{\"data\":[{\"fill\":\"toself\",\"fillcolor\":\"steelblue\",\"line\":{\"color\":\"darkblue\",\"width\":2},\"x\":[-0.2023045639973134,0.19769543600268663,0.19769543600268663,-0.2023045639973134,-0.2023045639973134],\"y\":[1.125,1.125,1.275,1.275,1.125],\"type\":\"scatter\"},{\"line\":{\"color\":\"sienna\",\"width\":8},\"mode\":\"lines\",\"x\":[-0.0023045639973133802,-0.008738809265196323],\"y\":[1.2,2.199979305267334],\"type\":\"scatter\"},{\"marker\":{\"color\":\"sienna\",\"line\":{\"color\":\"black\",\"width\":1},\"size\":18},\"mode\":\"markers\",\"x\":[-0.008738809265196323],\"y\":[2.199979305267334],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-0.1356378973306467],\"y\":[1.075],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[0.13102876933601995],\"y\":[1.075],\"type\":\"scatter\"}],\"name\":\"60\"}]);\n",
       "                        })                };            </script>        </div>"
      ],
      "text/plain": [
       "<IPython.core.display.HTML object>"
      ]
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "import plotly.graph_objects as go\n",
    "from plotly.subplots import make_subplots\n",
    "from IPython.display import HTML\n",
    "\n",
    "# Animation of cart-pole swing-up.\n",
    "cart_y_offset = 1.2  # Raise cart so pole can swing freely above ground.\n",
    "wheel_radius = 0.05\n",
    "\n",
    "\n",
    "def create_cart_pole_frame(x: float, theta: float) -> dict:\n",
    "    \"\"\"Create a single frame of cart-pole visualization.\n",
    "\n",
    "    Args:\n",
    "        x: Cart position.\n",
    "        theta: Pole angle (0 = down, pi = up).\n",
    "\n",
    "    Returns:\n",
    "        Dictionary with cart, pole, mass, and wheel coordinates.\n",
    "    \"\"\"\n",
    "    cart_width, cart_height = 0.4, 0.15\n",
    "    pole_len = 2 * length  # Full pole length.\n",
    "    pole_x = x + pole_len * jnp.sin(theta)\n",
    "    pole_y = cart_y_offset - pole_len * jnp.cos(theta)\n",
    "\n",
    "    # Wheel positions.\n",
    "    wheel_y = cart_y_offset - cart_height / 2 - wheel_radius\n",
    "\n",
    "    return dict(\n",
    "        cart_x=[\n",
    "            x - cart_width / 2,\n",
    "            x + cart_width / 2,\n",
    "            x + cart_width / 2,\n",
    "            x - cart_width / 2,\n",
    "            x - cart_width / 2,\n",
    "        ],\n",
    "        cart_y=[\n",
    "            cart_y_offset - cart_height / 2,\n",
    "            cart_y_offset - cart_height / 2,\n",
    "            cart_y_offset + cart_height / 2,\n",
    "            cart_y_offset + cart_height / 2,\n",
    "            cart_y_offset - cart_height / 2,\n",
    "        ],\n",
    "        pole_x=[x, float(pole_x)],\n",
    "        pole_y=[cart_y_offset, float(pole_y)],\n",
    "        mass_x=[float(pole_x)],\n",
    "        mass_y=[float(pole_y)],\n",
    "        wheel1_x=[x - cart_width / 3],\n",
    "        wheel1_y=[wheel_y],\n",
    "        wheel2_x=[x + cart_width / 3],\n",
    "        wheel2_y=[wheel_y],\n",
    "    )\n",
    "\n",
    "\n",
    "# Create animation frames (use every 2nd timestep for performance).\n",
    "frame_step = 2\n",
    "frame_indices = list(range(0, n_steps + 1, frame_step))\n",
    "frames = []\n",
    "for i in frame_indices:\n",
    "    frame_data = create_cart_pole_frame(\n",
    "        float(optimal_trajectory[i, 0]), float(optimal_trajectory[i, 1])\n",
    "    )\n",
    "    frames.append(\n",
    "        go.Frame(\n",
    "            data=[\n",
    "                go.Scatter(\n",
    "                    x=frame_data[\"cart_x\"],\n",
    "                    y=frame_data[\"cart_y\"],\n",
    "                    fill=\"toself\",\n",
    "                    fillcolor=\"steelblue\",\n",
    "                    line=dict(color=\"darkblue\", width=2),\n",
    "                ),\n",
    "                go.Scatter(\n",
    "                    x=frame_data[\"pole_x\"],\n",
    "                    y=frame_data[\"pole_y\"],\n",
    "                    mode=\"lines\",\n",
    "                    line=dict(color=\"sienna\", width=8),\n",
    "                ),\n",
    "                go.Scatter(\n",
    "                    x=frame_data[\"mass_x\"],\n",
    "                    y=frame_data[\"mass_y\"],\n",
    "                    mode=\"markers\",\n",
    "                    marker=dict(\n",
    "                        size=18, color=\"sienna\", line=dict(color=\"black\", width=1)\n",
    "                    ),\n",
    "                ),\n",
    "                go.Scatter(\n",
    "                    x=frame_data[\"wheel1_x\"],\n",
    "                    y=frame_data[\"wheel1_y\"],\n",
    "                    mode=\"markers\",\n",
    "                    marker=dict(size=12, color=\"black\", symbol=\"circle\"),\n",
    "                ),\n",
    "                go.Scatter(\n",
    "                    x=frame_data[\"wheel2_x\"],\n",
    "                    y=frame_data[\"wheel2_y\"],\n",
    "                    mode=\"markers\",\n",
    "                    marker=dict(size=12, color=\"black\", symbol=\"circle\"),\n",
    "                ),\n",
    "            ],\n",
    "            name=str(i),\n",
    "        )\n",
    "    )\n",
    "\n",
    "# Initial frame.\n",
    "init_frame = create_cart_pole_frame(\n",
    "    float(optimal_trajectory[0, 0]), float(optimal_trajectory[0, 1])\n",
    ")\n",
    "rail_y = cart_y_offset - 0.15 / 2 - wheel_radius * 2\n",
    "\n",
    "fig_anim = go.Figure(\n",
    "    data=[\n",
    "        go.Scatter(\n",
    "            x=init_frame[\"cart_x\"],\n",
    "            y=init_frame[\"cart_y\"],\n",
    "            fill=\"toself\",\n",
    "            fillcolor=\"steelblue\",\n",
    "            line=dict(color=\"darkblue\", width=2),\n",
    "            name=\"Cart\",\n",
    "        ),\n",
    "        go.Scatter(\n",
    "            x=init_frame[\"pole_x\"],\n",
    "            y=init_frame[\"pole_y\"],\n",
    "            mode=\"lines\",\n",
    "            line=dict(color=\"sienna\", width=8),\n",
    "            name=\"Pole\",\n",
    "        ),\n",
    "        go.Scatter(\n",
    "            x=init_frame[\"mass_x\"],\n",
    "            y=init_frame[\"mass_y\"],\n",
    "            mode=\"markers\",\n",
    "            marker=dict(size=18, color=\"sienna\", line=dict(color=\"black\", width=1)),\n",
    "            showlegend=False,\n",
    "        ),\n",
    "        go.Scatter(\n",
    "            x=init_frame[\"wheel1_x\"],\n",
    "            y=init_frame[\"wheel1_y\"],\n",
    "            mode=\"markers\",\n",
    "            marker=dict(size=12, color=\"black\", symbol=\"circle\"),\n",
    "            showlegend=False,\n",
    "        ),\n",
    "        go.Scatter(\n",
    "            x=init_frame[\"wheel2_x\"],\n",
    "            y=init_frame[\"wheel2_y\"],\n",
    "            mode=\"markers\",\n",
    "            marker=dict(size=12, color=\"black\", symbol=\"circle\"),\n",
    "            showlegend=False,\n",
    "        ),\n",
    "        go.Scatter(\n",
    "            x=[-2.5, 2.5],\n",
    "            y=[rail_y, rail_y],\n",
    "            mode=\"lines\",\n",
    "            line=dict(color=\"gray\", width=6),\n",
    "            name=\"Rail\",\n",
    "        ),\n",
    "    ],\n",
    "    frames=frames,\n",
    "    layout=go.Layout(\n",
    "        title=\"Cart-Pole (Shooting)\",\n",
    "        xaxis=dict(\n",
    "            range=[-2.5, 2.5], title=\"x (m)\", constrain=\"domain\", showgrid=False\n",
    "        ),\n",
    "        yaxis=dict(\n",
    "            range=[-0.1, 2.5],\n",
    "            title=\"y (m)\",\n",
    "            scaleanchor=\"x\",\n",
    "            scaleratio=1,\n",
    "            showgrid=False,\n",
    "        ),\n",
    "        updatemenus=[\n",
    "            dict(\n",
    "                type=\"buttons\",\n",
    "                showactive=False,\n",
    "                y=1.15,\n",
    "                x=0.5,\n",
    "                xanchor=\"center\",\n",
    "                buttons=[\n",
    "                    dict(\n",
    "                        label=\"Play\",\n",
    "                        method=\"animate\",\n",
    "                        args=[\n",
    "                            None,\n",
    "                            dict(\n",
    "                                frame=dict(duration=50, redraw=True),\n",
    "                                fromcurrent=True,\n",
    "                                transition=dict(duration=0),\n",
    "                            ),\n",
    "                        ],\n",
    "                    ),\n",
    "                    dict(\n",
    "                        label=\"Pause\",\n",
    "                        method=\"animate\",\n",
    "                        args=[\n",
    "                            [None],\n",
    "                            dict(\n",
    "                                frame=dict(duration=0, redraw=False),\n",
    "                                mode=\"immediate\",\n",
    "                            ),\n",
    "                        ],\n",
    "                    ),\n",
    "                ],\n",
    "            )\n",
    "        ],\n",
    "        sliders=[\n",
    "            dict(\n",
    "                active=0,\n",
    "                yanchor=\"top\",\n",
    "                xanchor=\"left\",\n",
    "                currentvalue=dict(\n",
    "                    prefix=\"Time: \",\n",
    "                    suffix=\"s\",\n",
    "                    visible=True,\n",
    "                    xanchor=\"center\",\n",
    "                    offset=20,\n",
    "                ),\n",
    "                pad=dict(b=10, t=60),\n",
    "                steps=[\n",
    "                    dict(\n",
    "                        args=[\n",
    "                            [str(i)],\n",
    "                            dict(\n",
    "                                frame=dict(duration=0, redraw=True),\n",
    "                                mode=\"immediate\",\n",
    "                                transition=dict(duration=0),\n",
    "                            ),\n",
    "                        ],\n",
    "                        label=f\"{float(times[i]):.2f}\",\n",
    "                        method=\"animate\",\n",
    "                    )\n",
    "                    for i in frame_indices\n",
    "                ],\n",
    "                x=0.1,\n",
    "                y=0,\n",
    "                len=0.8,\n",
    "            )\n",
    "        ],\n",
    "        height=500,\n",
    "        showlegend=False,\n",
    "        margin=dict(t=80, b=100),\n",
    "        plot_bgcolor=\"white\",\n",
    "    ),\n",
    ")\n",
    "HTML(fig_anim.to_html(full_html=False, include_plotlyjs=\"cdn\", auto_play=False))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "cell-18",
   "metadata": {
    "tags": [
     "hide-input"
    ]
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>                        <script type=\"text/javascript\">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>\n",
       "        <script charset=\"utf-8\" src=\"https://cdn.plot.ly/plotly-3.1.0.min.js\" integrity=\"sha256-Ei4740bWZhaUTQuD6q9yQlgVCMPBz6CZWhevDYPv93A=\" crossorigin=\"anonymous\"></script>                <div id=\"87e6d3cc-b51e-4fc2-8667-a126995818a7\" class=\"plotly-graph-div\" style=\"height:500px; width:100%;\"></div>            <script type=\"text/javascript\">                window.PLOTLYENV=window.PLOTLYENV || {};                                if (document.getElementById(\"87e6d3cc-b51e-4fc2-8667-a126995818a7\")) {                    Plotly.newPlot(                        \"87e6d3cc-b51e-4fc2-8667-a126995818a7\",                        [{\"line\":{\"color\":\"steelblue\",\"width\":2},\"mode\":\"lines\",\"name\":\"x\",\"x\":[0.0,0.05000000447034836,0.10000000894069672,0.15000000596046448,0.20000001788139343,0.2500000298023224,0.30000001192092896,0.3500000238418579,0.40000003576278687,0.4500000476837158,0.5000000596046448,0.5500000715255737,0.6000000238418579,0.6500000357627869,0.7000000476837158,0.7500000596046448,0.8000000715255737,0.8500000834465027,0.9000000953674316,0.9500001072883606,1.0000001192092896,1.0500000715255737,1.1000001430511475,1.1500000953674316,1.2000000476837158,1.2500001192092896,1.3000000715255737,1.3500001430511475,1.4000000953674316,1.4500001668930054,1.5000001192092896,1.5500001907348633,1.6000001430511475,1.6500000953674316,1.7000001668930054,1.7500001192092896,1.8000001907348633,1.8500001430511475,1.9000002145767212,1.9500001668930054,2.000000238418579,2.0500001907348633,2.1000001430511475,2.1500000953674316,2.200000286102295,2.250000238418579,2.3000001907348633,2.3500001430511475,2.4000000953674316,2.450000286102295,2.500000238418579,2.5500001907348633,2.6000001430511475,2.6500003337860107,2.700000286102295,2.750000238418579,2.8000001907348633,2.8500001430511475,2.9000003337860107,2.950000286102295,3.0],\"y\":[0.0,-0.012024289928376675,-0.045944247394800186,-0.09730774909257889,-0.16148026287555695,-0.23391757905483246,-0.310467928647995,-0.3875865340232849,-0.4623779058456421,-0.5324691534042358,-0.595810055732727,-0.6504756808280945,-0.6945541501045227,-0.7261571288108826,-0.7435895204544067,-0.7457329034805298,-0.7325528860092163,-0.7055023908615112,-0.6674538850784302,-0.6220650672912598,-0.5728514194488525,-0.5224244594573975,-0.47222158312797546,-0.42263269424438477,-0.3733382225036621,-0.3237193524837494,-0.2732680141925812,-0.2219667136669159,-0.17061573266983032,-0.12107928097248077,-0.07640088349580765,-0.04072056710720062,-0.01888134516775608,-0.015484923496842384,-0.03321215137839317,-0.07086876034736633,-0.12269795686006546,-0.18005958199501038,-0.23417313396930695,-0.27800339460372925,-0.3069024384021759,-0.3185041844844818,-0.3123370110988617,-0.2894355356693268,-0.25208407640457153,-0.20369401574134827,-0.14875036478042603,-0.09275772422552109,-0.042166873812675476,-0.004344065207988024,0.01230048667639494,0.01368151418864727,0.01218132209032774,0.01016912516206503,0.008130110800266266,0.006171413231641054,0.004318923689424992,0.0025780803989619017,0.0009430104400962591,-0.0006232562591321766,-0.0023045639973133802],\"type\":\"scatter\",\"xaxis\":\"x\",\"yaxis\":\"y\"},{\"line\":{\"color\":\"coral\",\"width\":2},\"mode\":\"lines\",\"name\":\"theta\",\"x\":[0.0,0.05000000447034836,0.10000000894069672,0.15000000596046448,0.20000001788139343,0.2500000298023224,0.30000001192092896,0.3500000238418579,0.40000003576278687,0.4500000476837158,0.5000000596046448,0.5500000715255737,0.6000000238418579,0.6500000357627869,0.7000000476837158,0.7500000596046448,0.8000000715255737,0.8500000834465027,0.9000000953674316,0.9500001072883606,1.0000001192092896,1.0500000715255737,1.1000001430511475,1.1500000953674316,1.2000000476837158,1.2500001192092896,1.3000000715255737,1.3500001430511475,1.4000000953674316,1.4500001668930054,1.5000001192092896,1.5500001907348633,1.6000001430511475,1.6500000953674316,1.7000001668930054,1.7500001192092896,1.8000001907348633,1.8500001430511475,1.9000002145767212,1.9500001668930054,2.000000238418579,2.0500001907348633,2.1000001430511475,2.1500000953674316,2.200000286102295,2.250000238418579,2.3000001907348633,2.3500001430511475,2.4000000953674316,2.450000286102295,2.500000238418579,2.5500001907348633,2.6000001430511475,2.6500003337860107,2.700000286102295,2.750000238418579,2.8000001907348633,2.8500001430511475,2.9000003337860107,2.950000286102295,3.0],\"y\":[0.0,0.01798088662326336,0.06803473830223083,0.14161333441734314,0.22898128628730774,0.32008060812950134,0.405509889125824,0.47728174924850464,0.5291310548782349,0.5563971400260925,0.5557012557983398,0.5246028304100037,0.4613928496837616,0.3651185929775238,0.2359483540058136,0.0760076716542244,-0.10950306802988052,-0.31157949566841125,-0.5181049704551697,-0.7161308526992798,-0.8945453763008118,-1.0455924272537231,-1.164764404296875,-1.2498438358306885,-1.2999123334884644,-1.3146936893463135,-1.294235348701477,-1.2387702465057373,-1.1485798358917236,-1.023727536201477,-0.8636536002159119,-0.6668276786804199,-0.43097254633903503,-0.15480126440525055,0.1579955667257309,0.4942794442176819,0.8321235179901123,1.1491754055023193,1.4315301179885864,1.6758860349655151,1.8862719535827637,2.069802761077881,2.233755350112915,2.384089469909668,2.5248069763183594,2.6576616764068604,2.782012701034546,2.8948092460632324,2.9906859397888184,3.0620193481445312,3.0986626148223877,3.1107866764068604,3.1174418926239014,3.1224358081817627,3.1266825199127197,3.130500078201294,3.134068012237549,3.137526273727417,3.140993595123291,3.1445424556732178,3.148026943206787],\"type\":\"scatter\",\"xaxis\":\"x2\",\"yaxis\":\"y2\"},{\"line\":{\"color\":\"steelblue\",\"width\":2},\"mode\":\"lines\",\"name\":\"x_dot\",\"x\":[0.0,0.05000000447034836,0.10000000894069672,0.15000000596046448,0.20000001788139343,0.2500000298023224,0.30000001192092896,0.3500000238418579,0.40000003576278687,0.4500000476837158,0.5000000596046448,0.5500000715255737,0.6000000238418579,0.6500000357627869,0.7000000476837158,0.7500000596046448,0.8000000715255737,0.8500000834465027,0.9000000953674316,0.9500001072883606,1.0000001192092896,1.0500000715255737,1.1000001430511475,1.1500000953674316,1.2000000476837158,1.2500001192092896,1.3000000715255737,1.3500001430511475,1.4000000953674316,1.4500001668930054,1.5000001192092896,1.5500001907348633,1.6000001430511475,1.6500000953674316,1.7000001668930054,1.7500001192092896,1.8000001907348633,1.8500001430511475,1.9000002145767212,1.9500001668930054,2.000000238418579,2.0500001907348633,2.1000001430511475,2.1500000953674316,2.200000286102295,2.250000238418579,2.3000001907348633,2.3500001430511475,2.4000000953674316,2.450000286102295,2.500000238418579,2.5500001907348633,2.6000001430511475,2.6500003337860107,2.700000286102295,2.750000238418579,2.8000001907348633,2.8500001430511475,2.9000003337860107,2.950000286102295,3.0],\"y\":[0.0,-0.4808580279350281,-0.8755805492401123,-1.17836332321167,-1.3878229856491089,-1.509033441543579,-1.5525777339935303,-1.532025694847107,-1.4596633911132812,-1.3440611362457275,-1.1895712614059448,-0.9969220161437988,-0.7660008072853088,-0.49799811840057373,-0.19960278272628784,0.11272744834423065,0.41230273246765137,0.6669367551803589,0.8526270985603333,0.9618377685546875,1.0070074796676636,1.0112282037734985,0.9982697367668152,0.9864571690559387,0.9860615134239197,0.9989160299301147,1.0188312530517578,1.0324183702468872,1.0204014778137207,0.959552526473999,0.8260129690170288,0.5999881029129028,0.2736220359802246,-0.13493718206882477,-0.567405104637146,-0.9302584528923035,-1.1375902891159058,-1.1572502851486206,-1.011055827140808,-0.746227502822876,-0.4126953184604645,-0.053102925419807434,0.29896634817123413,0.616819441318512,0.8772488236427307,1.0584717988967896,1.139412760734558,1.1004397869110107,0.9233748912811279,0.5897481441497803,0.07618439197540283,-0.020873209461569786,-0.03909481689333916,-0.04136314615607262,-0.040171947330236435,-0.03815305605530739,-0.035925112664699554,-0.03368786722421646,-0.03169412538409233,-0.03093525394797325,-0.036296140402555466],\"type\":\"scatter\",\"xaxis\":\"x3\",\"yaxis\":\"y3\"},{\"line\":{\"color\":\"coral\",\"dash\":\"dash\",\"width\":2},\"mode\":\"lines\",\"name\":\"theta_dot\",\"x\":[0.0,0.05000000447034836,0.10000000894069672,0.15000000596046448,0.20000001788139343,0.2500000298023224,0.30000001192092896,0.3500000238418579,0.40000003576278687,0.4500000476837158,0.5000000596046448,0.5500000715255737,0.6000000238418579,0.6500000357627869,0.7000000476837158,0.7500000596046448,0.8000000715255737,0.8500000834465027,0.9000000953674316,0.9500001072883606,1.0000001192092896,1.0500000715255737,1.1000001430511475,1.1500000953674316,1.2000000476837158,1.2500001192092896,1.3000000715255737,1.3500001430511475,1.4000000953674316,1.4500001668930054,1.5000001192092896,1.5500001907348633,1.6000001430511475,1.6500000953674316,1.7000001668930054,1.7500001192092896,1.8000001907348633,1.8500001430511475,1.9000002145767212,1.9500001668930054,2.000000238418579,2.0500001907348633,2.1000001430511475,2.1500000953674316,2.200000286102295,2.250000238418579,2.3000001907348633,2.3500001430511475,2.4000000953674316,2.450000286102295,2.500000238418579,2.5500001907348633,2.6000001430511475,2.6500003337860107,2.700000286102295,2.750000238418579,2.8000001907348633,2.8500001430511475,2.9000003337860107,2.950000286102295,3.0],\"y\":[0.0,0.7168334126472473,1.2784475088119507,1.6542792320251465,1.8280532360076904,1.8035439252853394,1.6029757261276245,1.259935736656189,0.8089829683303833,0.2793111503124237,-0.30708667635917664,-0.934519350528717,-1.5890675783157349,-2.2538585662841797,-2.900263547897339,-3.4783012866973877,-3.9160120487213135,-4.1362104415893555,-4.094660758972168,-3.802210807800293,-3.318117618560791,-2.714168071746826,-2.0474371910095215,-1.3528990745544434,-0.6483827829360962,0.05755743756890297,0.7601396441459656,1.4566123485565186,2.1478641033172607,2.8418331146240234,3.5553171634674072,4.309324741363525,5.110210418701172,5.90842866897583,6.555325984954834,6.8355793952941895,6.628808975219727,6.03095817565918,5.265072822570801,4.5249457359313965,3.9121670722961426,3.4521780014038086,3.128422975540161,2.9059715270996094,2.7419519424438477,2.589465618133545,2.3997509479522705,2.1252312660217285,1.720821499824524,1.1408642530441284,0.32931751012802124,0.1572369635105133,0.1098458394408226,0.09057292342185974,0.07986068725585938,0.07334334403276443,0.06984724849462509,0.0689418762922287,0.07021232694387436,0.07220927625894547,0.06763435155153275],\"type\":\"scatter\",\"xaxis\":\"x3\",\"yaxis\":\"y3\"},{\"fill\":\"tozeroy\",\"fillcolor\":\"rgba(34, 139, 34, 0.2)\",\"line\":{\"color\":\"forestgreen\",\"width\":2},\"mode\":\"lines\",\"name\":\"F\",\"x\":[0.0,0.05000000074505806,0.10000000149011612,0.15000000596046448,0.20000000298023224,0.25,0.30000001192092896,0.3499999940395355,0.4000000059604645,0.45000001788139343,0.5,0.550000011920929,0.6000000238418579,0.6500000357627869,0.699999988079071,0.75,0.800000011920929,0.8500000238418579,0.9000000357627869,0.949999988079071,1.0,1.0500000715255737,1.100000023841858,1.149999976158142,1.2000000476837158,1.25,1.3000000715255737,1.350000023841858,1.399999976158142,1.4500000476837158,1.5,1.5500000715255737,1.600000023841858,1.649999976158142,1.7000000476837158,1.75,1.8000000715255737,1.850000023841858,1.899999976158142,1.9500000476837158,2.0,2.049999952316284,2.1000001430511475,2.1500000953674316,2.200000047683716,2.25,2.299999952316284,2.3500001430511475,2.4000000953674316,2.450000047683716,2.5,2.549999952316284,2.6000001430511475,2.6500000953674316,2.700000047683716,2.75,2.799999952316284,2.8500001430511475,2.9000000953674316,2.950000047683716],\"y\":[-9.862168312072754,-8.125123023986816,-6.29898738861084,-4.465490818023682,-2.7350270748138428,-1.1969445943832397,0.09830048680305481,1.1711907386779785,2.0820863246917725,2.900726795196533,3.6903250217437744,4.466220378875732,5.213679313659668,5.850069046020508,6.22288179397583,6.166312217712402,5.557429313659668,4.464994430541992,3.0917530059814453,1.7852414846420288,0.8087250590324402,0.2670900523662567,0.1219836175441742,0.24459072947502136,0.47086790204048157,0.6311020851135254,0.5661489367485046,0.14098061621189117,-0.740566074848175,-2.106401205062866,-3.8961007595062256,-5.92331075668335,-7.793338298797607,-8.87817096710205,-8.438979148864746,-6.115752220153809,-2.42775297164917,1.4790879487991333,4.620722770690918,6.598522663116455,7.472774982452393,7.47215461730957,6.806796073913574,5.60405158996582,3.9314932823181152,1.8265411853790283,-0.6719872355461121,-3.5358612537384033,-6.775792598724365,-10.490180969238281,-1.9634158611297607,-0.3535268008708954,-0.030645739287137985,0.03691083937883377,0.050928547978401184,0.05250827595591545,0.05012337863445282,0.04259130731225014,0.014698541723191738,-0.11336344480514526],\"type\":\"scatter\",\"xaxis\":\"x4\",\"yaxis\":\"y4\"}],                        {\"template\":{\"data\":{\"histogram2dcontour\":[{\"type\":\"histogram2dcontour\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"choropleth\":[{\"type\":\"choropleth\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}],\"histogram2d\":[{\"type\":\"histogram2d\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"heatmap\":[{\"type\":\"heatmap\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"contourcarpet\":[{\"type\":\"contourcarpet\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}],\"contour\":[{\"type\":\"contour\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"surface\":[{\"type\":\"surface\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"mesh3d\":[{\"type\":\"mesh3d\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}],\"scatter\":[{\"fillpattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2},\"type\":\"scatter\"}],\"parcoords\":[{\"type\":\"parcoords\",\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scatterpolargl\":[{\"type\":\"scatterpolargl\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"bar\":[{\"error_x\":{\"color\":\"#2a3f5f\"},\"error_y\":{\"color\":\"#2a3f5f\"},\"marker\":{\"line\":{\"color\":\"#E5ECF6\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"bar\"}],\"scattergeo\":[{\"type\":\"scattergeo\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scatterpolar\":[{\"type\":\"scatterpolar\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"histogram\":[{\"marker\":{\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"histogram\"}],\"scattergl\":[{\"type\":\"scattergl\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scatter3d\":[{\"type\":\"scatter3d\",\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scattermap\":[{\"type\":\"scattermap\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scattermapbox\":[{\"type\":\"scattermapbox\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scatterternary\":[{\"type\":\"scatterternary\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scattercarpet\":[{\"type\":\"scattercarpet\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"carpet\":[{\"aaxis\":{\"endlinecolor\":\"#2a3f5f\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"minorgridcolor\":\"white\",\"startlinecolor\":\"#2a3f5f\"},\"baxis\":{\"endlinecolor\":\"#2a3f5f\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"minorgridcolor\":\"white\",\"startlinecolor\":\"#2a3f5f\"},\"type\":\"carpet\"}],\"table\":[{\"cells\":{\"fill\":{\"color\":\"#EBF0F8\"},\"line\":{\"color\":\"white\"}},\"header\":{\"fill\":{\"color\":\"#C8D4E3\"},\"line\":{\"color\":\"white\"}},\"type\":\"table\"}],\"barpolar\":[{\"marker\":{\"line\":{\"color\":\"#E5ECF6\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"barpolar\"}],\"pie\":[{\"automargin\":true,\"type\":\"pie\"}]},\"layout\":{\"autotypenumbers\":\"strict\",\"colorway\":[\"#636efa\",\"#EF553B\",\"#00cc96\",\"#ab63fa\",\"#FFA15A\",\"#19d3f3\",\"#FF6692\",\"#B6E880\",\"#FF97FF\",\"#FECB52\"],\"font\":{\"color\":\"#2a3f5f\"},\"hovermode\":\"closest\",\"hoverlabel\":{\"align\":\"left\"},\"paper_bgcolor\":\"white\",\"plot_bgcolor\":\"#E5ECF6\",\"polar\":{\"bgcolor\":\"#E5ECF6\",\"angularaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"},\"radialaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"}},\"ternary\":{\"bgcolor\":\"#E5ECF6\",\"aaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"},\"baxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"},\"caxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"}},\"coloraxis\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"colorscale\":{\"sequential\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"sequentialminus\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"diverging\":[[0,\"#8e0152\"],[0.1,\"#c51b7d\"],[0.2,\"#de77ae\"],[0.3,\"#f1b6da\"],[0.4,\"#fde0ef\"],[0.5,\"#f7f7f7\"],[0.6,\"#e6f5d0\"],[0.7,\"#b8e186\"],[0.8,\"#7fbc41\"],[0.9,\"#4d9221\"],[1,\"#276419\"]]},\"xaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"white\",\"automargin\":true,\"zerolinewidth\":2},\"yaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"white\",\"automargin\":true,\"zerolinewidth\":2},\"scene\":{\"xaxis\":{\"backgroundcolor\":\"#E5ECF6\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"white\",\"gridwidth\":2},\"yaxis\":{\"backgroundcolor\":\"#E5ECF6\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"white\",\"gridwidth\":2},\"zaxis\":{\"backgroundcolor\":\"#E5ECF6\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"white\",\"gridwidth\":2}},\"shapedefaults\":{\"line\":{\"color\":\"#2a3f5f\"}},\"annotationdefaults\":{\"arrowcolor\":\"#2a3f5f\",\"arrowhead\":0,\"arrowwidth\":1},\"geo\":{\"bgcolor\":\"white\",\"landcolor\":\"#E5ECF6\",\"subunitcolor\":\"white\",\"showland\":true,\"showlakes\":true,\"lakecolor\":\"white\"},\"title\":{\"x\":0.05},\"mapbox\":{\"style\":\"light\"}}},\"xaxis\":{\"anchor\":\"y\",\"domain\":[0.0,0.45],\"title\":{\"text\":\"Time (s)\"}},\"yaxis\":{\"anchor\":\"x\",\"domain\":[0.575,1.0],\"title\":{\"text\":\"Position (m)\"}},\"xaxis2\":{\"anchor\":\"y2\",\"domain\":[0.55,1.0],\"title\":{\"text\":\"Time (s)\"}},\"yaxis2\":{\"anchor\":\"x2\",\"domain\":[0.575,1.0],\"title\":{\"text\":\"Angle (rad)\"}},\"xaxis3\":{\"anchor\":\"y3\",\"domain\":[0.0,0.45],\"title\":{\"text\":\"Time (s)\"}},\"yaxis3\":{\"anchor\":\"x3\",\"domain\":[0.0,0.425],\"title\":{\"text\":\"Velocity\"}},\"xaxis4\":{\"anchor\":\"y4\",\"domain\":[0.55,1.0],\"title\":{\"text\":\"Time (s)\"}},\"yaxis4\":{\"anchor\":\"x4\",\"domain\":[0.0,0.425],\"title\":{\"text\":\"Force (N)\"}},\"annotations\":[{\"font\":{\"size\":16},\"showarrow\":false,\"text\":\"Cart Position\",\"x\":0.225,\"xanchor\":\"center\",\"xref\":\"paper\",\"y\":1.0,\"yanchor\":\"bottom\",\"yref\":\"paper\"},{\"font\":{\"size\":16},\"showarrow\":false,\"text\":\"Pole Angle\",\"x\":0.775,\"xanchor\":\"center\",\"xref\":\"paper\",\"y\":1.0,\"yanchor\":\"bottom\",\"yref\":\"paper\"},{\"font\":{\"size\":16},\"showarrow\":false,\"text\":\"Velocities\",\"x\":0.225,\"xanchor\":\"center\",\"xref\":\"paper\",\"y\":0.425,\"yanchor\":\"bottom\",\"yref\":\"paper\"},{\"font\":{\"size\":16},\"showarrow\":false,\"text\":\"Control Force\",\"x\":0.775,\"xanchor\":\"center\",\"xref\":\"paper\",\"y\":0.425,\"yanchor\":\"bottom\",\"yref\":\"paper\"},{\"showarrow\":false,\"text\":\"pi\",\"x\":1,\"xanchor\":\"right\",\"xref\":\"x2 domain\",\"y\":3.141592653589793,\"yanchor\":\"bottom\",\"yref\":\"y2\"}],\"shapes\":[{\"line\":{\"color\":\"gray\",\"dash\":\"dash\"},\"type\":\"line\",\"x0\":0,\"x1\":1,\"xref\":\"x2 domain\",\"y0\":3.141592653589793,\"y1\":3.141592653589793,\"yref\":\"y2\"}],\"margin\":{\"t\":40,\"b\":40},\"height\":500,\"showlegend\":false},                        {\"responsive\": true}                    )                };            </script>        </div>"
      ],
      "text/plain": [
       "<IPython.core.display.HTML object>"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# State and control trajectories.\n",
    "fig_traj = make_subplots(\n",
    "    rows=2,\n",
    "    cols=2,\n",
    "    subplot_titles=(\"Cart Position\", \"Pole Angle\", \"Velocities\", \"Control Force\"),\n",
    "    vertical_spacing=0.15,\n",
    "    horizontal_spacing=0.1,\n",
    ")\n",
    "\n",
    "# Cart position.\n",
    "fig_traj.add_trace(\n",
    "    go.Scatter(\n",
    "        x=[float(t) for t in times],\n",
    "        y=[float(s) for s in optimal_trajectory[:, 0]],\n",
    "        mode=\"lines\",\n",
    "        line=dict(color=\"steelblue\", width=2),\n",
    "        name=\"x\",\n",
    "    ),\n",
    "    row=1,\n",
    "    col=1,\n",
    ")\n",
    "\n",
    "# Pole angle.\n",
    "fig_traj.add_trace(\n",
    "    go.Scatter(\n",
    "        x=[float(t) for t in times],\n",
    "        y=[float(s) for s in optimal_trajectory[:, 1]],\n",
    "        mode=\"lines\",\n",
    "        line=dict(color=\"coral\", width=2),\n",
    "        name=\"theta\",\n",
    "    ),\n",
    "    row=1,\n",
    "    col=2,\n",
    ")\n",
    "fig_traj.add_hline(\n",
    "    y=float(jnp.pi),\n",
    "    line_dash=\"dash\",\n",
    "    line_color=\"gray\",\n",
    "    row=1,\n",
    "    col=2,\n",
    "    annotation_text=\"pi\",\n",
    ")\n",
    "\n",
    "# Velocities.\n",
    "fig_traj.add_trace(\n",
    "    go.Scatter(\n",
    "        x=[float(t) for t in times],\n",
    "        y=[float(s) for s in optimal_trajectory[:, 2]],\n",
    "        mode=\"lines\",\n",
    "        line=dict(color=\"steelblue\", width=2),\n",
    "        name=\"x_dot\",\n",
    "    ),\n",
    "    row=2,\n",
    "    col=1,\n",
    ")\n",
    "fig_traj.add_trace(\n",
    "    go.Scatter(\n",
    "        x=[float(t) for t in times],\n",
    "        y=[float(s) for s in optimal_trajectory[:, 3]],\n",
    "        mode=\"lines\",\n",
    "        line=dict(color=\"coral\", width=2, dash=\"dash\"),\n",
    "        name=\"theta_dot\",\n",
    "    ),\n",
    "    row=2,\n",
    "    col=1,\n",
    ")\n",
    "\n",
    "# Control force.\n",
    "fig_traj.add_trace(\n",
    "    go.Scatter(\n",
    "        x=[float(t) for t in control_times],\n",
    "        y=[float(u) for u in optimal_controls[:, 0]],\n",
    "        mode=\"lines\",\n",
    "        line=dict(color=\"forestgreen\", width=2),\n",
    "        name=\"F\",\n",
    "        fill=\"tozeroy\",\n",
    "        fillcolor=\"rgba(34, 139, 34, 0.2)\",\n",
    "    ),\n",
    "    row=2,\n",
    "    col=2,\n",
    ")\n",
    "\n",
    "# Axis labels.\n",
    "fig_traj.update_xaxes(title_text=\"Time (s)\", row=1, col=1)\n",
    "fig_traj.update_yaxes(title_text=\"Position (m)\", row=1, col=1)\n",
    "fig_traj.update_xaxes(title_text=\"Time (s)\", row=1, col=2)\n",
    "fig_traj.update_yaxes(title_text=\"Angle (rad)\", row=1, col=2)\n",
    "fig_traj.update_xaxes(title_text=\"Time (s)\", row=2, col=1)\n",
    "fig_traj.update_yaxes(title_text=\"Velocity\", row=2, col=1)\n",
    "fig_traj.update_xaxes(title_text=\"Time (s)\", row=2, col=2)\n",
    "fig_traj.update_yaxes(title_text=\"Force (N)\", row=2, col=2)\n",
    "\n",
    "fig_traj.update_layout(height=500, showlegend=False, margin=dict(t=40, b=40))\n",
    "HTML(fig_traj.to_html(full_html=False, include_plotlyjs=\"cdn\"))"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "cell-19",
   "metadata": {},
   "source": [
    "## Comparison with direct collocation\n",
    "\n",
    "The shooting method optimizes only the control trajectory (60 decision variables for 60 timesteps), while direct collocation in {doc}`cart_pole_collocation` optimizes both states and controls (305 decision variables: 61 states x 4 + 60 controls).\n",
    "\n",
    "Shooting method advantages:\n",
    "- Fewer decision variables\n",
    "- Dynamics are satisfied by construction (no defect constraints)\n",
    "- Simpler problem formulation\n",
    "\n",
    "Shooting method disadvantages:\n",
    "- Sensitivity to initial conditions grows exponentially with time horizon\n",
    "- Harder to add state constraints (must be handled through cost)\n",
    "- Can struggle with long horizons or unstable dynamics\n",
    "\n",
    "For this cart-pole problem, both methods work well because the time horizon is short. For longer horizons or more complex systems, direct collocation often provides better convergence.\n",
    "\n",
    "For solver configuration options, see {class}`jaxls.TrustRegionConfig` and {class}`jaxls.TerminationConfig`."
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.12.4"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
