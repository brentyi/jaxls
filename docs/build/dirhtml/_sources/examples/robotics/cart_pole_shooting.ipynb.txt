{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "cell-0",
   "metadata": {},
   "source": "# Cart-pole (shooting)\n\nIn this notebook, we solve a cart-pole swing-up problem using single shooting: finding\ncontrol inputs that swing a pendulum from hanging down to balancing upright.\n\n```{note}\nThis notebook demonstrates the shooting method, where we optimize only the control trajectory\nand compute states by forward simulation. For contrast, see {doc}`cart_pole_collocation`, which uses\ndirect collocation to optimize both states and controls with dynamics as constraints.\n```\n\nKey difference from direct collocation:\n- Shooting: Optimizes only controls; states are computed by simulating dynamics forward\n- Direct collocation: Optimizes both states and controls, with dynamics enforced as equality constraints\n\nShooting is simpler but can struggle with long time horizons due to sensitivity of the initial value problem.\n\nFeatures used:\n- {class}`~jaxls.Var` for control trajectory (single variable containing all controls)\n- {func}`@jaxls.Cost.factory <jaxls.Cost.factory>` for terminal state cost and control regularization\n- Forward simulation with `jax.lax.scan`"
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "cell-1",
   "metadata": {
    "tags": [
     "hide-input"
    ]
   },
   "outputs": [],
   "source": [
    "import sys\n",
    "from loguru import logger\n",
    "\n",
    "logger.remove()\n",
    "logger.add(sys.stdout, format=\"<level>{level: <8}</level> | {message}\");"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "cell-2",
   "metadata": {},
   "outputs": [],
   "source": [
    "import jax\n",
    "import jax.numpy as jnp\n",
    "import jaxls"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "cell-3",
   "metadata": {},
   "source": [
    "## Cart-pole dynamics\n",
    "\n",
    "The cart-pole system has state $[x, \\theta, \\dot{x}, \\dot{\\theta}]$ where $x$ is cart position and $\\theta$ is pole angle (0 = hanging down, $\\pi$ = upright). The control input is a horizontal force on the cart."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "cell-4",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Total trajectory time: 3.00s (50 swing + 10 hold)\n"
     ]
    }
   ],
   "source": [
    "# Physical parameters.\n",
    "m_cart = 1.0  # Cart mass (kg)\n",
    "m_pole = 0.1  # Pole mass (kg)\n",
    "length = 0.5  # Pole half-length (m)\n",
    "gravity = 9.81  # Gravitational acceleration (m/s^2)\n",
    "\n",
    "# Trajectory parameters.\n",
    "n_swing = 50  # Timesteps for swing-up phase\n",
    "n_hold = 10  # Timesteps to hold upright position\n",
    "n_steps = n_swing + n_hold  # Total timesteps\n",
    "dt = 0.05  # Time step (s)\n",
    "total_time = n_steps * dt\n",
    "print(f\"Total trajectory time: {total_time:.2f}s ({n_swing} swing + {n_hold} hold)\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "cell-5",
   "metadata": {},
   "outputs": [],
   "source": [
    "@jax.jit\n",
    "def cart_pole_dynamics(state: jax.Array, force: jax.Array) -> jax.Array:\n",
    "    \"\"\"Compute state derivatives for the cart-pole system.\n",
    "\n",
    "    State: [x, theta, x_dot, theta_dot]\n",
    "    theta = 0: pole hanging down, theta = pi: pole upright\n",
    "\n",
    "    Args:\n",
    "        state: Current state [x, theta, x_dot, theta_dot]\n",
    "        force: Control force [f]\n",
    "\n",
    "    Returns:\n",
    "        State derivatives [x_dot, theta_dot, x_ddot, theta_ddot]\n",
    "    \"\"\"\n",
    "    x, theta, x_dot, theta_dot = state\n",
    "    f = force[0]\n",
    "\n",
    "    sin_th = jnp.sin(theta)\n",
    "    cos_th = jnp.cos(theta)\n",
    "\n",
    "    # Total mass.\n",
    "    total_mass = m_cart + m_pole\n",
    "    pole_mass_length = m_pole * length\n",
    "\n",
    "    # Equations of motion for theta=0 being DOWN (stable equilibrium)\n",
    "    temp = (f + pole_mass_length * theta_dot**2 * sin_th) / total_mass\n",
    "    theta_ddot = (-gravity * sin_th - cos_th * temp) / (\n",
    "        length * (4.0 / 3.0 - m_pole * cos_th**2 / total_mass)\n",
    "    )\n",
    "    x_ddot = temp - pole_mass_length * theta_ddot * cos_th / total_mass\n",
    "\n",
    "    return jnp.array([x_dot, theta_dot, x_ddot, theta_ddot])\n",
    "\n",
    "\n",
    "@jax.jit\n",
    "def rk4_step(state: jax.Array, force: jax.Array, dt: float) -> jax.Array:\n",
    "    \"\"\"Runge-Kutta 4th order integration step.\n",
    "\n",
    "    Args:\n",
    "        state: Current state [x, theta, x_dot, theta_dot]\n",
    "        force: Control force [f]\n",
    "        dt: Time step\n",
    "\n",
    "    Returns:\n",
    "        Next state after integration\n",
    "    \"\"\"\n",
    "    k1 = cart_pole_dynamics(state, force)\n",
    "    k2 = cart_pole_dynamics(state + 0.5 * dt * k1, force)\n",
    "    k3 = cart_pole_dynamics(state + 0.5 * dt * k2, force)\n",
    "    k4 = cart_pole_dynamics(state + dt * k3, force)\n",
    "    return state + (dt / 6.0) * (k1 + 2 * k2 + 2 * k3 + k4)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "cell-6",
   "metadata": {},
   "source": [
    "## Forward simulation\n",
    "\n",
    "The key difference from direct collocation: we simulate the entire trajectory forward using `jax.lax.scan`. Given a control sequence, we compute all states by integrating the dynamics."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "cell-7",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Trajectory shape: (61, 4)\n",
      "Final state with zero controls: [0. 0. 0. 0.]\n"
     ]
    }
   ],
   "source": [
    "# Initial and target states.\n",
    "initial_state = jnp.array([0.0, 0.0, 0.0, 0.0])  # x=0, theta=0 (down), zero velocity\n",
    "target_state = jnp.array([0.0, jnp.pi, 0.0, 0.0])  # x=0, theta=pi (up), zero velocity\n",
    "\n",
    "\n",
    "@jax.jit\n",
    "def simulate_trajectory(controls: jax.Array) -> jax.Array:\n",
    "    \"\"\"Simulate the cart-pole system forward given a control sequence.\n",
    "\n",
    "    Args:\n",
    "        controls: Control forces, shape (n_steps, 1)\n",
    "\n",
    "    Returns:\n",
    "        State trajectory, shape (n_steps + 1, 4)\n",
    "    \"\"\"\n",
    "\n",
    "    def step(state: jax.Array, control: jax.Array) -> tuple[jax.Array, jax.Array]:\n",
    "        next_state = rk4_step(state, control, dt)\n",
    "        return next_state, next_state\n",
    "\n",
    "    _, trajectory = jax.lax.scan(step, initial_state, controls)\n",
    "    # Prepend initial state.\n",
    "    return jnp.concatenate([initial_state[None, :], trajectory], axis=0)\n",
    "\n",
    "\n",
    "# Test forward simulation with zero controls.\n",
    "test_controls = jnp.zeros((n_steps, 1))\n",
    "test_trajectory = simulate_trajectory(test_controls)\n",
    "print(f\"Trajectory shape: {test_trajectory.shape}\")\n",
    "print(f\"Final state with zero controls: {test_trajectory[-1]}\")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "cell-8",
   "metadata": {},
   "source": [
    "## Control variable and costs\n",
    "\n",
    "In the shooting method, we optimize a single variable containing the entire control trajectory. The costs include:\n",
    "1. Terminal cost: Penalize deviation from upright position at final time\n",
    "2. Control regularization: Penalize large control inputs"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "cell-9",
   "metadata": {},
   "outputs": [],
   "source": [
    "class ControlTrajectoryVar(\n",
    "    jaxls.Var[jax.Array], default_factory=lambda: jnp.zeros((n_steps, 1))\n",
    "):\n",
    "    \"\"\"Control trajectory variable: (n_steps, 1) array of forces.\"\"\"\n",
    "\n",
    "\n",
    "control_var = ControlTrajectoryVar(id=0)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "cell-10",
   "metadata": {},
   "outputs": [],
   "source": [
    "@jaxls.Cost.factory\n",
    "def terminal_cost(\n",
    "    vals: jaxls.VarValues,\n",
    "    var: ControlTrajectoryVar,\n",
    "    target: jax.Array,\n",
    ") -> jax.Array:\n",
    "    \"\"\"Penalize deviation from target state at final time.\n",
    "\n",
    "    Forward simulate the trajectory, then compute error at final state.\n",
    "    \"\"\"\n",
    "    controls = vals[var]\n",
    "    trajectory = simulate_trajectory(controls)\n",
    "    final_state = trajectory[-1]\n",
    "    # Weight position and angle errors more heavily.\n",
    "    weights = jnp.array([10.0, 20.0, 5.0, 5.0])\n",
    "    return (final_state - target) * weights\n",
    "\n",
    "\n",
    "@jaxls.Cost.factory\n",
    "def hold_cost(\n",
    "    vals: jaxls.VarValues,\n",
    "    var: ControlTrajectoryVar,\n",
    "    target: jax.Array,\n",
    ") -> jax.Array:\n",
    "    \"\"\"Penalize deviation from upright during the hold phase.\"\"\"\n",
    "    controls = vals[var]\n",
    "    trajectory = simulate_trajectory(controls)\n",
    "    # Get states during hold phase (use static slice with captured n_swing)\n",
    "    hold_states = jax.lax.slice_in_dim(trajectory, n_swing, n_steps + 1, axis=0)\n",
    "    # Penalize deviation from target for each hold state.\n",
    "    weights = jnp.array([5.0, 10.0, 2.0, 2.0])\n",
    "    errors = (hold_states - target) * weights\n",
    "    return errors.flatten()\n",
    "\n",
    "\n",
    "@jaxls.Cost.factory\n",
    "def control_regularization(\n",
    "    vals: jaxls.VarValues,\n",
    "    var: ControlTrajectoryVar,\n",
    ") -> jax.Array:\n",
    "    \"\"\"Penalize control effort (L2 regularization).\"\"\"\n",
    "    controls = vals[var]\n",
    "    return controls.flatten() * 0.1"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "cell-11",
   "metadata": {},
   "source": [
    "## Solving"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "cell-12",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Created 3 cost functions\n",
      "Control variable shape: (60, 1)\n"
     ]
    }
   ],
   "source": [
    "costs: list[jaxls.Cost] = [\n",
    "    terminal_cost(control_var, target_state),\n",
    "    hold_cost(control_var, target_state),\n",
    "    control_regularization(control_var),\n",
    "]\n",
    "\n",
    "print(f\"Created {len(costs)} cost functions\")\n",
    "print(f\"Control variable shape: ({n_steps}, 1)\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "cell-13",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\u001b[1mINFO    \u001b[0m | Building optimization problem with 3 terms and 1 variables: 3 costs, 0 eq_zero, 0 leq_zero, 0 geq_zero\n",
      "\u001b[1mINFO    \u001b[0m | Vectorizing group with 1 costs, 1 variables each: terminal_cost\n",
      "\u001b[1mINFO    \u001b[0m | Vectorizing group with 1 costs, 1 variables each: hold_cost\n",
      "\u001b[1mINFO    \u001b[0m | Vectorizing group with 1 costs, 1 variables each: control_regularization\n"
     ]
    }
   ],
   "source": [
    "# Initial guess: small random controls to break symmetry.\n",
    "key = jax.random.PRNGKey(42)\n",
    "initial_controls = jax.random.normal(key, (n_steps, 1)) * 0.1\n",
    "\n",
    "initial_vals = jaxls.VarValues.make([control_var.with_value(initial_controls)])\n",
    "\n",
    "# Create and analyze problem.\n",
    "problem = jaxls.LeastSquaresProblem(costs, [control_var]).analyze()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "cell-14",
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\u001b[1mINFO    \u001b[0m |  step #1: cost=14820.0186 lambd=0.0005 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 3938.88013 (avg 984.72003)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   10881.13477 (avg 247.29852)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 0.00345 (avg 0.00006)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=5.20e+02 cost_prev=14820.0186 cost_new=10036.3008\n",
      "\u001b[1mINFO    \u001b[0m |  step #2: cost=10036.2979 lambd=0.0003 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 623.13776 (avg 155.78444)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   9330.73438 (avg 212.06215)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 82.42606 (avg 1.37377)\n",
      "\u001b[1mINFO    \u001b[0m |  step #3: cost=10036.2979 lambd=0.0005 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 623.13776 (avg 155.78444)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   9330.73438 (avg 212.06215)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 82.42606 (avg 1.37377)\n",
      "\u001b[1mINFO    \u001b[0m |  step #4: cost=10036.2979 lambd=0.0010 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 623.13776 (avg 155.78444)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   9330.73438 (avg 212.06215)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 82.42606 (avg 1.37377)\n",
      "\u001b[1mINFO    \u001b[0m |  step #5: cost=10036.2979 lambd=0.0020 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 623.13776 (avg 155.78444)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   9330.73438 (avg 212.06215)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 82.42606 (avg 1.37377)\n",
      "\u001b[1mINFO    \u001b[0m |  step #6: cost=10036.2979 lambd=0.0040 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 623.13776 (avg 155.78444)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   9330.73438 (avg 212.06215)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 82.42606 (avg 1.37377)\n",
      "\u001b[1mINFO    \u001b[0m |  step #7: cost=10036.2979 lambd=0.0080 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 623.13776 (avg 155.78444)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   9330.73438 (avg 212.06215)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 82.42606 (avg 1.37377)\n",
      "\u001b[1mINFO    \u001b[0m |  step #8: cost=10036.2979 lambd=0.0160 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 623.13776 (avg 155.78444)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   9330.73438 (avg 212.06215)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 82.42606 (avg 1.37377)\n",
      "\u001b[1mINFO    \u001b[0m |  step #9: cost=10036.2979 lambd=0.0320 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 623.13776 (avg 155.78444)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   9330.73438 (avg 212.06215)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 82.42606 (avg 1.37377)\n",
      "\u001b[1mINFO    \u001b[0m |  step #10: cost=10036.2979 lambd=0.0640 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 623.13776 (avg 155.78444)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   9330.73438 (avg 212.06215)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 82.42606 (avg 1.37377)\n",
      "\u001b[1mINFO    \u001b[0m |  step #11: cost=10036.2979 lambd=0.1280 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 623.13776 (avg 155.78444)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   9330.73438 (avg 212.06215)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 82.42606 (avg 1.37377)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=2.84e+03 cost_prev=10036.3008 cost_new=4684.3662\n",
      "\u001b[1mINFO    \u001b[0m |  step #12: cost=4684.3662 lambd=0.0640 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 513.90247 (avg 128.47562)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   4061.28027 (avg 92.30183)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 109.18370 (avg 1.81973)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=1.40e+03 cost_prev=4684.3662 cost_new=4028.7876\n",
      "\u001b[1mINFO    \u001b[0m |  step #13: cost=4028.7878 lambd=0.0320 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 970.49084 (avg 242.62271)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   2844.49316 (avg 64.64758)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 213.80394 (avg 3.56340)\n",
      "\u001b[1mINFO    \u001b[0m |  step #14: cost=4028.7878 lambd=0.0640 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 970.49084 (avg 242.62271)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   2844.49316 (avg 64.64758)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 213.80394 (avg 3.56340)\n",
      "\u001b[1mINFO    \u001b[0m |  step #15: cost=4028.7878 lambd=0.1280 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 970.49084 (avg 242.62271)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   2844.49316 (avg 64.64758)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 213.80394 (avg 3.56340)\n",
      "\u001b[1mINFO    \u001b[0m |  step #16: cost=4028.7878 lambd=0.2560 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 970.49084 (avg 242.62271)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   2844.49316 (avg 64.64758)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 213.80394 (avg 3.56340)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=1.27e+03 cost_prev=4028.7876 cost_new=3628.3013\n",
      "\u001b[1mINFO    \u001b[0m |  step #17: cost=3628.3010 lambd=0.1280 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 1181.71997 (avg 295.42999)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   2341.52197 (avg 53.21641)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 105.05909 (avg 1.75098)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=1.14e+03 cost_prev=3628.3013 cost_new=1633.5022\n",
      "\u001b[1mINFO    \u001b[0m |  step #18: cost=1633.5022 lambd=0.0640 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 345.59445 (avg 86.39861)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   1256.49683 (avg 28.55675)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 31.41090 (avg 0.52351)\n",
      "\u001b[1mINFO    \u001b[0m |  step #19: cost=1633.5022 lambd=0.1280 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 345.59445 (avg 86.39861)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   1256.49683 (avg 28.55675)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 31.41090 (avg 0.52351)\n",
      "\u001b[1mINFO    \u001b[0m |  step #20: cost=1633.5022 lambd=0.2560 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 345.59445 (avg 86.39861)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   1256.49683 (avg 28.55675)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 31.41090 (avg 0.52351)\n",
      "\u001b[1mINFO    \u001b[0m |  step #21: cost=1633.5022 lambd=0.5120 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 345.59445 (avg 86.39861)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   1256.49683 (avg 28.55675)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 31.41090 (avg 0.52351)\n",
      "\u001b[1mINFO    \u001b[0m |  step #22: cost=1633.5022 lambd=1.0240 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 345.59445 (avg 86.39861)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   1256.49683 (avg 28.55675)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 31.41090 (avg 0.52351)\n",
      "\u001b[1mINFO    \u001b[0m |  step #23: cost=1633.5022 lambd=2.0480 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 345.59445 (avg 86.39861)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   1256.49683 (avg 28.55675)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 31.41090 (avg 0.52351)\n",
      "\u001b[1mINFO    \u001b[0m |  step #24: cost=1633.5022 lambd=4.0960 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 345.59445 (avg 86.39861)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   1256.49683 (avg 28.55675)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 31.41090 (avg 0.52351)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=3.72e+02 cost_prev=1633.5022 cost_new=1007.1594\n",
      "\u001b[1mINFO    \u001b[0m |  step #25: cost=1007.1594 lambd=2.0480 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 319.02032 (avg 79.75508)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   653.23999 (avg 14.84636)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 34.89909 (avg 0.58165)\n",
      "\u001b[1mINFO    \u001b[0m |  step #26: cost=1007.1594 lambd=4.0960 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 319.02032 (avg 79.75508)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   653.23999 (avg 14.84636)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 34.89909 (avg 0.58165)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=4.61e+02 cost_prev=1007.1594 cost_new=572.4126\n",
      "\u001b[1mINFO    \u001b[0m |  step #27: cost=572.4127 lambd=2.0480 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 145.04785 (avg 36.26196)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   390.94324 (avg 8.88507)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 36.42155 (avg 0.60703)\n",
      "\u001b[1mINFO    \u001b[0m |  step #28: cost=572.4127 lambd=4.0960 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 145.04785 (avg 36.26196)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   390.94324 (avg 8.88507)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 36.42155 (avg 0.60703)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=3.69e+02 cost_prev=572.4126 cost_new=340.4744\n",
      "\u001b[1mINFO    \u001b[0m |  step #29: cost=340.4744 lambd=2.0480 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 42.54160 (avg 10.63540)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   260.97519 (avg 5.93125)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 36.95764 (avg 0.61596)\n",
      "\u001b[1mINFO    \u001b[0m |  step #30: cost=340.4744 lambd=4.0960 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 42.54160 (avg 10.63540)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   260.97519 (avg 5.93125)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 36.95764 (avg 0.61596)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=2.10e+02 cost_prev=340.4744 cost_new=258.7848\n",
      "\u001b[1mINFO    \u001b[0m |  step #31: cost=258.7848 lambd=2.0480 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 17.60720 (avg 4.40180)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   203.89160 (avg 4.63390)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 37.28600 (avg 0.62143)\n",
      "\u001b[1mINFO    \u001b[0m |  step #32: cost=258.7848 lambd=4.0960 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 17.60720 (avg 4.40180)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   203.89160 (avg 4.63390)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 37.28600 (avg 0.62143)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=1.31e+02 cost_prev=258.7848 cost_new=217.3717\n",
      "\u001b[1mINFO    \u001b[0m |  step #33: cost=217.3717 lambd=2.0480 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 9.49219 (avg 2.37305)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   170.40802 (avg 3.87291)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 37.47153 (avg 0.62453)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=8.43e+01 cost_prev=217.3717 cost_new=205.9092\n",
      "\u001b[1mINFO    \u001b[0m |  step #34: cost=205.9092 lambd=1.0240 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 24.00981 (avg 6.00245)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   144.31160 (avg 3.27981)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 37.58778 (avg 0.62646)\n",
      "\u001b[1mINFO    \u001b[0m |  step #35: cost=205.9092 lambd=2.0480 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 24.00981 (avg 6.00245)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   144.31160 (avg 3.27981)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 37.58778 (avg 0.62646)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=2.04e+02 cost_prev=205.9092 cost_new=155.5018\n",
      "\u001b[1mINFO    \u001b[0m |  step #36: cost=155.5017 lambd=1.0240 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 7.42080 (avg 1.85520)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   110.72858 (avg 2.51656)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 37.35236 (avg 0.62254)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=9.93e+01 cost_prev=155.5018 cost_new=150.3035\n",
      "\u001b[1mINFO    \u001b[0m |  step #37: cost=150.3035 lambd=0.5120 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 21.09509 (avg 5.27377)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   92.15547 (avg 2.09444)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 37.05294 (avg 0.61755)\n",
      "\u001b[1mINFO    \u001b[0m |  step #38: cost=150.3035 lambd=1.0240 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 21.09509 (avg 5.27377)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   92.15547 (avg 2.09444)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 37.05294 (avg 0.61755)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=2.25e+02 cost_prev=150.3035 cost_new=107.0154\n",
      "\u001b[1mINFO    \u001b[0m |  step #39: cost=107.0154 lambd=0.5120 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 5.88594 (avg 1.47149)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   64.37170 (avg 1.46299)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 36.75779 (avg 0.61263)\n",
      "\u001b[1mINFO    \u001b[0m |  step #40: cost=107.0154 lambd=1.0240 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 5.88594 (avg 1.47149)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   64.37170 (avg 1.46299)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 36.75779 (avg 0.61263)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=1.15e+02 cost_prev=107.0154 cost_new=88.8110\n",
      "\u001b[1mINFO    \u001b[0m |  step #41: cost=88.8110 lambd=0.5120 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 2.51078 (avg 0.62770)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   49.79275 (avg 1.13165)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 36.50744 (avg 0.60846)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=6.90e+01 cost_prev=88.8110 cost_new=83.8815\n",
      "\u001b[1mINFO    \u001b[0m |  step #42: cost=83.8814 lambd=0.2560 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 9.01481 (avg 2.25370)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   38.66769 (avg 0.87881)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 36.19894 (avg 0.60332)\n",
      "\u001b[1mINFO    \u001b[0m |  step #43: cost=83.8814 lambd=0.5120 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 9.01481 (avg 2.25370)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   38.66769 (avg 0.87881)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 36.19894 (avg 0.60332)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=1.68e+02 cost_prev=83.8815 cost_new=64.7548\n",
      "\u001b[1mINFO    \u001b[0m |  step #44: cost=64.7548 lambd=0.2560 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 3.24689 (avg 0.81172)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   25.47734 (avg 0.57903)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 36.03053 (avg 0.60051)\n",
      "\u001b[1mINFO    \u001b[0m |  step #45: cost=64.7548 lambd=0.5120 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 3.24689 (avg 0.81172)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   25.47734 (avg 0.57903)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 36.03053 (avg 0.60051)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=1.01e+02 cost_prev=64.7548 cost_new=55.5099\n",
      "\u001b[1mINFO    \u001b[0m |  step #46: cost=55.5099 lambd=0.2560 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 1.41236 (avg 0.35309)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   18.26465 (avg 0.41511)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 35.83292 (avg 0.59722)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=6.48e+01 cost_prev=55.5099 cost_new=55.2921\n",
      "\u001b[1mINFO    \u001b[0m |  step #47: cost=55.2921 lambd=0.1280 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 5.59101 (avg 1.39775)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   14.36527 (avg 0.32648)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 35.33578 (avg 0.58893)\n",
      "\u001b[1mINFO    \u001b[0m |  step #48: cost=55.2921 lambd=0.2560 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 5.59101 (avg 1.39775)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   14.36527 (avg 0.32648)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 35.33578 (avg 0.58893)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=1.48e+02 cost_prev=55.2921 cost_new=45.7453\n",
      "\u001b[1mINFO    \u001b[0m |  step #49: cost=45.7453 lambd=0.1280 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 2.02972 (avg 0.50743)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   8.95305 (avg 0.20348)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 34.76252 (avg 0.57938)\n",
      "\u001b[1mINFO    \u001b[0m |  step #50: cost=45.7453 lambd=0.2560 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 2.02972 (avg 0.50743)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   8.95305 (avg 0.20348)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 34.76252 (avg 0.57938)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=8.89e+01 cost_prev=45.7453 cost_new=41.8801\n",
      "\u001b[1mINFO    \u001b[0m |  step #51: cost=41.8801 lambd=0.1280 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 1.12498 (avg 0.28124)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   6.62376 (avg 0.15054)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 34.13136 (avg 0.56886)\n",
      "\u001b[1mINFO    \u001b[0m |  step #52: cost=41.8801 lambd=0.2560 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 1.12498 (avg 0.28124)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   6.62376 (avg 0.15054)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 34.13136 (avg 0.56886)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=6.54e+01 cost_prev=41.8801 cost_new=39.5404\n",
      "\u001b[1mINFO    \u001b[0m |  step #53: cost=39.5404 lambd=0.1280 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.73957 (avg 0.18489)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   5.34821 (avg 0.12155)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 33.45261 (avg 0.55754)\n",
      "\u001b[1mINFO    \u001b[0m |  step #54: cost=39.5404 lambd=0.2560 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.73957 (avg 0.18489)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   5.34821 (avg 0.12155)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 33.45261 (avg 0.55754)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=5.19e+01 cost_prev=39.5404 cost_new=37.9006\n",
      "\u001b[1mINFO    \u001b[0m |  step #55: cost=37.9006 lambd=0.1280 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.55865 (avg 0.13966)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   4.59287 (avg 0.10438)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 32.74909 (avg 0.54582)\n",
      "\u001b[1mINFO    \u001b[0m |  step #56: cost=37.9006 lambd=0.2560 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.55865 (avg 0.13966)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   4.59287 (avg 0.10438)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 32.74909 (avg 0.54582)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=4.43e+01 cost_prev=37.9006 cost_new=36.6241\n",
      "\u001b[1mINFO    \u001b[0m |  step #57: cost=36.6241 lambd=0.1280 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.46727 (avg 0.11682)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   4.11784 (avg 0.09359)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 32.03899 (avg 0.53398)\n",
      "\u001b[1mINFO    \u001b[0m |  step #58: cost=36.6241 lambd=0.2560 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.46727 (avg 0.11682)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   4.11784 (avg 0.09359)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 32.03899 (avg 0.53398)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=4.01e+01 cost_prev=36.6241 cost_new=35.5560\n",
      "\u001b[1mINFO    \u001b[0m |  step #59: cost=35.5560 lambd=0.1280 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.41567 (avg 0.10392)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   3.80413 (avg 0.08646)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 31.33615 (avg 0.52227)\n",
      "\u001b[1mINFO    \u001b[0m |  step #60: cost=35.5560 lambd=0.2560 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.41567 (avg 0.10392)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   3.80413 (avg 0.08646)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 31.33615 (avg 0.52227)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=3.78e+01 cost_prev=35.5560 cost_new=34.6420\n",
      "\u001b[1mINFO    \u001b[0m |  step #61: cost=34.6419 lambd=0.1280 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.39779 (avg 0.09945)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   3.57618 (avg 0.08128)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 30.66799 (avg 0.51113)\n",
      "\u001b[1mINFO    \u001b[0m |  step #62: cost=34.6419 lambd=0.2560 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.39779 (avg 0.09945)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   3.57618 (avg 0.08128)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 30.66799 (avg 0.51113)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=3.74e+01 cost_prev=34.6420 cost_new=33.8013\n",
      "\u001b[1mINFO    \u001b[0m |  step #63: cost=33.8013 lambd=0.1280 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.37557 (avg 0.09389)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   3.41635 (avg 0.07764)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 30.00932 (avg 0.50016)\n",
      "\u001b[1mINFO    \u001b[0m |  step #64: cost=33.8013 lambd=0.2560 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.37557 (avg 0.09389)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   3.41635 (avg 0.07764)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 30.00932 (avg 0.50016)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=3.66e+01 cost_prev=33.8013 cost_new=33.0691\n",
      "\u001b[1mINFO    \u001b[0m |  step #65: cost=33.0691 lambd=0.1280 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.38565 (avg 0.09641)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   3.30474 (avg 0.07511)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 29.37868 (avg 0.48964)\n",
      "\u001b[1mINFO    \u001b[0m |  step #66: cost=33.0691 lambd=0.2560 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.38565 (avg 0.09641)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   3.30474 (avg 0.07511)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 29.37868 (avg 0.48964)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=3.81e+01 cost_prev=33.0691 cost_new=32.3507\n",
      "\u001b[1mINFO    \u001b[0m |  step #67: cost=32.3507 lambd=0.1280 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.37094 (avg 0.09273)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   3.21863 (avg 0.07315)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 28.76118 (avg 0.47935)\n",
      "\u001b[1mINFO    \u001b[0m |  step #68: cost=32.3507 lambd=0.2560 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.37094 (avg 0.09273)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   3.21863 (avg 0.07315)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 28.76118 (avg 0.47935)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=3.77e+01 cost_prev=32.3507 cost_new=31.6837\n",
      "\u001b[1mINFO    \u001b[0m |  step #69: cost=31.6837 lambd=0.1280 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.36263 (avg 0.09066)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   3.15847 (avg 0.07178)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 28.16257 (avg 0.46938)\n",
      "\u001b[1mINFO    \u001b[0m |  step #70: cost=31.6837 lambd=0.2560 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.36263 (avg 0.09066)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   3.15847 (avg 0.07178)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 28.16257 (avg 0.46938)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=3.77e+01 cost_prev=31.6837 cost_new=31.0596\n",
      "\u001b[1mINFO    \u001b[0m |  step #71: cost=31.0596 lambd=0.1280 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.35988 (avg 0.08997)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   3.11477 (avg 0.07079)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 27.58491 (avg 0.45975)\n",
      "\u001b[1mINFO    \u001b[0m |  step #72: cost=31.0596 lambd=0.2560 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.35988 (avg 0.08997)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   3.11477 (avg 0.07079)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 27.58491 (avg 0.45975)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=3.80e+01 cost_prev=31.0596 cost_new=30.4678\n",
      "\u001b[1mINFO    \u001b[0m |  step #73: cost=30.4678 lambd=0.1280 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.35859 (avg 0.08965)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   3.08194 (avg 0.07004)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 27.02728 (avg 0.45045)\n",
      "\u001b[1mINFO    \u001b[0m |  step #74: cost=30.4678 lambd=0.2560 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.35859 (avg 0.08965)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   3.08194 (avg 0.07004)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 27.02728 (avg 0.45045)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=3.85e+01 cost_prev=30.4678 cost_new=29.9041\n",
      "\u001b[1mINFO    \u001b[0m |  step #75: cost=29.9041 lambd=0.1280 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.35878 (avg 0.08969)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   3.05517 (avg 0.06944)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 26.49020 (avg 0.44150)\n",
      "\u001b[1mINFO    \u001b[0m |  step #76: cost=29.9041 lambd=0.2560 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.35878 (avg 0.08969)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   3.05517 (avg 0.06944)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 26.49020 (avg 0.44150)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=3.90e+01 cost_prev=29.9041 cost_new=29.3629\n",
      "\u001b[1mINFO    \u001b[0m |  step #77: cost=29.3629 lambd=0.1280 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.35818 (avg 0.08954)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   3.03246 (avg 0.06892)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 25.97230 (avg 0.43287)\n",
      "\u001b[1mINFO    \u001b[0m |  step #78: cost=29.3629 lambd=0.2560 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.35818 (avg 0.08954)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   3.03246 (avg 0.06892)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 25.97230 (avg 0.43287)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=3.95e+01 cost_prev=29.3629 cost_new=28.8504\n",
      "\u001b[1mINFO    \u001b[0m |  step #79: cost=28.8504 lambd=0.1280 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.36403 (avg 0.09101)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   3.00141 (avg 0.06821)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 25.48498 (avg 0.42475)\n",
      "\u001b[1mINFO    \u001b[0m |  step #80: cost=28.8504 lambd=0.2560 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.36403 (avg 0.09101)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   3.00141 (avg 0.06821)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 25.48498 (avg 0.42475)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=4.06e+01 cost_prev=28.8504 cost_new=28.3440\n",
      "\u001b[1mINFO    \u001b[0m |  step #81: cost=28.3440 lambd=0.1280 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.36140 (avg 0.09035)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   2.97735 (avg 0.06767)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 25.00524 (avg 0.41675)\n",
      "\u001b[1mINFO    \u001b[0m |  step #82: cost=28.3440 lambd=0.2560 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.36140 (avg 0.09035)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   2.97735 (avg 0.06767)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 25.00524 (avg 0.41675)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=4.09e+01 cost_prev=28.3440 cost_new=27.8604\n",
      "\u001b[1mINFO    \u001b[0m |  step #83: cost=27.8604 lambd=0.1280 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.36328 (avg 0.09082)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   2.95902 (avg 0.06725)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 24.53815 (avg 0.40897)\n",
      "\u001b[1mINFO    \u001b[0m |  step #84: cost=27.8604 lambd=0.2560 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.36328 (avg 0.09082)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   2.95902 (avg 0.06725)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 24.53815 (avg 0.40897)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=4.17e+01 cost_prev=27.8604 cost_new=27.3939\n",
      "\u001b[1mINFO    \u001b[0m |  step #85: cost=27.3939 lambd=0.1280 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.36715 (avg 0.09179)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   2.94275 (avg 0.06688)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 24.08404 (avg 0.40140)\n",
      "\u001b[1mINFO    \u001b[0m |  step #86: cost=27.3939 lambd=0.2560 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.36715 (avg 0.09179)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   2.94275 (avg 0.06688)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 24.08404 (avg 0.40140)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=4.26e+01 cost_prev=27.3939 cost_new=26.9409\n",
      "\u001b[1mINFO    \u001b[0m |  step #87: cost=26.9409 lambd=0.1280 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.37113 (avg 0.09278)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   2.92708 (avg 0.06652)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 23.64270 (avg 0.39404)\n",
      "\u001b[1mINFO    \u001b[0m |  step #88: cost=26.9409 lambd=0.2560 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.37113 (avg 0.09278)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   2.92708 (avg 0.06652)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 23.64270 (avg 0.39404)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=4.35e+01 cost_prev=26.9409 cost_new=26.5003\n",
      "\u001b[1mINFO    \u001b[0m |  step #89: cost=26.5003 lambd=0.1280 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.37487 (avg 0.09372)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   2.90931 (avg 0.06612)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 23.21608 (avg 0.38693)\n",
      "\u001b[1mINFO    \u001b[0m |  step #90: cost=26.5003 lambd=0.2560 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.37487 (avg 0.09372)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   2.90931 (avg 0.06612)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 23.21608 (avg 0.38693)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=4.45e+01 cost_prev=26.5003 cost_new=26.0711\n",
      "\u001b[1mINFO    \u001b[0m |  step #91: cost=26.0711 lambd=0.1280 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.37893 (avg 0.09473)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   2.89264 (avg 0.06574)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 22.79948 (avg 0.37999)\n",
      "\u001b[1mINFO    \u001b[0m |  step #92: cost=26.0711 lambd=0.2560 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.37893 (avg 0.09473)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   2.89264 (avg 0.06574)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 22.79948 (avg 0.37999)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=4.56e+01 cost_prev=26.0711 cost_new=25.6523\n",
      "\u001b[1mINFO    \u001b[0m |  step #93: cost=25.6523 lambd=0.1280 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.38280 (avg 0.09570)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   2.87318 (avg 0.06530)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 22.39634 (avg 0.37327)\n",
      "\u001b[1mINFO    \u001b[0m |  step #94: cost=25.6523 lambd=0.2560 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.38280 (avg 0.09570)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   2.87318 (avg 0.06530)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 22.39634 (avg 0.37327)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=4.67e+01 cost_prev=25.6523 cost_new=25.2424\n",
      "\u001b[1mINFO    \u001b[0m |  step #95: cost=25.2424 lambd=0.1280 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.38489 (avg 0.09622)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   2.85106 (avg 0.06480)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 22.00647 (avg 0.36677)\n",
      "\u001b[1mINFO    \u001b[0m |  step #96: cost=25.2424 lambd=0.2560 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.38489 (avg 0.09622)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   2.85106 (avg 0.06480)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 22.00647 (avg 0.36677)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=4.76e+01 cost_prev=25.2424 cost_new=24.8424\n",
      "\u001b[1mINFO    \u001b[0m |  step #97: cost=24.8424 lambd=0.1280 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.38760 (avg 0.09690)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   2.82887 (avg 0.06429)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 21.62596 (avg 0.36043)\n",
      "\u001b[1mINFO    \u001b[0m |  step #98: cost=24.8424 lambd=0.2560 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.38760 (avg 0.09690)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   2.82887 (avg 0.06429)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 21.62596 (avg 0.36043)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=4.86e+01 cost_prev=24.8424 cost_new=24.4540\n",
      "\u001b[1mINFO    \u001b[0m |  step #99: cost=24.4540 lambd=0.1280 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.39180 (avg 0.09795)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   2.80476 (avg 0.06374)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 21.25742 (avg 0.35429)\n",
      "\u001b[1mINFO    \u001b[0m |  step #100: cost=24.4540 lambd=0.2560 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - terminal_cost(1): 0.39180 (avg 0.09795)\n",
      "\u001b[1mINFO    \u001b[0m |      - hold_cost(1):   2.80476 (avg 0.06374)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_regularization(1): 21.25742 (avg 0.35429)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=4.98e+01 cost_prev=24.4540 cost_new=24.0721\n",
      "\u001b[1mINFO    \u001b[0m | Terminated @ iteration #100: cost=24.0721 criteria=[0 0 0 1], term_deltas=1.6e-02,1.4e+01,2.6e-02\n"
     ]
    }
   ],
   "source": [
    "solution = problem.solve(initial_vals)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "cell-15",
   "metadata": {},
   "source": [
    "## Visualization"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "cell-16",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Final state: x=-0.003, theta=3.153\n",
      "Target theta (pi): 3.142\n",
      "Terminal angle error: 0.0117 rad\n"
     ]
    }
   ],
   "source": [
    "# Extract solution.\n",
    "optimal_controls = solution[control_var]\n",
    "optimal_trajectory = simulate_trajectory(optimal_controls)\n",
    "\n",
    "times = jnp.linspace(0, total_time, n_steps + 1)\n",
    "control_times = jnp.linspace(0, total_time - dt, n_steps)\n",
    "\n",
    "print(\n",
    "    f\"Final state: x={float(optimal_trajectory[-1, 0]):.3f}, theta={float(optimal_trajectory[-1, 1]):.3f}\"\n",
    ")\n",
    "print(f\"Target theta (pi): {jnp.pi:.3f}\")\n",
    "print(f\"Terminal angle error: {abs(float(optimal_trajectory[-1, 1]) - jnp.pi):.4f} rad\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "cell-17",
   "metadata": {
    "tags": [
     "hide-input"
    ]
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>                        <script type=\"text/javascript\">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>\n",
       "        <script charset=\"utf-8\" src=\"https://cdn.plot.ly/plotly-3.1.0.min.js\" integrity=\"sha256-Ei4740bWZhaUTQuD6q9yQlgVCMPBz6CZWhevDYPv93A=\" crossorigin=\"anonymous\"></script>                <div id=\"dc059bb9-478b-4300-a96f-177886c3a013\" class=\"plotly-graph-div\" style=\"height:500px; width:100%;\"></div>            <script type=\"text/javascript\">                window.PLOTLYENV=window.PLOTLYENV || {};                                if (document.getElementById(\"dc059bb9-478b-4300-a96f-177886c3a013\")) {                    Plotly.newPlot(                        \"dc059bb9-478b-4300-a96f-177886c3a013\",                        [{\"fill\":\"toself\",\"fillcolor\":\"steelblue\",\"line\":{\"color\":\"darkblue\",\"width\":2},\"name\":\"Cart\",\"x\":[-0.2,0.2,0.2,-0.2,-0.2],\"y\":[1.125,1.125,1.275,1.275,1.125],\"type\":\"scatter\"},{\"line\":{\"color\":\"sienna\",\"width\":8},\"mode\":\"lines\",\"name\":\"Pole\",\"x\":[0.0,0.0],\"y\":[1.2,0.20000004768371582],\"type\":\"scatter\"},{\"marker\":{\"color\":\"sienna\",\"line\":{\"color\":\"black\",\"width\":1},\"size\":18},\"mode\":\"markers\",\"showlegend\":false,\"x\":[0.0],\"y\":[0.20000004768371582],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"showlegend\":false,\"x\":[-0.13333333333333333],\"y\":[1.075],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"showlegend\":false,\"x\":[0.13333333333333333],\"y\":[1.075],\"type\":\"scatter\"},{\"line\":{\"color\":\"gray\",\"width\":6},\"mode\":\"lines\",\"name\":\"Rail\",\"x\":[-2.5,2.5],\"y\":[1.025,1.025],\"type\":\"scatter\"}],                        {\"height\":500,\"margin\":{\"b\":100,\"t\":80},\"plot_bgcolor\":\"white\",\"showlegend\":false,\"sliders\":[{\"active\":0,\"currentvalue\":{\"offset\":20,\"prefix\":\"Time: \",\"suffix\":\"s\",\"visible\":true,\"xanchor\":\"center\"},\"len\":0.8,\"pad\":{\"b\":10,\"t\":60},\"steps\":[{\"args\":[[\"0\"],{\"frame\":{\"duration\":0,\"redraw\":true},\"mode\":\"immediate\",\"transition\":{\"duration\":0}}],\"label\":\"0.00\",\"method\":\"animate\"},{\"args\":[[\"2\"],{\"frame\":{\"duration\":0,\"redraw\":true},\"mode\":\"immediate\",\"transition\":{\"duration\":0}}],\"label\":\"0.10\",\"method\":\"animate\"},{\"args\":[[\"4\"],{\"frame\":{\"duration\":0,\"redraw\":true},\"mode\":\"immediate\",\"transition\":{\"duration\":0}}],\"label\":\"0.20\",\"method\":\"animate\"},{\"args\":[[\"6\"],{\"frame\":{\"duration\":0,\"redraw\":true},\"mode\":\"immediate\",\"transition\":{\"duration\":0}}],\"label\":\"0.30\",\"method\":\"animate\"},{\"args\":[[\"8\"],{\"frame\":{\"duration\":0,\"redraw\":true},\"mode\":\"immediate\",\"transition\":{\"duration\":0}}],\"label\":\"0.40\",\"method\":\"animate\"},{\"args\":[[\"10\"],{\"frame\":{\"duration\":0,\"redraw\":true},\"mode\":\"immediate\",\"transition\":{\"duration\":0}}],\"label\":\"0.50\",\"method\":\"animate\"},{\"args\":[[\"12\"],{\"frame\":{\"duration\":0,\"redraw\":true},\"mode\":\"immediate\",\"transition\":{\"duration\":0}}],\"label\":\"0.60\",\"method\":\"animate\"},{\"args\":[[\"14\"],{\"frame\":{\"duration\":0,\"redraw\":true},\"mode\":\"immediate\",\"transition\":{\"duration\":0}}],\"label\":\"0.70\",\"method\":\"animate\"},{\"args\":[[\"16\"],{\"frame\":{\"duration\":0,\"redraw\":true},\"mode\":\"immediate\",\"transition\":{\"duration\":0}}],\"label\":\"0.80\",\"method\":\"animate\"},{\"args\":[[\"18\"],{\"frame\":{\"duration\":0,\"redraw\":true},\"mode\":\"immediate\",\"transition\":{\"duration\":0}}],\"label\":\"0.90\",\"method\":\"animate\"},{\"args\":[[\"20\"],{\"frame\":{\"duration\":0,\"redraw\":true},\"mode\":\"immediate\",\"transition\":{\"duration\":0}}],\"label\":\"1.00\",\"method\":\"animate\"},{\"args\":[[\"22\"],{\"frame\":{\"duration\":0,\"redraw\":true},\"mode\":\"immediate\",\"transition\":{\"duration\":0}}],\"label\":\"1.10\",\"method\":\"animate\"},{\"args\":[[\"24\"],{\"frame\":{\"duration\":0,\"redraw\":true},\"mode\":\"immediate\",\"transition\":{\"duration\":0}}],\"label\":\"1.20\",\"method\":\"animate\"},{\"args\":[[\"26\"],{\"frame\":{\"duration\":0,\"redraw\":true},\"mode\":\"immediate\",\"transition\":{\"duration\":0}}],\"label\":\"1.30\",\"method\":\"animate\"},{\"args\":[[\"28\"],{\"frame\":{\"duration\":0,\"redraw\":true},\"mode\":\"immediate\",\"transition\":{\"duration\":0}}],\"label\":\"1.40\",\"method\":\"animate\"},{\"args\":[[\"30\"],{\"frame\":{\"duration\":0,\"redraw\":true},\"mode\":\"immediate\",\"transition\":{\"duration\":0}}],\"label\":\"1.50\",\"method\":\"animate\"},{\"args\":[[\"32\"],{\"frame\":{\"duration\":0,\"redraw\":true},\"mode\":\"immediate\",\"transition\":{\"duration\":0}}],\"label\":\"1.60\",\"method\":\"animate\"},{\"args\":[[\"34\"],{\"frame\":{\"duration\":0,\"redraw\":true},\"mode\":\"immediate\",\"transition\":{\"duration\":0}}],\"label\":\"1.70\",\"method\":\"animate\"},{\"args\":[[\"36\"],{\"frame\":{\"duration\":0,\"redraw\":true},\"mode\":\"immediate\",\"transition\":{\"duration\":0}}],\"label\":\"1.80\",\"method\":\"animate\"},{\"args\":[[\"38\"],{\"frame\":{\"duration\":0,\"redraw\":true},\"mode\":\"immediate\",\"transition\":{\"duration\":0}}],\"label\":\"1.90\",\"method\":\"animate\"},{\"args\":[[\"40\"],{\"frame\":{\"duration\":0,\"redraw\":true},\"mode\":\"immediate\",\"transition\":{\"duration\":0}}],\"label\":\"2.00\",\"method\":\"animate\"},{\"args\":[[\"42\"],{\"frame\":{\"duration\":0,\"redraw\":true},\"mode\":\"immediate\",\"transition\":{\"duration\":0}}],\"label\":\"2.10\",\"method\":\"animate\"},{\"args\":[[\"44\"],{\"frame\":{\"duration\":0,\"redraw\":true},\"mode\":\"immediate\",\"transition\":{\"duration\":0}}],\"label\":\"2.20\",\"method\":\"animate\"},{\"args\":[[\"46\"],{\"frame\":{\"duration\":0,\"redraw\":true},\"mode\":\"immediate\",\"transition\":{\"duration\":0}}],\"label\":\"2.30\",\"method\":\"animate\"},{\"args\":[[\"48\"],{\"frame\":{\"duration\":0,\"redraw\":true},\"mode\":\"immediate\",\"transition\":{\"duration\":0}}],\"label\":\"2.40\",\"method\":\"animate\"},{\"args\":[[\"50\"],{\"frame\":{\"duration\":0,\"redraw\":true},\"mode\":\"immediate\",\"transition\":{\"duration\":0}}],\"label\":\"2.50\",\"method\":\"animate\"},{\"args\":[[\"52\"],{\"frame\":{\"duration\":0,\"redraw\":true},\"mode\":\"immediate\",\"transition\":{\"duration\":0}}],\"label\":\"2.60\",\"method\":\"animate\"},{\"args\":[[\"54\"],{\"frame\":{\"duration\":0,\"redraw\":true},\"mode\":\"immediate\",\"transition\":{\"duration\":0}}],\"label\":\"2.70\",\"method\":\"animate\"},{\"args\":[[\"56\"],{\"frame\":{\"duration\":0,\"redraw\":true},\"mode\":\"immediate\",\"transition\":{\"duration\":0}}],\"label\":\"2.80\",\"method\":\"animate\"},{\"args\":[[\"58\"],{\"frame\":{\"duration\":0,\"redraw\":true},\"mode\":\"immediate\",\"transition\":{\"duration\":0}}],\"label\":\"2.90\",\"method\":\"animate\"},{\"args\":[[\"60\"],{\"frame\":{\"duration\":0,\"redraw\":true},\"mode\":\"immediate\",\"transition\":{\"duration\":0}}],\"label\":\"3.00\",\"method\":\"animate\"}],\"x\":0.1,\"xanchor\":\"left\",\"y\":0,\"yanchor\":\"top\"}],\"title\":{\"text\":\"Cart-Pole (Shooting)\"},\"updatemenus\":[{\"buttons\":[{\"args\":[null,{\"frame\":{\"duration\":50,\"redraw\":true},\"fromcurrent\":true,\"transition\":{\"duration\":0}}],\"label\":\"Play\",\"method\":\"animate\"},{\"args\":[[null],{\"frame\":{\"duration\":0,\"redraw\":false},\"mode\":\"immediate\"}],\"label\":\"Pause\",\"method\":\"animate\"}],\"showactive\":false,\"type\":\"buttons\",\"x\":0.5,\"xanchor\":\"center\",\"y\":1.15}],\"xaxis\":{\"constrain\":\"domain\",\"range\":[-2.5,2.5],\"showgrid\":false,\"title\":{\"text\":\"x (m)\"}},\"yaxis\":{\"range\":[-0.1,2.5],\"scaleanchor\":\"x\",\"scaleratio\":1,\"showgrid\":false,\"title\":{\"text\":\"y (m)\"}},\"template\":{\"data\":{\"histogram2dcontour\":[{\"type\":\"histogram2dcontour\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"choropleth\":[{\"type\":\"choropleth\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}],\"histogram2d\":[{\"type\":\"histogram2d\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"heatmap\":[{\"type\":\"heatmap\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"contourcarpet\":[{\"type\":\"contourcarpet\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}],\"contour\":[{\"type\":\"contour\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"surface\":[{\"type\":\"surface\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"mesh3d\":[{\"type\":\"mesh3d\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}],\"scatter\":[{\"fillpattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2},\"type\":\"scatter\"}],\"parcoords\":[{\"type\":\"parcoords\",\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scatterpolargl\":[{\"type\":\"scatterpolargl\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"bar\":[{\"error_x\":{\"color\":\"#2a3f5f\"},\"error_y\":{\"color\":\"#2a3f5f\"},\"marker\":{\"line\":{\"color\":\"#E5ECF6\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"bar\"}],\"scattergeo\":[{\"type\":\"scattergeo\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scatterpolar\":[{\"type\":\"scatterpolar\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"histogram\":[{\"marker\":{\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"histogram\"}],\"scattergl\":[{\"type\":\"scattergl\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scatter3d\":[{\"type\":\"scatter3d\",\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scattermap\":[{\"type\":\"scattermap\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scattermapbox\":[{\"type\":\"scattermapbox\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scatterternary\":[{\"type\":\"scatterternary\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scattercarpet\":[{\"type\":\"scattercarpet\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"carpet\":[{\"aaxis\":{\"endlinecolor\":\"#2a3f5f\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"minorgridcolor\":\"white\",\"startlinecolor\":\"#2a3f5f\"},\"baxis\":{\"endlinecolor\":\"#2a3f5f\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"minorgridcolor\":\"white\",\"startlinecolor\":\"#2a3f5f\"},\"type\":\"carpet\"}],\"table\":[{\"cells\":{\"fill\":{\"color\":\"#EBF0F8\"},\"line\":{\"color\":\"white\"}},\"header\":{\"fill\":{\"color\":\"#C8D4E3\"},\"line\":{\"color\":\"white\"}},\"type\":\"table\"}],\"barpolar\":[{\"marker\":{\"line\":{\"color\":\"#E5ECF6\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"barpolar\"}],\"pie\":[{\"automargin\":true,\"type\":\"pie\"}]},\"layout\":{\"autotypenumbers\":\"strict\",\"colorway\":[\"#636efa\",\"#EF553B\",\"#00cc96\",\"#ab63fa\",\"#FFA15A\",\"#19d3f3\",\"#FF6692\",\"#B6E880\",\"#FF97FF\",\"#FECB52\"],\"font\":{\"color\":\"#2a3f5f\"},\"hovermode\":\"closest\",\"hoverlabel\":{\"align\":\"left\"},\"paper_bgcolor\":\"white\",\"plot_bgcolor\":\"#E5ECF6\",\"polar\":{\"bgcolor\":\"#E5ECF6\",\"angularaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"},\"radialaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"}},\"ternary\":{\"bgcolor\":\"#E5ECF6\",\"aaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"},\"baxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"},\"caxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"}},\"coloraxis\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"colorscale\":{\"sequential\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"sequentialminus\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"diverging\":[[0,\"#8e0152\"],[0.1,\"#c51b7d\"],[0.2,\"#de77ae\"],[0.3,\"#f1b6da\"],[0.4,\"#fde0ef\"],[0.5,\"#f7f7f7\"],[0.6,\"#e6f5d0\"],[0.7,\"#b8e186\"],[0.8,\"#7fbc41\"],[0.9,\"#4d9221\"],[1,\"#276419\"]]},\"xaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"white\",\"automargin\":true,\"zerolinewidth\":2},\"yaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"white\",\"automargin\":true,\"zerolinewidth\":2},\"scene\":{\"xaxis\":{\"backgroundcolor\":\"#E5ECF6\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"white\",\"gridwidth\":2},\"yaxis\":{\"backgroundcolor\":\"#E5ECF6\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"white\",\"gridwidth\":2},\"zaxis\":{\"backgroundcolor\":\"#E5ECF6\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"white\",\"gridwidth\":2}},\"shapedefaults\":{\"line\":{\"color\":\"#2a3f5f\"}},\"annotationdefaults\":{\"arrowcolor\":\"#2a3f5f\",\"arrowhead\":0,\"arrowwidth\":1},\"geo\":{\"bgcolor\":\"white\",\"landcolor\":\"#E5ECF6\",\"subunitcolor\":\"white\",\"showland\":true,\"showlakes\":true,\"lakecolor\":\"white\"},\"title\":{\"x\":0.05},\"mapbox\":{\"style\":\"light\"}}}},                        {\"responsive\": true}                    ).then(function(){\n",
       "                            Plotly.addFrames('dc059bb9-478b-4300-a96f-177886c3a013', [{\"data\":[{\"fill\":\"toself\",\"fillcolor\":\"steelblue\",\"line\":{\"color\":\"darkblue\",\"width\":2},\"x\":[-0.2,0.2,0.2,-0.2,-0.2],\"y\":[1.125,1.125,1.275,1.275,1.125],\"type\":\"scatter\"},{\"line\":{\"color\":\"sienna\",\"width\":8},\"mode\":\"lines\",\"x\":[0.0,0.0],\"y\":[1.2,0.20000004768371582],\"type\":\"scatter\"},{\"marker\":{\"color\":\"sienna\",\"line\":{\"color\":\"black\",\"width\":1},\"size\":18},\"mode\":\"markers\",\"x\":[0.0],\"y\":[0.20000004768371582],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-0.13333333333333333],\"y\":[1.075],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[0.13333333333333333],\"y\":[1.075],\"type\":\"scatter\"}],\"name\":\"0\"},{\"data\":[{\"fill\":\"toself\",\"fillcolor\":\"steelblue\",\"line\":{\"color\":\"darkblue\",\"width\":2},\"x\":[-0.27110124081373216,0.12889875918626786,0.12889875918626786,-0.27110124081373216,-0.27110124081373216],\"y\":[1.125,1.125,1.275,1.275,1.125],\"type\":\"scatter\"},{\"line\":{\"color\":\"sienna\",\"width\":8},\"mode\":\"lines\",\"x\":[-0.07110124081373215,0.033966414630413055],\"y\":[1.2,0.20553499460220337],\"type\":\"scatter\"},{\"marker\":{\"color\":\"sienna\",\"line\":{\"color\":\"black\",\"width\":1},\"size\":18},\"mode\":\"markers\",\"x\":[0.033966414630413055],\"y\":[0.20553499460220337],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-0.20443457414706548],\"y\":[1.075],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[0.062232092519601184],\"y\":[1.075],\"type\":\"scatter\"}],\"name\":\"2\"},{\"data\":[{\"fill\":\"toself\",\"fillcolor\":\"steelblue\",\"line\":{\"color\":\"darkblue\",\"width\":2},\"x\":[-0.44715398252010347,-0.047153982520103443,-0.047153982520103443,-0.44715398252010347,-0.44715398252010347],\"y\":[1.125,1.125,1.275,1.275,1.125],\"type\":\"scatter\"},{\"line\":{\"color\":\"sienna\",\"width\":8},\"mode\":\"lines\",\"x\":[-0.24715398252010345,0.09542183578014374],\"y\":[1.2,0.2605098485946655],\"type\":\"scatter\"},{\"marker\":{\"color\":\"sienna\",\"line\":{\"color\":\"black\",\"width\":1},\"size\":18},\"mode\":\"markers\",\"x\":[0.09542183578014374],\"y\":[0.2605098485946655],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-0.38048731585343676],\"y\":[1.075],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-0.11382064918677012],\"y\":[1.075],\"type\":\"scatter\"}],\"name\":\"4\"},{\"data\":[{\"fill\":\"toself\",\"fillcolor\":\"steelblue\",\"line\":{\"color\":\"darkblue\",\"width\":2},\"x\":[-0.6723605513572692,-0.2723605513572693,-0.2723605513572693,-0.6723605513572692,-0.6723605513572692],\"y\":[1.125,1.125,1.275,1.275,1.125],\"type\":\"scatter\"},{\"line\":{\"color\":\"sienna\",\"width\":8},\"mode\":\"lines\",\"x\":[-0.4723605513572693,0.10350030660629272],\"y\":[1.2,0.3824523687362671],\"type\":\"scatter\"},{\"marker\":{\"color\":\"sienna\",\"line\":{\"color\":\"black\",\"width\":1},\"size\":18},\"mode\":\"markers\",\"x\":[0.10350030660629272],\"y\":[0.3824523687362671],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-0.6056938846906026],\"y\":[1.075],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-0.339027218023936],\"y\":[1.075],\"type\":\"scatter\"}],\"name\":\"6\"},{\"data\":[{\"fill\":\"toself\",\"fillcolor\":\"steelblue\",\"line\":{\"color\":\"darkblue\",\"width\":2},\"x\":[-0.910197627544403,-0.5101976275444031,-0.5101976275444031,-0.910197627544403,-0.910197627544403],\"y\":[1.125,1.125,1.275,1.275,1.125],\"type\":\"scatter\"},{\"line\":{\"color\":\"sienna\",\"width\":8},\"mode\":\"lines\",\"x\":[-0.7101976275444031,0.014284133911132812],\"y\":[1.2,0.5107060670852661],\"type\":\"scatter\"},{\"marker\":{\"color\":\"sienna\",\"line\":{\"color\":\"black\",\"width\":1},\"size\":18},\"mode\":\"markers\",\"x\":[0.014284133911132812],\"y\":[0.5107060670852661],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-0.8435309608777364],\"y\":[1.075],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-0.5768642942110698],\"y\":[1.075],\"type\":\"scatter\"}],\"name\":\"8\"},{\"data\":[{\"fill\":\"toself\",\"fillcolor\":\"steelblue\",\"line\":{\"color\":\"darkblue\",\"width\":2},\"x\":[-1.1456964135169982,-0.7456964135169983,-0.7456964135169983,-1.1456964135169982,-1.1456964135169982],\"y\":[1.125,1.125,1.275,1.275,1.125],\"type\":\"scatter\"},{\"line\":{\"color\":\"sienna\",\"width\":8},\"mode\":\"lines\",\"x\":[-0.9456964135169983,-0.16286879777908325],\"y\":[1.2,0.5777614116668701],\"type\":\"scatter\"},{\"marker\":{\"color\":\"sienna\",\"line\":{\"color\":\"black\",\"width\":1},\"size\":18},\"mode\":\"markers\",\"x\":[-0.16286879777908325],\"y\":[0.5777614116668701],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-1.0790297468503316],\"y\":[1.075],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-0.812363080183665],\"y\":[1.075],\"type\":\"scatter\"}],\"name\":\"10\"},{\"data\":[{\"fill\":\"toself\",\"fillcolor\":\"steelblue\",\"line\":{\"color\":\"darkblue\",\"width\":2},\"x\":[-1.3712768077850341,-0.9712768077850342,-0.9712768077850342,-1.3712768077850341,-1.3712768077850341],\"y\":[1.125,1.125,1.275,1.275,1.125],\"type\":\"scatter\"},{\"line\":{\"color\":\"sienna\",\"width\":8},\"mode\":\"lines\",\"x\":[-1.1712768077850342,-0.4104740023612976],\"y\":[1.2,0.5510169267654419],\"type\":\"scatter\"},{\"marker\":{\"color\":\"sienna\",\"line\":{\"color\":\"black\",\"width\":1},\"size\":18},\"mode\":\"markers\",\"x\":[-0.4104740023612976],\"y\":[0.5510169267654419],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-1.3046101411183675],\"y\":[1.075],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-1.0379434744517009],\"y\":[1.075],\"type\":\"scatter\"}],\"name\":\"12\"},{\"data\":[{\"fill\":\"toself\",\"fillcolor\":\"steelblue\",\"line\":{\"color\":\"darkblue\",\"width\":2},\"x\":[-1.5741941452026367,-1.1741941452026368,-1.1741941452026368,-1.5741941452026367,-1.5741941452026367],\"y\":[1.125,1.125,1.275,1.275,1.125],\"type\":\"scatter\"},{\"line\":{\"color\":\"sienna\",\"width\":8},\"mode\":\"lines\",\"x\":[-1.3741941452026367,-0.7326942682266235],\"y\":[1.2,0.4328768849372864],\"type\":\"scatter\"},{\"marker\":{\"color\":\"sienna\",\"line\":{\"color\":\"black\",\"width\":1},\"size\":18},\"mode\":\"markers\",\"x\":[-0.7326942682266235],\"y\":[0.4328768849372864],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-1.50752747853597],\"y\":[1.075],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-1.2408608118693034],\"y\":[1.075],\"type\":\"scatter\"}],\"name\":\"14\"},{\"data\":[{\"fill\":\"toself\",\"fillcolor\":\"steelblue\",\"line\":{\"color\":\"darkblue\",\"width\":2},\"x\":[-1.7326247215270996,-1.3326247215270997,-1.3326247215270997,-1.7326247215270996,-1.7326247215270996],\"y\":[1.125,1.125,1.275,1.275,1.125],\"type\":\"scatter\"},{\"line\":{\"color\":\"sienna\",\"width\":8},\"mode\":\"lines\",\"x\":[-1.5326247215270996,-1.1585540771484375],\"y\":[1.2,0.27259987592697144],\"type\":\"scatter\"},{\"marker\":{\"color\":\"sienna\",\"line\":{\"color\":\"black\",\"width\":1},\"size\":18},\"mode\":\"markers\",\"x\":[-1.1585540771484375],\"y\":[0.27259987592697144],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-1.665958054860433],\"y\":[1.075],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-1.3992913881937663],\"y\":[1.075],\"type\":\"scatter\"}],\"name\":\"16\"},{\"data\":[{\"fill\":\"toself\",\"fillcolor\":\"steelblue\",\"line\":{\"color\":\"darkblue\",\"width\":2},\"x\":[-1.8241450309753418,-1.4241450309753418,-1.4241450309753418,-1.8241450309753418,-1.8241450309753418],\"y\":[1.125,1.125,1.275,1.275,1.125],\"type\":\"scatter\"},{\"line\":{\"color\":\"sienna\",\"width\":8},\"mode\":\"lines\",\"x\":[-1.6241450309753418,-1.699370265007019],\"y\":[1.2,0.20283347368240356],\"type\":\"scatter\"},{\"marker\":{\"color\":\"sienna\",\"line\":{\"color\":\"black\",\"width\":1},\"size\":18},\"mode\":\"markers\",\"x\":[-1.699370265007019],\"y\":[0.20283347368240356],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-1.757478364308675],\"y\":[1.075],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-1.4908116976420085],\"y\":[1.075],\"type\":\"scatter\"}],\"name\":\"18\"},{\"data\":[{\"fill\":\"toself\",\"fillcolor\":\"steelblue\",\"line\":{\"color\":\"darkblue\",\"width\":2},\"x\":[-1.849120807647705,-1.4491208076477051,-1.4491208076477051,-1.849120807647705,-1.849120807647705],\"y\":[1.125,1.125,1.275,1.275,1.125],\"type\":\"scatter\"},{\"line\":{\"color\":\"sienna\",\"width\":8},\"mode\":\"lines\",\"x\":[-1.649120807647705,-2.229994773864746],\"y\":[1.2,0.3860066533088684],\"type\":\"scatter\"},{\"marker\":{\"color\":\"sienna\",\"line\":{\"color\":\"black\",\"width\":1},\"size\":18},\"mode\":\"markers\",\"x\":[-2.229994773864746],\"y\":[0.3860066533088684],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-1.7824541409810384],\"y\":[1.075],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-1.5157874743143718],\"y\":[1.075],\"type\":\"scatter\"}],\"name\":\"20\"},{\"data\":[{\"fill\":\"toself\",\"fillcolor\":\"steelblue\",\"line\":{\"color\":\"darkblue\",\"width\":2},\"x\":[-1.8417672634124755,-1.4417672634124756,-1.4417672634124756,-1.8417672634124755,-1.8417672634124755],\"y\":[1.125,1.125,1.275,1.275,1.125],\"type\":\"scatter\"},{\"line\":{\"color\":\"sienna\",\"width\":8},\"mode\":\"lines\",\"x\":[-1.6417672634124756,-2.543241500854492],\"y\":[1.2,0.7671675682067871],\"type\":\"scatter\"},{\"marker\":{\"color\":\"sienna\",\"line\":{\"color\":\"black\",\"width\":1},\"size\":18},\"mode\":\"markers\",\"x\":[-2.543241500854492],\"y\":[0.7671675682067871],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-1.775100596745809],\"y\":[1.075],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-1.5084339300791423],\"y\":[1.075],\"type\":\"scatter\"}],\"name\":\"22\"},{\"data\":[{\"fill\":\"toself\",\"fillcolor\":\"steelblue\",\"line\":{\"color\":\"darkblue\",\"width\":2},\"x\":[-1.8352688074111938,-1.435268807411194,-1.435268807411194,-1.8352688074111938,-1.8352688074111938],\"y\":[1.125,1.125,1.275,1.275,1.125],\"type\":\"scatter\"},{\"line\":{\"color\":\"sienna\",\"width\":8},\"mode\":\"lines\",\"x\":[-1.6352688074111938,-2.6326236724853516],\"y\":[1.2,1.1273152828216553],\"type\":\"scatter\"},{\"marker\":{\"color\":\"sienna\",\"line\":{\"color\":\"black\",\"width\":1},\"size\":18},\"mode\":\"markers\",\"x\":[-2.6326236724853516],\"y\":[1.1273152828216553],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-1.7686021407445272],\"y\":[1.075],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-1.5019354740778605],\"y\":[1.075],\"type\":\"scatter\"}],\"name\":\"24\"},{\"data\":[{\"fill\":\"toself\",\"fillcolor\":\"steelblue\",\"line\":{\"color\":\"darkblue\",\"width\":2},\"x\":[-1.8308372020721435,-1.4308372020721436,-1.4308372020721436,-1.8308372020721435,-1.8308372020721435],\"y\":[1.125,1.125,1.275,1.275,1.125],\"type\":\"scatter\"},{\"line\":{\"color\":\"sienna\",\"width\":8},\"mode\":\"lines\",\"x\":[-1.6308372020721436,-2.6188061237335205],\"y\":[1.2,1.3546521663665771],\"type\":\"scatter\"},{\"marker\":{\"color\":\"sienna\",\"line\":{\"color\":\"black\",\"width\":1},\"size\":18},\"mode\":\"markers\",\"x\":[-2.6188061237335205],\"y\":[1.3546521663665771],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-1.7641705354054769],\"y\":[1.075],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-1.4975038687388103],\"y\":[1.075],\"type\":\"scatter\"}],\"name\":\"26\"},{\"data\":[{\"fill\":\"toself\",\"fillcolor\":\"steelblue\",\"line\":{\"color\":\"darkblue\",\"width\":2},\"x\":[-1.8020874977111816,-1.4020874977111817,-1.4020874977111817,-1.8020874977111816,-1.8020874977111816],\"y\":[1.125,1.125,1.275,1.275,1.125],\"type\":\"scatter\"},{\"line\":{\"color\":\"sienna\",\"width\":8},\"mode\":\"lines\",\"x\":[-1.6020874977111816,-2.575418472290039],\"y\":[1.2,1.4294053316116333],\"type\":\"scatter\"},{\"marker\":{\"color\":\"sienna\",\"line\":{\"color\":\"black\",\"width\":1},\"size\":18},\"mode\":\"markers\",\"x\":[-2.575418472290039],\"y\":[1.4294053316116333],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-1.735420831044515],\"y\":[1.075],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-1.4687541643778483],\"y\":[1.075],\"type\":\"scatter\"}],\"name\":\"28\"},{\"data\":[{\"fill\":\"toself\",\"fillcolor\":\"steelblue\",\"line\":{\"color\":\"darkblue\",\"width\":2},\"x\":[-1.7137094259262085,-1.3137094259262085,-1.3137094259262085,-1.7137094259262085,-1.7137094259262085],\"y\":[1.125,1.125,1.275,1.275,1.125],\"type\":\"scatter\"},{\"line\":{\"color\":\"sienna\",\"width\":8},\"mode\":\"lines\",\"x\":[-1.5137094259262085,-2.5032618045806885],\"y\":[1.2,1.3441734313964844],\"type\":\"scatter\"},{\"marker\":{\"color\":\"sienna\",\"line\":{\"color\":\"black\",\"width\":1},\"size\":18},\"mode\":\"markers\",\"x\":[-2.5032618045806885],\"y\":[1.3441734313964844],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-1.6470427592595418],\"y\":[1.075],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-1.3803760925928752],\"y\":[1.075],\"type\":\"scatter\"}],\"name\":\"30\"},{\"data\":[{\"fill\":\"toself\",\"fillcolor\":\"steelblue\",\"line\":{\"color\":\"darkblue\",\"width\":2},\"x\":[-1.546828818321228,-1.146828818321228,-1.146828818321228,-1.546828818321228,-1.546828818321228],\"y\":[1.125,1.125,1.275,1.275,1.125],\"type\":\"scatter\"},{\"line\":{\"color\":\"sienna\",\"width\":8},\"mode\":\"lines\",\"x\":[-1.346828818321228,-2.341526508331299],\"y\":[1.2,1.09715735912323],\"type\":\"scatter\"},{\"marker\":{\"color\":\"sienna\",\"line\":{\"color\":\"black\",\"width\":1},\"size\":18},\"mode\":\"markers\",\"x\":[-2.341526508331299],\"y\":[1.09715735912323],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-1.4801621516545613],\"y\":[1.075],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-1.2134954849878947],\"y\":[1.075],\"type\":\"scatter\"}],\"name\":\"32\"},{\"data\":[{\"fill\":\"toself\",\"fillcolor\":\"steelblue\",\"line\":{\"color\":\"darkblue\",\"width\":2},\"x\":[-1.323206615447998,-0.9232066154479981,-0.9232066154479981,-1.323206615447998,-1.323206615447998],\"y\":[1.125,1.125,1.275,1.275,1.125],\"type\":\"scatter\"},{\"line\":{\"color\":\"sienna\",\"width\":8},\"mode\":\"lines\",\"x\":[-1.123206615447998,-2.005699396133423],\"y\":[1.2,0.7296741008758545],\"type\":\"scatter\"},{\"marker\":{\"color\":\"sienna\",\"line\":{\"color\":\"black\",\"width\":1},\"size\":18},\"mode\":\"markers\",\"x\":[-2.005699396133423],\"y\":[0.7296741008758545],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-1.2565399487813314],\"y\":[1.075],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-0.9898732821146647],\"y\":[1.075],\"type\":\"scatter\"}],\"name\":\"34\"},{\"data\":[{\"fill\":\"toself\",\"fillcolor\":\"steelblue\",\"line\":{\"color\":\"darkblue\",\"width\":2},\"x\":[-1.1043102860450744,-0.7043102860450745,-0.7043102860450745,-1.1043102860450744,-1.1043102860450744],\"y\":[1.125,1.125,1.275,1.275,1.125],\"type\":\"scatter\"},{\"line\":{\"color\":\"sienna\",\"width\":8},\"mode\":\"lines\",\"x\":[-0.9043102860450745,-1.433077096939087],\"y\":[1.2,0.35123294591903687],\"type\":\"scatter\"},{\"marker\":{\"color\":\"sienna\",\"line\":{\"color\":\"black\",\"width\":1},\"size\":18},\"mode\":\"markers\",\"x\":[-1.433077096939087],\"y\":[0.35123294591903687],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-1.0376436193784078],\"y\":[1.075],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-0.7709769527117412],\"y\":[1.075],\"type\":\"scatter\"}],\"name\":\"36\"},{\"data\":[{\"fill\":\"toself\",\"fillcolor\":\"steelblue\",\"line\":{\"color\":\"darkblue\",\"width\":2},\"x\":[-0.9554487586021423,-0.5554487586021424,-0.5554487586021424,-0.9554487586021423,-0.9554487586021423],\"y\":[1.125,1.125,1.275,1.275,1.125],\"type\":\"scatter\"},{\"line\":{\"color\":\"sienna\",\"width\":8},\"mode\":\"lines\",\"x\":[-0.7554487586021423,-0.6242251396179199],\"y\":[1.2,0.2086472511291504],\"type\":\"scatter\"},{\"marker\":{\"color\":\"sienna\",\"line\":{\"color\":\"black\",\"width\":1},\"size\":18},\"mode\":\"markers\",\"x\":[-0.6242251396179199],\"y\":[0.2086472511291504],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-0.8887820919354756],\"y\":[1.075],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-0.622115425268809],\"y\":[1.075],\"type\":\"scatter\"}],\"name\":\"38\"},{\"data\":[{\"fill\":\"toself\",\"fillcolor\":\"steelblue\",\"line\":{\"color\":\"darkblue\",\"width\":2},\"x\":[-0.8792402863502502,-0.47924028635025023,-0.47924028635025023,-0.8792402863502502,-0.8792402863502502],\"y\":[1.125,1.125,1.275,1.275,1.125],\"type\":\"scatter\"},{\"line\":{\"color\":\"sienna\",\"width\":8},\"mode\":\"lines\",\"x\":[-0.6792402863502502,0.10777086019515991],\"y\":[1.2,0.5830612182617188],\"type\":\"scatter\"},{\"marker\":{\"color\":\"sienna\",\"line\":{\"color\":\"black\",\"width\":1},\"size\":18},\"mode\":\"markers\",\"x\":[0.10777086019515991],\"y\":[0.5830612182617188],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-0.8125736196835835],\"y\":[1.075],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-0.5459069530169169],\"y\":[1.075],\"type\":\"scatter\"}],\"name\":\"40\"},{\"data\":[{\"fill\":\"toself\",\"fillcolor\":\"steelblue\",\"line\":{\"color\":\"darkblue\",\"width\":2},\"x\":[-0.7991539359092712,-0.39915393590927123,-0.39915393590927123,-0.7991539359092712,-0.7991539359092712],\"y\":[1.125,1.125,1.275,1.275,1.125],\"type\":\"scatter\"},{\"line\":{\"color\":\"sienna\",\"width\":8},\"mode\":\"lines\",\"x\":[-0.5991539359092712,0.4008137583732605],\"y\":[1.2,1.2080378532409668],\"type\":\"scatter\"},{\"marker\":{\"color\":\"sienna\",\"line\":{\"color\":\"black\",\"width\":1},\"size\":18},\"mode\":\"markers\",\"x\":[0.4008137583732605],\"y\":[1.2080378532409668],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-0.7324872692426045],\"y\":[1.075],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-0.46582060257593794],\"y\":[1.075],\"type\":\"scatter\"}],\"name\":\"42\"},{\"data\":[{\"fill\":\"toself\",\"fillcolor\":\"steelblue\",\"line\":{\"color\":\"darkblue\",\"width\":2},\"x\":[-0.6570401608943939,-0.2570401608943939,-0.2570401608943939,-0.6570401608943939,-0.6570401608943939],\"y\":[1.125,1.125,1.275,1.275,1.125],\"type\":\"scatter\"},{\"line\":{\"color\":\"sienna\",\"width\":8},\"mode\":\"lines\",\"x\":[-0.4570401608943939,0.3998599946498871],\"y\":[1.2,1.715482473373413],\"type\":\"scatter\"},{\"marker\":{\"color\":\"sienna\",\"line\":{\"color\":\"black\",\"width\":1},\"size\":18},\"mode\":\"markers\",\"x\":[0.3998599946498871],\"y\":[1.715482473373413],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-0.5903734942277272],\"y\":[1.075],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-0.3237068275610606],\"y\":[1.075],\"type\":\"scatter\"}],\"name\":\"44\"},{\"data\":[{\"fill\":\"toself\",\"fillcolor\":\"steelblue\",\"line\":{\"color\":\"darkblue\",\"width\":2},\"x\":[-0.461621356010437,-0.061621356010437,-0.061621356010437,-0.461621356010437,-0.461621356010437],\"y\":[1.125,1.125,1.275,1.275,1.125],\"type\":\"scatter\"},{\"line\":{\"color\":\"sienna\",\"width\":8},\"mode\":\"lines\",\"x\":[-0.261621356010437,0.28962886333465576],\"y\":[1.2,2.0343399047851562],\"type\":\"scatter\"},{\"marker\":{\"color\":\"sienna\",\"line\":{\"color\":\"black\",\"width\":1},\"size\":18},\"mode\":\"markers\",\"x\":[0.28962886333465576],\"y\":[2.0343399047851562],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-0.3949546893437703],\"y\":[1.075],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-0.12828802267710368],\"y\":[1.075],\"type\":\"scatter\"}],\"name\":\"46\"},{\"data\":[{\"fill\":\"toself\",\"fillcolor\":\"steelblue\",\"line\":{\"color\":\"darkblue\",\"width\":2},\"x\":[-0.2749558210372925,0.12504417896270753,0.12504417896270753,-0.2749558210372925,-0.2749558210372925],\"y\":[1.125,1.125,1.275,1.275,1.125],\"type\":\"scatter\"},{\"line\":{\"color\":\"sienna\",\"width\":8},\"mode\":\"lines\",\"x\":[-0.07495582103729248,0.15754705667495728],\"y\":[1.2,2.172595739364624],\"type\":\"scatter\"},{\"marker\":{\"color\":\"sienna\",\"line\":{\"color\":\"black\",\"width\":1},\"size\":18},\"mode\":\"markers\",\"x\":[0.15754705667495728],\"y\":[2.172595739364624],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-0.2082891543706258],\"y\":[1.075],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[0.05837751229604085],\"y\":[1.075],\"type\":\"scatter\"}],\"name\":\"48\"},{\"data\":[{\"fill\":\"toself\",\"fillcolor\":\"steelblue\",\"line\":{\"color\":\"darkblue\",\"width\":2},\"x\":[-0.18408348672091962,0.2159165132790804,0.2159165132790804,-0.18408348672091962,-0.18408348672091962],\"y\":[1.125,1.125,1.275,1.275,1.125],\"type\":\"scatter\"},{\"line\":{\"color\":\"sienna\",\"width\":8},\"mode\":\"lines\",\"x\":[0.01591651327908039,0.07737202942371368],\"y\":[1.2,2.1981098651885986],\"type\":\"scatter\"},{\"marker\":{\"color\":\"sienna\",\"line\":{\"color\":\"black\",\"width\":1},\"size\":18},\"mode\":\"markers\",\"x\":[0.07737202942371368],\"y\":[2.1981098651885986],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-0.11741682005425294],\"y\":[1.075],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[0.14924984661241372],\"y\":[1.075],\"type\":\"scatter\"}],\"name\":\"50\"},{\"data\":[{\"fill\":\"toself\",\"fillcolor\":\"steelblue\",\"line\":{\"color\":\"darkblue\",\"width\":2},\"x\":[-0.1829707033932209,0.2170292966067791,0.2170292966067791,-0.1829707033932209,-0.1829707033932209],\"y\":[1.125,1.125,1.275,1.275,1.125],\"type\":\"scatter\"},{\"line\":{\"color\":\"sienna\",\"width\":8},\"mode\":\"lines\",\"x\":[0.0170292966067791,0.05030105635523796],\"y\":[1.2,2.199446439743042],\"type\":\"scatter\"},{\"marker\":{\"color\":\"sienna\",\"line\":{\"color\":\"black\",\"width\":1},\"size\":18},\"mode\":\"markers\",\"x\":[0.05030105635523796],\"y\":[2.199446439743042],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-0.11630403672655423],\"y\":[1.075],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[0.15036262994011243],\"y\":[1.075],\"type\":\"scatter\"}],\"name\":\"52\"},{\"data\":[{\"fill\":\"toself\",\"fillcolor\":\"steelblue\",\"line\":{\"color\":\"darkblue\",\"width\":2},\"x\":[-0.18844784125685693,0.2115521587431431,0.2115521587431431,-0.18844784125685693,-0.18844784125685693],\"y\":[1.125,1.125,1.275,1.275,1.125],\"type\":\"scatter\"},{\"line\":{\"color\":\"sienna\",\"width\":8},\"mode\":\"lines\",\"x\":[0.011552158743143082,0.03152187541127205],\"y\":[1.2,2.199800491333008],\"type\":\"scatter\"},{\"marker\":{\"color\":\"sienna\",\"line\":{\"color\":\"black\",\"width\":1},\"size\":18},\"mode\":\"markers\",\"x\":[0.03152187541127205],\"y\":[2.199800491333008],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-0.12178117459019025],\"y\":[1.075],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[0.1448854920764764],\"y\":[1.075],\"type\":\"scatter\"}],\"name\":\"54\"},{\"data\":[{\"fill\":\"toself\",\"fillcolor\":\"steelblue\",\"line\":{\"color\":\"darkblue\",\"width\":2},\"x\":[-0.19365940177813173,0.2063405982218683,0.2063405982218683,-0.19365940177813173,-0.19365940177813173],\"y\":[1.125,1.125,1.275,1.275,1.125],\"type\":\"scatter\"},{\"line\":{\"color\":\"sienna\",\"width\":8},\"mode\":\"lines\",\"x\":[0.006340598221868277,0.015574092045426369],\"y\":[1.2,2.1999573707580566],\"type\":\"scatter\"},{\"marker\":{\"color\":\"sienna\",\"line\":{\"color\":\"black\",\"width\":1},\"size\":18},\"mode\":\"markers\",\"x\":[0.015574092045426369],\"y\":[2.1999573707580566],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-0.12699273511146505],\"y\":[1.075],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[0.1396739315552016],\"y\":[1.075],\"type\":\"scatter\"}],\"name\":\"56\"},{\"data\":[{\"fill\":\"toself\",\"fillcolor\":\"steelblue\",\"line\":{\"color\":\"darkblue\",\"width\":2},\"x\":[-0.19827558046672494,0.20172441953327508,0.20172441953327508,-0.19827558046672494,-0.19827558046672494],\"y\":[1.125,1.125,1.275,1.275,1.125],\"type\":\"scatter\"},{\"line\":{\"color\":\"sienna\",\"width\":8},\"mode\":\"lines\",\"x\":[0.0017244195332750678,0.0006919798906892538],\"y\":[1.2,2.1999995708465576],\"type\":\"scatter\"},{\"marker\":{\"color\":\"sienna\",\"line\":{\"color\":\"black\",\"width\":1},\"size\":18},\"mode\":\"markers\",\"x\":[0.0006919798906892538],\"y\":[2.1999995708465576],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-0.13160891380005826],\"y\":[1.075],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[0.1350577528666084],\"y\":[1.075],\"type\":\"scatter\"}],\"name\":\"58\"},{\"data\":[{\"fill\":\"toself\",\"fillcolor\":\"steelblue\",\"line\":{\"color\":\"darkblue\",\"width\":2},\"x\":[-0.20271008396521212,0.1972899160347879,0.1972899160347879,-0.20271008396521212,-0.20271008396521212],\"y\":[1.125,1.125,1.275,1.275,1.125],\"type\":\"scatter\"},{\"line\":{\"color\":\"sienna\",\"width\":8},\"mode\":\"lines\",\"x\":[-0.0027100839652121067,-0.014440812170505524],\"y\":[1.2,2.1999311447143555],\"type\":\"scatter\"},{\"marker\":{\"color\":\"sienna\",\"line\":{\"color\":\"black\",\"width\":1},\"size\":18},\"mode\":\"markers\",\"x\":[-0.014440812170505524],\"y\":[2.1999311447143555],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-0.13604341729854544],\"y\":[1.075],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[0.13062324936812122],\"y\":[1.075],\"type\":\"scatter\"}],\"name\":\"60\"}]);\n",
       "                        })                };            </script>        </div>"
      ],
      "text/plain": [
       "<IPython.core.display.HTML object>"
      ]
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "import plotly.graph_objects as go\n",
    "from plotly.subplots import make_subplots\n",
    "from IPython.display import HTML\n",
    "\n",
    "# Animation of cart-pole swing-up.\n",
    "cart_y_offset = 1.2  # Raise cart so pole can swing freely above ground.\n",
    "wheel_radius = 0.05\n",
    "\n",
    "\n",
    "def create_cart_pole_frame(x: float, theta: float) -> dict:\n",
    "    \"\"\"Create a single frame of cart-pole visualization.\n",
    "\n",
    "    Args:\n",
    "        x: Cart position.\n",
    "        theta: Pole angle (0 = down, pi = up).\n",
    "\n",
    "    Returns:\n",
    "        Dictionary with cart, pole, mass, and wheel coordinates.\n",
    "    \"\"\"\n",
    "    cart_width, cart_height = 0.4, 0.15\n",
    "    pole_len = 2 * length  # Full pole length.\n",
    "    pole_x = x + pole_len * jnp.sin(theta)\n",
    "    pole_y = cart_y_offset - pole_len * jnp.cos(theta)\n",
    "\n",
    "    # Wheel positions.\n",
    "    wheel_y = cart_y_offset - cart_height / 2 - wheel_radius\n",
    "\n",
    "    return dict(\n",
    "        cart_x=[\n",
    "            x - cart_width / 2,\n",
    "            x + cart_width / 2,\n",
    "            x + cart_width / 2,\n",
    "            x - cart_width / 2,\n",
    "            x - cart_width / 2,\n",
    "        ],\n",
    "        cart_y=[\n",
    "            cart_y_offset - cart_height / 2,\n",
    "            cart_y_offset - cart_height / 2,\n",
    "            cart_y_offset + cart_height / 2,\n",
    "            cart_y_offset + cart_height / 2,\n",
    "            cart_y_offset - cart_height / 2,\n",
    "        ],\n",
    "        pole_x=[x, float(pole_x)],\n",
    "        pole_y=[cart_y_offset, float(pole_y)],\n",
    "        mass_x=[float(pole_x)],\n",
    "        mass_y=[float(pole_y)],\n",
    "        wheel1_x=[x - cart_width / 3],\n",
    "        wheel1_y=[wheel_y],\n",
    "        wheel2_x=[x + cart_width / 3],\n",
    "        wheel2_y=[wheel_y],\n",
    "    )\n",
    "\n",
    "\n",
    "# Create animation frames (use every 2nd timestep for performance).\n",
    "frame_step = 2\n",
    "frame_indices = list(range(0, n_steps + 1, frame_step))\n",
    "frames = []\n",
    "for i in frame_indices:\n",
    "    frame_data = create_cart_pole_frame(\n",
    "        float(optimal_trajectory[i, 0]), float(optimal_trajectory[i, 1])\n",
    "    )\n",
    "    frames.append(\n",
    "        go.Frame(\n",
    "            data=[\n",
    "                go.Scatter(\n",
    "                    x=frame_data[\"cart_x\"],\n",
    "                    y=frame_data[\"cart_y\"],\n",
    "                    fill=\"toself\",\n",
    "                    fillcolor=\"steelblue\",\n",
    "                    line=dict(color=\"darkblue\", width=2),\n",
    "                ),\n",
    "                go.Scatter(\n",
    "                    x=frame_data[\"pole_x\"],\n",
    "                    y=frame_data[\"pole_y\"],\n",
    "                    mode=\"lines\",\n",
    "                    line=dict(color=\"sienna\", width=8),\n",
    "                ),\n",
    "                go.Scatter(\n",
    "                    x=frame_data[\"mass_x\"],\n",
    "                    y=frame_data[\"mass_y\"],\n",
    "                    mode=\"markers\",\n",
    "                    marker=dict(\n",
    "                        size=18, color=\"sienna\", line=dict(color=\"black\", width=1)\n",
    "                    ),\n",
    "                ),\n",
    "                go.Scatter(\n",
    "                    x=frame_data[\"wheel1_x\"],\n",
    "                    y=frame_data[\"wheel1_y\"],\n",
    "                    mode=\"markers\",\n",
    "                    marker=dict(size=12, color=\"black\", symbol=\"circle\"),\n",
    "                ),\n",
    "                go.Scatter(\n",
    "                    x=frame_data[\"wheel2_x\"],\n",
    "                    y=frame_data[\"wheel2_y\"],\n",
    "                    mode=\"markers\",\n",
    "                    marker=dict(size=12, color=\"black\", symbol=\"circle\"),\n",
    "                ),\n",
    "            ],\n",
    "            name=str(i),\n",
    "        )\n",
    "    )\n",
    "\n",
    "# Initial frame.\n",
    "init_frame = create_cart_pole_frame(\n",
    "    float(optimal_trajectory[0, 0]), float(optimal_trajectory[0, 1])\n",
    ")\n",
    "rail_y = cart_y_offset - 0.15 / 2 - wheel_radius * 2\n",
    "\n",
    "fig_anim = go.Figure(\n",
    "    data=[\n",
    "        go.Scatter(\n",
    "            x=init_frame[\"cart_x\"],\n",
    "            y=init_frame[\"cart_y\"],\n",
    "            fill=\"toself\",\n",
    "            fillcolor=\"steelblue\",\n",
    "            line=dict(color=\"darkblue\", width=2),\n",
    "            name=\"Cart\",\n",
    "        ),\n",
    "        go.Scatter(\n",
    "            x=init_frame[\"pole_x\"],\n",
    "            y=init_frame[\"pole_y\"],\n",
    "            mode=\"lines\",\n",
    "            line=dict(color=\"sienna\", width=8),\n",
    "            name=\"Pole\",\n",
    "        ),\n",
    "        go.Scatter(\n",
    "            x=init_frame[\"mass_x\"],\n",
    "            y=init_frame[\"mass_y\"],\n",
    "            mode=\"markers\",\n",
    "            marker=dict(size=18, color=\"sienna\", line=dict(color=\"black\", width=1)),\n",
    "            showlegend=False,\n",
    "        ),\n",
    "        go.Scatter(\n",
    "            x=init_frame[\"wheel1_x\"],\n",
    "            y=init_frame[\"wheel1_y\"],\n",
    "            mode=\"markers\",\n",
    "            marker=dict(size=12, color=\"black\", symbol=\"circle\"),\n",
    "            showlegend=False,\n",
    "        ),\n",
    "        go.Scatter(\n",
    "            x=init_frame[\"wheel2_x\"],\n",
    "            y=init_frame[\"wheel2_y\"],\n",
    "            mode=\"markers\",\n",
    "            marker=dict(size=12, color=\"black\", symbol=\"circle\"),\n",
    "            showlegend=False,\n",
    "        ),\n",
    "        go.Scatter(\n",
    "            x=[-2.5, 2.5],\n",
    "            y=[rail_y, rail_y],\n",
    "            mode=\"lines\",\n",
    "            line=dict(color=\"gray\", width=6),\n",
    "            name=\"Rail\",\n",
    "        ),\n",
    "    ],\n",
    "    frames=frames,\n",
    "    layout=go.Layout(\n",
    "        title=\"Cart-Pole (Shooting)\",\n",
    "        xaxis=dict(\n",
    "            range=[-2.5, 2.5], title=\"x (m)\", constrain=\"domain\", showgrid=False\n",
    "        ),\n",
    "        yaxis=dict(\n",
    "            range=[-0.1, 2.5],\n",
    "            title=\"y (m)\",\n",
    "            scaleanchor=\"x\",\n",
    "            scaleratio=1,\n",
    "            showgrid=False,\n",
    "        ),\n",
    "        updatemenus=[\n",
    "            dict(\n",
    "                type=\"buttons\",\n",
    "                showactive=False,\n",
    "                y=1.15,\n",
    "                x=0.5,\n",
    "                xanchor=\"center\",\n",
    "                buttons=[\n",
    "                    dict(\n",
    "                        label=\"Play\",\n",
    "                        method=\"animate\",\n",
    "                        args=[\n",
    "                            None,\n",
    "                            dict(\n",
    "                                frame=dict(duration=50, redraw=True),\n",
    "                                fromcurrent=True,\n",
    "                                transition=dict(duration=0),\n",
    "                            ),\n",
    "                        ],\n",
    "                    ),\n",
    "                    dict(\n",
    "                        label=\"Pause\",\n",
    "                        method=\"animate\",\n",
    "                        args=[\n",
    "                            [None],\n",
    "                            dict(\n",
    "                                frame=dict(duration=0, redraw=False),\n",
    "                                mode=\"immediate\",\n",
    "                            ),\n",
    "                        ],\n",
    "                    ),\n",
    "                ],\n",
    "            )\n",
    "        ],\n",
    "        sliders=[\n",
    "            dict(\n",
    "                active=0,\n",
    "                yanchor=\"top\",\n",
    "                xanchor=\"left\",\n",
    "                currentvalue=dict(\n",
    "                    prefix=\"Time: \",\n",
    "                    suffix=\"s\",\n",
    "                    visible=True,\n",
    "                    xanchor=\"center\",\n",
    "                    offset=20,\n",
    "                ),\n",
    "                pad=dict(b=10, t=60),\n",
    "                steps=[\n",
    "                    dict(\n",
    "                        args=[\n",
    "                            [str(i)],\n",
    "                            dict(\n",
    "                                frame=dict(duration=0, redraw=True),\n",
    "                                mode=\"immediate\",\n",
    "                                transition=dict(duration=0),\n",
    "                            ),\n",
    "                        ],\n",
    "                        label=f\"{float(times[i]):.2f}\",\n",
    "                        method=\"animate\",\n",
    "                    )\n",
    "                    for i in frame_indices\n",
    "                ],\n",
    "                x=0.1,\n",
    "                y=0,\n",
    "                len=0.8,\n",
    "            )\n",
    "        ],\n",
    "        height=500,\n",
    "        showlegend=False,\n",
    "        margin=dict(t=80, b=100),\n",
    "        plot_bgcolor=\"white\",\n",
    "    ),\n",
    ")\n",
    "HTML(fig_anim.to_html(full_html=False, include_plotlyjs=\"cdn\", auto_play=False))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "cell-18",
   "metadata": {
    "tags": [
     "hide-input"
    ]
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>                        <script type=\"text/javascript\">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>\n",
       "        <script charset=\"utf-8\" src=\"https://cdn.plot.ly/plotly-3.1.0.min.js\" integrity=\"sha256-Ei4740bWZhaUTQuD6q9yQlgVCMPBz6CZWhevDYPv93A=\" crossorigin=\"anonymous\"></script>                <div id=\"70ec0c0d-bc7c-4b3b-b578-b4aa1d0af75d\" class=\"plotly-graph-div\" style=\"height:500px; width:100%;\"></div>            <script type=\"text/javascript\">                window.PLOTLYENV=window.PLOTLYENV || {};                                if (document.getElementById(\"70ec0c0d-bc7c-4b3b-b578-b4aa1d0af75d\")) {                    Plotly.newPlot(                        \"70ec0c0d-bc7c-4b3b-b578-b4aa1d0af75d\",                        [{\"line\":{\"color\":\"steelblue\",\"width\":2},\"mode\":\"lines\",\"name\":\"x\",\"x\":[0.0,0.05000000447034836,0.10000000894069672,0.15000000596046448,0.20000001788139343,0.2500000298023224,0.30000001192092896,0.3500000238418579,0.40000003576278687,0.4500000476837158,0.5000000596046448,0.5500000715255737,0.6000000238418579,0.6500000357627869,0.7000000476837158,0.7500000596046448,0.8000000715255737,0.8500000834465027,0.9000000953674316,0.9500001072883606,1.0000001192092896,1.0500000715255737,1.1000001430511475,1.1500000953674316,1.2000000476837158,1.2500001192092896,1.3000000715255737,1.3500001430511475,1.4000000953674316,1.4500001668930054,1.5000001192092896,1.5500001907348633,1.6000001430511475,1.6500000953674316,1.7000001668930054,1.7500001192092896,1.8000001907348633,1.8500001430511475,1.9000002145767212,1.9500001668930054,2.000000238418579,2.0500001907348633,2.1000001430511475,2.1500000953674316,2.200000286102295,2.250000238418579,2.3000001907348633,2.3500001430511475,2.4000000953674316,2.450000286102295,2.500000238418579,2.5500001907348633,2.6000001430511475,2.6500003337860107,2.700000286102295,2.750000238418579,2.8000001907348633,2.8500001430511475,2.9000003337860107,2.950000286102295,3.0],\"y\":[0.0,-0.018680190667510033,-0.07110124081373215,-0.149765282869339,-0.24715398252010345,-0.35649746656417847,-0.4723605513572693,-0.5910033583641052,-0.7101976275444031,-0.8287041187286377,-0.9456964135169983,-1.0603042840957642,-1.1712768077850342,-1.2767466306686401,-1.3741941452026367,-1.460567593574524,-1.5326247215270996,-1.5875948667526245,-1.6241450309753418,-1.643383502960205,-1.649120807647705,-1.6468218564987183,-1.6417672634124756,-1.6375150680541992,-1.6352688074111938,-1.6339879035949707,-1.6308372020721436,-1.6217591762542725,-1.6020874977111816,-1.5672601461410522,-1.5137094259262085,-1.4398400783538818,-1.346828818321228,-1.2389404773712158,-1.123206615447998,-1.0085257291793823,-0.9043102860450745,-0.8186067342758179,-0.7554487586021423,-0.7121294736862183,-0.6792402863502502,-0.6448346376419067,-0.5991539359092712,-0.5368247628211975,-0.4570401608943939,-0.36306941509246826,-0.261621356010437,-0.16199469566345215,-0.07495582103729248,-0.01177220419049263,0.01591651327908039,0.018859991803765297,0.0170292966067791,0.014328661374747753,0.011552158743143082,0.008875125087797642,0.006340598221868277,0.0039591616950929165,0.0017244195332750678,-0.00041401071939617395,-0.0027100839652121067],\"type\":\"scatter\",\"xaxis\":\"x\",\"yaxis\":\"y\"},{\"line\":{\"color\":\"coral\",\"width\":2},\"mode\":\"lines\",\"name\":\"theta\",\"x\":[0.0,0.05000000447034836,0.10000000894069672,0.15000000596046448,0.20000001788139343,0.2500000298023224,0.30000001192092896,0.3500000238418579,0.40000003576278687,0.4500000476837158,0.5000000596046448,0.5500000715255737,0.6000000238418579,0.6500000357627869,0.7000000476837158,0.7500000596046448,0.8000000715255737,0.8500000834465027,0.9000000953674316,0.9500001072883606,1.0000001192092896,1.0500000715255737,1.1000001430511475,1.1500000953674316,1.2000000476837158,1.2500001192092896,1.3000000715255737,1.3500001430511475,1.4000000953674316,1.4500001668930054,1.5000001192092896,1.5500001907348633,1.6000001430511475,1.6500000953674316,1.7000001668930054,1.7500001192092896,1.8000001907348633,1.8500001430511475,1.9000002145767212,1.9500001668930054,2.000000238418579,2.0500001907348633,2.1000001430511475,2.1500000953674316,2.200000286102295,2.250000238418579,2.3000001907348633,2.3500001430511475,2.4000000953674316,2.450000286102295,2.500000238418579,2.5500001907348633,2.6000001430511475,2.6500003337860107,2.700000286102295,2.750000238418579,2.8000001907348633,2.8500001430511475,2.9000003337860107,2.950000286102295,3.0],\"y\":[0.0,0.027933452278375626,0.10526192933320999,0.21774354577064514,0.34965723752975464,0.4858672022819519,0.613656759262085,0.7237898111343384,0.8102822303771973,0.8694922924041748,0.8991972208023071,0.8979340195655823,0.8645492792129517,0.797855019569397,0.6964518427848816,0.5587414503097534,0.3833945393562317,0.17067058384418488,-0.07529640197753906,-0.34419840574264526,-0.6198021173477173,-0.8841859698295593,-1.1231638193130493,-1.328761100769043,-1.4980473518371582,-1.6305341720581055,-1.7260717153549194,-1.783832311630249,-1.8022629022598267,-1.7797213792800903,-1.7154738903045654,-1.6105468273162842,-1.4677715301513672,-1.2906156778335571,-1.0811362266540527,-0.8381608128547668,-0.5571470856666565,-0.23323260247707367,0.1316031515598297,0.5208156704902649,0.9059492349624634,1.2619916200637817,1.5788341760635376,1.8595086336135864,2.1123669147491455,2.344440460205078,2.5577306747436523,2.7481961250305176,2.906942367553711,3.0222113132476807,3.0800983905792236,3.0985872745513916,3.1083147525787354,3.115506410598755,3.121621608734131,3.1271495819091797,3.132359027862549,3.137458086013794,3.142625093460083,3.147975206375122,3.1533236503601074],\"type\":\"scatter\",\"xaxis\":\"x2\",\"yaxis\":\"y2\"},{\"line\":{\"color\":\"steelblue\",\"width\":2},\"mode\":\"lines\",\"name\":\"x_dot\",\"x\":[0.0,0.05000000447034836,0.10000000894069672,0.15000000596046448,0.20000001788139343,0.2500000298023224,0.30000001192092896,0.3500000238418579,0.40000003576278687,0.4500000476837158,0.5000000596046448,0.5500000715255737,0.6000000238418579,0.6500000357627869,0.7000000476837158,0.7500000596046448,0.8000000715255737,0.8500000834465027,0.9000000953674316,0.9500001072883606,1.0000001192092896,1.0500000715255737,1.1000001430511475,1.1500000953674316,1.2000000476837158,1.2500001192092896,1.3000000715255737,1.3500001430511475,1.4000000953674316,1.4500001668930054,1.5000001192092896,1.5500001907348633,1.6000001430511475,1.6500000953674316,1.7000001668930054,1.7500001192092896,1.8000001907348633,1.8500001430511475,1.9000002145767212,1.9500001668930054,2.000000238418579,2.0500001907348633,2.1000001430511475,2.1500000953674316,2.200000286102295,2.250000238418579,2.3000001907348633,2.3500001430511475,2.4000000953674316,2.450000286102295,2.500000238418579,2.5500001907348633,2.6000001430511475,2.6500003337860107,2.700000286102295,2.750000238418579,2.8000001907348633,2.8500001430511475,2.9000003337860107,2.950000286102295,3.0],\"y\":[0.0,-0.7470188736915588,-1.3491401672363281,-1.7962077856063843,-2.09793758392334,-2.274733781814575,-2.359346866607666,-2.3864736557006836,-2.381692886352539,-2.3589892387390137,-2.3209617137908936,-2.263340950012207,-2.1752350330352783,-2.0429301261901855,-1.8541470766067505,-1.6000409126281738,-1.2821221351623535,-0.9180747270584106,-0.5475539565086365,-0.2271614968776703,-0.006655564531683922,0.09718314558267593,0.10630645602941513,0.06636777520179749,0.026144519448280334,0.027299195528030396,0.10035104304552078,0.26377931237220764,0.5234256386756897,0.8692395687103271,1.2715498208999634,1.6812982559204102,2.036865711212158,2.2763795852661133,2.3508989810943604,2.234689712524414,1.9336143732070923,1.497933268547058,1.0378384590148926,0.7069047093391418,0.6146321892738342,0.7596604824066162,1.0625627040863037,1.4262475967407227,1.7622309923171997,1.9946234226226807,2.061673164367676,1.9220142364501953,1.5586789846420288,0.9684377312660217,0.13919498026371002,-0.02135460451245308,-0.05181580409407616,-0.05616668239235878,-0.0548567958176136,-0.05219141021370888,-0.049158431589603424,-0.046068452298641205,-0.043290238827466965,-0.04221488535404205,-0.04959595203399658],\"type\":\"scatter\",\"xaxis\":\"x3\",\"yaxis\":\"y3\"},{\"line\":{\"color\":\"coral\",\"dash\":\"dash\",\"width\":2},\"mode\":\"lines\",\"name\":\"theta_dot\",\"x\":[0.0,0.05000000447034836,0.10000000894069672,0.15000000596046448,0.20000001788139343,0.2500000298023224,0.30000001192092896,0.3500000238418579,0.40000003576278687,0.4500000476837158,0.5000000596046448,0.5500000715255737,0.6000000238418579,0.6500000357627869,0.7000000476837158,0.7500000596046448,0.8000000715255737,0.8500000834465027,0.9000000953674316,0.9500001072883606,1.0000001192092896,1.0500000715255737,1.1000001430511475,1.1500000953674316,1.2000000476837158,1.2500001192092896,1.3000000715255737,1.3500001430511475,1.4000000953674316,1.4500001668930054,1.5000001192092896,1.5500001907348633,1.6000001430511475,1.6500000953674316,1.7000001668930054,1.7500001192092896,1.8000001907348633,1.8500001430511475,1.9000002145767212,1.9500001668930054,2.000000238418579,2.0500001907348633,2.1000001430511475,2.1500000953674316,2.200000286102295,2.250000238418579,2.3000001907348633,2.3500001430511475,2.4000000953674316,2.450000286102295,2.500000238418579,2.5500001907348633,2.6000001430511475,2.6500003337860107,2.700000286102295,2.750000238418579,2.8000001907348633,2.8500001430511475,2.9000003337860107,2.950000286102295,3.0],\"y\":[0.0,1.113545298576355,1.9683555364608765,2.513535261154175,2.7427594661712646,2.686544418334961,2.409754753112793,1.9846711158752441,1.4679120779037476,0.8963290452957153,0.29003235697746277,-0.3404855728149414,-0.9931803345680237,-1.671343207359314,-2.3798232078552246,-3.1209800243377686,-3.8802449703216553,-4.60698127746582,-5.197432041168213,-5.514642715454102,-5.4670515060424805,-5.078487396240234,-4.46549129486084,-3.7531182765960693,-3.0173885822296143,-2.281973123550415,-1.5387965440750122,-0.7703312635421753,0.033881668001413345,0.8663392663002014,1.6982691287994385,2.4890568256378174,3.2088592052459717,3.8635082244873047,4.5035905838012695,5.205514907836914,6.022548675537109,6.906351089477539,7.630974292755127,7.865882873535156,7.491449356079102,6.742439270019531,5.950215816497803,5.306171894073486,4.838418006896973,4.470846176147461,4.081368923187256,3.5529558658599854,2.809756278991699,1.811621069908142,0.5100091695785522,0.23193241655826569,0.15844367444515228,0.13017186522483826,0.11524035036563873,0.10660495609045029,0.1024569720029831,0.10217490047216415,0.10519186407327652,0.10951938480138779,0.10512524098157883],\"type\":\"scatter\",\"xaxis\":\"x3\",\"yaxis\":\"y3\"},{\"fill\":\"tozeroy\",\"fillcolor\":\"rgba(34, 139, 34, 0.2)\",\"line\":{\"color\":\"forestgreen\",\"width\":2},\"mode\":\"lines\",\"name\":\"F\",\"x\":[0.0,0.05000000074505806,0.10000000149011612,0.15000000596046448,0.20000000298023224,0.25,0.30000001192092896,0.3499999940395355,0.4000000059604645,0.45000001788139343,0.5,0.550000011920929,0.6000000238418579,0.6500000357627869,0.699999988079071,0.75,0.800000011920929,0.8500000238418579,0.9000000357627869,0.949999988079071,1.0,1.0500000715255737,1.100000023841858,1.149999976158142,1.2000000476837158,1.25,1.3000000715255737,1.350000023841858,1.399999976158142,1.4500000476837158,1.5,1.5500000715255737,1.600000023841858,1.649999976158142,1.7000000476837158,1.75,1.8000000715255737,1.850000023841858,1.899999976158142,1.9500000476837158,2.0,2.049999952316284,2.1000001430511475,2.1500000953674316,2.200000047683716,2.25,2.299999952316284,2.3500001430511475,2.4000000953674316,2.450000047683716,2.5,2.549999952316284,2.6000001430511475,2.6500000953674316,2.700000047683716,2.75,2.799999952316284,2.8500001430511475,2.9000000953674316,2.950000047683716],\"y\":[-15.32133960723877,-12.402318000793457,-9.3387451171875,-6.515432834625244,-4.090690612792969,-2.267047166824341,-1.079766869544983,-0.3701135516166687,0.06598667800426483,0.4387594759464264,0.8749992847442627,1.5059828758239746,2.3882718086242676,3.4946253299713135,4.76961088180542,6.0420145988464355,7.067478656768799,7.508688926696777,7.040088176727295,5.592254161834717,3.515352964401245,1.4872859716415405,0.15460148453712463,-0.20470331609249115,0.38095054030418396,1.7088745832443237,3.520310401916504,5.541572570800781,7.435983180999756,8.785649299621582,9.160372734069824,8.25139045715332,6.00766134262085,2.6892101764678955,-1.193150281906128,-4.993511199951172,-7.9772210121154785,-9.276093482971191,-8.022568702697754,-4.231597423553467,0.6179765462875366,4.5669474601745605,6.538147449493408,6.408255577087402,4.482736587524414,1.1938053369522095,-2.9488322734832764,-7.444619178771973,-12.0513334274292,-16.953733444213867,-3.2547645568847656,-0.5967844128608704,-0.06749100238084793,0.043727677315473557,0.06726197898387909,0.07086679339408875,0.068258136510849,0.058102916926145554,0.019332420080900192,-0.15798431634902954],\"type\":\"scatter\",\"xaxis\":\"x4\",\"yaxis\":\"y4\"}],                        {\"template\":{\"data\":{\"histogram2dcontour\":[{\"type\":\"histogram2dcontour\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"choropleth\":[{\"type\":\"choropleth\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}],\"histogram2d\":[{\"type\":\"histogram2d\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"heatmap\":[{\"type\":\"heatmap\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"contourcarpet\":[{\"type\":\"contourcarpet\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}],\"contour\":[{\"type\":\"contour\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"surface\":[{\"type\":\"surface\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"mesh3d\":[{\"type\":\"mesh3d\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}],\"scatter\":[{\"fillpattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2},\"type\":\"scatter\"}],\"parcoords\":[{\"type\":\"parcoords\",\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scatterpolargl\":[{\"type\":\"scatterpolargl\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"bar\":[{\"error_x\":{\"color\":\"#2a3f5f\"},\"error_y\":{\"color\":\"#2a3f5f\"},\"marker\":{\"line\":{\"color\":\"#E5ECF6\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"bar\"}],\"scattergeo\":[{\"type\":\"scattergeo\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scatterpolar\":[{\"type\":\"scatterpolar\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"histogram\":[{\"marker\":{\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"histogram\"}],\"scattergl\":[{\"type\":\"scattergl\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scatter3d\":[{\"type\":\"scatter3d\",\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scattermap\":[{\"type\":\"scattermap\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scattermapbox\":[{\"type\":\"scattermapbox\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scatterternary\":[{\"type\":\"scatterternary\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scattercarpet\":[{\"type\":\"scattercarpet\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"carpet\":[{\"aaxis\":{\"endlinecolor\":\"#2a3f5f\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"minorgridcolor\":\"white\",\"startlinecolor\":\"#2a3f5f\"},\"baxis\":{\"endlinecolor\":\"#2a3f5f\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"minorgridcolor\":\"white\",\"startlinecolor\":\"#2a3f5f\"},\"type\":\"carpet\"}],\"table\":[{\"cells\":{\"fill\":{\"color\":\"#EBF0F8\"},\"line\":{\"color\":\"white\"}},\"header\":{\"fill\":{\"color\":\"#C8D4E3\"},\"line\":{\"color\":\"white\"}},\"type\":\"table\"}],\"barpolar\":[{\"marker\":{\"line\":{\"color\":\"#E5ECF6\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"barpolar\"}],\"pie\":[{\"automargin\":true,\"type\":\"pie\"}]},\"layout\":{\"autotypenumbers\":\"strict\",\"colorway\":[\"#636efa\",\"#EF553B\",\"#00cc96\",\"#ab63fa\",\"#FFA15A\",\"#19d3f3\",\"#FF6692\",\"#B6E880\",\"#FF97FF\",\"#FECB52\"],\"font\":{\"color\":\"#2a3f5f\"},\"hovermode\":\"closest\",\"hoverlabel\":{\"align\":\"left\"},\"paper_bgcolor\":\"white\",\"plot_bgcolor\":\"#E5ECF6\",\"polar\":{\"bgcolor\":\"#E5ECF6\",\"angularaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"},\"radialaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"}},\"ternary\":{\"bgcolor\":\"#E5ECF6\",\"aaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"},\"baxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"},\"caxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"}},\"coloraxis\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"colorscale\":{\"sequential\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"sequentialminus\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"diverging\":[[0,\"#8e0152\"],[0.1,\"#c51b7d\"],[0.2,\"#de77ae\"],[0.3,\"#f1b6da\"],[0.4,\"#fde0ef\"],[0.5,\"#f7f7f7\"],[0.6,\"#e6f5d0\"],[0.7,\"#b8e186\"],[0.8,\"#7fbc41\"],[0.9,\"#4d9221\"],[1,\"#276419\"]]},\"xaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"white\",\"automargin\":true,\"zerolinewidth\":2},\"yaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"white\",\"automargin\":true,\"zerolinewidth\":2},\"scene\":{\"xaxis\":{\"backgroundcolor\":\"#E5ECF6\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"white\",\"gridwidth\":2},\"yaxis\":{\"backgroundcolor\":\"#E5ECF6\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"white\",\"gridwidth\":2},\"zaxis\":{\"backgroundcolor\":\"#E5ECF6\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"white\",\"gridwidth\":2}},\"shapedefaults\":{\"line\":{\"color\":\"#2a3f5f\"}},\"annotationdefaults\":{\"arrowcolor\":\"#2a3f5f\",\"arrowhead\":0,\"arrowwidth\":1},\"geo\":{\"bgcolor\":\"white\",\"landcolor\":\"#E5ECF6\",\"subunitcolor\":\"white\",\"showland\":true,\"showlakes\":true,\"lakecolor\":\"white\"},\"title\":{\"x\":0.05},\"mapbox\":{\"style\":\"light\"}}},\"xaxis\":{\"anchor\":\"y\",\"domain\":[0.0,0.45],\"title\":{\"text\":\"Time (s)\"}},\"yaxis\":{\"anchor\":\"x\",\"domain\":[0.575,1.0],\"title\":{\"text\":\"Position (m)\"}},\"xaxis2\":{\"anchor\":\"y2\",\"domain\":[0.55,1.0],\"title\":{\"text\":\"Time (s)\"}},\"yaxis2\":{\"anchor\":\"x2\",\"domain\":[0.575,1.0],\"title\":{\"text\":\"Angle (rad)\"}},\"xaxis3\":{\"anchor\":\"y3\",\"domain\":[0.0,0.45],\"title\":{\"text\":\"Time (s)\"}},\"yaxis3\":{\"anchor\":\"x3\",\"domain\":[0.0,0.425],\"title\":{\"text\":\"Velocity\"}},\"xaxis4\":{\"anchor\":\"y4\",\"domain\":[0.55,1.0],\"title\":{\"text\":\"Time (s)\"}},\"yaxis4\":{\"anchor\":\"x4\",\"domain\":[0.0,0.425],\"title\":{\"text\":\"Force (N)\"}},\"annotations\":[{\"font\":{\"size\":16},\"showarrow\":false,\"text\":\"Cart Position\",\"x\":0.225,\"xanchor\":\"center\",\"xref\":\"paper\",\"y\":1.0,\"yanchor\":\"bottom\",\"yref\":\"paper\"},{\"font\":{\"size\":16},\"showarrow\":false,\"text\":\"Pole Angle\",\"x\":0.775,\"xanchor\":\"center\",\"xref\":\"paper\",\"y\":1.0,\"yanchor\":\"bottom\",\"yref\":\"paper\"},{\"font\":{\"size\":16},\"showarrow\":false,\"text\":\"Velocities\",\"x\":0.225,\"xanchor\":\"center\",\"xref\":\"paper\",\"y\":0.425,\"yanchor\":\"bottom\",\"yref\":\"paper\"},{\"font\":{\"size\":16},\"showarrow\":false,\"text\":\"Control Force\",\"x\":0.775,\"xanchor\":\"center\",\"xref\":\"paper\",\"y\":0.425,\"yanchor\":\"bottom\",\"yref\":\"paper\"},{\"showarrow\":false,\"text\":\"pi\",\"x\":1,\"xanchor\":\"right\",\"xref\":\"x2 domain\",\"y\":3.141592653589793,\"yanchor\":\"bottom\",\"yref\":\"y2\"}],\"shapes\":[{\"line\":{\"color\":\"gray\",\"dash\":\"dash\"},\"type\":\"line\",\"x0\":0,\"x1\":1,\"xref\":\"x2 domain\",\"y0\":3.141592653589793,\"y1\":3.141592653589793,\"yref\":\"y2\"}],\"margin\":{\"t\":40,\"b\":40},\"height\":500,\"showlegend\":false},                        {\"responsive\": true}                    )                };            </script>        </div>"
      ],
      "text/plain": [
       "<IPython.core.display.HTML object>"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# State and control trajectories.\n",
    "fig_traj = make_subplots(\n",
    "    rows=2,\n",
    "    cols=2,\n",
    "    subplot_titles=(\"Cart Position\", \"Pole Angle\", \"Velocities\", \"Control Force\"),\n",
    "    vertical_spacing=0.15,\n",
    "    horizontal_spacing=0.1,\n",
    ")\n",
    "\n",
    "# Cart position.\n",
    "fig_traj.add_trace(\n",
    "    go.Scatter(\n",
    "        x=[float(t) for t in times],\n",
    "        y=[float(s) for s in optimal_trajectory[:, 0]],\n",
    "        mode=\"lines\",\n",
    "        line=dict(color=\"steelblue\", width=2),\n",
    "        name=\"x\",\n",
    "    ),\n",
    "    row=1,\n",
    "    col=1,\n",
    ")\n",
    "\n",
    "# Pole angle.\n",
    "fig_traj.add_trace(\n",
    "    go.Scatter(\n",
    "        x=[float(t) for t in times],\n",
    "        y=[float(s) for s in optimal_trajectory[:, 1]],\n",
    "        mode=\"lines\",\n",
    "        line=dict(color=\"coral\", width=2),\n",
    "        name=\"theta\",\n",
    "    ),\n",
    "    row=1,\n",
    "    col=2,\n",
    ")\n",
    "fig_traj.add_hline(\n",
    "    y=float(jnp.pi),\n",
    "    line_dash=\"dash\",\n",
    "    line_color=\"gray\",\n",
    "    row=1,\n",
    "    col=2,\n",
    "    annotation_text=\"pi\",\n",
    ")\n",
    "\n",
    "# Velocities.\n",
    "fig_traj.add_trace(\n",
    "    go.Scatter(\n",
    "        x=[float(t) for t in times],\n",
    "        y=[float(s) for s in optimal_trajectory[:, 2]],\n",
    "        mode=\"lines\",\n",
    "        line=dict(color=\"steelblue\", width=2),\n",
    "        name=\"x_dot\",\n",
    "    ),\n",
    "    row=2,\n",
    "    col=1,\n",
    ")\n",
    "fig_traj.add_trace(\n",
    "    go.Scatter(\n",
    "        x=[float(t) for t in times],\n",
    "        y=[float(s) for s in optimal_trajectory[:, 3]],\n",
    "        mode=\"lines\",\n",
    "        line=dict(color=\"coral\", width=2, dash=\"dash\"),\n",
    "        name=\"theta_dot\",\n",
    "    ),\n",
    "    row=2,\n",
    "    col=1,\n",
    ")\n",
    "\n",
    "# Control force.\n",
    "fig_traj.add_trace(\n",
    "    go.Scatter(\n",
    "        x=[float(t) for t in control_times],\n",
    "        y=[float(u) for u in optimal_controls[:, 0]],\n",
    "        mode=\"lines\",\n",
    "        line=dict(color=\"forestgreen\", width=2),\n",
    "        name=\"F\",\n",
    "        fill=\"tozeroy\",\n",
    "        fillcolor=\"rgba(34, 139, 34, 0.2)\",\n",
    "    ),\n",
    "    row=2,\n",
    "    col=2,\n",
    ")\n",
    "\n",
    "# Axis labels.\n",
    "fig_traj.update_xaxes(title_text=\"Time (s)\", row=1, col=1)\n",
    "fig_traj.update_yaxes(title_text=\"Position (m)\", row=1, col=1)\n",
    "fig_traj.update_xaxes(title_text=\"Time (s)\", row=1, col=2)\n",
    "fig_traj.update_yaxes(title_text=\"Angle (rad)\", row=1, col=2)\n",
    "fig_traj.update_xaxes(title_text=\"Time (s)\", row=2, col=1)\n",
    "fig_traj.update_yaxes(title_text=\"Velocity\", row=2, col=1)\n",
    "fig_traj.update_xaxes(title_text=\"Time (s)\", row=2, col=2)\n",
    "fig_traj.update_yaxes(title_text=\"Force (N)\", row=2, col=2)\n",
    "\n",
    "fig_traj.update_layout(height=500, showlegend=False, margin=dict(t=40, b=40))\n",
    "HTML(fig_traj.to_html(full_html=False, include_plotlyjs=\"cdn\"))"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "cell-19",
   "metadata": {},
   "source": [
    "## Comparison with direct collocation\n",
    "\n",
    "The shooting method optimizes only the control trajectory (60 decision variables for 60 timesteps), while direct collocation in {doc}`cart_pole_collocation` optimizes both states and controls (305 decision variables: 61 states x 4 + 60 controls).\n",
    "\n",
    "Shooting method advantages:\n",
    "- Fewer decision variables\n",
    "- Dynamics are satisfied by construction (no defect constraints)\n",
    "- Simpler problem formulation\n",
    "\n",
    "Shooting method disadvantages:\n",
    "- Sensitivity to initial conditions grows exponentially with time horizon\n",
    "- Harder to add state constraints (must be handled through cost)\n",
    "- Can struggle with long horizons or unstable dynamics\n",
    "\n",
    "For this cart-pole problem, both methods work well because the time horizon is short. For longer horizons or more complex systems, direct collocation often provides better convergence.\n",
    "\n",
    "For solver configuration options, see {class}`jaxls.TrustRegionConfig` and {class}`jaxls.TerminationConfig`."
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.12.4"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}