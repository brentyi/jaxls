{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "cell-0",
   "metadata": {},
   "source": [
    "# Cart-Pole (Collocation)\n",
    "\n",
    "Trajectory optimization for swinging a pole from hanging down to balancing upright.\n",
    "\n",
    "Features used:\n",
    "- {class}`~jaxls.Var` subclassing with batched IDs for state and control trajectories\n",
    "- {func}`@jaxls.Cost.factory <jaxls.Cost.factory>` with batched arguments\n",
    "- Equality constraints (`constraint_eq_zero`): dynamics collocation\n",
    "- Inequality constraints (`constraint_leq_zero`): control bounds\n",
    "- Augmented Lagrangian solver for constrained optimization"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "cell-1",
   "metadata": {
    "tags": [
     "hide-input"
    ]
   },
   "outputs": [],
   "source": [
    "import sys\n",
    "from loguru import logger\n",
    "\n",
    "logger.remove()\n",
    "logger.add(sys.stdout, format=\"<level>{level: <8}</level> | {message}\");"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "cell-2",
   "metadata": {},
   "outputs": [],
   "source": [
    "import jax\n",
    "import jax.numpy as jnp\n",
    "import jaxls"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "cell-3",
   "metadata": {},
   "source": [
    "## Cart-pole dynamics\n",
    "\n",
    "The cart-pole system has state $[x, \\theta, \\dot{x}, \\dot{\\theta}]$ where $x$ is cart position and $\\theta$ is pole angle (0 = hanging down, $\\pi$ = upright). The control input is a horizontal force on the cart."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "cell-4",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Total trajectory time: 3.00s (50 swing + 10 hold)\n"
     ]
    }
   ],
   "source": [
    "# Physical parameters\n",
    "m_cart = 1.0  # Cart mass (kg)\n",
    "m_pole = 0.1  # Pole mass (kg)\n",
    "length = 0.5  # Pole half-length (m)\n",
    "gravity = 9.81  # Gravitational acceleration (m/s^2)\n",
    "force_limit = 10.0  # Maximum control force (N)\n",
    "\n",
    "# Trajectory parameters\n",
    "n_swing = 50  # Timesteps for swing-up phase\n",
    "n_hold = 10  # Timesteps to hold upright position\n",
    "n_steps = n_swing + n_hold  # Total timesteps\n",
    "dt = 0.05  # Time step (s)\n",
    "total_time = n_steps * dt\n",
    "print(f\"Total trajectory time: {total_time:.2f}s ({n_swing} swing + {n_hold} hold)\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "cell-5",
   "metadata": {},
   "outputs": [],
   "source": [
    "@jax.jit\n",
    "def cart_pole_dynamics(state: jax.Array, force: jax.Array) -> jax.Array:\n",
    "    \"\"\"Compute state derivatives for the cart-pole system.\n",
    "\n",
    "    State: [x, theta, x_dot, theta_dot]\n",
    "    theta = 0: pole hanging down, theta = pi: pole upright\n",
    "\n",
    "    Note: We use the standard cart-pole equations but with theta measured\n",
    "    from hanging down, so the gravitational term has a negative sign.\n",
    "    \"\"\"\n",
    "    x, theta, x_dot, theta_dot = state\n",
    "    f = force[0]\n",
    "\n",
    "    sin_th = jnp.sin(theta)\n",
    "    cos_th = jnp.cos(theta)\n",
    "\n",
    "    # Total mass\n",
    "    total_mass = m_cart + m_pole\n",
    "    pole_mass_length = m_pole * length\n",
    "\n",
    "    # Equations of motion for theta=0 being DOWN (stable equilibrium)\n",
    "    # The gravitational term is negated compared to theta=0 being UP\n",
    "    temp = (f + pole_mass_length * theta_dot**2 * sin_th) / total_mass\n",
    "    theta_ddot = (-gravity * sin_th - cos_th * temp) / (\n",
    "        length * (4.0 / 3.0 - m_pole * cos_th**2 / total_mass)\n",
    "    )\n",
    "    x_ddot = temp - pole_mass_length * theta_ddot * cos_th / total_mass\n",
    "\n",
    "    return jnp.array([x_dot, theta_dot, x_ddot, theta_ddot])\n",
    "\n",
    "\n",
    "@jax.jit\n",
    "def rk4_step(state: jax.Array, force: jax.Array, dt: float) -> jax.Array:\n",
    "    \"\"\"Runge-Kutta 4th order integration step.\"\"\"\n",
    "    k1 = cart_pole_dynamics(state, force)\n",
    "    k2 = cart_pole_dynamics(state + 0.5 * dt * k1, force)\n",
    "    k3 = cart_pole_dynamics(state + 0.5 * dt * k2, force)\n",
    "    k4 = cart_pole_dynamics(state + dt * k3, force)\n",
    "    return state + (dt / 6.0) * (k1 + 2 * k2 + 2 * k3 + k4)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "cell-6",
   "metadata": {},
   "source": [
    "## Variables\n",
    "\n",
    "We define state variables at each timestep and control inputs between timesteps. Using batched IDs for efficient construction:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "cell-7",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "State variables: 61 (shape: (61,))\n",
      "Control variables: 60 (shape: (60,))\n"
     ]
    }
   ],
   "source": [
    "class StateVar(jaxls.Var[jax.Array], default_factory=lambda: jnp.zeros(4)):\n",
    "    \"\"\"State variable: [x, theta, x_dot, theta_dot].\"\"\"\n",
    "\n",
    "\n",
    "class ControlVar(jaxls.Var[jax.Array], default_factory=lambda: jnp.zeros(1)):\n",
    "    \"\"\"Control variable: [force].\"\"\"\n",
    "\n",
    "\n",
    "# Create batched variables\n",
    "state_vars = StateVar(id=jnp.arange(n_steps + 1))  # States at t=0, 1, ..., n_steps\n",
    "control_vars = ControlVar(id=jnp.arange(n_steps))  # Controls at t=0, 1, ..., n_steps-1\n",
    "\n",
    "print(f\"State variables: {n_steps + 1} (shape: {state_vars.id.shape})\")\n",
    "print(f\"Control variables: {n_steps} (shape: {control_vars.id.shape})\")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "cell-8",
   "metadata": {},
   "source": [
    "## Cost functions\n",
    "\n",
    "We define costs for:\n",
    "1. Dynamics constraints: RK4 integration between consecutive states\n",
    "2. Boundary costs: Penalize deviation from initial and target states\n",
    "3. Control effort: Minimize force usage\n",
    "4. Control bounds: Keep force within limits"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "cell-9",
   "metadata": {},
   "outputs": [],
   "source": [
    "@jaxls.Cost.factory(kind=\"constraint_eq_zero\")\n",
    "def dynamics_constraint(\n",
    "    vals: jaxls.VarValues,\n",
    "    state_k: StateVar,\n",
    "    state_k1: StateVar,\n",
    "    control_k: ControlVar,\n",
    "    dt: float,\n",
    ") -> jax.Array:\n",
    "    \"\"\"Enforce RK4 dynamics between consecutive states.\"\"\"\n",
    "    s_k = vals[state_k]\n",
    "    s_k1 = vals[state_k1]\n",
    "    u_k = vals[control_k]\n",
    "    s_next = rk4_step(s_k, u_k, dt)\n",
    "    return s_k1 - s_next\n",
    "\n",
    "\n",
    "@jaxls.Cost.factory\n",
    "def boundary_cost(\n",
    "    vals: jaxls.VarValues,\n",
    "    var: StateVar,\n",
    "    target: jax.Array,\n",
    ") -> jax.Array:\n",
    "    \"\"\"Penalize deviation from target state.\"\"\"\n",
    "    return (vals[var] - target) * 100.0\n",
    "\n",
    "\n",
    "@jaxls.Cost.factory\n",
    "def control_cost(\n",
    "    vals: jaxls.VarValues,\n",
    "    var: ControlVar,\n",
    ") -> jax.Array:\n",
    "    \"\"\"Minimize control effort.\"\"\"\n",
    "    return vals[var] * 1.0\n",
    "\n",
    "\n",
    "@jaxls.Cost.factory(kind=\"constraint_leq_zero\")\n",
    "def control_upper_bound(\n",
    "    vals: jaxls.VarValues,\n",
    "    var: ControlVar,\n",
    "    limit: float,\n",
    ") -> jax.Array:\n",
    "    \"\"\"Control <= limit.\"\"\"\n",
    "    return vals[var] - limit\n",
    "\n",
    "\n",
    "@jaxls.Cost.factory(kind=\"constraint_leq_zero\")\n",
    "def control_lower_bound(\n",
    "    vals: jaxls.VarValues,\n",
    "    var: ControlVar,\n",
    "    limit: float,\n",
    ") -> jax.Array:\n",
    "    \"\"\"-limit <= control, i.e., -limit - control <= 0.\"\"\"\n",
    "    return -limit - vals[var]"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "cell-10",
   "metadata": {},
   "source": [
    "## Problem construction\n",
    "\n",
    "Initial state: pole hanging down ($\\theta = 0$). Target state: pole upright ($\\theta = \\pi$), centered at origin with zero velocity."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "cell-11",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Created 6 batched cost objects\n"
     ]
    }
   ],
   "source": [
    "# Boundary conditions\n",
    "initial_state = jnp.array([0.0, 0.0, 0.0, 0.0])  # x=0, theta=0 (down), zero velocity\n",
    "target_state = jnp.array([0.0, jnp.pi, 0.0, 0.0])  # x=0, theta=pi (up), zero velocity\n",
    "\n",
    "# State indices for dynamics constraints\n",
    "state_k_ids = jnp.arange(n_steps)  # 0, 1, ..., n_steps-1\n",
    "state_k1_ids = jnp.arange(1, n_steps + 1)  # 1, 2, ..., n_steps\n",
    "control_k_ids = jnp.arange(n_steps)  # 0, 1, ..., n_steps-1\n",
    "\n",
    "# Hold phase: penalize states during hold to stay at target\n",
    "hold_state_ids = jnp.arange(n_swing, n_steps + 1)  # States during hold phase\n",
    "n_hold_states = len(hold_state_ids)\n",
    "hold_targets = jnp.tile(target_state, (n_hold_states, 1))  # Broadcast for batching\n",
    "\n",
    "# Build costs using batched construction\n",
    "costs: list[jaxls.Cost] = [\n",
    "    # Dynamics constraints (batched)\n",
    "    dynamics_constraint(\n",
    "        StateVar(id=state_k_ids),\n",
    "        StateVar(id=state_k1_ids),\n",
    "        ControlVar(id=control_k_ids),\n",
    "        dt,\n",
    "    ),\n",
    "    # Boundary costs\n",
    "    boundary_cost(StateVar(id=0), initial_state),\n",
    "    # Hold phase: penalize all hold states deviating from target\n",
    "    boundary_cost(StateVar(id=hold_state_ids), hold_targets),\n",
    "    # Control effort (batched)\n",
    "    control_cost(control_vars),\n",
    "    # Control bounds (batched)\n",
    "    control_upper_bound(control_vars, force_limit),\n",
    "    control_lower_bound(control_vars, force_limit),\n",
    "]\n",
    "\n",
    "print(f\"Created {len(costs)} batched cost objects\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "cell-12",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\u001b[1mINFO    \u001b[0m | Building optimization problem with 252 terms and 121 variables: 72 costs, 60 eq_zero, 120 leq_zero, 0 geq_zero\n",
      "\u001b[1mINFO    \u001b[0m | Vectorizing constraint group with 60 constraints (constraint_leq_zero), 1 variables each: augmented_control_lower_bound\n",
      "\u001b[1mINFO    \u001b[0m | Vectorizing constraint group with 60 constraints (constraint_eq_zero), 3 variables each: augmented_dynamics_constraint\n",
      "\u001b[1mINFO    \u001b[0m | Vectorizing constraint group with 60 constraints (constraint_leq_zero), 1 variables each: augmented_control_upper_bound\n",
      "\u001b[1mINFO    \u001b[0m | Vectorizing group with 60 costs, 1 variables each: control_cost\n",
      "\u001b[1mINFO    \u001b[0m | Vectorizing group with 12 costs, 1 variables each: boundary_cost\n"
     ]
    }
   ],
   "source": [
    "# Initial guess: linear interpolation for states, zero controls\n",
    "t_interp = jnp.linspace(0, 1, n_steps + 1)[:, None]\n",
    "initial_states = initial_state + t_interp * (target_state - initial_state)\n",
    "initial_controls = jnp.zeros((n_steps, 1))\n",
    "\n",
    "initial_vals = jaxls.VarValues.make(\n",
    "    [\n",
    "        state_vars.with_value(initial_states),\n",
    "        control_vars.with_value(initial_controls),\n",
    "    ]\n",
    ")\n",
    "\n",
    "# Create and analyze problem\n",
    "problem = jaxls.LeastSquaresProblem(costs, [state_vars, control_vars]).analyze()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "cell-13",
   "metadata": {},
   "source": [
    "## Solving"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "cell-14",
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\u001b[1mINFO    \u001b[0m | Augmented Lagrangian: initial snorm=7.3573e-01, csupn=7.3573e-01, max_rho=1.0572e+05, constraint_dim=360\n",
      "\u001b[1mINFO    \u001b[0m |  step #1: cost=1816479.1250 lambd=0.0005 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_lower_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_dynamics_constraint(60): 1805924.12500 (avg 7524.68408)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_cost(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - boundary_cost(12): 10554.98535 (avg 219.89554)\n",
      "\u001b[1mINFO    \u001b[0m |  step #2: cost=1816479.1250 lambd=0.0010 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_lower_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_dynamics_constraint(60): 1805924.12500 (avg 7524.68408)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_cost(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - boundary_cost(12): 10554.98535 (avg 219.89554)\n",
      "\u001b[1mINFO    \u001b[0m |  step #3: cost=1816479.1250 lambd=0.0020 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_lower_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_dynamics_constraint(60): 1805924.12500 (avg 7524.68408)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_cost(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - boundary_cost(12): 10554.98535 (avg 219.89554)\n",
      "\u001b[1mINFO    \u001b[0m |  step #4: cost=1816479.1250 lambd=0.0040 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_lower_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_dynamics_constraint(60): 1805924.12500 (avg 7524.68408)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_cost(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - boundary_cost(12): 10554.98535 (avg 219.89554)\n",
      "\u001b[1mINFO    \u001b[0m |  step #5: cost=1816479.1250 lambd=0.0080 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_lower_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_dynamics_constraint(60): 1805924.12500 (avg 7524.68408)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_cost(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - boundary_cost(12): 10554.98535 (avg 219.89554)\n",
      "\u001b[1mINFO    \u001b[0m |  step #6: cost=1816479.1250 lambd=0.0160 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_lower_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_dynamics_constraint(60): 1805924.12500 (avg 7524.68408)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_cost(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - boundary_cost(12): 10554.98535 (avg 219.89554)\n",
      "\u001b[1mINFO    \u001b[0m |  step #7: cost=1816479.1250 lambd=0.0320 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_lower_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_dynamics_constraint(60): 1805924.12500 (avg 7524.68408)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_cost(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - boundary_cost(12): 10554.98535 (avg 219.89554)\n",
      "\u001b[1mINFO    \u001b[0m |  step #8: cost=1816479.1250 lambd=0.0640 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_lower_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_dynamics_constraint(60): 1805924.12500 (avg 7524.68408)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_cost(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - boundary_cost(12): 10554.98535 (avg 219.89554)\n",
      "\u001b[1mINFO    \u001b[0m |  step #9: cost=1816479.1250 lambd=0.1280 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_lower_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_dynamics_constraint(60): 1805924.12500 (avg 7524.68408)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_cost(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - boundary_cost(12): 10554.98535 (avg 219.89554)\n",
      "\u001b[1mINFO    \u001b[0m |  step #10: cost=1816479.1250 lambd=0.2560 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_lower_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_dynamics_constraint(60): 1805924.12500 (avg 7524.68408)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_cost(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - boundary_cost(12): 10554.98535 (avg 219.89554)\n",
      "\u001b[1mINFO    \u001b[0m |  step #11: cost=1816479.1250 lambd=0.5120 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_lower_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_dynamics_constraint(60): 1805924.12500 (avg 7524.68408)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_cost(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - boundary_cost(12): 10554.98535 (avg 219.89554)\n",
      "\u001b[1mINFO    \u001b[0m |  step #12: cost=1816479.1250 lambd=1.0240 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_lower_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_dynamics_constraint(60): 1805924.12500 (avg 7524.68408)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_cost(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - boundary_cost(12): 10554.98535 (avg 219.89554)\n",
      "\u001b[1mINFO    \u001b[0m |  step #13: cost=1816479.1250 lambd=2.0480 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_lower_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_dynamics_constraint(60): 1805924.12500 (avg 7524.68408)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_cost(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - boundary_cost(12): 10554.98535 (avg 219.89554)\n",
      "\u001b[1mINFO    \u001b[0m |  step #14: cost=1816479.1250 lambd=4.0960 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_lower_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_dynamics_constraint(60): 1805924.12500 (avg 7524.68408)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_cost(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - boundary_cost(12): 10554.98535 (avg 219.89554)\n",
      "\u001b[1mINFO    \u001b[0m |  step #15: cost=1816479.1250 lambd=8.1920 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_lower_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_dynamics_constraint(60): 1805924.12500 (avg 7524.68408)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_cost(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - boundary_cost(12): 10554.98535 (avg 219.89554)\n",
      "\u001b[1mINFO    \u001b[0m |  step #16: cost=1816479.1250 lambd=16.3840 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_lower_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_dynamics_constraint(60): 1805924.12500 (avg 7524.68408)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_cost(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - boundary_cost(12): 10554.98535 (avg 219.89554)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=1.64e+05 cost_prev=1816479.1250 cost_new=1205258.0000\n",
      "\u001b[1mINFO    \u001b[0m |  AL update: snorm=8.5630e-01, csupn=8.5630e-01, max_rho=1.0572e+05, inner_converged=False\n",
      "\u001b[1mINFO    \u001b[0m |  step #17: cost=1205258.0000 lambd=8.1920 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_lower_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_dynamics_constraint(60): 1201695.25000 (avg 5007.06396)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_cost(60): 1217.73413 (avg 20.29557)\n",
      "\u001b[1mINFO    \u001b[0m |      - boundary_cost(12): 2345.05713 (avg 48.85536)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=2.58e+05 cost_prev=1205258.0000 cost_new=37898.7148\n",
      "\u001b[1mINFO    \u001b[0m |  AL update: snorm=2.1977e-01, csupn=2.1977e-01, max_rho=1.0572e+05, inner_converged=False\n",
      "\u001b[1mINFO    \u001b[0m |  step #18: cost=37898.7148 lambd=4.0960 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_lower_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_dynamics_constraint(60): 36011.00391 (avg 150.04585)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_cost(60): 1183.01208 (avg 19.71687)\n",
      "\u001b[1mINFO    \u001b[0m |      - boundary_cost(12): 704.69739 (avg 14.68120)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=4.25e+04 cost_prev=37898.7148 cost_new=2399.6958\n",
      "\u001b[1mINFO    \u001b[0m |  AL update: snorm=3.3794e-02, csupn=3.3794e-02, max_rho=1.0572e+05, inner_converged=False\n",
      "\u001b[1mINFO    \u001b[0m |  step #19: cost=2399.6958 lambd=2.0480 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_lower_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_dynamics_constraint(60): 944.96472 (avg 3.93735)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_cost(60): 1215.33936 (avg 20.25566)\n",
      "\u001b[1mINFO    \u001b[0m |      - boundary_cost(12): 239.39171 (avg 4.98733)\n",
      "\u001b[1mINFO    \u001b[0m |  step #20: cost=2399.6958 lambd=4.0960 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_lower_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_dynamics_constraint(60): 944.96472 (avg 3.93735)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_cost(60): 1215.33936 (avg 20.25566)\n",
      "\u001b[1mINFO    \u001b[0m |      - boundary_cost(12): 239.39171 (avg 4.98733)\n",
      "\u001b[1mINFO    \u001b[0m |  step #21: cost=2399.6958 lambd=8.1920 inexact_tol=1.0e-02\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_lower_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_dynamics_constraint(60): 944.96472 (avg 3.93735)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_cost(60): 1215.33936 (avg 20.25566)\n",
      "\u001b[1mINFO    \u001b[0m |      - boundary_cost(12): 239.39171 (avg 4.98733)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=3.15e+03 cost_prev=2399.6958 cost_new=1538.2828\n",
      "\u001b[1mINFO    \u001b[0m |  AL update: snorm=1.2707e-02, csupn=1.2707e-02, max_rho=1.0572e+05, inner_converged=False\n",
      "\u001b[1mINFO    \u001b[0m |  step #22: cost=1538.2828 lambd=4.0960 inexact_tol=4.9e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_lower_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_dynamics_constraint(60): 241.45467 (avg 1.00606)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_cost(60): 1211.05554 (avg 20.18426)\n",
      "\u001b[1mINFO    \u001b[0m |      - boundary_cost(12): 85.77243 (avg 1.78693)\n",
      "\u001b[1mINFO    \u001b[0m |  step #23: cost=1538.2828 lambd=8.1920 inexact_tol=4.9e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_lower_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_dynamics_constraint(60): 241.45467 (avg 1.00606)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_cost(60): 1211.05554 (avg 20.18426)\n",
      "\u001b[1mINFO    \u001b[0m |      - boundary_cost(12): 85.77243 (avg 1.78693)\n",
      "\u001b[1mINFO    \u001b[0m |  step #24: cost=1538.2828 lambd=16.3840 inexact_tol=4.9e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_lower_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_dynamics_constraint(60): 241.45467 (avg 1.00606)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_cost(60): 1211.05554 (avg 20.18426)\n",
      "\u001b[1mINFO    \u001b[0m |      - boundary_cost(12): 85.77243 (avg 1.78693)\n",
      "\u001b[1mINFO    \u001b[0m |  step #25: cost=1538.2828 lambd=32.7680 inexact_tol=4.9e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_lower_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_dynamics_constraint(60): 241.45467 (avg 1.00606)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_cost(60): 1211.05554 (avg 20.18426)\n",
      "\u001b[1mINFO    \u001b[0m |      - boundary_cost(12): 85.77243 (avg 1.78693)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=1.76e+03 cost_prev=1538.2828 cost_new=1421.9125\n",
      "\u001b[1mINFO    \u001b[0m |  AL update: snorm=1.1418e-02, csupn=1.1418e-02, max_rho=1.0572e+05, inner_converged=False\n",
      "\u001b[1mINFO    \u001b[0m |  step #26: cost=1421.9125 lambd=16.3840 inexact_tol=4.9e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_lower_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_dynamics_constraint(60): 138.83307 (avg 0.57847)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_cost(60): 1211.85950 (avg 20.19766)\n",
      "\u001b[1mINFO    \u001b[0m |      - boundary_cost(12): 71.22009 (avg 1.48375)\n",
      "\u001b[1mINFO    \u001b[0m |  step #27: cost=1421.9125 lambd=32.7680 inexact_tol=4.9e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_lower_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_dynamics_constraint(60): 138.83307 (avg 0.57847)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_cost(60): 1211.85950 (avg 20.19766)\n",
      "\u001b[1mINFO    \u001b[0m |      - boundary_cost(12): 71.22009 (avg 1.48375)\n",
      "\u001b[1mINFO    \u001b[0m |  step #28: cost=1421.9125 lambd=65.5360 inexact_tol=4.9e-03\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_lower_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_dynamics_constraint(60): 138.83307 (avg 0.57847)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_cost(60): 1211.85950 (avg 20.19766)\n",
      "\u001b[1mINFO    \u001b[0m |      - boundary_cost(12): 71.22009 (avg 1.48375)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=3.24e+01 cost_prev=1421.9125 cost_new=1405.5913\n",
      "\u001b[1mINFO    \u001b[0m |  AL update: snorm=1.0839e-02, csupn=1.0839e-02, max_rho=1.0572e+05, inner_converged=False\n",
      "\u001b[1mINFO    \u001b[0m |  step #29: cost=1405.5913 lambd=32.7680 inexact_tol=3.1e-04\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_lower_bound(60): 1.11938 (avg 0.01866)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_dynamics_constraint(60): 127.37616 (avg 0.53073)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_cost(60): 1211.34875 (avg 20.18915)\n",
      "\u001b[1mINFO    \u001b[0m |      - boundary_cost(12): 65.74706 (avg 1.36973)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=3.58e+02 cost_prev=1405.5913 cost_new=1376.1820\n",
      "\u001b[1mINFO    \u001b[0m |  AL update: snorm=9.8314e-03, csupn=9.8314e-03, max_rho=1.0572e+05, inner_converged=False\n",
      "\u001b[1mINFO    \u001b[0m |  step #30: cost=1376.1820 lambd=16.3840 inexact_tol=3.1e-04\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_lower_bound(60): 0.00010 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_dynamics_constraint(60): 111.62934 (avg 0.46512)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_cost(60): 1206.93677 (avg 20.11561)\n",
      "\u001b[1mINFO    \u001b[0m |      - boundary_cost(12): 57.61580 (avg 1.20033)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=3.07e+01 cost_prev=1376.1820 cost_new=1334.4932\n",
      "\u001b[1mINFO    \u001b[0m |  AL update: snorm=8.2908e-03, csupn=8.2908e-03, max_rho=1.0572e+05, inner_converged=False\n",
      "\u001b[1mINFO    \u001b[0m |  step #31: cost=1334.4932 lambd=8.1920 inexact_tol=3.1e-04\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_lower_bound(60): 0.00008 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_dynamics_constraint(60): 91.15641 (avg 0.37982)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_cost(60): 1196.41357 (avg 19.94023)\n",
      "\u001b[1mINFO    \u001b[0m |      - boundary_cost(12): 46.92320 (avg 0.97757)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=5.67e+01 cost_prev=1334.4932 cost_new=1282.3281\n",
      "\u001b[1mINFO    \u001b[0m |  AL update: snorm=6.4011e-03, csupn=6.4011e-03, max_rho=1.0572e+05, inner_converged=False\n",
      "\u001b[1mINFO    \u001b[0m |  step #32: cost=1282.3281 lambd=4.0960 inexact_tol=3.1e-04\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_lower_bound(60): 0.00005 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_dynamics_constraint(60): 71.30376 (avg 0.29710)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_cost(60): 1174.59985 (avg 19.57667)\n",
      "\u001b[1mINFO    \u001b[0m |      - boundary_cost(12): 36.42455 (avg 0.75884)\n",
      "\u001b[1mINFO    \u001b[0m |  step #33: cost=1282.3281 lambd=8.1920 inexact_tol=3.1e-04\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_lower_bound(60): 0.00005 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_dynamics_constraint(60): 71.30376 (avg 0.29710)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_cost(60): 1174.59985 (avg 19.57667)\n",
      "\u001b[1mINFO    \u001b[0m |      - boundary_cost(12): 36.42455 (avg 0.75884)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=1.12e+02 cost_prev=1282.3281 cost_new=1247.3293\n",
      "\u001b[1mINFO    \u001b[0m |  AL update: snorm=5.2476e-03, csupn=5.2476e-03, max_rho=1.0572e+05, inner_converged=False\n",
      "\u001b[1mINFO    \u001b[0m |  step #34: cost=1247.3293 lambd=4.0960 inexact_tol=3.1e-04\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_lower_bound(60): 0.00004 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_dynamics_constraint(60): 60.84770 (avg 0.25353)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_cost(60): 1155.32556 (avg 19.25543)\n",
      "\u001b[1mINFO    \u001b[0m |      - boundary_cost(12): 31.15633 (avg 0.64909)\n",
      "\u001b[1mINFO    \u001b[0m |  step #35: cost=1247.3293 lambd=8.1920 inexact_tol=3.1e-04\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_lower_bound(60): 0.00004 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_dynamics_constraint(60): 60.84770 (avg 0.25353)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_cost(60): 1155.32556 (avg 19.25543)\n",
      "\u001b[1mINFO    \u001b[0m |      - boundary_cost(12): 31.15633 (avg 0.64909)\n",
      "\u001b[1mINFO    \u001b[0m |  step #36: cost=1247.3293 lambd=16.3840 inexact_tol=3.1e-04\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_lower_bound(60): 0.00004 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_dynamics_constraint(60): 60.84770 (avg 0.25353)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_cost(60): 1155.32556 (avg 19.25543)\n",
      "\u001b[1mINFO    \u001b[0m |      - boundary_cost(12): 31.15633 (avg 0.64909)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=6.86e+01 cost_prev=1247.3293 cost_new=1233.3575\n",
      "\u001b[1mINFO    \u001b[0m |  AL update: snorm=4.9002e-03, csupn=4.9002e-03, max_rho=1.0572e+05, inner_converged=False\n",
      "\u001b[1mINFO    \u001b[0m |  step #37: cost=1233.3575 lambd=8.1920 inexact_tol=3.1e-04\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_lower_bound(60): 0.00003 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_dynamics_constraint(60): 57.30374 (avg 0.23877)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_cost(60): 1146.85010 (avg 19.11417)\n",
      "\u001b[1mINFO    \u001b[0m |      - boundary_cost(12): 29.20385 (avg 0.60841)\n",
      "\u001b[1mINFO    \u001b[0m |  step #38: cost=1233.3575 lambd=16.3840 inexact_tol=3.1e-04\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_lower_bound(60): 0.00003 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_dynamics_constraint(60): 57.30374 (avg 0.23877)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_cost(60): 1146.85010 (avg 19.11417)\n",
      "\u001b[1mINFO    \u001b[0m |      - boundary_cost(12): 29.20385 (avg 0.60841)\n",
      "\u001b[1mINFO    \u001b[0m |  step #39: cost=1233.3575 lambd=32.7680 inexact_tol=3.1e-04\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_lower_bound(60): 0.00003 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_dynamics_constraint(60): 57.30374 (avg 0.23877)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_cost(60): 1146.85010 (avg 19.11417)\n",
      "\u001b[1mINFO    \u001b[0m |      - boundary_cost(12): 29.20385 (avg 0.60841)\n",
      "\u001b[1mINFO    \u001b[0m |  step #40: cost=1233.3575 lambd=65.5360 inexact_tol=3.1e-04\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_lower_bound(60): 0.00003 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_dynamics_constraint(60): 57.30374 (avg 0.23877)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_cost(60): 1146.85010 (avg 19.11417)\n",
      "\u001b[1mINFO    \u001b[0m |      - boundary_cost(12): 29.20385 (avg 0.60841)\n",
      "\u001b[1mINFO    \u001b[0m |  step #41: cost=1233.3575 lambd=131.0720 inexact_tol=3.1e-04\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_lower_bound(60): 0.00003 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_dynamics_constraint(60): 57.30374 (avg 0.23877)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_cost(60): 1146.85010 (avg 19.11417)\n",
      "\u001b[1mINFO    \u001b[0m |      - boundary_cost(12): 29.20385 (avg 0.60841)\n",
      "\u001b[1mINFO    \u001b[0m |  step #42: cost=1233.3575 lambd=262.1440 inexact_tol=3.1e-04\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_lower_bound(60): 0.00003 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_dynamics_constraint(60): 57.30374 (avg 0.23877)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_cost(60): 1146.85010 (avg 19.11417)\n",
      "\u001b[1mINFO    \u001b[0m |      - boundary_cost(12): 29.20385 (avg 0.60841)\n",
      "\u001b[1mINFO    \u001b[0m |  step #43: cost=1233.3575 lambd=524.2880 inexact_tol=3.1e-04\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_lower_bound(60): 0.00003 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_dynamics_constraint(60): 57.30374 (avg 0.23877)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_cost(60): 1146.85010 (avg 19.11417)\n",
      "\u001b[1mINFO    \u001b[0m |      - boundary_cost(12): 29.20385 (avg 0.60841)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=1.75e+01 cost_prev=1233.3575 cost_new=1232.9393\n",
      "\u001b[1mINFO    \u001b[0m |  AL update: snorm=4.9180e-03, csupn=4.9180e-03, max_rho=1.0572e+06, inner_converged=True\n",
      "\u001b[1mINFO    \u001b[0m |  step #44: cost=1433.1947 lambd=262.1440 inexact_tol=3.1e-04\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_lower_bound(60): 0.00038 (avg 0.00001)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_dynamics_constraint(60): 257.44833 (avg 1.07270)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_cost(60): 1146.60730 (avg 19.11012)\n",
      "\u001b[1mINFO    \u001b[0m |      - boundary_cost(12): 29.13865 (avg 0.60706)\n",
      "\u001b[1mINFO    \u001b[0m |  step #45: cost=1433.1947 lambd=524.2880 inexact_tol=3.1e-04\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_lower_bound(60): 0.00038 (avg 0.00001)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_dynamics_constraint(60): 257.44833 (avg 1.07270)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_cost(60): 1146.60730 (avg 19.11012)\n",
      "\u001b[1mINFO    \u001b[0m |      - boundary_cost(12): 29.13865 (avg 0.60706)\n",
      "\u001b[1mINFO    \u001b[0m |  step #46: cost=1433.1947 lambd=1048.5760 inexact_tol=3.1e-04\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_lower_bound(60): 0.00038 (avg 0.00001)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_dynamics_constraint(60): 257.44833 (avg 1.07270)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_cost(60): 1146.60730 (avg 19.11012)\n",
      "\u001b[1mINFO    \u001b[0m |      - boundary_cost(12): 29.13865 (avg 0.60706)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=2.46e+03 cost_prev=1433.1947 cost_new=1413.2758\n",
      "\u001b[1mINFO    \u001b[0m |  AL update: snorm=1.3571e-02, csupn=1.3571e-02, max_rho=1.0572e+06, inner_converged=False\n",
      "\u001b[1mINFO    \u001b[0m |  step #47: cost=1413.2758 lambd=524.2880 inexact_tol=3.1e-04\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_lower_bound(60): 19.47034 (avg 0.32451)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_dynamics_constraint(60): 195.00543 (avg 0.81252)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_cost(60): 1148.02161 (avg 19.13369)\n",
      "\u001b[1mINFO    \u001b[0m |      - boundary_cost(12): 50.77815 (avg 1.05788)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=1.49e+03 cost_prev=1413.2758 cost_new=1387.8641\n",
      "\u001b[1mINFO    \u001b[0m |  AL update: snorm=4.0770e-03, csupn=4.0770e-03, max_rho=1.0572e+06, inner_converged=False\n",
      "\u001b[1mINFO    \u001b[0m |  step #48: cost=1387.8641 lambd=262.1440 inexact_tol=3.1e-04\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_lower_bound(60): 0.00364 (avg 0.00006)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_dynamics_constraint(60): 180.48836 (avg 0.75203)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_cost(60): 1149.86292 (avg 19.16438)\n",
      "\u001b[1mINFO    \u001b[0m |      - boundary_cost(12): 57.50916 (avg 1.19811)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=3.63e+01 cost_prev=1387.8641 cost_new=1381.7618\n",
      "\u001b[1mINFO    \u001b[0m |  AL update: snorm=3.6390e-03, csupn=3.6390e-03, max_rho=1.0572e+06, inner_converged=True\n",
      "\u001b[1mINFO    \u001b[0m |  step #49: cost=1585.3141 lambd=131.0720 inexact_tol=3.1e-04\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_lower_bound(60): 0.01550 (avg 0.00026)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_dynamics_constraint(60): 370.83170 (avg 1.54513)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_cost(60): 1153.65710 (avg 19.22762)\n",
      "\u001b[1mINFO    \u001b[0m |      - boundary_cost(12): 60.80987 (avg 1.26687)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=4.39e+03 cost_prev=1585.3141 cost_new=1518.2073\n",
      "\u001b[1mINFO    \u001b[0m |  AL update: snorm=4.0779e-03, csupn=4.0779e-03, max_rho=1.0572e+06, inner_converged=False\n",
      "\u001b[1mINFO    \u001b[0m |  step #50: cost=1518.2073 lambd=65.5360 inexact_tol=3.1e-04\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_lower_bound(60): 0.00053 (avg 0.00001)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_dynamics_constraint(60): 268.27316 (avg 1.11780)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_cost(60): 1167.63293 (avg 19.46055)\n",
      "\u001b[1mINFO    \u001b[0m |      - boundary_cost(12): 82.30062 (avg 1.71460)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=4.65e+01 cost_prev=1518.2073 cost_new=1485.0570\n",
      "\u001b[1mINFO    \u001b[0m |  AL update: snorm=3.5813e-03, csupn=3.5813e-03, max_rho=1.0572e+06, inner_converged=False\n",
      "\u001b[1mINFO    \u001b[0m |  step #51: cost=1485.0570 lambd=32.7680 inexact_tol=1.0e-04\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_lower_bound(60): 0.00033 (avg 0.00001)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_dynamics_constraint(60): 212.55637 (avg 0.88565)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_cost(60): 1188.04419 (avg 19.80074)\n",
      "\u001b[1mINFO    \u001b[0m |      - boundary_cost(12): 84.45638 (avg 1.75951)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=3.16e+01 cost_prev=1485.0570 cost_new=1452.4296\n",
      "\u001b[1mINFO    \u001b[0m |  AL update: snorm=2.8131e-03, csupn=2.8131e-03, max_rho=1.0572e+06, inner_converged=False\n",
      "\u001b[1mINFO    \u001b[0m |  step #52: cost=1452.4296 lambd=16.3840 inexact_tol=1.0e-04\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_lower_bound(60): 0.00016 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_dynamics_constraint(60): 162.05928 (avg 0.67525)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_cost(60): 1213.80627 (avg 20.23011)\n",
      "\u001b[1mINFO    \u001b[0m |      - boundary_cost(12): 76.56392 (avg 1.59508)\n",
      "\u001b[1mINFO    \u001b[0m |  step #53: cost=1452.4296 lambd=32.7680 inexact_tol=1.0e-04\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_lower_bound(60): 0.00016 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_dynamics_constraint(60): 162.05928 (avg 0.67525)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_cost(60): 1213.80627 (avg 20.23011)\n",
      "\u001b[1mINFO    \u001b[0m |      - boundary_cost(12): 76.56392 (avg 1.59508)\n",
      "\u001b[1mINFO    \u001b[0m |  step #54: cost=1452.4296 lambd=65.5360 inexact_tol=1.0e-04\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_lower_bound(60): 0.00016 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_dynamics_constraint(60): 162.05928 (avg 0.67525)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_cost(60): 1213.80627 (avg 20.23011)\n",
      "\u001b[1mINFO    \u001b[0m |      - boundary_cost(12): 76.56392 (avg 1.59508)\n",
      "\u001b[1mINFO    \u001b[0m |  step #55: cost=1452.4296 lambd=131.0720 inexact_tol=1.0e-04\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_lower_bound(60): 0.00016 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_dynamics_constraint(60): 162.05928 (avg 0.67525)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_cost(60): 1213.80627 (avg 20.23011)\n",
      "\u001b[1mINFO    \u001b[0m |      - boundary_cost(12): 76.56392 (avg 1.59508)\n",
      "\u001b[1mINFO    \u001b[0m |  step #56: cost=1452.4296 lambd=262.1440 inexact_tol=1.0e-04\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_lower_bound(60): 0.00016 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_dynamics_constraint(60): 162.05928 (avg 0.67525)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_cost(60): 1213.80627 (avg 20.23011)\n",
      "\u001b[1mINFO    \u001b[0m |      - boundary_cost(12): 76.56392 (avg 1.59508)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=4.18e+01 cost_prev=1452.4296 cost_new=1449.9518\n",
      "\u001b[1mINFO    \u001b[0m |  AL update: snorm=2.7215e-03, csupn=2.7215e-03, max_rho=1.0000e+07, inner_converged=True\n",
      "\u001b[1mINFO    \u001b[0m |  step #57: cost=1468.5273 lambd=131.0720 inexact_tol=1.0e-04\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_lower_bound(60): 9.29168 (avg 0.15486)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_dynamics_constraint(60): 166.83406 (avg 0.69514)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_cost(60): 1216.83521 (avg 20.28059)\n",
      "\u001b[1mINFO    \u001b[0m |      - boundary_cost(12): 75.56646 (avg 1.57430)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=3.71e+03 cost_prev=1468.5273 cost_new=1448.8378\n",
      "\u001b[1mINFO    \u001b[0m |  AL update: snorm=1.6701e-03, csupn=1.6701e-03, max_rho=1.0000e+07, inner_converged=True\n",
      "\u001b[1mINFO    \u001b[0m |  step #58: cost=1394.1461 lambd=65.5360 inexact_tol=1.0e-04\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_lower_bound(60): 0.00005 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_dynamics_constraint(60): 94.14177 (avg 0.39226)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_cost(60): 1219.80957 (avg 20.33016)\n",
      "\u001b[1mINFO    \u001b[0m |      - boundary_cost(12): 80.19482 (avg 1.67073)\n",
      "\u001b[1mINFO    \u001b[0m |  step #59: cost=1394.1461 lambd=131.0720 inexact_tol=1.0e-04\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_lower_bound(60): 0.00005 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_dynamics_constraint(60): 94.14177 (avg 0.39226)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_cost(60): 1219.80957 (avg 20.33016)\n",
      "\u001b[1mINFO    \u001b[0m |      - boundary_cost(12): 80.19482 (avg 1.67073)\n",
      "\u001b[1mINFO    \u001b[0m |  step #60: cost=1394.1461 lambd=262.1440 inexact_tol=1.0e-04\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_lower_bound(60): 0.00005 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_dynamics_constraint(60): 94.14177 (avg 0.39226)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_cost(60): 1219.80957 (avg 20.33016)\n",
      "\u001b[1mINFO    \u001b[0m |      - boundary_cost(12): 80.19482 (avg 1.67073)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=1.00e+03 cost_prev=1394.1461 cost_new=1390.3269\n",
      "\u001b[1mINFO    \u001b[0m |  AL update: snorm=2.6655e-03, csupn=2.6655e-03, max_rho=1.0000e+07, inner_converged=False\n",
      "\u001b[1mINFO    \u001b[0m |  step #61: cost=1390.3269 lambd=131.0720 inexact_tol=1.0e-04\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_lower_bound(60): 7.54697 (avg 0.12578)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_dynamics_constraint(60): 87.42477 (avg 0.36427)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_cost(60): 1218.77698 (avg 20.31295)\n",
      "\u001b[1mINFO    \u001b[0m |      - boundary_cost(12): 76.57829 (avg 1.59538)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=2.96e+03 cost_prev=1390.3269 cost_new=1376.3423\n",
      "\u001b[1mINFO    \u001b[0m |  AL update: snorm=1.0915e-03, csupn=1.0915e-03, max_rho=1.0000e+07, inner_converged=False\n",
      "\u001b[1mINFO    \u001b[0m |  step #62: cost=1376.3423 lambd=65.5360 inexact_tol=1.0e-04\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_lower_bound(60): 0.00005 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_dynamics_constraint(60): 85.64678 (avg 0.35686)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_cost(60): 1219.02002 (avg 20.31700)\n",
      "\u001b[1mINFO    \u001b[0m |      - boundary_cost(12): 71.67519 (avg 1.49323)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=7.12e+01 cost_prev=1376.3423 cost_new=1367.2699\n",
      "\u001b[1mINFO    \u001b[0m |  AL update: snorm=4.3857e-04, csupn=4.3857e-04, max_rho=1.0000e+07, inner_converged=True\n",
      "\u001b[1mINFO    \u001b[0m |  step #63: cost=1363.1577 lambd=32.7680 inexact_tol=1.0e-04\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_lower_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_dynamics_constraint(60): 75.90777 (avg 0.31628)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_cost(60): 1222.26343 (avg 20.37106)\n",
      "\u001b[1mINFO    \u001b[0m |      - boundary_cost(12): 64.98666 (avg 1.35389)\n",
      "\u001b[1mINFO    \u001b[0m |  step #64: cost=1363.1577 lambd=65.5360 inexact_tol=1.0e-04\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_lower_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_dynamics_constraint(60): 75.90777 (avg 0.31628)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_cost(60): 1222.26343 (avg 20.37106)\n",
      "\u001b[1mINFO    \u001b[0m |      - boundary_cost(12): 64.98666 (avg 1.35389)\n",
      "\u001b[1mINFO    \u001b[0m |  step #65: cost=1363.1577 lambd=131.0720 inexact_tol=1.0e-04\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_lower_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_dynamics_constraint(60): 75.90777 (avg 0.31628)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_cost(60): 1222.26343 (avg 20.37106)\n",
      "\u001b[1mINFO    \u001b[0m |      - boundary_cost(12): 64.98666 (avg 1.35389)\n",
      "\u001b[1mINFO    \u001b[0m |  step #66: cost=1363.1577 lambd=262.1440 inexact_tol=1.0e-04\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_lower_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_dynamics_constraint(60): 75.90777 (avg 0.31628)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_cost(60): 1222.26343 (avg 20.37106)\n",
      "\u001b[1mINFO    \u001b[0m |      - boundary_cost(12): 64.98666 (avg 1.35389)\n",
      "\u001b[1mINFO    \u001b[0m |  step #67: cost=1363.1577 lambd=524.2880 inexact_tol=1.0e-04\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_lower_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_dynamics_constraint(60): 75.90777 (avg 0.31628)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_cost(60): 1222.26343 (avg 20.37106)\n",
      "\u001b[1mINFO    \u001b[0m |      - boundary_cost(12): 64.98666 (avg 1.35389)\n",
      "\u001b[1mINFO    \u001b[0m |  step #68: cost=1363.1577 lambd=1048.5760 inexact_tol=1.0e-04\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_lower_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_dynamics_constraint(60): 75.90777 (avg 0.31628)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_cost(60): 1222.26343 (avg 20.37106)\n",
      "\u001b[1mINFO    \u001b[0m |      - boundary_cost(12): 64.98666 (avg 1.35389)\n",
      "\u001b[1mINFO    \u001b[0m |  step #69: cost=1363.1577 lambd=2097.1521 inexact_tol=1.0e-04\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_lower_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_dynamics_constraint(60): 75.90777 (avg 0.31628)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_cost(60): 1222.26343 (avg 20.37106)\n",
      "\u001b[1mINFO    \u001b[0m |      - boundary_cost(12): 64.98666 (avg 1.35389)\n",
      "\u001b[1mINFO    \u001b[0m |  step #70: cost=1363.1577 lambd=4194.3042 inexact_tol=1.0e-04\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_lower_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_dynamics_constraint(60): 75.90777 (avg 0.31628)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_cost(60): 1222.26343 (avg 20.37106)\n",
      "\u001b[1mINFO    \u001b[0m |      - boundary_cost(12): 64.98666 (avg 1.35389)\n",
      "\u001b[1mINFO    \u001b[0m |  step #71: cost=1363.1577 lambd=8388.6084 inexact_tol=1.0e-04\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_lower_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_dynamics_constraint(60): 75.90777 (avg 0.31628)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_cost(60): 1222.26343 (avg 20.37106)\n",
      "\u001b[1mINFO    \u001b[0m |      - boundary_cost(12): 64.98666 (avg 1.35389)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=1.38e+03 cost_prev=1363.1577 cost_new=1362.6167\n",
      "\u001b[1mINFO    \u001b[0m |  AL update: snorm=4.2272e-04, csupn=4.2272e-04, max_rho=1.0000e+07, inner_converged=True\n",
      "\u001b[1mINFO    \u001b[0m |  step #72: cost=1324.1345 lambd=4194.3042 inexact_tol=1.0e-04\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_lower_bound(60): 3.16400 (avg 0.05273)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_dynamics_constraint(60): 34.26021 (avg 0.14275)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_cost(60): 1222.28064 (avg 20.37135)\n",
      "\u001b[1mINFO    \u001b[0m |      - boundary_cost(12): 64.42976 (avg 1.34229)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=6.14e+03 cost_prev=1324.1345 cost_new=1319.6340\n",
      "\u001b[1mINFO    \u001b[0m |  AL update: snorm=3.4237e-04, csupn=2.9969e-04, max_rho=1.0000e+07, inner_converged=False\n",
      "\u001b[1mINFO    \u001b[0m |  step #73: cost=1319.6340 lambd=2097.1521 inexact_tol=1.0e-04\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_lower_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_dynamics_constraint(60): 33.75049 (avg 0.14063)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_cost(60): 1222.16455 (avg 20.36941)\n",
      "\u001b[1mINFO    \u001b[0m |      - boundary_cost(12): 63.71895 (avg 1.32748)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=3.51e+01 cost_prev=1319.6340 cost_new=1319.3131\n",
      "\u001b[1mINFO    \u001b[0m |  AL update: snorm=3.6335e-04, csupn=3.6335e-04, max_rho=1.0000e+07, inner_converged=True\n",
      "\u001b[1mINFO    \u001b[0m |  step #74: cost=1310.1614 lambd=1048.5760 inexact_tol=2.9e-05\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_lower_bound(60): 1.61560 (avg 0.02693)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_dynamics_constraint(60): 23.29877 (avg 0.09708)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_cost(60): 1222.08972 (avg 20.36816)\n",
      "\u001b[1mINFO    \u001b[0m |      - boundary_cost(12): 63.15729 (avg 1.31578)\n",
      "\u001b[1mINFO    \u001b[0m |  step #75: cost=1310.1614 lambd=2097.1521 inexact_tol=2.9e-05\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_lower_bound(60): 1.61560 (avg 0.02693)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_dynamics_constraint(60): 23.29877 (avg 0.09708)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_cost(60): 1222.08972 (avg 20.36816)\n",
      "\u001b[1mINFO    \u001b[0m |      - boundary_cost(12): 63.15729 (avg 1.31578)\n",
      "\u001b[1mINFO    \u001b[0m |  step #76: cost=1310.1614 lambd=4194.3042 inexact_tol=2.9e-05\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_lower_bound(60): 1.61560 (avg 0.02693)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_dynamics_constraint(60): 23.29877 (avg 0.09708)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_cost(60): 1222.08972 (avg 20.36816)\n",
      "\u001b[1mINFO    \u001b[0m |      - boundary_cost(12): 63.15729 (avg 1.31578)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=4.66e+03 cost_prev=1310.1614 cost_new=1308.2646\n",
      "\u001b[1mINFO    \u001b[0m |  AL update: snorm=2.0218e-04, csupn=2.0218e-04, max_rho=1.0000e+07, inner_converged=True\n",
      "\u001b[1mINFO    \u001b[0m |  step #77: cost=1290.5809 lambd=2097.1521 inexact_tol=2.9e-05\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_lower_bound(60): 1.63713 (avg 0.02729)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_dynamics_constraint(60): 4.01062 (avg 0.01671)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_cost(60): 1221.99548 (avg 20.36659)\n",
      "\u001b[1mINFO    \u001b[0m |      - boundary_cost(12): 62.93769 (avg 1.31120)\n",
      "\u001b[1mINFO    \u001b[0m |  step #78: cost=1290.5809 lambd=4194.3042 inexact_tol=2.9e-05\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_lower_bound(60): 1.63713 (avg 0.02729)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_dynamics_constraint(60): 4.01062 (avg 0.01671)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_cost(60): 1221.99548 (avg 20.36659)\n",
      "\u001b[1mINFO    \u001b[0m |      - boundary_cost(12): 62.93769 (avg 1.31120)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=4.29e+03 cost_prev=1290.5809 cost_new=1288.9012\n",
      "\u001b[1mINFO    \u001b[0m |  AL update: snorm=2.0218e-04, csupn=1.6499e-04, max_rho=1.0000e+07, inner_converged=False\n",
      "\u001b[1mINFO    \u001b[0m |  step #79: cost=1288.9012 lambd=2097.1521 inexact_tol=2.9e-05\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_lower_bound(60): 0.27369 (avg 0.00456)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_dynamics_constraint(60): 4.29752 (avg 0.01791)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_cost(60): 1221.91833 (avg 20.36531)\n",
      "\u001b[1mINFO    \u001b[0m |      - boundary_cost(12): 62.41175 (avg 1.30024)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=1.74e+03 cost_prev=1288.9012 cost_new=1288.2922\n",
      "\u001b[1mINFO    \u001b[0m |  AL update: snorm=2.0218e-04, csupn=7.9751e-05, max_rho=1.0000e+07, inner_converged=True\n",
      "\u001b[1mINFO    \u001b[0m |  step #80: cost=1287.9323 lambd=1048.5760 inexact_tol=2.9e-05\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_lower_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_dynamics_constraint(60): 4.11695 (avg 0.01715)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_cost(60): 1221.86475 (avg 20.36441)\n",
      "\u001b[1mINFO    \u001b[0m |      - boundary_cost(12): 61.95068 (avg 1.29064)\n",
      "\u001b[1mINFO    \u001b[0m |  step #81: cost=1287.9323 lambd=2097.1521 inexact_tol=2.9e-05\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_lower_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_dynamics_constraint(60): 4.11695 (avg 0.01715)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_cost(60): 1221.86475 (avg 20.36441)\n",
      "\u001b[1mINFO    \u001b[0m |      - boundary_cost(12): 61.95068 (avg 1.29064)\n",
      "\u001b[1mINFO    \u001b[0m |  step #82: cost=1287.9323 lambd=4194.3042 inexact_tol=2.9e-05\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_lower_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_dynamics_constraint(60): 4.11695 (avg 0.01715)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_cost(60): 1221.86475 (avg 20.36441)\n",
      "\u001b[1mINFO    \u001b[0m |      - boundary_cost(12): 61.95068 (avg 1.29064)\n",
      "\u001b[1mINFO    \u001b[0m |  step #83: cost=1287.9323 lambd=8388.6084 inexact_tol=2.9e-05\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_lower_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_dynamics_constraint(60): 4.11695 (avg 0.01715)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_cost(60): 1221.86475 (avg 20.36441)\n",
      "\u001b[1mINFO    \u001b[0m |      - boundary_cost(12): 61.95068 (avg 1.29064)\n",
      "\u001b[1mINFO    \u001b[0m |  step #84: cost=1287.9323 lambd=16777.2168 inexact_tol=2.9e-05\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_lower_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_dynamics_constraint(60): 4.11695 (avg 0.01715)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_cost(60): 1221.86475 (avg 20.36441)\n",
      "\u001b[1mINFO    \u001b[0m |      - boundary_cost(12): 61.95068 (avg 1.29064)\n",
      "\u001b[1mINFO    \u001b[0m |  step #85: cost=1287.9323 lambd=33554.4336 inexact_tol=2.9e-05\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_lower_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_dynamics_constraint(60): 4.11695 (avg 0.01715)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_cost(60): 1221.86475 (avg 20.36441)\n",
      "\u001b[1mINFO    \u001b[0m |      - boundary_cost(12): 61.95068 (avg 1.29064)\n",
      "\u001b[1mINFO    \u001b[0m |  step #86: cost=1287.9323 lambd=67108.8672 inexact_tol=2.9e-05\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_lower_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_dynamics_constraint(60): 4.11695 (avg 0.01715)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_cost(60): 1221.86475 (avg 20.36441)\n",
      "\u001b[1mINFO    \u001b[0m |      - boundary_cost(12): 61.95068 (avg 1.29064)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=1.06e+03 cost_prev=1287.9323 cost_new=1287.9110\n",
      "\u001b[1mINFO    \u001b[0m |  AL update: snorm=7.5340e-05, csupn=7.5340e-05, max_rho=1.0000e+07, inner_converged=True\n",
      "\u001b[1mINFO    \u001b[0m |  step #87: cost=1288.1426 lambd=33554.4336 inexact_tol=2.9e-05\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_lower_bound(60): 0.22826 (avg 0.00380)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_dynamics_constraint(60): 4.13414 (avg 0.01723)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_cost(60): 1221.87231 (avg 20.36454)\n",
      "\u001b[1mINFO    \u001b[0m |      - boundary_cost(12): 61.90799 (avg 1.28975)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=1.59e+03 cost_prev=1288.1426 cost_new=1288.0981\n",
      "\u001b[1mINFO    \u001b[0m |  AL update: snorm=1.5545e-04, csupn=1.5545e-04, max_rho=1.0000e+07, inner_converged=True\n",
      "\u001b[1mINFO    \u001b[0m |  step #88: cost=1288.3821 lambd=16777.2168 inexact_tol=2.9e-05\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_lower_bound(60): 0.96658 (avg 0.01611)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_dynamics_constraint(60): 3.66926 (avg 0.01529)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_cost(60): 1221.88855 (avg 20.36481)\n",
      "\u001b[1mINFO    \u001b[0m |      - boundary_cost(12): 61.85766 (avg 1.28870)\n",
      "\u001b[1mINFO    \u001b[0m |  step #89: cost=1288.3821 lambd=33554.4336 inexact_tol=2.9e-05\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_lower_bound(60): 0.96658 (avg 0.01611)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_dynamics_constraint(60): 3.66926 (avg 0.01529)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_cost(60): 1221.88855 (avg 20.36481)\n",
      "\u001b[1mINFO    \u001b[0m |      - boundary_cost(12): 61.85766 (avg 1.28870)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=3.26e+03 cost_prev=1288.3821 cost_new=1287.7029\n",
      "\u001b[1mINFO    \u001b[0m |  AL update: snorm=1.8406e-04, csupn=1.8406e-04, max_rho=1.0000e+07, inner_converged=True\n",
      "\u001b[1mINFO    \u001b[0m |  step #90: cost=1287.7079 lambd=16777.2168 inexact_tol=2.9e-05\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_lower_bound(60): 1.36512 (avg 0.02275)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_dynamics_constraint(60): 2.55578 (avg 0.01065)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_cost(60): 1221.90466 (avg 20.36508)\n",
      "\u001b[1mINFO    \u001b[0m |      - boundary_cost(12): 61.88216 (avg 1.28921)\n",
      "\u001b[1mINFO    \u001b[0m |  step #91: cost=1287.7079 lambd=33554.4336 inexact_tol=2.9e-05\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_lower_bound(60): 1.36512 (avg 0.02275)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_dynamics_constraint(60): 2.55578 (avg 0.01065)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_cost(60): 1221.90466 (avg 20.36508)\n",
      "\u001b[1mINFO    \u001b[0m |      - boundary_cost(12): 61.88216 (avg 1.28921)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=3.86e+03 cost_prev=1287.7079 cost_new=1286.5648\n",
      "\u001b[1mINFO    \u001b[0m |  AL update: snorm=1.8311e-04, csupn=1.6499e-04, max_rho=1.0000e+07, inner_converged=True\n",
      "\u001b[1mINFO    \u001b[0m |  step #92: cost=1287.4193 lambd=16777.2168 inexact_tol=2.9e-05\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_lower_bound(60): 1.10144 (avg 0.01836)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_dynamics_constraint(60): 2.43935 (avg 0.01016)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_cost(60): 1221.92175 (avg 20.36536)\n",
      "\u001b[1mINFO    \u001b[0m |      - boundary_cost(12): 61.95699 (avg 1.29077)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=3.47e+03 cost_prev=1287.4193 cost_new=1286.9832\n",
      "\u001b[1mINFO    \u001b[0m |  AL update: snorm=2.6989e-04, csupn=2.6989e-04, max_rho=1.0000e+07, inner_converged=True\n",
      "\u001b[1mINFO    \u001b[0m |  step #93: cost=1289.0365 lambd=8388.6084 inexact_tol=2.9e-05\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_lower_bound(60): 2.93862 (avg 0.04898)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_dynamics_constraint(60): 2.10732 (avg 0.00878)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_cost(60): 1221.95178 (avg 20.36586)\n",
      "\u001b[1mINFO    \u001b[0m |      - boundary_cost(12): 62.03889 (avg 1.29248)\n",
      "\u001b[1mINFO    \u001b[0m |  step #94: cost=1289.0365 lambd=16777.2168 inexact_tol=2.9e-05\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_lower_bound(60): 2.93862 (avg 0.04898)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_dynamics_constraint(60): 2.10732 (avg 0.00878)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_cost(60): 1221.95178 (avg 20.36586)\n",
      "\u001b[1mINFO    \u001b[0m |      - boundary_cost(12): 62.03889 (avg 1.29248)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=5.67e+03 cost_prev=1289.0365 cost_new=1286.6815\n",
      "\u001b[1mINFO    \u001b[0m |  AL update: snorm=2.7084e-04, csupn=2.4891e-04, max_rho=1.0000e+07, inner_converged=True\n",
      "\u001b[1mINFO    \u001b[0m |  step #95: cost=1288.3661 lambd=8388.6084 inexact_tol=2.9e-05\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_lower_bound(60): 2.48773 (avg 0.04146)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_dynamics_constraint(60): 1.87027 (avg 0.00779)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_cost(60): 1221.96472 (avg 20.36608)\n",
      "\u001b[1mINFO    \u001b[0m |      - boundary_cost(12): 62.04350 (avg 1.29257)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=5.23e+03 cost_prev=1288.3661 cost_new=1286.1896\n",
      "\u001b[1mINFO    \u001b[0m |  AL update: snorm=2.4891e-04, csupn=1.9264e-04, max_rho=1.0000e+07, inner_converged=True\n",
      "\u001b[1mINFO    \u001b[0m |  step #96: cost=1287.1671 lambd=4194.3042 inexact_tol=2.9e-05\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_lower_bound(60): 1.49492 (avg 0.02492)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_dynamics_constraint(60): 1.74794 (avg 0.00728)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_cost(60): 1221.97168 (avg 20.36620)\n",
      "\u001b[1mINFO    \u001b[0m |      - boundary_cost(12): 61.95255 (avg 1.29068)\n",
      "\u001b[1mINFO    \u001b[0m |  step #97: cost=1287.1671 lambd=8388.6084 inexact_tol=2.9e-05\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_lower_bound(60): 1.49492 (avg 0.02492)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_dynamics_constraint(60): 1.74794 (avg 0.00728)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_cost(60): 1221.97168 (avg 20.36620)\n",
      "\u001b[1mINFO    \u001b[0m |      - boundary_cost(12): 61.95255 (avg 1.29068)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=4.05e+03 cost_prev=1287.1671 cost_new=1286.0896\n",
      "\u001b[1mINFO    \u001b[0m |  AL update: snorm=2.2125e-04, csupn=2.2125e-04, max_rho=1.0000e+07, inner_converged=True\n",
      "\u001b[1mINFO    \u001b[0m |  step #98: cost=1287.4895 lambd=4194.3042 inexact_tol=2.9e-05\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_lower_bound(60): 1.96656 (avg 0.03278)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_dynamics_constraint(60): 1.73766 (avg 0.00724)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_cost(60): 1221.96899 (avg 20.36615)\n",
      "\u001b[1mINFO    \u001b[0m |      - boundary_cost(12): 61.81639 (avg 1.28784)\n",
      "\u001b[1mINFO    \u001b[0m |  step #99: cost=1287.4895 lambd=8388.6084 inexact_tol=2.9e-05\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_lower_bound(60): 1.96656 (avg 0.03278)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_dynamics_constraint(60): 1.73766 (avg 0.00724)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_cost(60): 1221.96899 (avg 20.36615)\n",
      "\u001b[1mINFO    \u001b[0m |      - boundary_cost(12): 61.81639 (avg 1.28784)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=4.65e+03 cost_prev=1287.4895 cost_new=1285.7018\n",
      "\u001b[1mINFO    \u001b[0m |  AL update: snorm=2.2125e-04, csupn=1.5831e-04, max_rho=1.0000e+07, inner_converged=True\n",
      "\u001b[1mINFO    \u001b[0m |  step #100: cost=1286.4484 lambd=4194.3042 inexact_tol=2.9e-05\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_lower_bound(60): 1.00504 (avg 0.01675)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_dynamics_constraint(60): 1.79736 (avg 0.00749)\n",
      "\u001b[1mINFO    \u001b[0m |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)\n",
      "\u001b[1mINFO    \u001b[0m |      - control_cost(60): 1221.96252 (avg 20.36604)\n",
      "\u001b[1mINFO    \u001b[0m |      - boundary_cost(12): 61.68334 (avg 1.28507)\n",
      "\u001b[1mINFO    \u001b[0m |      accepted=True ATb_norm=3.32e+03 cost_prev=1286.4484 cost_new=1292.4403\n",
      "\u001b[1mINFO    \u001b[0m |  AL update: snorm=8.4400e-04, csupn=8.4400e-04, max_rho=1.0000e+07, inner_converged=True\n",
      "\u001b[1mINFO    \u001b[0m | Terminated @ iteration #100: cost=1313.8629 criteria=[0 0 0 1], term_deltas=1.4e-04,2.1e+01,1.1e-05\n"
     ]
    }
   ],
   "source": [
    "solution = problem.solve(\n",
    "    initial_vals,\n",
    "    termination=jaxls.TerminationConfig(cost_tolerance=1e-6),\n",
    ")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "cell-15",
   "metadata": {},
   "source": [
    "## Visualization\n",
    "\n",
    "Extract solution trajectories and create animated visualization:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "cell-16",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Final state: x=0.002, theta=3.135\n",
      "Target theta (pi): 3.142\n"
     ]
    }
   ],
   "source": [
    "# Extract solution trajectories\n",
    "states = solution[state_vars]  # Shape: (n_steps+1, 4)\n",
    "controls = solution[control_vars]  # Shape: (n_steps, 1)\n",
    "\n",
    "times = jnp.linspace(0, total_time, n_steps + 1)\n",
    "control_times = jnp.linspace(0, total_time - dt, n_steps)\n",
    "\n",
    "print(f\"Final state: x={float(states[-1, 0]):.3f}, theta={float(states[-1, 1]):.3f}\")\n",
    "print(f\"Target theta (pi): {jnp.pi:.3f}\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "cell-17",
   "metadata": {
    "tags": [
     "hide-input"
    ]
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>                        <script type=\"text/javascript\">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>\n",
       "        <script charset=\"utf-8\" src=\"https://cdn.plot.ly/plotly-3.1.0.min.js\" integrity=\"sha256-Ei4740bWZhaUTQuD6q9yQlgVCMPBz6CZWhevDYPv93A=\" crossorigin=\"anonymous\"></script>                <div id=\"9310d3ef-1c6f-468f-a0c0-40724c94cca8\" class=\"plotly-graph-div\" style=\"height:500px; width:100%;\"></div>            <script type=\"text/javascript\">                window.PLOTLYENV=window.PLOTLYENV || {};                                if (document.getElementById(\"9310d3ef-1c6f-468f-a0c0-40724c94cca8\")) {                    Plotly.newPlot(                        \"9310d3ef-1c6f-468f-a0c0-40724c94cca8\",                        [{\"fill\":\"toself\",\"fillcolor\":\"steelblue\",\"line\":{\"color\":\"darkblue\",\"width\":2},\"name\":\"Cart\",\"x\":[-0.2145872849971056,0.1854127150028944,0.1854127150028944,-0.2145872849971056,-0.2145872849971056],\"y\":[1.125,1.125,1.275,1.275,1.125],\"type\":\"scatter\"},{\"line\":{\"color\":\"sienna\",\"width\":8},\"mode\":\"lines\",\"name\":\"Pole\",\"x\":[-0.014587284997105598,0.04423695057630539],\"y\":[1.2,0.20173168182373047],\"type\":\"scatter\"},{\"marker\":{\"color\":\"sienna\",\"line\":{\"color\":\"black\",\"width\":1},\"size\":18},\"mode\":\"markers\",\"showlegend\":false,\"x\":[0.04423695057630539],\"y\":[0.20173168182373047],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"showlegend\":false,\"x\":[-0.14792061833043893],\"y\":[1.075],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"showlegend\":false,\"x\":[0.11874604833622773],\"y\":[1.075],\"type\":\"scatter\"},{\"line\":{\"color\":\"gray\",\"width\":6},\"mode\":\"lines\",\"name\":\"Rail\",\"x\":[-2.5,2.5],\"y\":[1.025,1.025],\"type\":\"scatter\"}],                        {\"height\":500,\"margin\":{\"b\":100,\"t\":80},\"plot_bgcolor\":\"white\",\"showlegend\":false,\"sliders\":[{\"active\":0,\"currentvalue\":{\"offset\":20,\"prefix\":\"Time: \",\"suffix\":\"s\",\"visible\":true,\"xanchor\":\"center\"},\"len\":0.8,\"pad\":{\"b\":10,\"t\":60},\"steps\":[{\"args\":[[\"0\"],{\"frame\":{\"duration\":0,\"redraw\":true},\"mode\":\"immediate\",\"transition\":{\"duration\":0}}],\"label\":\"0.00\",\"method\":\"animate\"},{\"args\":[[\"2\"],{\"frame\":{\"duration\":0,\"redraw\":true},\"mode\":\"immediate\",\"transition\":{\"duration\":0}}],\"label\":\"0.10\",\"method\":\"animate\"},{\"args\":[[\"4\"],{\"frame\":{\"duration\":0,\"redraw\":true},\"mode\":\"immediate\",\"transition\":{\"duration\":0}}],\"label\":\"0.20\",\"method\":\"animate\"},{\"args\":[[\"6\"],{\"frame\":{\"duration\":0,\"redraw\":true},\"mode\":\"immediate\",\"transition\":{\"duration\":0}}],\"label\":\"0.30\",\"method\":\"animate\"},{\"args\":[[\"8\"],{\"frame\":{\"duration\":0,\"redraw\":true},\"mode\":\"immediate\",\"transition\":{\"duration\":0}}],\"label\":\"0.40\",\"method\":\"animate\"},{\"args\":[[\"10\"],{\"frame\":{\"duration\":0,\"redraw\":true},\"mode\":\"immediate\",\"transition\":{\"duration\":0}}],\"label\":\"0.50\",\"method\":\"animate\"},{\"args\":[[\"12\"],{\"frame\":{\"duration\":0,\"redraw\":true},\"mode\":\"immediate\",\"transition\":{\"duration\":0}}],\"label\":\"0.60\",\"method\":\"animate\"},{\"args\":[[\"14\"],{\"frame\":{\"duration\":0,\"redraw\":true},\"mode\":\"immediate\",\"transition\":{\"duration\":0}}],\"label\":\"0.70\",\"method\":\"animate\"},{\"args\":[[\"16\"],{\"frame\":{\"duration\":0,\"redraw\":true},\"mode\":\"immediate\",\"transition\":{\"duration\":0}}],\"label\":\"0.80\",\"method\":\"animate\"},{\"args\":[[\"18\"],{\"frame\":{\"duration\":0,\"redraw\":true},\"mode\":\"immediate\",\"transition\":{\"duration\":0}}],\"label\":\"0.90\",\"method\":\"animate\"},{\"args\":[[\"20\"],{\"frame\":{\"duration\":0,\"redraw\":true},\"mode\":\"immediate\",\"transition\":{\"duration\":0}}],\"label\":\"1.00\",\"method\":\"animate\"},{\"args\":[[\"22\"],{\"frame\":{\"duration\":0,\"redraw\":true},\"mode\":\"immediate\",\"transition\":{\"duration\":0}}],\"label\":\"1.10\",\"method\":\"animate\"},{\"args\":[[\"24\"],{\"frame\":{\"duration\":0,\"redraw\":true},\"mode\":\"immediate\",\"transition\":{\"duration\":0}}],\"label\":\"1.20\",\"method\":\"animate\"},{\"args\":[[\"26\"],{\"frame\":{\"duration\":0,\"redraw\":true},\"mode\":\"immediate\",\"transition\":{\"duration\":0}}],\"label\":\"1.30\",\"method\":\"animate\"},{\"args\":[[\"28\"],{\"frame\":{\"duration\":0,\"redraw\":true},\"mode\":\"immediate\",\"transition\":{\"duration\":0}}],\"label\":\"1.40\",\"method\":\"animate\"},{\"args\":[[\"30\"],{\"frame\":{\"duration\":0,\"redraw\":true},\"mode\":\"immediate\",\"transition\":{\"duration\":0}}],\"label\":\"1.50\",\"method\":\"animate\"},{\"args\":[[\"32\"],{\"frame\":{\"duration\":0,\"redraw\":true},\"mode\":\"immediate\",\"transition\":{\"duration\":0}}],\"label\":\"1.60\",\"method\":\"animate\"},{\"args\":[[\"34\"],{\"frame\":{\"duration\":0,\"redraw\":true},\"mode\":\"immediate\",\"transition\":{\"duration\":0}}],\"label\":\"1.70\",\"method\":\"animate\"},{\"args\":[[\"36\"],{\"frame\":{\"duration\":0,\"redraw\":true},\"mode\":\"immediate\",\"transition\":{\"duration\":0}}],\"label\":\"1.80\",\"method\":\"animate\"},{\"args\":[[\"38\"],{\"frame\":{\"duration\":0,\"redraw\":true},\"mode\":\"immediate\",\"transition\":{\"duration\":0}}],\"label\":\"1.90\",\"method\":\"animate\"},{\"args\":[[\"40\"],{\"frame\":{\"duration\":0,\"redraw\":true},\"mode\":\"immediate\",\"transition\":{\"duration\":0}}],\"label\":\"2.00\",\"method\":\"animate\"},{\"args\":[[\"42\"],{\"frame\":{\"duration\":0,\"redraw\":true},\"mode\":\"immediate\",\"transition\":{\"duration\":0}}],\"label\":\"2.10\",\"method\":\"animate\"},{\"args\":[[\"44\"],{\"frame\":{\"duration\":0,\"redraw\":true},\"mode\":\"immediate\",\"transition\":{\"duration\":0}}],\"label\":\"2.20\",\"method\":\"animate\"},{\"args\":[[\"46\"],{\"frame\":{\"duration\":0,\"redraw\":true},\"mode\":\"immediate\",\"transition\":{\"duration\":0}}],\"label\":\"2.30\",\"method\":\"animate\"},{\"args\":[[\"48\"],{\"frame\":{\"duration\":0,\"redraw\":true},\"mode\":\"immediate\",\"transition\":{\"duration\":0}}],\"label\":\"2.40\",\"method\":\"animate\"},{\"args\":[[\"50\"],{\"frame\":{\"duration\":0,\"redraw\":true},\"mode\":\"immediate\",\"transition\":{\"duration\":0}}],\"label\":\"2.50\",\"method\":\"animate\"},{\"args\":[[\"52\"],{\"frame\":{\"duration\":0,\"redraw\":true},\"mode\":\"immediate\",\"transition\":{\"duration\":0}}],\"label\":\"2.60\",\"method\":\"animate\"},{\"args\":[[\"54\"],{\"frame\":{\"duration\":0,\"redraw\":true},\"mode\":\"immediate\",\"transition\":{\"duration\":0}}],\"label\":\"2.70\",\"method\":\"animate\"},{\"args\":[[\"56\"],{\"frame\":{\"duration\":0,\"redraw\":true},\"mode\":\"immediate\",\"transition\":{\"duration\":0}}],\"label\":\"2.80\",\"method\":\"animate\"},{\"args\":[[\"58\"],{\"frame\":{\"duration\":0,\"redraw\":true},\"mode\":\"immediate\",\"transition\":{\"duration\":0}}],\"label\":\"2.90\",\"method\":\"animate\"},{\"args\":[[\"60\"],{\"frame\":{\"duration\":0,\"redraw\":true},\"mode\":\"immediate\",\"transition\":{\"duration\":0}}],\"label\":\"3.00\",\"method\":\"animate\"}],\"x\":0.1,\"xanchor\":\"left\",\"y\":0,\"yanchor\":\"top\"}],\"title\":{\"text\":\"Cart-Pole (Collocation)\"},\"updatemenus\":[{\"buttons\":[{\"args\":[null,{\"frame\":{\"duration\":50,\"redraw\":true},\"fromcurrent\":true,\"transition\":{\"duration\":0}}],\"label\":\"Play\",\"method\":\"animate\"},{\"args\":[[null],{\"frame\":{\"duration\":0,\"redraw\":false},\"mode\":\"immediate\"}],\"label\":\"Pause\",\"method\":\"animate\"}],\"showactive\":false,\"type\":\"buttons\",\"x\":0.5,\"xanchor\":\"center\",\"y\":1.15}],\"xaxis\":{\"constrain\":\"domain\",\"range\":[-2.5,2.5],\"showgrid\":false,\"title\":{\"text\":\"x (m)\"}},\"yaxis\":{\"range\":[-0.1,2.5],\"scaleanchor\":\"x\",\"scaleratio\":1,\"showgrid\":false,\"title\":{\"text\":\"y (m)\"}},\"template\":{\"data\":{\"histogram2dcontour\":[{\"type\":\"histogram2dcontour\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"choropleth\":[{\"type\":\"choropleth\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}],\"histogram2d\":[{\"type\":\"histogram2d\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"heatmap\":[{\"type\":\"heatmap\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"contourcarpet\":[{\"type\":\"contourcarpet\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}],\"contour\":[{\"type\":\"contour\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"surface\":[{\"type\":\"surface\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"mesh3d\":[{\"type\":\"mesh3d\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}],\"scatter\":[{\"fillpattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2},\"type\":\"scatter\"}],\"parcoords\":[{\"type\":\"parcoords\",\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scatterpolargl\":[{\"type\":\"scatterpolargl\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"bar\":[{\"error_x\":{\"color\":\"#2a3f5f\"},\"error_y\":{\"color\":\"#2a3f5f\"},\"marker\":{\"line\":{\"color\":\"#E5ECF6\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"bar\"}],\"scattergeo\":[{\"type\":\"scattergeo\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scatterpolar\":[{\"type\":\"scatterpolar\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"histogram\":[{\"marker\":{\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"histogram\"}],\"scattergl\":[{\"type\":\"scattergl\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scatter3d\":[{\"type\":\"scatter3d\",\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scattermap\":[{\"type\":\"scattermap\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scattermapbox\":[{\"type\":\"scattermapbox\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scatterternary\":[{\"type\":\"scatterternary\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scattercarpet\":[{\"type\":\"scattercarpet\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"carpet\":[{\"aaxis\":{\"endlinecolor\":\"#2a3f5f\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"minorgridcolor\":\"white\",\"startlinecolor\":\"#2a3f5f\"},\"baxis\":{\"endlinecolor\":\"#2a3f5f\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"minorgridcolor\":\"white\",\"startlinecolor\":\"#2a3f5f\"},\"type\":\"carpet\"}],\"table\":[{\"cells\":{\"fill\":{\"color\":\"#EBF0F8\"},\"line\":{\"color\":\"white\"}},\"header\":{\"fill\":{\"color\":\"#C8D4E3\"},\"line\":{\"color\":\"white\"}},\"type\":\"table\"}],\"barpolar\":[{\"marker\":{\"line\":{\"color\":\"#E5ECF6\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"barpolar\"}],\"pie\":[{\"automargin\":true,\"type\":\"pie\"}]},\"layout\":{\"autotypenumbers\":\"strict\",\"colorway\":[\"#636efa\",\"#EF553B\",\"#00cc96\",\"#ab63fa\",\"#FFA15A\",\"#19d3f3\",\"#FF6692\",\"#B6E880\",\"#FF97FF\",\"#FECB52\"],\"font\":{\"color\":\"#2a3f5f\"},\"hovermode\":\"closest\",\"hoverlabel\":{\"align\":\"left\"},\"paper_bgcolor\":\"white\",\"plot_bgcolor\":\"#E5ECF6\",\"polar\":{\"bgcolor\":\"#E5ECF6\",\"angularaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"},\"radialaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"}},\"ternary\":{\"bgcolor\":\"#E5ECF6\",\"aaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"},\"baxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"},\"caxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"}},\"coloraxis\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"colorscale\":{\"sequential\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"sequentialminus\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"diverging\":[[0,\"#8e0152\"],[0.1,\"#c51b7d\"],[0.2,\"#de77ae\"],[0.3,\"#f1b6da\"],[0.4,\"#fde0ef\"],[0.5,\"#f7f7f7\"],[0.6,\"#e6f5d0\"],[0.7,\"#b8e186\"],[0.8,\"#7fbc41\"],[0.9,\"#4d9221\"],[1,\"#276419\"]]},\"xaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"white\",\"automargin\":true,\"zerolinewidth\":2},\"yaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"white\",\"automargin\":true,\"zerolinewidth\":2},\"scene\":{\"xaxis\":{\"backgroundcolor\":\"#E5ECF6\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"white\",\"gridwidth\":2},\"yaxis\":{\"backgroundcolor\":\"#E5ECF6\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"white\",\"gridwidth\":2},\"zaxis\":{\"backgroundcolor\":\"#E5ECF6\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"white\",\"gridwidth\":2}},\"shapedefaults\":{\"line\":{\"color\":\"#2a3f5f\"}},\"annotationdefaults\":{\"arrowcolor\":\"#2a3f5f\",\"arrowhead\":0,\"arrowwidth\":1},\"geo\":{\"bgcolor\":\"white\",\"landcolor\":\"#E5ECF6\",\"subunitcolor\":\"white\",\"showland\":true,\"showlakes\":true,\"lakecolor\":\"white\"},\"title\":{\"x\":0.05},\"mapbox\":{\"style\":\"light\"}}}},                        {\"responsive\": true}                    ).then(function(){\n",
       "                            Plotly.addFrames('9310d3ef-1c6f-468f-a0c0-40724c94cca8', [{\"data\":[{\"fill\":\"toself\",\"fillcolor\":\"steelblue\",\"line\":{\"color\":\"darkblue\",\"width\":2},\"x\":[-0.2145872849971056,0.1854127150028944,0.1854127150028944,-0.2145872849971056,-0.2145872849971056],\"y\":[1.125,1.125,1.275,1.275,1.125],\"type\":\"scatter\"},{\"line\":{\"color\":\"sienna\",\"width\":8},\"mode\":\"lines\",\"x\":[-0.014587284997105598,0.04423695057630539],\"y\":[1.2,0.20173168182373047],\"type\":\"scatter\"},{\"marker\":{\"color\":\"sienna\",\"line\":{\"color\":\"black\",\"width\":1},\"size\":18},\"mode\":\"markers\",\"x\":[0.04423695057630539],\"y\":[0.20173168182373047],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-0.14792061833043893],\"y\":[1.075],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[0.11874604833622773],\"y\":[1.075],\"type\":\"scatter\"}],\"name\":\"0\"},{\"data\":[{\"fill\":\"toself\",\"fillcolor\":\"steelblue\",\"line\":{\"color\":\"darkblue\",\"width\":2},\"x\":[-0.19718294991180302,0.202817050088197,0.202817050088197,-0.19718294991180302,-0.19718294991180302],\"y\":[1.125,1.125,1.275,1.275,1.125],\"type\":\"scatter\"},{\"line\":{\"color\":\"sienna\",\"width\":8},\"mode\":\"lines\",\"x\":[0.002817050088196993,0.028225727379322052],\"y\":[1.2,0.2003229260444641],\"type\":\"scatter\"},{\"marker\":{\"color\":\"sienna\",\"line\":{\"color\":\"black\",\"width\":1},\"size\":18},\"mode\":\"markers\",\"x\":[0.028225727379322052],\"y\":[0.2003229260444641],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-0.13051628324513634],\"y\":[1.075],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[0.13615038342153032],\"y\":[1.075],\"type\":\"scatter\"}],\"name\":\"2\"},{\"data\":[{\"fill\":\"toself\",\"fillcolor\":\"steelblue\",\"line\":{\"color\":\"darkblue\",\"width\":2},\"x\":[-0.12152821272611619,0.27847178727388383,0.27847178727388383,-0.12152821272611619,-0.12152821272611619],\"y\":[1.125,1.125,1.275,1.275,1.125],\"type\":\"scatter\"},{\"line\":{\"color\":\"sienna\",\"width\":8},\"mode\":\"lines\",\"x\":[0.07847178727388382,-0.01933811604976654],\"y\":[1.2,0.20479494333267212],\"type\":\"scatter\"},{\"marker\":{\"color\":\"sienna\",\"line\":{\"color\":\"black\",\"width\":1},\"size\":18},\"mode\":\"markers\",\"x\":[-0.01933811604976654],\"y\":[0.20479494333267212],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-0.05486154605944951],\"y\":[1.075],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[0.21180512060721715],\"y\":[1.075],\"type\":\"scatter\"}],\"name\":\"4\"},{\"data\":[{\"fill\":\"toself\",\"fillcolor\":\"steelblue\",\"line\":{\"color\":\"darkblue\",\"width\":2},\"x\":[0.029558587074279774,0.4295585870742798,0.4295585870742798,0.029558587074279774,0.029558587074279774],\"y\":[1.125,1.125,1.275,1.275,1.125],\"type\":\"scatter\"},{\"line\":{\"color\":\"sienna\",\"width\":8},\"mode\":\"lines\",\"x\":[0.22955858707427979,-0.08310148119926453],\"y\":[1.2,0.2501349449157715],\"type\":\"scatter\"},{\"marker\":{\"color\":\"sienna\",\"line\":{\"color\":\"black\",\"width\":1},\"size\":18},\"mode\":\"markers\",\"x\":[-0.08310148119926453],\"y\":[0.2501349449157715],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[0.09622525374094645],\"y\":[1.075],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[0.3628919204076131],\"y\":[1.075],\"type\":\"scatter\"}],\"name\":\"6\"},{\"data\":[{\"fill\":\"toself\",\"fillcolor\":\"steelblue\",\"line\":{\"color\":\"darkblue\",\"width\":2},\"x\":[0.2457731246948242,0.6457731246948242,0.6457731246948242,0.2457731246948242,0.2457731246948242],\"y\":[1.125,1.125,1.275,1.275,1.125],\"type\":\"scatter\"},{\"line\":{\"color\":\"sienna\",\"width\":8},\"mode\":\"lines\",\"x\":[0.4457731246948242,-0.1059451699256897],\"y\":[1.2,0.36596953868865967],\"type\":\"scatter\"},{\"marker\":{\"color\":\"sienna\",\"line\":{\"color\":\"black\",\"width\":1},\"size\":18},\"mode\":\"markers\",\"x\":[-0.1059451699256897],\"y\":[0.36596953868865967],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[0.3124397913614909],\"y\":[1.075],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[0.5791064580281575],\"y\":[1.075],\"type\":\"scatter\"}],\"name\":\"8\"},{\"data\":[{\"fill\":\"toself\",\"fillcolor\":\"steelblue\",\"line\":{\"color\":\"darkblue\",\"width\":2},\"x\":[0.48975675106048583,0.8897567510604858,0.8897567510604858,0.48975675106048583,0.48975675106048583],\"y\":[1.125,1.125,1.275,1.275,1.125],\"type\":\"scatter\"},{\"line\":{\"color\":\"sienna\",\"width\":8},\"mode\":\"lines\",\"x\":[0.6897567510604858,-0.03227508068084717],\"y\":[1.2,0.5081402063369751],\"type\":\"scatter\"},{\"marker\":{\"color\":\"sienna\",\"line\":{\"color\":\"black\",\"width\":1},\"size\":18},\"mode\":\"markers\",\"x\":[-0.03227508068084717],\"y\":[0.5081402063369751],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[0.5564234177271525],\"y\":[1.075],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[0.8230900843938191],\"y\":[1.075],\"type\":\"scatter\"}],\"name\":\"10\"},{\"data\":[{\"fill\":\"toself\",\"fillcolor\":\"steelblue\",\"line\":{\"color\":\"darkblue\",\"width\":2},\"x\":[0.7215331673622132,1.121533167362213,1.121533167362213,0.7215331673622132,0.7215331673622132],\"y\":[1.125,1.125,1.275,1.275,1.125],\"type\":\"scatter\"},{\"line\":{\"color\":\"sienna\",\"width\":8},\"mode\":\"lines\",\"x\":[0.9215331673622131,0.13058704137802124],\"y\":[1.2,0.5881142616271973],\"type\":\"scatter\"},{\"marker\":{\"color\":\"sienna\",\"line\":{\"color\":\"black\",\"width\":1},\"size\":18},\"mode\":\"markers\",\"x\":[0.13058704137802124],\"y\":[0.5881142616271973],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[0.7881998340288798],\"y\":[1.075],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[1.0548665006955464],\"y\":[1.075],\"type\":\"scatter\"}],\"name\":\"12\"},{\"data\":[{\"fill\":\"toself\",\"fillcolor\":\"steelblue\",\"line\":{\"color\":\"darkblue\",\"width\":2},\"x\":[0.9148004531860352,1.3148004531860351,1.3148004531860351,0.9148004531860352,0.9148004531860352],\"y\":[1.125,1.125,1.275,1.275,1.125],\"type\":\"scatter\"},{\"line\":{\"color\":\"sienna\",\"width\":8},\"mode\":\"lines\",\"x\":[1.1148004531860352,0.3524273633956909],\"y\":[1.2,0.552862286567688],\"type\":\"scatter\"},{\"marker\":{\"color\":\"sienna\",\"line\":{\"color\":\"black\",\"width\":1},\"size\":18},\"mode\":\"markers\",\"x\":[0.3524273633956909],\"y\":[0.552862286567688],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[0.9814671198527019],\"y\":[1.075],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[1.2481337865193685],\"y\":[1.075],\"type\":\"scatter\"}],\"name\":\"14\"},{\"data\":[{\"fill\":\"toself\",\"fillcolor\":\"steelblue\",\"line\":{\"color\":\"darkblue\",\"width\":2},\"x\":[1.0541457414627076,1.4541457414627075,1.4541457414627075,1.0541457414627076,1.0541457414627076],\"y\":[1.125,1.125,1.275,1.275,1.125],\"type\":\"scatter\"},{\"line\":{\"color\":\"sienna\",\"width\":8},\"mode\":\"lines\",\"x\":[1.2541457414627075,0.6430888772010803],\"y\":[1.2,0.4084133505821228],\"type\":\"scatter\"},{\"marker\":{\"color\":\"sienna\",\"line\":{\"color\":\"black\",\"width\":1},\"size\":18},\"mode\":\"markers\",\"x\":[0.6430888772010803],\"y\":[0.4084133505821228],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[1.1208124081293742],\"y\":[1.075],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[1.3874790747960408],\"y\":[1.075],\"type\":\"scatter\"}],\"name\":\"16\"},{\"data\":[{\"fill\":\"toself\",\"fillcolor\":\"steelblue\",\"line\":{\"color\":\"darkblue\",\"width\":2},\"x\":[1.1204611539840699,1.5204611539840698,1.5204611539840698,1.1204611539840699,1.1204611539840699],\"y\":[1.125,1.125,1.275,1.275,1.125],\"type\":\"scatter\"},{\"line\":{\"color\":\"sienna\",\"width\":8},\"mode\":\"lines\",\"x\":[1.3204611539840698,1.051514744758606],\"y\":[1.2,0.23684489727020264],\"type\":\"scatter\"},{\"marker\":{\"color\":\"sienna\",\"line\":{\"color\":\"black\",\"width\":1},\"size\":18},\"mode\":\"markers\",\"x\":[1.051514744758606],\"y\":[0.23684489727020264],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[1.1871278206507365],\"y\":[1.075],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[1.4537944873174031],\"y\":[1.075],\"type\":\"scatter\"}],\"name\":\"18\"},{\"data\":[{\"fill\":\"toself\",\"fillcolor\":\"steelblue\",\"line\":{\"color\":\"darkblue\",\"width\":2},\"x\":[1.0936650514602662,1.493665051460266,1.493665051460266,1.0936650514602662,1.0936650514602662],\"y\":[1.125,1.125,1.275,1.275,1.125],\"type\":\"scatter\"},{\"line\":{\"color\":\"sienna\",\"width\":8},\"mode\":\"lines\",\"x\":[1.2936650514602661,1.5725483894348145],\"y\":[1.2,0.23967504501342773],\"type\":\"scatter\"},{\"marker\":{\"color\":\"sienna\",\"line\":{\"color\":\"black\",\"width\":1},\"size\":18},\"mode\":\"markers\",\"x\":[1.5725483894348145],\"y\":[0.23967504501342773],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[1.1603317181269328],\"y\":[1.075],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[1.4269983847935994],\"y\":[1.075],\"type\":\"scatter\"}],\"name\":\"20\"},{\"data\":[{\"fill\":\"toself\",\"fillcolor\":\"steelblue\",\"line\":{\"color\":\"darkblue\",\"width\":2},\"x\":[0.9774486303329468,1.3774486303329467,1.3774486303329467,0.9774486303329468,0.9774486303329468],\"y\":[1.125,1.125,1.275,1.275,1.125],\"type\":\"scatter\"},{\"line\":{\"color\":\"sienna\",\"width\":8},\"mode\":\"lines\",\"x\":[1.1774486303329468,1.974381685256958],\"y\":[1.2,0.5959324240684509],\"type\":\"scatter\"},{\"marker\":{\"color\":\"sienna\",\"line\":{\"color\":\"black\",\"width\":1},\"size\":18},\"mode\":\"markers\",\"x\":[1.974381685256958],\"y\":[0.5959324240684509],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[1.0441152969996135],\"y\":[1.075],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[1.31078196366628],\"y\":[1.075],\"type\":\"scatter\"}],\"name\":\"22\"},{\"data\":[{\"fill\":\"toself\",\"fillcolor\":\"steelblue\",\"line\":{\"color\":\"darkblue\",\"width\":2},\"x\":[0.8034881830215455,1.2034881830215454,1.2034881830215454,0.8034881830215455,0.8034881830215455],\"y\":[1.125,1.125,1.275,1.275,1.125],\"type\":\"scatter\"},{\"line\":{\"color\":\"sienna\",\"width\":8},\"mode\":\"lines\",\"x\":[1.0034881830215454,2.0013749599456787],\"y\":[1.2,1.1350241899490356],\"type\":\"scatter\"},{\"marker\":{\"color\":\"sienna\",\"line\":{\"color\":\"black\",\"width\":1},\"size\":18},\"mode\":\"markers\",\"x\":[2.0013749599456787],\"y\":[1.1350241899490356],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[0.8701548496882121],\"y\":[1.075],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[1.1368215163548787],\"y\":[1.075],\"type\":\"scatter\"}],\"name\":\"24\"},{\"data\":[{\"fill\":\"toself\",\"fillcolor\":\"steelblue\",\"line\":{\"color\":\"darkblue\",\"width\":2},\"x\":[0.6173772692680359,1.0173772692680358,1.0173772692680358,0.6173772692680359,0.6173772692680359],\"y\":[1.125,1.125,1.275,1.275,1.125],\"type\":\"scatter\"},{\"line\":{\"color\":\"sienna\",\"width\":8},\"mode\":\"lines\",\"x\":[0.8173772692680359,1.7458165884017944],\"y\":[1.2,1.5714842081069946],\"type\":\"scatter\"},{\"marker\":{\"color\":\"sienna\",\"line\":{\"color\":\"black\",\"width\":1},\"size\":18},\"mode\":\"markers\",\"x\":[1.7458165884017944],\"y\":[1.5714842081069946],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[0.6840439359347026],\"y\":[1.075],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[0.9507106026013692],\"y\":[1.075],\"type\":\"scatter\"}],\"name\":\"26\"},{\"data\":[{\"fill\":\"toself\",\"fillcolor\":\"steelblue\",\"line\":{\"color\":\"darkblue\",\"width\":2},\"x\":[0.4388323903083801,0.8388323903083801,0.8388323903083801,0.4388323903083801,0.4388323903083801],\"y\":[1.125,1.125,1.275,1.275,1.125],\"type\":\"scatter\"},{\"line\":{\"color\":\"sienna\",\"width\":8},\"mode\":\"lines\",\"x\":[0.6388323903083801,1.4064475297927856],\"y\":[1.2,1.8409111499786377],\"type\":\"scatter\"},{\"marker\":{\"color\":\"sienna\",\"line\":{\"color\":\"black\",\"width\":1},\"size\":18},\"mode\":\"markers\",\"x\":[1.4064475297927856],\"y\":[1.8409111499786377],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[0.5054990569750468],\"y\":[1.075],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[0.7721657236417134],\"y\":[1.075],\"type\":\"scatter\"}],\"name\":\"28\"},{\"data\":[{\"fill\":\"toself\",\"fillcolor\":\"steelblue\",\"line\":{\"color\":\"darkblue\",\"width\":2},\"x\":[0.2744873344898224,0.6744873344898223,0.6744873344898223,0.2744873344898224,0.2744873344898224],\"y\":[1.125,1.125,1.275,1.275,1.125],\"type\":\"scatter\"},{\"line\":{\"color\":\"sienna\",\"width\":8},\"mode\":\"lines\",\"x\":[0.4744873344898224,1.0872654914855957],\"y\":[1.2,1.9902551174163818],\"type\":\"scatter\"},{\"marker\":{\"color\":\"sienna\",\"line\":{\"color\":\"black\",\"width\":1},\"size\":18},\"mode\":\"markers\",\"x\":[1.0872654914855957],\"y\":[1.9902551174163818],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[0.3411540011564891],\"y\":[1.075],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[0.6078206678231557],\"y\":[1.075],\"type\":\"scatter\"}],\"name\":\"30\"},{\"data\":[{\"fill\":\"toself\",\"fillcolor\":\"steelblue\",\"line\":{\"color\":\"darkblue\",\"width\":2},\"x\":[0.12517021894454955,0.5251702189445495,0.5251702189445495,0.12517021894454955,0.12517021894454955],\"y\":[1.125,1.125,1.275,1.275,1.125],\"type\":\"scatter\"},{\"line\":{\"color\":\"sienna\",\"width\":8},\"mode\":\"lines\",\"x\":[0.32517021894454956,0.8193527460098267],\"y\":[1.2,2.0693583488464355],\"type\":\"scatter\"},{\"marker\":{\"color\":\"sienna\",\"line\":{\"color\":\"black\",\"width\":1},\"size\":18},\"mode\":\"markers\",\"x\":[0.8193527460098267],\"y\":[2.0693583488464355],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[0.19183688561121623],\"y\":[1.075],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[0.45850355227788286],\"y\":[1.075],\"type\":\"scatter\"}],\"name\":\"32\"},{\"data\":[{\"fill\":\"toself\",\"fillcolor\":\"steelblue\",\"line\":{\"color\":\"darkblue\",\"width\":2},\"x\":[-0.004829999804496776,0.39517000019550325,0.39517000019550325,-0.004829999804496776,-0.004829999804496776],\"y\":[1.125,1.125,1.275,1.275,1.125],\"type\":\"scatter\"},{\"line\":{\"color\":\"sienna\",\"width\":8},\"mode\":\"lines\",\"x\":[0.19517000019550323,0.6049414277076721],\"y\":[1.2,2.1121883392333984],\"type\":\"scatter\"},{\"marker\":{\"color\":\"sienna\",\"line\":{\"color\":\"black\",\"width\":1},\"size\":18},\"mode\":\"markers\",\"x\":[0.6049414277076721],\"y\":[2.1121883392333984],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[0.0618366668621699],\"y\":[1.075],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[0.32850333352883654],\"y\":[1.075],\"type\":\"scatter\"}],\"name\":\"34\"},{\"data\":[{\"fill\":\"toself\",\"fillcolor\":\"steelblue\",\"line\":{\"color\":\"darkblue\",\"width\":2},\"x\":[-0.11288124769926072,0.2871187523007393,0.2871187523007393,-0.11288124769926072,-0.11288124769926072],\"y\":[1.125,1.125,1.275,1.275,1.125],\"type\":\"scatter\"},{\"line\":{\"color\":\"sienna\",\"width\":8},\"mode\":\"lines\",\"x\":[0.08711875230073929,0.43762874603271484],\"y\":[1.2,2.136559009552002],\"type\":\"scatter\"},{\"marker\":{\"color\":\"sienna\",\"line\":{\"color\":\"black\",\"width\":1},\"size\":18},\"mode\":\"markers\",\"x\":[0.43762874603271484],\"y\":[2.136559009552002],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-0.04621458103259404],\"y\":[1.075],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[0.22045208563407262],\"y\":[1.075],\"type\":\"scatter\"}],\"name\":\"36\"},{\"data\":[{\"fill\":\"toself\",\"fillcolor\":\"steelblue\",\"line\":{\"color\":\"darkblue\",\"width\":2},\"x\":[-0.19589556083083154,0.20410443916916848,0.20410443916916848,-0.19589556083083154,-0.19589556083083154],\"y\":[1.125,1.125,1.275,1.275,1.125],\"type\":\"scatter\"},{\"line\":{\"color\":\"sienna\",\"width\":8},\"mode\":\"lines\",\"x\":[0.004104439169168472,0.3097530007362366],\"y\":[1.2,2.152144432067871],\"type\":\"scatter\"},{\"marker\":{\"color\":\"sienna\",\"line\":{\"color\":\"black\",\"width\":1},\"size\":18},\"mode\":\"markers\",\"x\":[0.3097530007362366],\"y\":[2.152144432067871],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-0.12922889416416486],\"y\":[1.075],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[0.1374377725025018],\"y\":[1.075],\"type\":\"scatter\"}],\"name\":\"38\"},{\"data\":[{\"fill\":\"toself\",\"fillcolor\":\"steelblue\",\"line\":{\"color\":\"darkblue\",\"width\":2},\"x\":[-0.2508730374276638,0.1491269625723362,0.1491269625723362,-0.2508730374276638,-0.2508730374276638],\"y\":[1.125,1.125,1.275,1.275,1.125],\"type\":\"scatter\"},{\"line\":{\"color\":\"sienna\",\"width\":8},\"mode\":\"lines\",\"x\":[-0.0508730374276638,0.21403634548187256],\"y\":[1.2,2.164273262023926],\"type\":\"scatter\"},{\"marker\":{\"color\":\"sienna\",\"line\":{\"color\":\"black\",\"width\":1},\"size\":18},\"mode\":\"markers\",\"x\":[0.21403634548187256],\"y\":[2.164273262023926],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-0.18420637076099713],\"y\":[1.075],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[0.08246029590566953],\"y\":[1.075],\"type\":\"scatter\"}],\"name\":\"40\"},{\"data\":[{\"fill\":\"toself\",\"fillcolor\":\"steelblue\",\"line\":{\"color\":\"darkblue\",\"width\":2},\"x\":[-0.27628855854272844,0.12371144145727159,0.12371144145727159,-0.27628855854272844,-0.27628855854272844],\"y\":[1.125,1.125,1.275,1.275,1.125],\"type\":\"scatter\"},{\"line\":{\"color\":\"sienna\",\"width\":8},\"mode\":\"lines\",\"x\":[-0.07628855854272842,0.14366918802261353],\"y\":[1.2,2.175509452819824],\"type\":\"scatter\"},{\"marker\":{\"color\":\"sienna\",\"line\":{\"color\":\"black\",\"width\":1},\"size\":18},\"mode\":\"markers\",\"x\":[0.14366918802261353],\"y\":[2.175509452819824],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-0.20962189187606176],\"y\":[1.075],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[0.05704477479060491],\"y\":[1.075],\"type\":\"scatter\"}],\"name\":\"42\"},{\"data\":[{\"fill\":\"toself\",\"fillcolor\":\"steelblue\",\"line\":{\"color\":\"darkblue\",\"width\":2},\"x\":[-0.27357484847307206,0.12642515152692796,0.12642515152692796,-0.27357484847307206,-0.27357484847307206],\"y\":[1.125,1.125,1.275,1.275,1.125],\"type\":\"scatter\"},{\"line\":{\"color\":\"sienna\",\"width\":8},\"mode\":\"lines\",\"x\":[-0.07357484847307205,0.09219077974557877],\"y\":[1.2,2.1861653327941895],\"type\":\"scatter\"},{\"marker\":{\"color\":\"sienna\",\"line\":{\"color\":\"black\",\"width\":1},\"size\":18},\"mode\":\"markers\",\"x\":[0.09219077974557877],\"y\":[2.1861653327941895],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-0.20690818180640538],\"y\":[1.075],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[0.05975848486026128],\"y\":[1.075],\"type\":\"scatter\"}],\"name\":\"44\"},{\"data\":[{\"fill\":\"toself\",\"fillcolor\":\"steelblue\",\"line\":{\"color\":\"darkblue\",\"width\":2},\"x\":[-0.24865758493542672,0.1513424150645733,0.1513424150645733,-0.24865758493542672,-0.24865758493542672],\"y\":[1.125,1.125,1.275,1.275,1.125],\"type\":\"scatter\"},{\"line\":{\"color\":\"sienna\",\"width\":8},\"mode\":\"lines\",\"x\":[-0.04865758493542671,0.053918804973363876],\"y\":[1.2,2.1947250366210938],\"type\":\"scatter\"},{\"marker\":{\"color\":\"sienna\",\"line\":{\"color\":\"black\",\"width\":1},\"size\":18},\"mode\":\"markers\",\"x\":[0.053918804973363876],\"y\":[2.1947250366210938],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-0.18199091826876004],\"y\":[1.075],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[0.08467574839790662],\"y\":[1.075],\"type\":\"scatter\"}],\"name\":\"46\"},{\"data\":[{\"fill\":\"toself\",\"fillcolor\":\"steelblue\",\"line\":{\"color\":\"darkblue\",\"width\":2},\"x\":[-0.21486941147595645,0.18513058852404357,0.18513058852404357,-0.21486941147595645,-0.21486941147595645],\"y\":[1.125,1.125,1.275,1.275,1.125],\"type\":\"scatter\"},{\"line\":{\"color\":\"sienna\",\"width\":8},\"mode\":\"lines\",\"x\":[-0.01486941147595644,0.02599884197115898],\"y\":[1.2,2.199164628982544],\"type\":\"scatter\"},{\"marker\":{\"color\":\"sienna\",\"line\":{\"color\":\"black\",\"width\":1},\"size\":18},\"mode\":\"markers\",\"x\":[0.02599884197115898],\"y\":[2.199164628982544],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-0.14820274480928977],\"y\":[1.075],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[0.11846392185737689],\"y\":[1.075],\"type\":\"scatter\"}],\"name\":\"48\"},{\"data\":[{\"fill\":\"toself\",\"fillcolor\":\"steelblue\",\"line\":{\"color\":\"darkblue\",\"width\":2},\"x\":[-0.1971203487366438,0.20287965126335622,0.20287965126335622,-0.1971203487366438,-0.1971203487366438],\"y\":[1.125,1.125,1.275,1.275,1.125],\"type\":\"scatter\"},{\"line\":{\"color\":\"sienna\",\"width\":8},\"mode\":\"lines\",\"x\":[0.002879651263356209,0.012301011011004448],\"y\":[1.2,2.199955701828003],\"type\":\"scatter\"},{\"marker\":{\"color\":\"sienna\",\"line\":{\"color\":\"black\",\"width\":1},\"size\":18},\"mode\":\"markers\",\"x\":[0.012301011011004448],\"y\":[2.199955701828003],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-0.13045368206997712],\"y\":[1.075],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[0.13621298459668954],\"y\":[1.075],\"type\":\"scatter\"}],\"name\":\"50\"},{\"data\":[{\"fill\":\"toself\",\"fillcolor\":\"steelblue\",\"line\":{\"color\":\"darkblue\",\"width\":2},\"x\":[-0.19814212846104057,0.20185787153895945,0.20185787153895945,-0.19814212846104057,-0.19814212846104057],\"y\":[1.125,1.125,1.275,1.275,1.125],\"type\":\"scatter\"},{\"line\":{\"color\":\"sienna\",\"width\":8},\"mode\":\"lines\",\"x\":[0.0018578715389594436,0.009757939726114273],\"y\":[1.2,2.1999688148498535],\"type\":\"scatter\"},{\"marker\":{\"color\":\"sienna\",\"line\":{\"color\":\"black\",\"width\":1},\"size\":18},\"mode\":\"markers\",\"x\":[0.009757939726114273],\"y\":[2.1999688148498535],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-0.1314754617943739],\"y\":[1.075],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[0.13519120487229278],\"y\":[1.075],\"type\":\"scatter\"}],\"name\":\"52\"},{\"data\":[{\"fill\":\"toself\",\"fillcolor\":\"steelblue\",\"line\":{\"color\":\"darkblue\",\"width\":2},\"x\":[-0.1988180802902207,0.20118191970977933,0.20118191970977933,-0.1988180802902207,-0.1988180802902207],\"y\":[1.125,1.125,1.275,1.275,1.125],\"type\":\"scatter\"},{\"line\":{\"color\":\"sienna\",\"width\":8},\"mode\":\"lines\",\"x\":[0.0011819197097793221,0.008210831321775913],\"y\":[1.2,2.1999754905700684],\"type\":\"scatter\"},{\"marker\":{\"color\":\"sienna\",\"line\":{\"color\":\"black\",\"width\":1},\"size\":18},\"mode\":\"markers\",\"x\":[0.008210831321775913],\"y\":[2.1999754905700684],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-0.132151413623554],\"y\":[1.075],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[0.13451525304311265],\"y\":[1.075],\"type\":\"scatter\"}],\"name\":\"54\"},{\"data\":[{\"fill\":\"toself\",\"fillcolor\":\"steelblue\",\"line\":{\"color\":\"darkblue\",\"width\":2},\"x\":[-0.1990573357208632,0.20094266427913682,0.20094266427913682,-0.1990573357208632,-0.1990573357208632],\"y\":[1.125,1.125,1.275,1.275,1.125],\"type\":\"scatter\"},{\"line\":{\"color\":\"sienna\",\"width\":8},\"mode\":\"lines\",\"x\":[0.0009426642791368067,0.007483543828129768],\"y\":[1.2,2.1999785900115967],\"type\":\"scatter\"},{\"marker\":{\"color\":\"sienna\",\"line\":{\"color\":\"black\",\"width\":1},\"size\":18},\"mode\":\"markers\",\"x\":[0.007483543828129768],\"y\":[2.1999785900115967],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-0.13239066905419652],\"y\":[1.075],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[0.13427599761247014],\"y\":[1.075],\"type\":\"scatter\"}],\"name\":\"56\"},{\"data\":[{\"fill\":\"toself\",\"fillcolor\":\"steelblue\",\"line\":{\"color\":\"darkblue\",\"width\":2},\"x\":[-0.19891074711922557,0.20108925288077445,0.20108925288077445,-0.19891074711922557,-0.19891074711922557],\"y\":[1.125,1.125,1.275,1.275,1.125],\"type\":\"scatter\"},{\"line\":{\"color\":\"sienna\",\"width\":8},\"mode\":\"lines\",\"x\":[0.0010892528807744384,0.007530475966632366],\"y\":[1.2,2.199979305267334],\"type\":\"scatter\"},{\"marker\":{\"color\":\"sienna\",\"line\":{\"color\":\"black\",\"width\":1},\"size\":18},\"mode\":\"markers\",\"x\":[0.007530475966632366],\"y\":[2.199979305267334],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-0.1322440804525589],\"y\":[1.075],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[0.13442258621410777],\"y\":[1.075],\"type\":\"scatter\"}],\"name\":\"58\"},{\"data\":[{\"fill\":\"toself\",\"fillcolor\":\"steelblue\",\"line\":{\"color\":\"darkblue\",\"width\":2},\"x\":[-0.19837725795805455,0.20162274204194547,0.20162274204194547,-0.19837725795805455,-0.19837725795805455],\"y\":[1.125,1.125,1.275,1.275,1.125],\"type\":\"scatter\"},{\"line\":{\"color\":\"sienna\",\"width\":8},\"mode\":\"lines\",\"x\":[0.0016227420419454575,0.008336471393704414],\"y\":[1.2,2.199977397918701],\"type\":\"scatter\"},{\"marker\":{\"color\":\"sienna\",\"line\":{\"color\":\"black\",\"width\":1},\"size\":18},\"mode\":\"markers\",\"x\":[0.008336471393704414],\"y\":[2.199977397918701],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[-0.13171059129138787],\"y\":[1.075],\"type\":\"scatter\"},{\"marker\":{\"color\":\"black\",\"size\":12,\"symbol\":\"circle\"},\"mode\":\"markers\",\"x\":[0.1349560753752788],\"y\":[1.075],\"type\":\"scatter\"}],\"name\":\"60\"}]);\n",
       "                        })                };            </script>        </div>"
      ],
      "text/plain": [
       "<IPython.core.display.HTML object>"
      ]
     },
     "execution_count": 11,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "import plotly.graph_objects as go\n",
    "from plotly.subplots import make_subplots\n",
    "from IPython.display import HTML\n",
    "\n",
    "# Animation of cart-pole swing-up.\n",
    "cart_y_offset = 1.2  # Raise cart so pole can swing freely above ground.\n",
    "wheel_radius = 0.05\n",
    "\n",
    "\n",
    "def create_cart_pole_frame(x: float, theta: float) -> dict:\n",
    "    \"\"\"Create a single frame of cart-pole visualization.\"\"\"\n",
    "    cart_width, cart_height = 0.4, 0.15\n",
    "    pole_len = 2 * length  # Full pole length.\n",
    "    pole_x = x + pole_len * jnp.sin(theta)\n",
    "    pole_y = cart_y_offset - pole_len * jnp.cos(theta)\n",
    "\n",
    "    # Wheel positions.\n",
    "    wheel_y = cart_y_offset - cart_height / 2 - wheel_radius\n",
    "\n",
    "    return dict(\n",
    "        cart_x=[\n",
    "            x - cart_width / 2,\n",
    "            x + cart_width / 2,\n",
    "            x + cart_width / 2,\n",
    "            x - cart_width / 2,\n",
    "            x - cart_width / 2,\n",
    "        ],\n",
    "        cart_y=[\n",
    "            cart_y_offset - cart_height / 2,\n",
    "            cart_y_offset - cart_height / 2,\n",
    "            cart_y_offset + cart_height / 2,\n",
    "            cart_y_offset + cart_height / 2,\n",
    "            cart_y_offset - cart_height / 2,\n",
    "        ],\n",
    "        pole_x=[x, float(pole_x)],\n",
    "        pole_y=[cart_y_offset, float(pole_y)],\n",
    "        mass_x=[float(pole_x)],\n",
    "        mass_y=[float(pole_y)],\n",
    "        wheel1_x=[x - cart_width / 3],\n",
    "        wheel1_y=[wheel_y],\n",
    "        wheel2_x=[x + cart_width / 3],\n",
    "        wheel2_y=[wheel_y],\n",
    "    )\n",
    "\n",
    "\n",
    "# Create animation frames (use every 2nd timestep for performance).\n",
    "frame_step = 2\n",
    "frame_indices = list(range(0, n_steps + 1, frame_step))\n",
    "frames = []\n",
    "for i in frame_indices:\n",
    "    frame_data = create_cart_pole_frame(float(states[i, 0]), float(states[i, 1]))\n",
    "    frames.append(\n",
    "        go.Frame(\n",
    "            data=[\n",
    "                go.Scatter(\n",
    "                    x=frame_data[\"cart_x\"],\n",
    "                    y=frame_data[\"cart_y\"],\n",
    "                    fill=\"toself\",\n",
    "                    fillcolor=\"steelblue\",\n",
    "                    line=dict(color=\"darkblue\", width=2),\n",
    "                ),\n",
    "                go.Scatter(\n",
    "                    x=frame_data[\"pole_x\"],\n",
    "                    y=frame_data[\"pole_y\"],\n",
    "                    mode=\"lines\",\n",
    "                    line=dict(color=\"sienna\", width=8),\n",
    "                ),\n",
    "                go.Scatter(\n",
    "                    x=frame_data[\"mass_x\"],\n",
    "                    y=frame_data[\"mass_y\"],\n",
    "                    mode=\"markers\",\n",
    "                    marker=dict(\n",
    "                        size=18, color=\"sienna\", line=dict(color=\"black\", width=1)\n",
    "                    ),\n",
    "                ),\n",
    "                go.Scatter(\n",
    "                    x=frame_data[\"wheel1_x\"],\n",
    "                    y=frame_data[\"wheel1_y\"],\n",
    "                    mode=\"markers\",\n",
    "                    marker=dict(size=12, color=\"black\", symbol=\"circle\"),\n",
    "                ),\n",
    "                go.Scatter(\n",
    "                    x=frame_data[\"wheel2_x\"],\n",
    "                    y=frame_data[\"wheel2_y\"],\n",
    "                    mode=\"markers\",\n",
    "                    marker=dict(size=12, color=\"black\", symbol=\"circle\"),\n",
    "                ),\n",
    "            ],\n",
    "            name=str(i),\n",
    "        )\n",
    "    )\n",
    "\n",
    "# Initial frame.\n",
    "init_frame = create_cart_pole_frame(float(states[0, 0]), float(states[0, 1]))\n",
    "rail_y = cart_y_offset - 0.15 / 2 - wheel_radius * 2\n",
    "\n",
    "fig_anim = go.Figure(\n",
    "    data=[\n",
    "        go.Scatter(\n",
    "            x=init_frame[\"cart_x\"],\n",
    "            y=init_frame[\"cart_y\"],\n",
    "            fill=\"toself\",\n",
    "            fillcolor=\"steelblue\",\n",
    "            line=dict(color=\"darkblue\", width=2),\n",
    "            name=\"Cart\",\n",
    "        ),\n",
    "        go.Scatter(\n",
    "            x=init_frame[\"pole_x\"],\n",
    "            y=init_frame[\"pole_y\"],\n",
    "            mode=\"lines\",\n",
    "            line=dict(color=\"sienna\", width=8),\n",
    "            name=\"Pole\",\n",
    "        ),\n",
    "        go.Scatter(\n",
    "            x=init_frame[\"mass_x\"],\n",
    "            y=init_frame[\"mass_y\"],\n",
    "            mode=\"markers\",\n",
    "            marker=dict(size=18, color=\"sienna\", line=dict(color=\"black\", width=1)),\n",
    "            showlegend=False,\n",
    "        ),\n",
    "        go.Scatter(\n",
    "            x=init_frame[\"wheel1_x\"],\n",
    "            y=init_frame[\"wheel1_y\"],\n",
    "            mode=\"markers\",\n",
    "            marker=dict(size=12, color=\"black\", symbol=\"circle\"),\n",
    "            showlegend=False,\n",
    "        ),\n",
    "        go.Scatter(\n",
    "            x=init_frame[\"wheel2_x\"],\n",
    "            y=init_frame[\"wheel2_y\"],\n",
    "            mode=\"markers\",\n",
    "            marker=dict(size=12, color=\"black\", symbol=\"circle\"),\n",
    "            showlegend=False,\n",
    "        ),\n",
    "        go.Scatter(\n",
    "            x=[-2.5, 2.5],\n",
    "            y=[rail_y, rail_y],\n",
    "            mode=\"lines\",\n",
    "            line=dict(color=\"gray\", width=6),\n",
    "            name=\"Rail\",\n",
    "        ),\n",
    "    ],\n",
    "    frames=frames,\n",
    "    layout=go.Layout(\n",
    "        title=\"Cart-Pole (Collocation)\",\n",
    "        xaxis=dict(\n",
    "            range=[-2.5, 2.5], title=\"x (m)\", constrain=\"domain\", showgrid=False\n",
    "        ),\n",
    "        yaxis=dict(\n",
    "            range=[-0.1, 2.5],\n",
    "            title=\"y (m)\",\n",
    "            scaleanchor=\"x\",\n",
    "            scaleratio=1,\n",
    "            showgrid=False,\n",
    "        ),\n",
    "        updatemenus=[\n",
    "            dict(\n",
    "                type=\"buttons\",\n",
    "                showactive=False,\n",
    "                y=1.15,\n",
    "                x=0.5,\n",
    "                xanchor=\"center\",\n",
    "                buttons=[\n",
    "                    dict(\n",
    "                        label=\"Play\",\n",
    "                        method=\"animate\",\n",
    "                        args=[\n",
    "                            None,\n",
    "                            dict(\n",
    "                                frame=dict(duration=50, redraw=True),\n",
    "                                fromcurrent=True,\n",
    "                                transition=dict(duration=0),\n",
    "                            ),\n",
    "                        ],\n",
    "                    ),\n",
    "                    dict(\n",
    "                        label=\"Pause\",\n",
    "                        method=\"animate\",\n",
    "                        args=[\n",
    "                            [None],\n",
    "                            dict(\n",
    "                                frame=dict(duration=0, redraw=False),\n",
    "                                mode=\"immediate\",\n",
    "                            ),\n",
    "                        ],\n",
    "                    ),\n",
    "                ],\n",
    "            )\n",
    "        ],\n",
    "        sliders=[\n",
    "            dict(\n",
    "                active=0,\n",
    "                yanchor=\"top\",\n",
    "                xanchor=\"left\",\n",
    "                currentvalue=dict(\n",
    "                    prefix=\"Time: \",\n",
    "                    suffix=\"s\",\n",
    "                    visible=True,\n",
    "                    xanchor=\"center\",\n",
    "                    offset=20,\n",
    "                ),\n",
    "                pad=dict(b=10, t=60),\n",
    "                steps=[\n",
    "                    dict(\n",
    "                        args=[\n",
    "                            [str(i)],\n",
    "                            dict(\n",
    "                                frame=dict(duration=0, redraw=True),\n",
    "                                mode=\"immediate\",\n",
    "                                transition=dict(duration=0),\n",
    "                            ),\n",
    "                        ],\n",
    "                        label=f\"{float(times[i]):.2f}\",\n",
    "                        method=\"animate\",\n",
    "                    )\n",
    "                    for i in frame_indices\n",
    "                ],\n",
    "                x=0.1,\n",
    "                y=0,\n",
    "                len=0.8,\n",
    "            )\n",
    "        ],\n",
    "        height=500,\n",
    "        showlegend=False,\n",
    "        margin=dict(t=80, b=100),\n",
    "        plot_bgcolor=\"white\",\n",
    "    ),\n",
    ")\n",
    "HTML(fig_anim.to_html(full_html=False, include_plotlyjs=\"cdn\", auto_play=False))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "27td45ecm6g",
   "metadata": {
    "tags": [
     "hide-input"
    ]
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>                        <script type=\"text/javascript\">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>\n",
       "        <script charset=\"utf-8\" src=\"https://cdn.plot.ly/plotly-3.1.0.min.js\" integrity=\"sha256-Ei4740bWZhaUTQuD6q9yQlgVCMPBz6CZWhevDYPv93A=\" crossorigin=\"anonymous\"></script>                <div id=\"5a65c8ad-9397-47e5-9ff2-8b0f9e8b6793\" class=\"plotly-graph-div\" style=\"height:500px; width:100%;\"></div>            <script type=\"text/javascript\">                window.PLOTLYENV=window.PLOTLYENV || {};                                if (document.getElementById(\"5a65c8ad-9397-47e5-9ff2-8b0f9e8b6793\")) {                    Plotly.newPlot(                        \"5a65c8ad-9397-47e5-9ff2-8b0f9e8b6793\",                        [{\"line\":{\"color\":\"steelblue\",\"width\":2},\"mode\":\"lines\",\"name\":\"x\",\"x\":[0.0,0.05000000447034836,0.10000000894069672,0.15000000596046448,0.20000001788139343,0.2500000298023224,0.30000001192092896,0.3500000238418579,0.40000003576278687,0.4500000476837158,0.5000000596046448,0.5500000715255737,0.6000000238418579,0.6500000357627869,0.7000000476837158,0.7500000596046448,0.8000000715255737,0.8500000834465027,0.9000000953674316,0.9500001072883606,1.0000001192092896,1.0500000715255737,1.1000001430511475,1.1500000953674316,1.2000000476837158,1.2500001192092896,1.3000000715255737,1.3500001430511475,1.4000000953674316,1.4500001668930054,1.5000001192092896,1.5500001907348633,1.6000001430511475,1.6500000953674316,1.7000001668930054,1.7500001192092896,1.8000001907348633,1.8500001430511475,1.9000002145767212,1.9500001668930054,2.000000238418579,2.0500001907348633,2.1000001430511475,2.1500000953674316,2.200000286102295,2.250000238418579,2.3000001907348633,2.3500001430511475,2.4000000953674316,2.450000286102295,2.500000238418579,2.5500001907348633,2.6000001430511475,2.6500003337860107,2.700000286102295,2.750000238418579,2.8000001907348633,2.8500001430511475,2.9000003337860107,2.950000286102295,3.0],\"y\":[-0.014587284997105598,-0.01124281994998455,0.002817050088196993,0.031748149544000626,0.07847178727388382,0.14451104402542114,0.22955858707427979,0.3313799202442169,0.4457731246948242,0.5670218467712402,0.6897567510604858,0.8092708587646484,0.9215331673622131,1.0239731073379517,1.1148004531860352,1.1922667026519775,1.2541457414627075,1.2978196144104004,1.3204611539840698,1.319251537322998,1.2936650514602661,1.245625376701355,1.1774486303329468,1.0942940711975098,1.0034881830215454,0.9102118611335754,0.8173772692680359,0.7265289425849915,0.6388323903083801,0.5549300909042358,0.4744873344898224,0.3976452946662903,0.32517021894454956,0.2575836181640625,0.19517000019550323,0.13822270929813385,0.08711875230073929,0.04227641969919205,0.004104439169168472,-0.02703733555972576,-0.0508730374276638,-0.06727027148008347,-0.07628855854272842,-0.07820788025856018,-0.07357484847307205,-0.06327865272760391,-0.04865758493542671,-0.031631000339984894,-0.01486941147595644,-0.0019173853797838092,0.002879651263356209,0.0023681772872805595,0.0018578715389594436,0.001462492160499096,0.0011819197097793221,0.001011352869682014,0.0009426642791368067,0.0009691795567050576,0.0010892528807744384,0.001307072350755334,0.0016227420419454575],\"type\":\"scatter\",\"xaxis\":\"x\",\"yaxis\":\"y\"},{\"line\":{\"color\":\"coral\",\"width\":2},\"mode\":\"lines\",\"name\":\"\",\"x\":[0.0,0.05000000447034836,0.10000000894069672,0.15000000596046448,0.20000001788139343,0.2500000298023224,0.30000001192092896,0.3500000238418579,0.40000003576278687,0.4500000476837158,0.5000000596046448,0.5500000715255737,0.6000000238418579,0.6500000357627869,0.7000000476837158,0.7500000596046448,0.8000000715255737,0.8500000834465027,0.9000000953674316,0.9500001072883606,1.0000001192092896,1.0500000715255737,1.1000001430511475,1.1500000953674316,1.2000000476837158,1.2500001192092896,1.3000000715255737,1.3500001430511475,1.4000000953674316,1.4500001668930054,1.5000001192092896,1.5500001907348633,1.6000001430511475,1.6500000953674316,1.7000001668930054,1.7500001192092896,1.8000001907348633,1.8500001430511475,1.9000002145767212,1.9500001668930054,2.000000238418579,2.0500001907348633,2.1000001430511475,2.1500000953674316,2.200000286102295,2.250000238418579,2.3000001907348633,2.3500001430511475,2.4000000953674316,2.450000286102295,2.500000238418579,2.5500001907348633,2.6000001430511475,2.6500003337860107,2.700000286102295,2.750000238418579,2.8000001907348633,2.8500001430511475,2.9000003337860107,2.950000286102295,3.0],\"y\":[0.05885821208357811,0.05107323080301285,0.025411412119865417,-0.023412443697452545,-0.09796652942895889,-0.1976557821035385,-0.3179922103881836,-0.4506959915161133,-0.5844230651855469,-0.7065922617912292,-0.806734561920166,-0.8771212697029114,-0.9123536944389343,-0.9095161557197571,-0.8669722676277161,-0.7834344506263733,-0.6573950052261353,-0.4873286783695221,-0.27229899168014526,-0.013180985115468502,0.2826310694217682,0.6003186702728271,0.9222009181976318,1.2290219068527222,1.5057746171951294,1.7465180158615112,1.9514033794403076,2.123332977294922,2.2664809226989746,2.38501238822937,2.4820213317871094,2.560729742050171,2.6246984004974365,2.676832914352417,2.7193892002105713,2.7543299198150635,2.7834770679473877,2.8085145950317383,2.8309731483459473,2.852224826812744,2.8734827041625977,2.8957581520080566,2.9198215007781982,2.9461872577667236,2.9750583171844482,3.006213903427124,3.0388355255126953,3.07127046585083,3.100713014602661,3.122920274734497,3.132171154022217,3.1330881118774414,3.133692502975464,3.134178638458252,3.134563684463501,3.134855270385742,3.135051727294922,3.1351499557495117,3.1351513862609863,3.1350619792938232,3.1348788738250732],\"type\":\"scatter\",\"xaxis\":\"x2\",\"yaxis\":\"y2\"},{\"line\":{\"color\":\"steelblue\",\"width\":2},\"mode\":\"lines\",\"name\":\"\",\"x\":[0.0,0.05000000447034836,0.10000000894069672,0.15000000596046448,0.20000001788139343,0.2500000298023224,0.30000001192092896,0.3500000238418579,0.40000003576278687,0.4500000476837158,0.5000000596046448,0.5500000715255737,0.6000000238418579,0.6500000357627869,0.7000000476837158,0.7500000596046448,0.8000000715255737,0.8500000834465027,0.9000000953674316,0.9500001072883606,1.0000001192092896,1.0500000715255737,1.1000001430511475,1.1500000953674316,1.2000000476837158,1.2500001192092896,1.3000000715255737,1.3500001430511475,1.4000000953674316,1.4500001668930054,1.5000001192092896,1.5500001907348633,1.6000001430511475,1.6500000953674316,1.7000001668930054,1.7500001192092896,1.8000001907348633,1.8500001430511475,1.9000002145767212,1.9500001668930054,2.000000238418579,2.0500001907348633,2.1000001430511475,2.1500000953674316,2.200000286102295,2.250000238418579,2.3000001907348633,2.3500001430511475,2.4000000953674316,2.450000286102295,2.500000238418579,2.5500001907348633,2.6000001430511475,2.6500003337860107,2.700000286102295,2.750000238418579,2.8000001907348633,2.8500001430511475,2.9000003337860107,2.950000286102295,3.0],\"y\":[-0.016349516808986664,0.15008585155010223,0.412166029214859,0.7447679042816162,1.1235888004302979,1.5170037746429443,1.8835763931274414,2.1879184246063232,2.386920213699341,2.462902307510376,2.4469263553619385,2.3342788219451904,2.1566383838653564,1.9409232139587402,1.6915924549102783,1.406006097793579,1.0678634643554688,0.6781572103500366,0.22797264158725739,-0.27305057644844055,-0.743817150592804,-1.1702451705932617,-1.5519073009490967,-1.7744708061218262,-1.8612380027770996,-1.87392258644104,-1.8428348302841187,-1.793420433998108,-1.7157987356185913,-1.641033411026001,-1.5770355463027954,-1.4967325925827026,-1.4022141695022583,-1.3011319637298584,-1.195274829864502,-1.0824767351150513,-0.9615485668182373,-0.8320188522338867,-0.6947392821311951,-0.5508112907409668,-0.40249159932136536,-0.2532634139060974,-0.10732154548168182,0.03070990741252899,0.1547866016626358,0.2572469115257263,0.32778555154800415,0.3534621000289917,0.3171660602092743,0.2010398507118225,-0.009106634184718132,-0.011348933912813663,-0.009061381220817566,-0.006752397399395704,-0.004469446372240782,-0.0023523448035120964,-0.0003949358069803566,0.001455444609746337,0.0033468971960246563,0.005364932585507631,0.007260587532073259],\"type\":\"scatter\",\"xaxis\":\"x3\",\"yaxis\":\"y3\"},{\"line\":{\"color\":\"coral\",\"dash\":\"dash\",\"width\":2},\"mode\":\"lines\",\"name\":\"\",\"x\":[0.0,0.05000000447034836,0.10000000894069672,0.15000000596046448,0.20000001788139343,0.2500000298023224,0.30000001192092896,0.3500000238418579,0.40000003576278687,0.4500000476837158,0.5000000596046448,0.5500000715255737,0.6000000238418579,0.6500000357627869,0.7000000476837158,0.7500000596046448,0.8000000715255737,0.8500000834465027,0.9000000953674316,0.9500001072883606,1.0000001192092896,1.0500000715255737,1.1000001430511475,1.1500000953674316,1.2000000476837158,1.2500001192092896,1.3000000715255737,1.3500001430511475,1.4000000953674316,1.4500001668930054,1.5000001192092896,1.5500001907348633,1.6000001430511475,1.6500000953674316,1.7000001668930054,1.7500001192092896,1.8000001907348633,1.8500001430511475,1.9000002145767212,1.9500001668930054,2.000000238418579,2.0500001907348633,2.1000001430511475,2.1500000953674316,2.200000286102295,2.250000238418579,2.3000001907348633,2.3500001430511475,2.4000000953674316,2.450000286102295,2.500000238418579,2.5500001907348633,2.6000001430511475,2.6500003337860107,2.700000286102295,2.750000238418579,2.8000001907348633,2.8500001430511475,2.9000003337860107,2.950000286102295,3.0],\"y\":[-0.00991344265639782,-0.30047884583473206,-0.722690999507904,-1.2238061428070068,-1.7479177713394165,-2.2246744632720947,-2.5698025226593018,-2.717606544494629,-2.612771511077881,-2.260446310043335,-1.7369999885559082,-1.0747588872909546,-0.33337050676345825,0.44690462946891785,1.2542542219161987,2.0858466625213623,2.9526853561401367,3.8426709175109863,4.74245023727417,5.590741157531738,6.191751003265381,6.456380367279053,6.364134311676025,5.8759565353393555,5.182378768920898,4.44781494140625,3.7545909881591797,3.1323626041412354,2.6048483848571777,2.1471922397613525,1.7427959442138672,1.4141918420791626,1.1520963907241821,0.939686119556427,0.7679518461227417,0.6341841816902161,0.5355364680290222,0.46931424736976624,0.4320473372936249,0.4209093749523163,0.43232905864715576,0.4617336392402649,0.5040967464447021,0.5541375279426575,0.6046296954154968,0.6457977294921875,0.6634047627449036,0.6382625699043274,0.5433099865913391,0.3478947579860687,0.02336599864065647,0.013438869267702103,0.010843418538570404,0.008680037222802639,0.006797182373702526,0.004914418328553438,0.002971719251945615,0.0009770875331014395,-0.0009195696911774576,-0.002659308258444071,-0.004681979306042194],\"type\":\"scatter\",\"xaxis\":\"x3\",\"yaxis\":\"y3\"},{\"fill\":\"tozeroy\",\"fillcolor\":\"rgba(34, 139, 34, 0.2)\",\"line\":{\"color\":\"forestgreen\",\"width\":2},\"mode\":\"lines\",\"name\":\"F\",\"x\":[0.0,0.05000000074505806,0.10000000149011612,0.15000000596046448,0.20000000298023224,0.25,0.30000001192092896,0.3499999940395355,0.4000000059604645,0.45000001788139343,0.5,0.550000011920929,0.6000000238418579,0.6500000357627869,0.699999988079071,0.75,0.800000011920929,0.8500000238418579,0.9000000357627869,0.949999988079071,1.0,1.0500000715255737,1.100000023841858,1.149999976158142,1.2000000476837158,1.25,1.3000000715255737,1.350000023841858,1.399999976158142,1.4500000476837158,1.5,1.5500000715255737,1.600000023841858,1.649999976158142,1.7000000476837158,1.75,1.8000000715255737,1.850000023841858,1.899999976158142,1.9500000476837158,2.0,2.049999952316284,2.1000001430511475,2.1500000953674316,2.200000047683716,2.25,2.299999952316284,2.3500001430511475,2.4000000953674316,2.450000047683716,2.5,2.549999952316284,2.6000001430511475,2.6500000953674316,2.700000047683716,2.75,2.799999952316284,2.8500001430511475,2.9000000953674316,2.950000047683716],\"y\":[3.3713884353637695,5.343393802642822,6.816225528717041,7.817986011505127,8.213294982910156,7.80497407913208,6.690252304077148,4.64516019821167,2.13149356842041,0.16601474583148956,-1.9636634588241577,-3.4249160289764404,-4.267307281494141,-4.9480719566345215,-5.616782188415527,-6.579660892486572,-7.515523433685303,-8.731653213500977,-9.999841690063477,-10.00084400177002,-10.0,-9.879938125610352,-6.771528244018555,-3.5415241718292236,-1.393316388130188,0.06673717498779297,0.8378639817237854,1.6822030544281006,1.7528866529464722,1.5921021699905396,1.9616620540618896,2.260064125061035,2.38537335395813,2.468348264694214,2.5948519706726074,2.7460784912109375,2.90769362449646,3.052299976348877,3.174377918243408,3.2495601177215576,3.2520525455474854,3.166821241378784,2.984851837158203,2.677015781402588,2.210503101348877,1.5318344831466675,0.5881054401397705,-0.7046826481819153,-2.3597536087036133,-4.298752784729004,-0.03940334543585777,0.05292162671685219,0.05296070873737335,0.05210716277360916,0.048458121716976166,0.045004721730947495,0.04270210862159729,0.04350780323147774,0.04613589867949486,0.043726708739995956],\"type\":\"scatter\",\"xaxis\":\"x4\",\"yaxis\":\"y4\"}],                        {\"template\":{\"data\":{\"histogram2dcontour\":[{\"type\":\"histogram2dcontour\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"choropleth\":[{\"type\":\"choropleth\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}],\"histogram2d\":[{\"type\":\"histogram2d\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"heatmap\":[{\"type\":\"heatmap\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"contourcarpet\":[{\"type\":\"contourcarpet\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}],\"contour\":[{\"type\":\"contour\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"surface\":[{\"type\":\"surface\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"mesh3d\":[{\"type\":\"mesh3d\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}],\"scatter\":[{\"fillpattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2},\"type\":\"scatter\"}],\"parcoords\":[{\"type\":\"parcoords\",\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scatterpolargl\":[{\"type\":\"scatterpolargl\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"bar\":[{\"error_x\":{\"color\":\"#2a3f5f\"},\"error_y\":{\"color\":\"#2a3f5f\"},\"marker\":{\"line\":{\"color\":\"#E5ECF6\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"bar\"}],\"scattergeo\":[{\"type\":\"scattergeo\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scatterpolar\":[{\"type\":\"scatterpolar\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"histogram\":[{\"marker\":{\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"histogram\"}],\"scattergl\":[{\"type\":\"scattergl\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scatter3d\":[{\"type\":\"scatter3d\",\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scattermap\":[{\"type\":\"scattermap\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scattermapbox\":[{\"type\":\"scattermapbox\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scatterternary\":[{\"type\":\"scatterternary\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scattercarpet\":[{\"type\":\"scattercarpet\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"carpet\":[{\"aaxis\":{\"endlinecolor\":\"#2a3f5f\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"minorgridcolor\":\"white\",\"startlinecolor\":\"#2a3f5f\"},\"baxis\":{\"endlinecolor\":\"#2a3f5f\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"minorgridcolor\":\"white\",\"startlinecolor\":\"#2a3f5f\"},\"type\":\"carpet\"}],\"table\":[{\"cells\":{\"fill\":{\"color\":\"#EBF0F8\"},\"line\":{\"color\":\"white\"}},\"header\":{\"fill\":{\"color\":\"#C8D4E3\"},\"line\":{\"color\":\"white\"}},\"type\":\"table\"}],\"barpolar\":[{\"marker\":{\"line\":{\"color\":\"#E5ECF6\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"barpolar\"}],\"pie\":[{\"automargin\":true,\"type\":\"pie\"}]},\"layout\":{\"autotypenumbers\":\"strict\",\"colorway\":[\"#636efa\",\"#EF553B\",\"#00cc96\",\"#ab63fa\",\"#FFA15A\",\"#19d3f3\",\"#FF6692\",\"#B6E880\",\"#FF97FF\",\"#FECB52\"],\"font\":{\"color\":\"#2a3f5f\"},\"hovermode\":\"closest\",\"hoverlabel\":{\"align\":\"left\"},\"paper_bgcolor\":\"white\",\"plot_bgcolor\":\"#E5ECF6\",\"polar\":{\"bgcolor\":\"#E5ECF6\",\"angularaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"},\"radialaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"}},\"ternary\":{\"bgcolor\":\"#E5ECF6\",\"aaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"},\"baxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"},\"caxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"}},\"coloraxis\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"colorscale\":{\"sequential\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"sequentialminus\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"diverging\":[[0,\"#8e0152\"],[0.1,\"#c51b7d\"],[0.2,\"#de77ae\"],[0.3,\"#f1b6da\"],[0.4,\"#fde0ef\"],[0.5,\"#f7f7f7\"],[0.6,\"#e6f5d0\"],[0.7,\"#b8e186\"],[0.8,\"#7fbc41\"],[0.9,\"#4d9221\"],[1,\"#276419\"]]},\"xaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"white\",\"automargin\":true,\"zerolinewidth\":2},\"yaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"white\",\"automargin\":true,\"zerolinewidth\":2},\"scene\":{\"xaxis\":{\"backgroundcolor\":\"#E5ECF6\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"white\",\"gridwidth\":2},\"yaxis\":{\"backgroundcolor\":\"#E5ECF6\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"white\",\"gridwidth\":2},\"zaxis\":{\"backgroundcolor\":\"#E5ECF6\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"white\",\"gridwidth\":2}},\"shapedefaults\":{\"line\":{\"color\":\"#2a3f5f\"}},\"annotationdefaults\":{\"arrowcolor\":\"#2a3f5f\",\"arrowhead\":0,\"arrowwidth\":1},\"geo\":{\"bgcolor\":\"white\",\"landcolor\":\"#E5ECF6\",\"subunitcolor\":\"white\",\"showland\":true,\"showlakes\":true,\"lakecolor\":\"white\"},\"title\":{\"x\":0.05},\"mapbox\":{\"style\":\"light\"}}},\"xaxis\":{\"anchor\":\"y\",\"domain\":[0.0,0.45],\"title\":{\"text\":\"Time (s)\"}},\"yaxis\":{\"anchor\":\"x\",\"domain\":[0.575,1.0],\"title\":{\"text\":\"Position (m)\"}},\"xaxis2\":{\"anchor\":\"y2\",\"domain\":[0.55,1.0],\"title\":{\"text\":\"Time (s)\"}},\"yaxis2\":{\"anchor\":\"x2\",\"domain\":[0.575,1.0],\"title\":{\"text\":\"Angle (rad)\"}},\"xaxis3\":{\"anchor\":\"y3\",\"domain\":[0.0,0.45],\"title\":{\"text\":\"Time (s)\"}},\"yaxis3\":{\"anchor\":\"x3\",\"domain\":[0.0,0.425],\"title\":{\"text\":\"Velocity\"}},\"xaxis4\":{\"anchor\":\"y4\",\"domain\":[0.55,1.0],\"title\":{\"text\":\"Time (s)\"}},\"yaxis4\":{\"anchor\":\"x4\",\"domain\":[0.0,0.425],\"title\":{\"text\":\"Force (N)\"}},\"annotations\":[{\"font\":{\"size\":16},\"showarrow\":false,\"text\":\"Cart Position\",\"x\":0.225,\"xanchor\":\"center\",\"xref\":\"paper\",\"y\":1.0,\"yanchor\":\"bottom\",\"yref\":\"paper\"},{\"font\":{\"size\":16},\"showarrow\":false,\"text\":\"Pole Angle\",\"x\":0.775,\"xanchor\":\"center\",\"xref\":\"paper\",\"y\":1.0,\"yanchor\":\"bottom\",\"yref\":\"paper\"},{\"font\":{\"size\":16},\"showarrow\":false,\"text\":\"Velocities\",\"x\":0.225,\"xanchor\":\"center\",\"xref\":\"paper\",\"y\":0.425,\"yanchor\":\"bottom\",\"yref\":\"paper\"},{\"font\":{\"size\":16},\"showarrow\":false,\"text\":\"Control Force\",\"x\":0.775,\"xanchor\":\"center\",\"xref\":\"paper\",\"y\":0.425,\"yanchor\":\"bottom\",\"yref\":\"paper\"},{\"showarrow\":false,\"text\":\"\",\"x\":1,\"xanchor\":\"right\",\"xref\":\"x2 domain\",\"y\":3.141592653589793,\"yanchor\":\"bottom\",\"yref\":\"y2\"}],\"shapes\":[{\"line\":{\"color\":\"gray\",\"dash\":\"dash\"},\"type\":\"line\",\"x0\":0,\"x1\":1,\"xref\":\"x2 domain\",\"y0\":3.141592653589793,\"y1\":3.141592653589793,\"yref\":\"y2\"},{\"line\":{\"color\":\"red\",\"dash\":\"dash\"},\"opacity\":0.5,\"type\":\"line\",\"x0\":0,\"x1\":1,\"xref\":\"x4 domain\",\"y0\":10.0,\"y1\":10.0,\"yref\":\"y4\"},{\"line\":{\"color\":\"red\",\"dash\":\"dash\"},\"opacity\":0.5,\"type\":\"line\",\"x0\":0,\"x1\":1,\"xref\":\"x4 domain\",\"y0\":-10.0,\"y1\":-10.0,\"yref\":\"y4\"}],\"margin\":{\"t\":40,\"b\":40},\"height\":500,\"showlegend\":false},                        {\"responsive\": true}                    )                };            </script>        </div>"
      ],
      "text/plain": [
       "<IPython.core.display.HTML object>"
      ]
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# State and control trajectories\n",
    "fig_traj = make_subplots(\n",
    "    rows=2,\n",
    "    cols=2,\n",
    "    subplot_titles=(\"Cart Position\", \"Pole Angle\", \"Velocities\", \"Control Force\"),\n",
    "    vertical_spacing=0.15,\n",
    "    horizontal_spacing=0.1,\n",
    ")\n",
    "\n",
    "# Cart position\n",
    "fig_traj.add_trace(\n",
    "    go.Scatter(\n",
    "        x=[float(t) for t in times],\n",
    "        y=[float(s) for s in states[:, 0]],\n",
    "        mode=\"lines\",\n",
    "        line=dict(color=\"steelblue\", width=2),\n",
    "        name=\"x\",\n",
    "    ),\n",
    "    row=1,\n",
    "    col=1,\n",
    ")\n",
    "\n",
    "# Pole angle\n",
    "fig_traj.add_trace(\n",
    "    go.Scatter(\n",
    "        x=[float(t) for t in times],\n",
    "        y=[float(s) for s in states[:, 1]],\n",
    "        mode=\"lines\",\n",
    "        line=dict(color=\"coral\", width=2),\n",
    "        name=\"\",\n",
    "    ),\n",
    "    row=1,\n",
    "    col=2,\n",
    ")\n",
    "fig_traj.add_hline(\n",
    "    y=float(jnp.pi),\n",
    "    line_dash=\"dash\",\n",
    "    line_color=\"gray\",\n",
    "    row=1,\n",
    "    col=2,\n",
    "    annotation_text=\"\",\n",
    ")\n",
    "\n",
    "# Velocities\n",
    "fig_traj.add_trace(\n",
    "    go.Scatter(\n",
    "        x=[float(t) for t in times],\n",
    "        y=[float(s) for s in states[:, 2]],\n",
    "        mode=\"lines\",\n",
    "        line=dict(color=\"steelblue\", width=2),\n",
    "        name=\"\",\n",
    "    ),\n",
    "    row=2,\n",
    "    col=1,\n",
    ")\n",
    "fig_traj.add_trace(\n",
    "    go.Scatter(\n",
    "        x=[float(t) for t in times],\n",
    "        y=[float(s) for s in states[:, 3]],\n",
    "        mode=\"lines\",\n",
    "        line=dict(color=\"coral\", width=2, dash=\"dash\"),\n",
    "        name=\"\",\n",
    "    ),\n",
    "    row=2,\n",
    "    col=1,\n",
    ")\n",
    "\n",
    "# Control force\n",
    "fig_traj.add_trace(\n",
    "    go.Scatter(\n",
    "        x=[float(t) for t in control_times],\n",
    "        y=[float(u) for u in controls[:, 0]],\n",
    "        mode=\"lines\",\n",
    "        line=dict(color=\"forestgreen\", width=2),\n",
    "        name=\"F\",\n",
    "        fill=\"tozeroy\",\n",
    "        fillcolor=\"rgba(34, 139, 34, 0.2)\",\n",
    "    ),\n",
    "    row=2,\n",
    "    col=2,\n",
    ")\n",
    "fig_traj.add_hline(\n",
    "    y=force_limit, line_dash=\"dash\", line_color=\"red\", opacity=0.5, row=2, col=2\n",
    ")\n",
    "fig_traj.add_hline(\n",
    "    y=-force_limit, line_dash=\"dash\", line_color=\"red\", opacity=0.5, row=2, col=2\n",
    ")\n",
    "\n",
    "# Axis labels\n",
    "fig_traj.update_xaxes(title_text=\"Time (s)\", row=1, col=1)\n",
    "fig_traj.update_yaxes(title_text=\"Position (m)\", row=1, col=1)\n",
    "fig_traj.update_xaxes(title_text=\"Time (s)\", row=1, col=2)\n",
    "fig_traj.update_yaxes(title_text=\"Angle (rad)\", row=1, col=2)\n",
    "fig_traj.update_xaxes(title_text=\"Time (s)\", row=2, col=1)\n",
    "fig_traj.update_yaxes(title_text=\"Velocity\", row=2, col=1)\n",
    "fig_traj.update_xaxes(title_text=\"Time (s)\", row=2, col=2)\n",
    "fig_traj.update_yaxes(title_text=\"Force (N)\", row=2, col=2)\n",
    "\n",
    "fig_traj.update_layout(height=500, showlegend=False, margin=dict(t=40, b=40))\n",
    "HTML(fig_traj.to_html(full_html=False, include_plotlyjs=\"cdn\"))"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.12.4"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}