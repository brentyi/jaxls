<!doctype html>
<html class="no-js" lang="en" data-content_root="../../../">
  <head><meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../../../genindex/"><link rel="search" title="Search" href="../../../search/"><link rel="next" title="Cloth draping" href="../cloth_draping/"><link rel="prev" title="Mechanics" href="../">

    <!-- Generated with Sphinx 8.1.3 and Furo 2025.12.19 -->
        <title>Spring equilibrium - jaxls</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=b86133f3" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/furo.css?v=7bdb33bb" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css?v=6644e6bb" />
    <link rel="stylesheet" type="text/css" href="../../../_static/css/custom.css?v=6517d2d4" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/furo-extensions.css?v=8dab3a3b" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  --color-code-background: #f4f4f4;
  --color-code-foreground: #000;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle site navigation sidebar">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc" aria-label="Toggle table of contents sidebar">
<label class="overlay sidebar-overlay" for="__navigation"></label>
<label class="overlay toc-overlay" for="__toc"></label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <span class="icon"><svg><use href="#svg-menu"></use></svg></span>
      </label>
    </div>
    <div class="header-center">
      <a href="../../../"><div class="brand">jaxls</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a
  class="sidebar-brand"
  href="../../../"
  style="margin-top: 0.75em"
>
  
  <span class="sidebar-brand-text">jaxls</span>

  
</a>

<div style="text-align: left; padding: 0 1em 1em 1em">
  <a href="https://github.com/brentyi/jaxls">
    <img src="https://img.shields.io/github/stars/brentyi/jaxls?style=social" alt="GitHub stars">
  </a>
</div><form class="sidebar-search-container" method="get" action="../../../search/" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../guide/basics/">Basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../guide/tips_and_gotchas/">Tips and gotchas</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../guide/advanced/">Advanced</a><input aria-label="Toggle navigation of Advanced" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../guide/advanced/non_euclidean/">Non-Euclidean variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../guide/advanced/custom_jacobians/">Custom Jacobians</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../guide/advanced/constraints/">Constraints</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../guide/advanced/robust_costs/">Robust costs</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Examples</span></p>
<ul class="current">
<li class="toctree-l1 current has-children"><a class="reference internal" href="../">Mechanics</a><input aria-label="Toggle navigation of Mechanics" checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul class="current">
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">Spring equilibrium</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cloth_draping/">Cloth draping</a></li>
<li class="toctree-l2"><a class="reference internal" href="../beam_bending/">Beam bending</a></li>
<li class="toctree-l2"><a class="reference internal" href="../truss_analysis/">Truss analysis</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../vision/">Vision</a><input aria-label="Toggle navigation of Vision" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../vision/camera_calibration/">Camera calibration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../vision/pose_graph_2d/">SE(2) pose graph</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../vision/pose_graph_3d/">SE(3) pose graph</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../vision/bundle_adjustment/">Bundle adjustment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../vision/smplh_shape_fitting/">SMPL-H shape fitting</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../robotics/">Robotics</a><input aria-label="Toggle navigation of Robotics" class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../robotics/inverse_kinematics/">Inverse kinematics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../robotics/obstacle_avoidance/">Obstacle avoidance</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../robotics/cart_pole_collocation/">Cart-pole (collocation)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../robotics/cart_pole_shooting/">Cart-pole (shooting)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../robotics/cam_design/">Cam profile optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../robotics/imu_sensor_fusion/">IMU fusion + calibration</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../portfolio/">Portfolio optimization</a><input aria-label="Toggle navigation of Portfolio optimization" class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../portfolio/mean_variance/">Mean-variance allocation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../portfolio/manifold_allocation/">Manifold allocation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../portfolio/reparameterized_allocation/">Reparameterized allocation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../portfolio/cvar_optimization/">CVaR allocation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../portfolio/black_litterman/">Black-Litterman allocation</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../api/core/">Core API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/lie_group_variables/">Lie group variables</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/solver_config/">Solver configuration</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Design Notes</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../design/typed_api/">Typed API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../design/sparse_matrices/">Sparse matrices</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../design/traced_vs_static/">What’s traced?</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="../../../_sources/examples/mechanics/spring_equilibrium.ipynb.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section class="tex2jax_ignore mathjax_ignore" id="spring-equilibrium">
<h1>Spring equilibrium<a class="headerlink" href="#spring-equilibrium" title="Link to this heading">¶</a></h1>
<p>In this notebook, we solve a spring network equilibrium problem: finding the resting
shape of a mesh of masses connected by springs under gravity.</p>
<p>Features used:</p>
<ul class="simple">
<li><p><a class="reference internal" href="../../../api/core/#jaxls.Var" title="jaxls.Var"><code class="xref py py-class docutils literal notranslate"><span class="pre">Var</span></code></a> subclassing for custom variable types</p></li>
<li><p><a class="reference internal" href="../../../api/core/#jaxls.Cost.factory" title="jaxls.Cost.factory"><code class="xref py py-func docutils literal notranslate"><span class="pre">&#64;jaxls.Cost.factory</span></code></a> for defining costs</p></li>
<li><p>Equality constraints (<code class="docutils literal notranslate"><span class="pre">constraint_eq_zero</span></code>) for anchoring points</p></li>
<li><p>Augmented Lagrangian solver for constrained optimization</p></li>
</ul>
<p>We show two approaches:</p>
<ol class="arabic simple">
<li><p>Naive construction: Build variables and costs one-by-one (simple but slower)</p></li>
<li><p>Batched construction: Use array operations for efficiency (recommended for large problems)</p></li>
</ol>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">loguru</span><span class="w"> </span><span class="kn">import</span> <span class="n">logger</span>

<span class="n">logger</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
<span class="n">logger</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;&lt;level&gt;</span><span class="si">{level: &lt;8}</span><span class="s2">&lt;/level&gt; | </span><span class="si">{message}</span><span class="s2">&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">jax</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">jax.numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">jnp</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">jaxls</span>
</pre></div>
</div>
</div>
</div>
<section id="variables-and-costs">
<h2>Variables and costs<a class="headerlink" href="#variables-and-costs" title="Link to this heading">¶</a></h2>
<p>Variables represent the unknowns we want to solve for. We define a custom 2D point variable by subclassing <code class="docutils literal notranslate"><span class="pre">jaxls.Var</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">Point2Var</span><span class="p">(</span><span class="n">jaxls</span><span class="o">.</span><span class="n">Var</span><span class="p">[</span><span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">],</span> <span class="n">default_factory</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">2</span><span class="p">)):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A 2D point variable.&quot;&quot;&quot;</span>
</pre></div>
</div>
</div>
</div>
<p>Cost functions define what we’re optimizing. Use <a class="reference internal" href="../../../api/core/#jaxls.Cost.factory" title="jaxls.Cost.factory"><code class="xref py py-func docutils literal notranslate"><span class="pre">&#64;jaxls.Cost.factory</span></code></a> to create cost factories.</p>
<p>A cost function takes a <a class="reference internal" href="../../../api/core/#jaxls.VarValues" title="jaxls.VarValues"><code class="xref py py-class docutils literal notranslate"><span class="pre">VarValues</span></code></a> object (for looking up variable values) plus any arguments, and returns a residual vector to minimize or constrain.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@jaxls</span><span class="o">.</span><span class="n">Cost</span><span class="o">.</span><span class="n">factory</span>
<span class="k">def</span><span class="w"> </span><span class="nf">spring_cost</span><span class="p">(</span>
    <span class="n">vals</span><span class="p">:</span> <span class="n">jaxls</span><span class="o">.</span><span class="n">VarValues</span><span class="p">,</span>
    <span class="n">var_a</span><span class="p">:</span> <span class="n">Point2Var</span><span class="p">,</span>
    <span class="n">var_b</span><span class="p">:</span> <span class="n">Point2Var</span><span class="p">,</span>
    <span class="n">rest_length</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Penalize deviation from rest length.&quot;&quot;&quot;</span>
    <span class="n">diff</span> <span class="o">=</span> <span class="n">vals</span><span class="p">[</span><span class="n">var_a</span><span class="p">]</span> <span class="o">-</span> <span class="n">vals</span><span class="p">[</span><span class="n">var_b</span><span class="p">]</span>
    <span class="n">length</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">diff</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1e-6</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">length</span> <span class="o">-</span> <span class="n">rest_length</span>


<span class="nd">@jaxls</span><span class="o">.</span><span class="n">Cost</span><span class="o">.</span><span class="n">factory</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s2">&quot;constraint_eq_zero&quot;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">anchor_constraint</span><span class="p">(</span>
    <span class="n">vals</span><span class="p">:</span> <span class="n">jaxls</span><span class="o">.</span><span class="n">VarValues</span><span class="p">,</span>
    <span class="n">var</span><span class="p">:</span> <span class="n">Point2Var</span><span class="p">,</span>
    <span class="n">target</span><span class="p">:</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Pin a point to a target position (hard constraint).&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">vals</span><span class="p">[</span><span class="n">var</span><span class="p">]</span> <span class="o">-</span> <span class="n">target</span>


<span class="nd">@jaxls</span><span class="o">.</span><span class="n">Cost</span><span class="o">.</span><span class="n">factory</span>
<span class="k">def</span><span class="w"> </span><span class="nf">gravity_cost</span><span class="p">(</span>
    <span class="n">vals</span><span class="p">:</span> <span class="n">jaxls</span><span class="o">.</span><span class="n">VarValues</span><span class="p">,</span>
    <span class="n">var</span><span class="p">:</span> <span class="n">Point2Var</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Pull points downward.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">vals</span><span class="p">[</span><span class="n">var</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mf">10.0</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.15</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="problem-setup">
<h2>Problem setup<a class="headerlink" href="#problem-setup" title="Link to this heading">¶</a></h2>
<p>We’ll create a 5x4 grid of points. The left and right columns will be anchored, and springs connect adjacent points:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Grid dimensions.</span>
<span class="n">cols</span><span class="p">,</span> <span class="n">rows</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">4</span>
<span class="n">num_points</span> <span class="o">=</span> <span class="n">cols</span> <span class="o">*</span> <span class="n">rows</span>
<span class="n">spacing</span> <span class="o">=</span> <span class="mf">1.0</span>


<span class="k">def</span><span class="w"> </span><span class="nf">idx</span><span class="p">(</span><span class="n">row</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">col</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert (row, col) to flat index.</span>

<span class="sd">    Args:</span>
<span class="sd">        row: Row index</span>
<span class="sd">        col: Column index</span>

<span class="sd">    Returns:</span>
<span class="sd">        Flat index into the points array</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">row</span> <span class="o">*</span> <span class="n">cols</span> <span class="o">+</span> <span class="n">col</span>


<span class="c1"># Initial positions (regular grid)</span>
<span class="n">initial_positions</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
    <span class="p">[[</span><span class="n">c</span> <span class="o">*</span> <span class="n">spacing</span><span class="p">,</span> <span class="o">-</span><span class="n">r</span> <span class="o">*</span> <span class="n">spacing</span><span class="p">]</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">rows</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">cols</span><span class="p">)]</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Grid: </span><span class="si">{</span><span class="n">cols</span><span class="si">}</span><span class="s2">x</span><span class="si">{</span><span class="n">rows</span><span class="si">}</span><span class="s2"> = </span><span class="si">{</span><span class="n">num_points</span><span class="si">}</span><span class="s2"> points&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Grid: 5x4 = 20 points
</pre></div>
</div>
</div>
</div>
</section>
<section id="approach-1-naive-construction">
<h2>Approach 1: naive construction<a class="headerlink" href="#approach-1-naive-construction" title="Link to this heading">¶</a></h2>
<p>The straightforward approach: create variables and costs one-by-one using Python loops.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create variables for each grid point.</span>
<span class="n">point_vars_naive</span> <span class="o">=</span> <span class="p">{</span>
    <span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span> <span class="n">Point2Var</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">idx</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">))</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">rows</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">costs_naive</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">jaxls</span><span class="o">.</span><span class="n">Cost</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># Anchor the left and right columns.</span>
<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">rows</span><span class="p">):</span>
    <span class="n">costs_naive</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
        <span class="n">anchor_constraint</span><span class="p">(</span><span class="n">point_vars_naive</span><span class="p">[(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">)],</span> <span class="n">initial_positions</span><span class="p">[</span><span class="n">idx</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">)])</span>
    <span class="p">)</span>
    <span class="n">costs_naive</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
        <span class="n">anchor_constraint</span><span class="p">(</span>
            <span class="n">point_vars_naive</span><span class="p">[(</span><span class="n">row</span><span class="p">,</span> <span class="n">cols</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)],</span> <span class="n">initial_positions</span><span class="p">[</span><span class="n">idx</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">cols</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)]</span>
        <span class="p">)</span>
    <span class="p">)</span>

<span class="c1"># Horizontal springs.</span>
<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">rows</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">cols</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">costs_naive</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">spring_cost</span><span class="p">(</span>
                <span class="n">point_vars_naive</span><span class="p">[(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">)],</span> <span class="n">point_vars_naive</span><span class="p">[(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)],</span> <span class="n">spacing</span>
            <span class="p">)</span>
        <span class="p">)</span>

<span class="c1"># Vertical springs.</span>
<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">rows</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">cols</span><span class="p">):</span>
        <span class="n">costs_naive</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">spring_cost</span><span class="p">(</span>
                <span class="n">point_vars_naive</span><span class="p">[(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">)],</span> <span class="n">point_vars_naive</span><span class="p">[(</span><span class="n">row</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">col</span><span class="p">)],</span> <span class="n">spacing</span>
            <span class="p">)</span>
        <span class="p">)</span>

<span class="c1"># Gravity on non-anchor points.</span>
<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">rows</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">cols</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">costs_naive</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">gravity_cost</span><span class="p">(</span><span class="n">point_vars_naive</span><span class="p">[(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">)]))</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Naive: Created </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">costs_naive</span><span class="p">)</span><span class="si">}</span><span class="s2"> cost objects&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Naive: Created 51 cost objects
</pre></div>
</div>
</div>
</div>
</section>
<section id="approach-2-batched-construction">
<h2>Approach 2: batched construction<a class="headerlink" href="#approach-2-batched-construction" title="Link to this heading">¶</a></h2>
<p>When variable IDs have a leading batch axis, a batch of costs is created in one call. This reduces Python overhead and speeds up problem analysis.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create ALL point variables at once with batched IDs.</span>
<span class="n">all_point_vars</span> <span class="o">=</span> <span class="n">Point2Var</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">num_points</span><span class="p">))</span>

<span class="c1"># Precompute index arrays.</span>
<span class="n">anchor_indices</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">idx</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">rows</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">cols</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]])</span>
<span class="n">anchor_positions</span> <span class="o">=</span> <span class="n">initial_positions</span><span class="p">[</span><span class="n">anchor_indices</span><span class="p">]</span>

<span class="n">h_spring_a</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">idx</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">rows</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">cols</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)])</span>
<span class="n">h_spring_b</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">idx</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">c</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">rows</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">cols</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)])</span>

<span class="n">v_spring_a</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">idx</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">rows</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">cols</span><span class="p">)])</span>
<span class="n">v_spring_b</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">idx</span><span class="p">(</span><span class="n">r</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">rows</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">cols</span><span class="p">)])</span>

<span class="n">interior_indices</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
    <span class="p">[</span><span class="n">idx</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">rows</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">cols</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)]</span>
<span class="p">)</span>

<span class="c1"># Create all costs using batched construction (4 calls instead of 51!)</span>
<span class="n">costs_batched</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">jaxls</span><span class="o">.</span><span class="n">Cost</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">anchor_constraint</span><span class="p">(</span><span class="n">Point2Var</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">anchor_indices</span><span class="p">),</span> <span class="n">anchor_positions</span><span class="p">),</span>
    <span class="n">spring_cost</span><span class="p">(</span><span class="n">Point2Var</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">h_spring_a</span><span class="p">),</span> <span class="n">Point2Var</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">h_spring_b</span><span class="p">),</span> <span class="n">spacing</span><span class="p">),</span>
    <span class="n">spring_cost</span><span class="p">(</span><span class="n">Point2Var</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">v_spring_a</span><span class="p">),</span> <span class="n">Point2Var</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">v_spring_b</span><span class="p">),</span> <span class="n">spacing</span><span class="p">),</span>
    <span class="n">gravity_cost</span><span class="p">(</span><span class="n">Point2Var</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">interior_indices</span><span class="p">)),</span>
<span class="p">]</span>

<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;Batched: Created </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">costs_batched</span><span class="p">)</span><span class="si">}</span><span class="s2"> cost objects (representing 51 individual costs)&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Batched: Created 4 cost objects (representing 51 individual costs)
</pre></div>
</div>
</div>
</div>
</section>
<section id="solving">
<h2>Solving<a class="headerlink" href="#solving" title="Link to this heading">¶</a></h2>
<p>Both approaches produce identical results. We’ll use the batched version:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create initial values.</span>
<span class="n">initial_vals</span> <span class="o">=</span> <span class="n">jaxls</span><span class="o">.</span><span class="n">VarValues</span><span class="o">.</span><span class="n">make</span><span class="p">([</span><span class="n">all_point_vars</span><span class="o">.</span><span class="n">with_value</span><span class="p">(</span><span class="n">initial_positions</span><span class="p">)])</span>

<span class="c1"># Build and solve.</span>
<span class="n">problem</span> <span class="o">=</span> <span class="n">jaxls</span><span class="o">.</span><span class="n">LeastSquaresProblem</span><span class="p">(</span><span class="n">costs_batched</span><span class="p">,</span> <span class="p">[</span><span class="n">all_point_vars</span><span class="p">])</span><span class="o">.</span><span class="n">analyze</span><span class="p">()</span>
<span class="n">solution</span> <span class="o">=</span> <span class="n">problem</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">initial_vals</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Bold">INFO    </span> | Building optimization problem with 51 terms and 20 variables: 43 costs, 8 eq_zero, 0 leq_zero, 0 geq_zero
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing constraint group with 8 constraints (constraint_eq_zero), 1 variables each: augmented_anchor_constraint
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 31 costs, 2 variables each: spring_cost
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 12 costs, 1 variables each: gravity_cost
<span class=" -Color -Color-Bold">INFO    </span> | Augmented Lagrangian: initial snorm=0.0000e+00, csupn=0.0000e+00, max_rho=1.9845e+02, constraint_dim=16
<span class=" -Color -Color-Bold">INFO    </span> |  step #0: cost=19.8450 lambd=0.0005 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_anchor_constraint(8): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - spring_cost(31): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - gravity_cost(12): 19.84501 (avg 1.65375)
<span class=" -Color -Color-Bold">INFO    </span> |  step #1: cost=19.8450 lambd=0.0010 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_anchor_constraint(8): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - spring_cost(31): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - gravity_cost(12): 19.84501 (avg 1.65375)
<span class=" -Color -Color-Bold">INFO    </span> |  step #2: cost=19.8450 lambd=0.0020 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_anchor_constraint(8): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - spring_cost(31): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - gravity_cost(12): 19.84501 (avg 1.65375)
<span class=" -Color -Color-Bold">INFO    </span> |  step #3: cost=19.8450 lambd=0.0040 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_anchor_constraint(8): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - spring_cost(31): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - gravity_cost(12): 19.84501 (avg 1.65375)
<span class=" -Color -Color-Bold">INFO    </span> |  step #4: cost=19.8450 lambd=0.0080 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_anchor_constraint(8): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - spring_cost(31): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - gravity_cost(12): 19.84501 (avg 1.65375)
<span class=" -Color -Color-Bold">INFO    </span> |  step #5: cost=19.8450 lambd=0.0160 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_anchor_constraint(8): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - spring_cost(31): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - gravity_cost(12): 19.84501 (avg 1.65375)
<span class=" -Color -Color-Bold">INFO    </span> |  step #6: cost=19.8450 lambd=0.0320 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_anchor_constraint(8): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - spring_cost(31): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - gravity_cost(12): 19.84501 (avg 1.65375)
<span class=" -Color -Color-Bold">INFO    </span> |  step #7: cost=19.8450 lambd=0.0640 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_anchor_constraint(8): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - spring_cost(31): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - gravity_cost(12): 19.84501 (avg 1.65375)
<span class=" -Color -Color-Bold">INFO    </span> |  step #8: cost=19.8450 lambd=0.1280 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_anchor_constraint(8): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - spring_cost(31): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - gravity_cost(12): 19.84501 (avg 1.65375)
<span class=" -Color -Color-Bold">INFO    </span> |  step #9: cost=19.8450 lambd=0.2560 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_anchor_constraint(8): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - spring_cost(31): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - gravity_cost(12): 19.84501 (avg 1.65375)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=9.73e-01 cost_prev=19.8450 cost_new=17.7450
<span class=" -Color -Color-Bold">INFO    </span> |  step #10: cost=17.7450 lambd=0.1280 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_anchor_constraint(8): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - spring_cost(31): 3.55096 (avg 0.11455)
<span class=" -Color -Color-Bold">INFO    </span> |      - gravity_cost(12): 14.19406 (avg 1.18284)
<span class=" -Color -Color-Bold">INFO    </span> |  step #11: cost=17.7450 lambd=0.2560 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_anchor_constraint(8): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - spring_cost(31): 3.55096 (avg 0.11455)
<span class=" -Color -Color-Bold">INFO    </span> |      - gravity_cost(12): 14.19406 (avg 1.18284)
<span class=" -Color -Color-Bold">INFO    </span> |  step #12: cost=17.7450 lambd=0.5120 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_anchor_constraint(8): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - spring_cost(31): 3.55096 (avg 0.11455)
<span class=" -Color -Color-Bold">INFO    </span> |      - gravity_cost(12): 14.19406 (avg 1.18284)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=3.02e+00 cost_prev=17.7450 cost_new=16.9790
<span class=" -Color -Color-Bold">INFO    </span> |  step #13: cost=16.9751 lambd=0.2560 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_anchor_constraint(8): 0.00390 (avg 0.00024)
<span class=" -Color -Color-Bold">INFO    </span> |      - spring_cost(31): 2.66078 (avg 0.08583)
<span class=" -Color -Color-Bold">INFO    </span> |      - gravity_cost(12): 14.31436 (avg 1.19286)
<span class=" -Color -Color-Bold">INFO    </span> |  step #14: cost=16.9751 lambd=0.5120 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_anchor_constraint(8): 0.00390 (avg 0.00024)
<span class=" -Color -Color-Bold">INFO    </span> |      - spring_cost(31): 2.66078 (avg 0.08583)
<span class=" -Color -Color-Bold">INFO    </span> |      - gravity_cost(12): 14.31436 (avg 1.19286)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=1.80e+00 cost_prev=16.9790 cost_new=16.5303
<span class=" -Color -Color-Bold">INFO    </span> |  step #15: cost=16.5258 lambd=0.2560 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_anchor_constraint(8): 0.00455 (avg 0.00028)
<span class=" -Color -Color-Bold">INFO    </span> |      - spring_cost(31): 2.14423 (avg 0.06917)
<span class=" -Color -Color-Bold">INFO    </span> |      - gravity_cost(12): 14.38154 (avg 1.19846)
<span class=" -Color -Color-Bold">INFO    </span> |  step #16: cost=16.5258 lambd=0.5120 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_anchor_constraint(8): 0.00455 (avg 0.00028)
<span class=" -Color -Color-Bold">INFO    </span> |      - spring_cost(31): 2.14423 (avg 0.06917)
<span class=" -Color -Color-Bold">INFO    </span> |      - gravity_cost(12): 14.38154 (avg 1.19846)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=8.48e-01 cost_prev=16.5303 cost_new=16.3810
<span class=" -Color -Color-Bold">INFO    </span> |  step #17: cost=16.3774 lambd=0.2560 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_anchor_constraint(8): 0.00368 (avg 0.00023)
<span class=" -Color -Color-Bold">INFO    </span> |      - spring_cost(31): 1.76783 (avg 0.05703)
<span class=" -Color -Color-Bold">INFO    </span> |      - gravity_cost(12): 14.60952 (avg 1.21746)
<span class=" -Color -Color-Bold">INFO    </span> |  step #18: cost=16.3774 lambd=0.5120 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_anchor_constraint(8): 0.00368 (avg 0.00023)
<span class=" -Color -Color-Bold">INFO    </span> |      - spring_cost(31): 1.76783 (avg 0.05703)
<span class=" -Color -Color-Bold">INFO    </span> |      - gravity_cost(12): 14.60952 (avg 1.21746)
<span class=" -Color -Color-Bold">INFO    </span> |  step #19: cost=16.3774 lambd=1.0240 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_anchor_constraint(8): 0.00368 (avg 0.00023)
<span class=" -Color -Color-Bold">INFO    </span> |      - spring_cost(31): 1.76783 (avg 0.05703)
<span class=" -Color -Color-Bold">INFO    </span> |      - gravity_cost(12): 14.60952 (avg 1.21746)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=8.15e-01 cost_prev=16.3810 cost_new=16.1719
<span class=" -Color -Color-Bold">INFO    </span> |  step #20: cost=16.1672 lambd=0.5120 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_anchor_constraint(8): 0.00474 (avg 0.00030)
<span class=" -Color -Color-Bold">INFO    </span> |      - spring_cost(31): 1.54577 (avg 0.04986)
<span class=" -Color -Color-Bold">INFO    </span> |      - gravity_cost(12): 14.62142 (avg 1.21845)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=2.05e-01 cost_prev=16.1719 cost_new=16.1493
<span class=" -Color -Color-Bold">INFO    </span> |  step #21: cost=16.1448 lambd=0.2560 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_anchor_constraint(8): 0.00449 (avg 0.00028)
<span class=" -Color -Color-Bold">INFO    </span> |      - spring_cost(31): 1.32984 (avg 0.04290)
<span class=" -Color -Color-Bold">INFO    </span> |      - gravity_cost(12): 14.81496 (avg 1.23458)
<span class=" -Color -Color-Bold">INFO    </span> |  step #22: cost=16.1448 lambd=0.5120 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_anchor_constraint(8): 0.00449 (avg 0.00028)
<span class=" -Color -Color-Bold">INFO    </span> |      - spring_cost(31): 1.32984 (avg 0.04290)
<span class=" -Color -Color-Bold">INFO    </span> |      - gravity_cost(12): 14.81496 (avg 1.23458)
<span class=" -Color -Color-Bold">INFO    </span> |  step #23: cost=16.1448 lambd=1.0240 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_anchor_constraint(8): 0.00449 (avg 0.00028)
<span class=" -Color -Color-Bold">INFO    </span> |      - spring_cost(31): 1.32984 (avg 0.04290)
<span class=" -Color -Color-Bold">INFO    </span> |      - gravity_cost(12): 14.81496 (avg 1.23458)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=9.54e-02 cost_prev=16.1493 cost_new=16.1445
<span class=" -Color -Color-Bold">INFO    </span> |  step #24: cost=16.1401 lambd=0.5120 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_anchor_constraint(8): 0.00445 (avg 0.00028)
<span class=" -Color -Color-Bold">INFO    </span> |      - spring_cost(31): 1.30091 (avg 0.04196)
<span class=" -Color -Color-Bold">INFO    </span> |      - gravity_cost(12): 14.83919 (avg 1.23660)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=3.27e-02 cost_prev=16.1445 cost_new=16.1439
<span class=" -Color -Color-Bold">INFO    </span> |  step #25: cost=16.1396 lambd=0.2560 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_anchor_constraint(8): 0.00430 (avg 0.00027)
<span class=" -Color -Color-Bold">INFO    </span> |      - spring_cost(31): 1.26332 (avg 0.04075)
<span class=" -Color -Color-Bold">INFO    </span> |      - gravity_cost(12): 14.87631 (avg 1.23969)
<span class=" -Color -Color-Bold">INFO    </span> |  step #26: cost=16.1396 lambd=0.5120 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_anchor_constraint(8): 0.00430 (avg 0.00027)
<span class=" -Color -Color-Bold">INFO    </span> |      - spring_cost(31): 1.26332 (avg 0.04075)
<span class=" -Color -Color-Bold">INFO    </span> |      - gravity_cost(12): 14.87631 (avg 1.23969)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=False ATb_norm=1.73e-02 cost_prev=16.1439 cost_new=16.1439
<span class=" -Color -Color-Bold">INFO    </span> |  AL update: snorm=1.3601e-03, csupn=1.3601e-03, max_rho=7.9380e+02
<span class=" -Color -Color-Bold">INFO    </span> |  step #27: cost=16.1396 lambd=0.5120 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_anchor_constraint(8): 0.02690 (avg 0.00168)
<span class=" -Color -Color-Bold">INFO    </span> |      - spring_cost(31): 1.26332 (avg 0.04075)
<span class=" -Color -Color-Bold">INFO    </span> |      - gravity_cost(12): 14.87631 (avg 1.23969)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=3.94e+00 cost_prev=16.1665 cost_new=16.1492
<span class=" -Color -Color-Bold">INFO    </span> |  step #28: cost=16.1482 lambd=0.2560 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_anchor_constraint(8): 0.00106 (avg 0.00007)
<span class=" -Color -Color-Bold">INFO    </span> |      - spring_cost(31): 1.27173 (avg 0.04102)
<span class=" -Color -Color-Bold">INFO    </span> |      - gravity_cost(12): 14.87643 (avg 1.23970)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=False ATb_norm=1.75e-02 cost_prev=16.1492 cost_new=16.1494
<span class=" -Color -Color-Bold">INFO    </span> |  AL update: snorm=4.5311e-06, csupn=4.5311e-06, max_rho=7.9380e+02
<span class=" -Color -Color-Bold">INFO    </span> | Terminated @ iteration #29: cost=16.1482 criteria=[1 0 0], term_deltas=8.6e-06,7.9e-03,7.0e-04
</pre></div>
</div>
</div>
</div>
</section>
<section id="visualization">
<h2>Visualization<a class="headerlink" href="#visualization" title="Link to this heading">¶</a></h2>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">plotly.graph_objects</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">go</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">plotly.subplots</span><span class="w"> </span><span class="kn">import</span> <span class="n">make_subplots</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">IPython.display</span><span class="w"> </span><span class="kn">import</span> <span class="n">HTML</span>


<span class="k">def</span><span class="w"> </span><span class="nf">get_traces</span><span class="p">(</span><span class="n">vals</span><span class="p">:</span> <span class="n">jaxls</span><span class="o">.</span><span class="n">VarValues</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get all Plotly traces for visualization.</span>

<span class="sd">    Args:</span>
<span class="sd">        vals: Variable values containing point positions</span>

<span class="sd">    Returns:</span>
<span class="sd">        List of Plotly Scatter traces for springs and points</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">positions</span> <span class="o">=</span> <span class="n">vals</span><span class="p">[</span><span class="n">all_point_vars</span><span class="p">]</span>
    <span class="n">traces</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># Spring lines.</span>
    <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="p">[(</span><span class="n">h_spring_a</span><span class="p">,</span> <span class="n">h_spring_b</span><span class="p">),</span> <span class="p">(</span><span class="n">v_spring_a</span><span class="p">,</span> <span class="n">v_spring_b</span><span class="p">)]:</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
            <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span> <span class="o">=</span> <span class="n">positions</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">positions</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
            <span class="n">traces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
                    <span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="n">p1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">p2</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
                    <span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="n">p1</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">p2</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span>
                    <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;lines&quot;</span><span class="p">,</span>
                    <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                    <span class="n">opacity</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
                    <span class="n">hoverinfo</span><span class="o">=</span><span class="s2">&quot;skip&quot;</span><span class="p">,</span>
                    <span class="n">showlegend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="p">)</span>

    <span class="c1"># Anchor points.</span>
    <span class="n">anchor_pos</span> <span class="o">=</span> <span class="n">positions</span><span class="p">[</span><span class="n">anchor_indices</span><span class="p">]</span>
    <span class="n">traces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
        <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
            <span class="n">x</span><span class="o">=</span><span class="n">anchor_pos</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="n">y</span><span class="o">=</span><span class="n">anchor_pos</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span>
            <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;markers&quot;</span><span class="p">,</span>
            <span class="n">marker</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;crimson&quot;</span><span class="p">),</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Anchors&quot;</span><span class="p">,</span>
            <span class="n">hovertemplate</span><span class="o">=</span><span class="s2">&quot;(%</span><span class="si">{x:.2f}</span><span class="s2">, %</span><span class="si">{y:.2f}</span><span class="s2">)&quot;</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="p">)</span>

    <span class="c1"># Free points.</span>
    <span class="n">free_pos</span> <span class="o">=</span> <span class="n">positions</span><span class="p">[</span><span class="n">interior_indices</span><span class="p">]</span>
    <span class="n">traces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
        <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
            <span class="n">x</span><span class="o">=</span><span class="n">free_pos</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="n">y</span><span class="o">=</span><span class="n">free_pos</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span>
            <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;markers&quot;</span><span class="p">,</span>
            <span class="n">marker</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;steelblue&quot;</span><span class="p">),</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Free points&quot;</span><span class="p">,</span>
            <span class="n">hovertemplate</span><span class="o">=</span><span class="s2">&quot;(%</span><span class="si">{x:.2f}</span><span class="s2">, %</span><span class="si">{y:.2f}</span><span class="s2">)&quot;</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">traces</span>


<span class="n">fig</span> <span class="o">=</span> <span class="n">make_subplots</span><span class="p">(</span><span class="n">rows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">subplot_titles</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;Initial&quot;</span><span class="p">,</span> <span class="s2">&quot;Optimized&quot;</span><span class="p">))</span>
<span class="k">for</span> <span class="n">trace</span> <span class="ow">in</span> <span class="n">get_traces</span><span class="p">(</span><span class="n">initial_vals</span><span class="p">):</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">trace</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="k">for</span> <span class="n">trace</span> <span class="ow">in</span> <span class="n">get_traces</span><span class="p">(</span><span class="n">solution</span><span class="p">):</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">trace</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span><span class="n">title_text</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">4.5</span><span class="p">],</span> <span class="n">scaleanchor</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">scaleratio</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="n">title_text</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">])</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">height</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span> <span class="n">showlegend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">margin</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">t</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">l</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="mi">40</span><span class="p">))</span>
<span class="n">HTML</span><span class="p">(</span><span class="n">fig</span><span class="o">.</span><span class="n">to_html</span><span class="p">(</span><span class="n">full_html</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">include_plotlyjs</span><span class="o">=</span><span class="s2">&quot;cdn&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><div>                        <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-3.3.0.min.js" integrity="sha256-bO3dS6yCpk9aK4gUpNELtCiDeSYvGYnK7jFI58NQnHI=" crossorigin="anonymous"></script>                <div id="6bab2e5e-9eea-4b77-aca8-4a650e8cc4cb" class="plotly-graph-div" style="height:400px; width:100%;"></div>            <script type="text/javascript">                window.PLOTLYENV=window.PLOTLYENV || {};                                if (document.getElementById("6bab2e5e-9eea-4b77-aca8-4a650e8cc4cb")) {                    Plotly.newPlot(                        "6bab2e5e-9eea-4b77-aca8-4a650e8cc4cb",                        [{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[0.0,1.0],"y":[0.0,0.0],"type":"scatter","xaxis":"x","yaxis":"y"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[1.0,2.0],"y":[0.0,0.0],"type":"scatter","xaxis":"x","yaxis":"y"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[2.0,3.0],"y":[0.0,0.0],"type":"scatter","xaxis":"x","yaxis":"y"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[3.0,4.0],"y":[0.0,0.0],"type":"scatter","xaxis":"x","yaxis":"y"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[0.0,1.0],"y":[-1.0,-1.0],"type":"scatter","xaxis":"x","yaxis":"y"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[1.0,2.0],"y":[-1.0,-1.0],"type":"scatter","xaxis":"x","yaxis":"y"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[2.0,3.0],"y":[-1.0,-1.0],"type":"scatter","xaxis":"x","yaxis":"y"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[3.0,4.0],"y":[-1.0,-1.0],"type":"scatter","xaxis":"x","yaxis":"y"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[0.0,1.0],"y":[-2.0,-2.0],"type":"scatter","xaxis":"x","yaxis":"y"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[1.0,2.0],"y":[-2.0,-2.0],"type":"scatter","xaxis":"x","yaxis":"y"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[2.0,3.0],"y":[-2.0,-2.0],"type":"scatter","xaxis":"x","yaxis":"y"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[3.0,4.0],"y":[-2.0,-2.0],"type":"scatter","xaxis":"x","yaxis":"y"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[0.0,1.0],"y":[-3.0,-3.0],"type":"scatter","xaxis":"x","yaxis":"y"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[1.0,2.0],"y":[-3.0,-3.0],"type":"scatter","xaxis":"x","yaxis":"y"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[2.0,3.0],"y":[-3.0,-3.0],"type":"scatter","xaxis":"x","yaxis":"y"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[3.0,4.0],"y":[-3.0,-3.0],"type":"scatter","xaxis":"x","yaxis":"y"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[0.0,0.0],"y":[0.0,-1.0],"type":"scatter","xaxis":"x","yaxis":"y"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[1.0,1.0],"y":[0.0,-1.0],"type":"scatter","xaxis":"x","yaxis":"y"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[2.0,2.0],"y":[0.0,-1.0],"type":"scatter","xaxis":"x","yaxis":"y"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[3.0,3.0],"y":[0.0,-1.0],"type":"scatter","xaxis":"x","yaxis":"y"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[4.0,4.0],"y":[0.0,-1.0],"type":"scatter","xaxis":"x","yaxis":"y"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[0.0,0.0],"y":[-1.0,-2.0],"type":"scatter","xaxis":"x","yaxis":"y"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[1.0,1.0],"y":[-1.0,-2.0],"type":"scatter","xaxis":"x","yaxis":"y"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[2.0,2.0],"y":[-1.0,-2.0],"type":"scatter","xaxis":"x","yaxis":"y"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[3.0,3.0],"y":[-1.0,-2.0],"type":"scatter","xaxis":"x","yaxis":"y"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[4.0,4.0],"y":[-1.0,-2.0],"type":"scatter","xaxis":"x","yaxis":"y"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[0.0,0.0],"y":[-2.0,-3.0],"type":"scatter","xaxis":"x","yaxis":"y"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[1.0,1.0],"y":[-2.0,-3.0],"type":"scatter","xaxis":"x","yaxis":"y"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[2.0,2.0],"y":[-2.0,-3.0],"type":"scatter","xaxis":"x","yaxis":"y"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[3.0,3.0],"y":[-2.0,-3.0],"type":"scatter","xaxis":"x","yaxis":"y"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[4.0,4.0],"y":[-2.0,-3.0],"type":"scatter","xaxis":"x","yaxis":"y"},{"hovertemplate":"(%{x:.2f}, %{y:.2f})","marker":{"color":"crimson","size":12},"mode":"markers","name":"Anchors","x":{"dtype":"f4","bdata":"AAAAAAAAgEAAAAAAAACAQAAAAAAAAIBAAAAAAAAAgEA="},"y":{"dtype":"f4","bdata":"AAAAAAAAAAAAAIC\u002fAACAvwAAAMAAAADAAABAwAAAQMA="},"type":"scatter","xaxis":"x","yaxis":"y"},{"hovertemplate":"(%{x:.2f}, %{y:.2f})","marker":{"color":"steelblue","size":10},"mode":"markers","name":"Free points","x":{"dtype":"f4","bdata":"AACAPwAAAEAAAEBAAACAPwAAAEAAAEBAAACAPwAAAEAAAEBAAACAPwAAAEAAAEBA"},"y":{"dtype":"f4","bdata":"AAAAAAAAAAAAAAAAAACAvwAAgL8AAIC\u002fAAAAwAAAAMAAAADAAABAwAAAQMAAAEDA"},"type":"scatter","xaxis":"x","yaxis":"y"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[6.207667979651887e-07,0.8500503897666931],"y":[4.531074864644324e-06,-1.045619249343872],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[0.8500503897666931,2.0],"y":[-1.045619249343872,-1.4933643341064453],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[2.0,3.149949550628662],"y":[-1.4933643341064453,-1.045619249343872],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[3.149949550628662,3.9999992847442627],"y":[-1.045619249343872,4.531105787464185e-06],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[2.5841924866654153e-07,0.8544419407844543],"y":[-0.9999974370002747,-2.0259692668914795],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[0.8544419407844543,2.0],"y":[-2.0259692668914795,-2.470848321914673],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[2.0,3.1455581188201904],"y":[-2.470848321914673,-2.0259692668914795],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[3.1455581188201904,3.999999761581421],"y":[-2.0259692668914795,-0.9999974370002747],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[6.787188056023297e-08,0.8592046499252319],"y":[-1.9999977350234985,-3.001931667327881],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[0.8592046499252319,2.0],"y":[-3.001931667327881,-3.4390735626220703],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[2.0,3.1407952308654785],"y":[-3.4390735626220703,-3.001931667327881],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[3.1407952308654785,4.0],"y":[-3.001931667327881,-1.9999977350234985],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[6.446146727512314e-08,0.8625942468643188],"y":[-2.9999961853027344,-3.9838004112243652],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[0.8625942468643188,2.0],"y":[-3.9838004112243652,-4.4133830070495605],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[2.0,3.1374058723449707],"y":[-4.4133830070495605,-3.9838006496429443],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[3.1374058723449707,4.0],"y":[-3.9838006496429443,-2.9999961853027344],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[6.207667979651887e-07,2.5841924866654153e-07],"y":[4.531074864644324e-06,-0.9999974370002747],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[0.8500503897666931,0.8544419407844543],"y":[-1.045619249343872,-2.0259692668914795],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[2.0,2.0],"y":[-1.4933643341064453,-2.470848321914673],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[3.149949550628662,3.1455581188201904],"y":[-1.045619249343872,-2.0259692668914795],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[3.9999992847442627,3.999999761581421],"y":[4.531105787464185e-06,-0.9999974370002747],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[2.5841924866654153e-07,6.787188056023297e-08],"y":[-0.9999974370002747,-1.9999977350234985],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[0.8544419407844543,0.8592046499252319],"y":[-2.0259692668914795,-3.001931667327881],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[2.0,2.0],"y":[-2.470848321914673,-3.4390735626220703],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[3.1455581188201904,3.1407952308654785],"y":[-2.0259692668914795,-3.001931667327881],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[3.999999761581421,4.0],"y":[-0.9999974370002747,-1.9999977350234985],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[6.787188056023297e-08,6.446146727512314e-08],"y":[-1.9999977350234985,-2.9999961853027344],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[0.8592046499252319,0.8625942468643188],"y":[-3.001931667327881,-3.9838004112243652],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[2.0,2.0],"y":[-3.4390735626220703,-4.4133830070495605],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[3.1407952308654785,3.1374058723449707],"y":[-3.001931667327881,-3.9838006496429443],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[4.0,4.0],"y":[-1.9999977350234985,-2.9999961853027344],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"hovertemplate":"(%{x:.2f}, %{y:.2f})","marker":{"color":"crimson","size":12},"mode":"markers","name":"Anchors","x":{"dtype":"f4","bdata":"xaImNf3\u002ff0DfvIo0\u002f\u002f9\u002fQPbAkTMAAIBAEW6KMwAAgEA="},"y":{"dtype":"f4","bdata":"owmYNucJmDbV\u002f3+\u002f1f9\u002fv+3\u002f\u002f7\u002ft\u002f\u002f+\u002f8P8\u002fwPD\u002fP8A="},"type":"scatter","xaxis":"x2","yaxis":"y2"},{"hovertemplate":"(%{x:.2f}, %{y:.2f})","marker":{"color":"steelblue","size":10},"mode":"markers","name":"Free points","x":{"dtype":"f4","bdata":"55xZPwAAAEDGmElAtbxaPwAAAEDTUElA1vRbPwAAAEDKAklA+tJcPwAAAEBCy0hA"},"y":{"dtype":"f4","bdata":"2taFv5Amv7\u002fa1oW\u002fe6kBwGEiHsB7qQHAph9AwMgZXMCmH0DAlvZ+wG86jcCX9n7A"},"type":"scatter","xaxis":"x2","yaxis":"y2"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermap":[{"type":"scattermap","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"anchor":"y","domain":[0.0,0.45],"title":{"text":"x"},"range":[-0.5,4.5],"scaleanchor":"y","scaleratio":1},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"y"},"range":[-5,0.5]},"xaxis2":{"anchor":"y2","domain":[0.55,1.0],"title":{"text":"x"},"range":[-0.5,4.5],"scaleanchor":"y","scaleratio":1},"yaxis2":{"anchor":"x2","domain":[0.0,1.0],"title":{"text":"y"},"range":[-5,0.5]},"annotations":[{"font":{"size":16},"showarrow":false,"text":"Initial","x":0.225,"xanchor":"center","xref":"paper","y":1.0,"yanchor":"bottom","yref":"paper"},{"font":{"size":16},"showarrow":false,"text":"Optimized","x":0.775,"xanchor":"center","xref":"paper","y":1.0,"yanchor":"bottom","yref":"paper"}],"margin":{"t":40,"b":40,"l":40,"r":40},"height":400,"showlegend":false},                        {"responsive": true}                    )                };            </script>        </div></div></div>
</div>
</section>
<section id="relaxation-animation">
<h2>Relaxation animation<a class="headerlink" href="#relaxation-animation" title="Link to this heading">¶</a></h2>
<p>We can visualize the relaxation process by solving a sequence of problems with progressively increasing gravity. This simulates how the network would settle from its initial configuration to the final equilibrium:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@jaxls</span><span class="o">.</span><span class="n">Cost</span><span class="o">.</span><span class="n">factory</span>
<span class="k">def</span><span class="w"> </span><span class="nf">gravity_cost_scaled</span><span class="p">(</span>
    <span class="n">vals</span><span class="p">:</span> <span class="n">jaxls</span><span class="o">.</span><span class="n">VarValues</span><span class="p">,</span>
    <span class="n">var</span><span class="p">:</span> <span class="n">Point2Var</span><span class="p">,</span>
    <span class="n">scale</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Pull points downward with adjustable strength.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">vals</span><span class="p">[</span><span class="n">var</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mf">10.0</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.15</span> <span class="o">*</span> <span class="n">scale</span>


<span class="c1"># Solve for a sequence of gravity strengths.</span>
<span class="n">n_frames</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">gravity_scales</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">n_frames</span><span class="p">)</span>
<span class="n">frame_solutions</span> <span class="o">=</span> <span class="p">[</span><span class="n">initial_vals</span><span class="p">]</span>

<span class="n">current_vals</span> <span class="o">=</span> <span class="n">initial_vals</span>
<span class="k">for</span> <span class="n">scale</span> <span class="ow">in</span> <span class="n">gravity_scales</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
    <span class="n">costs_scaled</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">jaxls</span><span class="o">.</span><span class="n">Cost</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">anchor_constraint</span><span class="p">(</span><span class="n">Point2Var</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">anchor_indices</span><span class="p">),</span> <span class="n">anchor_positions</span><span class="p">),</span>
        <span class="n">spring_cost</span><span class="p">(</span><span class="n">Point2Var</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">h_spring_a</span><span class="p">),</span> <span class="n">Point2Var</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">h_spring_b</span><span class="p">),</span> <span class="n">spacing</span><span class="p">),</span>
        <span class="n">spring_cost</span><span class="p">(</span><span class="n">Point2Var</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">v_spring_a</span><span class="p">),</span> <span class="n">Point2Var</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">v_spring_b</span><span class="p">),</span> <span class="n">spacing</span><span class="p">),</span>
        <span class="n">gravity_cost_scaled</span><span class="p">(</span><span class="n">Point2Var</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">interior_indices</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="n">scale</span><span class="p">)),</span>
    <span class="p">]</span>
    <span class="n">problem_scaled</span> <span class="o">=</span> <span class="n">jaxls</span><span class="o">.</span><span class="n">LeastSquaresProblem</span><span class="p">(</span><span class="n">costs_scaled</span><span class="p">,</span> <span class="p">[</span><span class="n">all_point_vars</span><span class="p">])</span><span class="o">.</span><span class="n">analyze</span><span class="p">()</span>
    <span class="n">current_vals</span> <span class="o">=</span> <span class="n">problem_scaled</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">current_vals</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">frame_solutions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">current_vals</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Generated </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">frame_solutions</span><span class="p">)</span><span class="si">}</span><span class="s2"> frames&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Bold">INFO    </span> | Building optimization problem with 51 terms and 20 variables: 43 costs, 8 eq_zero, 0 leq_zero, 0 geq_zero
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 12 costs, 1 variables each: gravity_cost_scaled
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 31 costs, 2 variables each: spring_cost
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing constraint group with 8 constraints (constraint_eq_zero), 1 variables each: augmented_anchor_constraint
<span class=" -Color -Color-Bold">INFO    </span> | Building optimization problem with 51 terms and 20 variables: 43 costs, 8 eq_zero, 0 leq_zero, 0 geq_zero
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing constraint group with 8 constraints (constraint_eq_zero), 1 variables each: augmented_anchor_constraint
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 31 costs, 2 variables each: spring_cost
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 12 costs, 1 variables each: gravity_cost_scaled
<span class=" -Color -Color-Bold">INFO    </span> | Building optimization problem with 51 terms and 20 variables: 43 costs, 8 eq_zero, 0 leq_zero, 0 geq_zero
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing constraint group with 8 constraints (constraint_eq_zero), 1 variables each: augmented_anchor_constraint
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 12 costs, 1 variables each: gravity_cost_scaled
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 31 costs, 2 variables each: spring_cost
<span class=" -Color -Color-Bold">INFO    </span> | Building optimization problem with 51 terms and 20 variables: 43 costs, 8 eq_zero, 0 leq_zero, 0 geq_zero
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing constraint group with 8 constraints (constraint_eq_zero), 1 variables each: augmented_anchor_constraint
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 31 costs, 2 variables each: spring_cost
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 12 costs, 1 variables each: gravity_cost_scaled
<span class=" -Color -Color-Bold">INFO    </span> | Building optimization problem with 51 terms and 20 variables: 43 costs, 8 eq_zero, 0 leq_zero, 0 geq_zero
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing constraint group with 8 constraints (constraint_eq_zero), 1 variables each: augmented_anchor_constraint
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 31 costs, 2 variables each: spring_cost
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 12 costs, 1 variables each: gravity_cost_scaled
<span class=" -Color -Color-Bold">INFO    </span> | Building optimization problem with 51 terms and 20 variables: 43 costs, 8 eq_zero, 0 leq_zero, 0 geq_zero
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 12 costs, 1 variables each: gravity_cost_scaled
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing constraint group with 8 constraints (constraint_eq_zero), 1 variables each: augmented_anchor_constraint
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 31 costs, 2 variables each: spring_cost
<span class=" -Color -Color-Bold">INFO    </span> | Building optimization problem with 51 terms and 20 variables: 43 costs, 8 eq_zero, 0 leq_zero, 0 geq_zero
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing constraint group with 8 constraints (constraint_eq_zero), 1 variables each: augmented_anchor_constraint
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 12 costs, 1 variables each: gravity_cost_scaled
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 31 costs, 2 variables each: spring_cost
<span class=" -Color -Color-Bold">INFO    </span> | Building optimization problem with 51 terms and 20 variables: 43 costs, 8 eq_zero, 0 leq_zero, 0 geq_zero
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing constraint group with 8 constraints (constraint_eq_zero), 1 variables each: augmented_anchor_constraint
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 12 costs, 1 variables each: gravity_cost_scaled
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 31 costs, 2 variables each: spring_cost
<span class=" -Color -Color-Bold">INFO    </span> | Building optimization problem with 51 terms and 20 variables: 43 costs, 8 eq_zero, 0 leq_zero, 0 geq_zero
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 12 costs, 1 variables each: gravity_cost_scaled
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 31 costs, 2 variables each: spring_cost
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing constraint group with 8 constraints (constraint_eq_zero), 1 variables each: augmented_anchor_constraint
<span class=" -Color -Color-Bold">INFO    </span> | Building optimization problem with 51 terms and 20 variables: 43 costs, 8 eq_zero, 0 leq_zero, 0 geq_zero
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 12 costs, 1 variables each: gravity_cost_scaled
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 31 costs, 2 variables each: spring_cost
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing constraint group with 8 constraints (constraint_eq_zero), 1 variables each: augmented_anchor_constraint
<span class=" -Color -Color-Bold">INFO    </span> | Building optimization problem with 51 terms and 20 variables: 43 costs, 8 eq_zero, 0 leq_zero, 0 geq_zero
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 12 costs, 1 variables each: gravity_cost_scaled
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing constraint group with 8 constraints (constraint_eq_zero), 1 variables each: augmented_anchor_constraint
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 31 costs, 2 variables each: spring_cost
<span class=" -Color -Color-Bold">INFO    </span> | Building optimization problem with 51 terms and 20 variables: 43 costs, 8 eq_zero, 0 leq_zero, 0 geq_zero
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 31 costs, 2 variables each: spring_cost
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing constraint group with 8 constraints (constraint_eq_zero), 1 variables each: augmented_anchor_constraint
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 12 costs, 1 variables each: gravity_cost_scaled
<span class=" -Color -Color-Bold">INFO    </span> | Building optimization problem with 51 terms and 20 variables: 43 costs, 8 eq_zero, 0 leq_zero, 0 geq_zero
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 12 costs, 1 variables each: gravity_cost_scaled
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 31 costs, 2 variables each: spring_cost
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing constraint group with 8 constraints (constraint_eq_zero), 1 variables each: augmented_anchor_constraint
<span class=" -Color -Color-Bold">INFO    </span> | Building optimization problem with 51 terms and 20 variables: 43 costs, 8 eq_zero, 0 leq_zero, 0 geq_zero
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 12 costs, 1 variables each: gravity_cost_scaled
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing constraint group with 8 constraints (constraint_eq_zero), 1 variables each: augmented_anchor_constraint
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 31 costs, 2 variables each: spring_cost
<span class=" -Color -Color-Bold">INFO    </span> | Building optimization problem with 51 terms and 20 variables: 43 costs, 8 eq_zero, 0 leq_zero, 0 geq_zero
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing constraint group with 8 constraints (constraint_eq_zero), 1 variables each: augmented_anchor_constraint
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 12 costs, 1 variables each: gravity_cost_scaled
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 31 costs, 2 variables each: spring_cost
<span class=" -Color -Color-Bold">INFO    </span> | Building optimization problem with 51 terms and 20 variables: 43 costs, 8 eq_zero, 0 leq_zero, 0 geq_zero
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 12 costs, 1 variables each: gravity_cost_scaled
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 31 costs, 2 variables each: spring_cost
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing constraint group with 8 constraints (constraint_eq_zero), 1 variables each: augmented_anchor_constraint
<span class=" -Color -Color-Bold">INFO    </span> | Building optimization problem with 51 terms and 20 variables: 43 costs, 8 eq_zero, 0 leq_zero, 0 geq_zero
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 12 costs, 1 variables each: gravity_cost_scaled
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing constraint group with 8 constraints (constraint_eq_zero), 1 variables each: augmented_anchor_constraint
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 31 costs, 2 variables each: spring_cost
<span class=" -Color -Color-Bold">INFO    </span> | Building optimization problem with 51 terms and 20 variables: 43 costs, 8 eq_zero, 0 leq_zero, 0 geq_zero
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 12 costs, 1 variables each: gravity_cost_scaled
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 31 costs, 2 variables each: spring_cost
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing constraint group with 8 constraints (constraint_eq_zero), 1 variables each: augmented_anchor_constraint
<span class=" -Color -Color-Bold">INFO    </span> | Building optimization problem with 51 terms and 20 variables: 43 costs, 8 eq_zero, 0 leq_zero, 0 geq_zero
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 12 costs, 1 variables each: gravity_cost_scaled
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing constraint group with 8 constraints (constraint_eq_zero), 1 variables each: augmented_anchor_constraint
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 31 costs, 2 variables each: spring_cost
Generated 20 frames
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">get_frame_data</span><span class="p">(</span><span class="n">vals</span><span class="p">:</span> <span class="n">jaxls</span><span class="o">.</span><span class="n">VarValues</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Extract position data for animation frame.&quot;&quot;&quot;</span>
    <span class="n">positions</span> <span class="o">=</span> <span class="n">vals</span><span class="p">[</span><span class="n">all_point_vars</span><span class="p">]</span>

    <span class="c1"># Build spring line coordinates.</span>
    <span class="n">spring_x</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">spring_y</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="p">[(</span><span class="n">h_spring_a</span><span class="p">,</span> <span class="n">h_spring_b</span><span class="p">),</span> <span class="p">(</span><span class="n">v_spring_a</span><span class="p">,</span> <span class="n">v_spring_b</span><span class="p">)]:</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
            <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span> <span class="o">=</span> <span class="n">positions</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">positions</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
            <span class="n">spring_x</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">p1</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">p2</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="kc">None</span><span class="p">])</span>
            <span class="n">spring_y</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">p1</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">p2</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="kc">None</span><span class="p">])</span>

    <span class="n">anchor_pos</span> <span class="o">=</span> <span class="n">positions</span><span class="p">[</span><span class="n">anchor_indices</span><span class="p">]</span>
    <span class="n">free_pos</span> <span class="o">=</span> <span class="n">positions</span><span class="p">[</span><span class="n">interior_indices</span><span class="p">]</span>

    <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span>
        <span class="n">spring_x</span><span class="o">=</span><span class="n">spring_x</span><span class="p">,</span>
        <span class="n">spring_y</span><span class="o">=</span><span class="n">spring_y</span><span class="p">,</span>
        <span class="n">anchor_x</span><span class="o">=</span><span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">anchor_pos</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]],</span>
        <span class="n">anchor_y</span><span class="o">=</span><span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">anchor_pos</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]],</span>
        <span class="n">free_x</span><span class="o">=</span><span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">free_pos</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]],</span>
        <span class="n">free_y</span><span class="o">=</span><span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">free_pos</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]],</span>
    <span class="p">)</span>


<span class="c1"># Build animation frames.</span>
<span class="n">frames</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">vals</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">frame_solutions</span><span class="p">):</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">get_frame_data</span><span class="p">(</span><span class="n">vals</span><span class="p">)</span>
    <span class="n">frames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
        <span class="n">go</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span>
            <span class="n">data</span><span class="o">=</span><span class="p">[</span>
                <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
                    <span class="n">x</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;spring_x&quot;</span><span class="p">],</span>
                    <span class="n">y</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;spring_y&quot;</span><span class="p">],</span>
                    <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;lines&quot;</span><span class="p">,</span>
                    <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span>
                    <span class="n">hoverinfo</span><span class="o">=</span><span class="s2">&quot;skip&quot;</span><span class="p">,</span>
                <span class="p">),</span>
                <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
                    <span class="n">x</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;anchor_x&quot;</span><span class="p">],</span>
                    <span class="n">y</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;anchor_y&quot;</span><span class="p">],</span>
                    <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;markers&quot;</span><span class="p">,</span>
                    <span class="n">marker</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;crimson&quot;</span><span class="p">),</span>
                <span class="p">),</span>
                <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
                    <span class="n">x</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;free_x&quot;</span><span class="p">],</span>
                    <span class="n">y</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;free_y&quot;</span><span class="p">],</span>
                    <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;markers&quot;</span><span class="p">,</span>
                    <span class="n">marker</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;steelblue&quot;</span><span class="p">),</span>
                <span class="p">),</span>
            <span class="p">],</span>
            <span class="n">name</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">),</span>
        <span class="p">)</span>
    <span class="p">)</span>

<span class="c1"># Initial frame data.</span>
<span class="n">init_data</span> <span class="o">=</span> <span class="n">get_frame_data</span><span class="p">(</span><span class="n">initial_vals</span><span class="p">)</span>

<span class="n">fig_anim</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="p">[</span>
        <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
            <span class="n">x</span><span class="o">=</span><span class="n">init_data</span><span class="p">[</span><span class="s2">&quot;spring_x&quot;</span><span class="p">],</span>
            <span class="n">y</span><span class="o">=</span><span class="n">init_data</span><span class="p">[</span><span class="s2">&quot;spring_y&quot;</span><span class="p">],</span>
            <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;lines&quot;</span><span class="p">,</span>
            <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span>
            <span class="n">hoverinfo</span><span class="o">=</span><span class="s2">&quot;skip&quot;</span><span class="p">,</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Springs&quot;</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
            <span class="n">x</span><span class="o">=</span><span class="n">init_data</span><span class="p">[</span><span class="s2">&quot;anchor_x&quot;</span><span class="p">],</span>
            <span class="n">y</span><span class="o">=</span><span class="n">init_data</span><span class="p">[</span><span class="s2">&quot;anchor_y&quot;</span><span class="p">],</span>
            <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;markers&quot;</span><span class="p">,</span>
            <span class="n">marker</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;crimson&quot;</span><span class="p">),</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Anchors&quot;</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
            <span class="n">x</span><span class="o">=</span><span class="n">init_data</span><span class="p">[</span><span class="s2">&quot;free_x&quot;</span><span class="p">],</span>
            <span class="n">y</span><span class="o">=</span><span class="n">init_data</span><span class="p">[</span><span class="s2">&quot;free_y&quot;</span><span class="p">],</span>
            <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;markers&quot;</span><span class="p">,</span>
            <span class="n">marker</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;steelblue&quot;</span><span class="p">),</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Free points&quot;</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">],</span>
    <span class="n">frames</span><span class="o">=</span><span class="n">frames</span><span class="p">,</span>
    <span class="n">layout</span><span class="o">=</span><span class="n">go</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span>
        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Spring network relaxation&quot;</span><span class="p">,</span>
        <span class="n">xaxis</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="nb">range</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">4.5</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">scaleanchor</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">scaleratio</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
        <span class="n">yaxis</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="nb">range</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">),</span>
        <span class="n">updatemenus</span><span class="o">=</span><span class="p">[</span>
            <span class="nb">dict</span><span class="p">(</span>
                <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;buttons&quot;</span><span class="p">,</span>
                <span class="n">showactive</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">y</span><span class="o">=</span><span class="mf">1.15</span><span class="p">,</span>
                <span class="n">x</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
                <span class="n">xanchor</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
                <span class="n">buttons</span><span class="o">=</span><span class="p">[</span>
                    <span class="nb">dict</span><span class="p">(</span>
                        <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Play&quot;</span><span class="p">,</span>
                        <span class="n">method</span><span class="o">=</span><span class="s2">&quot;animate&quot;</span><span class="p">,</span>
                        <span class="n">args</span><span class="o">=</span><span class="p">[</span>
                            <span class="kc">None</span><span class="p">,</span>
                            <span class="nb">dict</span><span class="p">(</span>
                                <span class="n">frame</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">redraw</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
                                <span class="n">fromcurrent</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                <span class="n">transition</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="mi">50</span><span class="p">),</span>
                            <span class="p">),</span>
                        <span class="p">],</span>
                    <span class="p">),</span>
                    <span class="nb">dict</span><span class="p">(</span>
                        <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Pause&quot;</span><span class="p">,</span>
                        <span class="n">method</span><span class="o">=</span><span class="s2">&quot;animate&quot;</span><span class="p">,</span>
                        <span class="n">args</span><span class="o">=</span><span class="p">[</span>
                            <span class="p">[</span><span class="kc">None</span><span class="p">],</span>
                            <span class="nb">dict</span><span class="p">(</span>
                                <span class="n">frame</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">redraw</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;immediate&quot;</span>
                            <span class="p">),</span>
                        <span class="p">],</span>
                    <span class="p">),</span>
                <span class="p">],</span>
            <span class="p">)</span>
        <span class="p">],</span>
        <span class="n">sliders</span><span class="o">=</span><span class="p">[</span>
            <span class="nb">dict</span><span class="p">(</span>
                <span class="n">active</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                <span class="n">yanchor</span><span class="o">=</span><span class="s2">&quot;top&quot;</span><span class="p">,</span>
                <span class="n">xanchor</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span>
                <span class="n">currentvalue</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                    <span class="n">prefix</span><span class="o">=</span><span class="s2">&quot;Gravity: &quot;</span><span class="p">,</span> <span class="n">suffix</span><span class="o">=</span><span class="s2">&quot;%&quot;</span><span class="p">,</span> <span class="n">visible</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">xanchor</span><span class="o">=</span><span class="s2">&quot;center&quot;</span>
                <span class="p">),</span>
                <span class="n">pad</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">b</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="mi">50</span><span class="p">),</span>
                <span class="n">steps</span><span class="o">=</span><span class="p">[</span>
                    <span class="nb">dict</span><span class="p">(</span>
                        <span class="n">args</span><span class="o">=</span><span class="p">[</span>
                            <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)],</span>
                            <span class="nb">dict</span><span class="p">(</span>
                                <span class="n">frame</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">redraw</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
                                <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;immediate&quot;</span><span class="p">,</span>
                                <span class="n">transition</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
                            <span class="p">),</span>
                        <span class="p">],</span>
                        <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">gravity_scales</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">100</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                        <span class="n">method</span><span class="o">=</span><span class="s2">&quot;animate&quot;</span><span class="p">,</span>
                    <span class="p">)</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_frames</span><span class="p">)</span>
                <span class="p">],</span>
                <span class="n">x</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
                <span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                <span class="nb">len</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">],</span>
        <span class="n">height</span><span class="o">=</span><span class="mi">450</span><span class="p">,</span>
        <span class="n">showlegend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">margin</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">t</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">80</span><span class="p">),</span>
    <span class="p">),</span>
<span class="p">)</span>
<span class="n">HTML</span><span class="p">(</span><span class="n">fig_anim</span><span class="o">.</span><span class="n">to_html</span><span class="p">(</span><span class="n">full_html</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">include_plotlyjs</span><span class="o">=</span><span class="s2">&quot;cdn&quot;</span><span class="p">,</span> <span class="n">auto_play</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><div>                        <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-3.3.0.min.js" integrity="sha256-bO3dS6yCpk9aK4gUpNELtCiDeSYvGYnK7jFI58NQnHI=" crossorigin="anonymous"></script>                <div id="87712f4c-3408-4fe3-89bd-29aebbb0e616" class="plotly-graph-div" style="height:450px; width:100%;"></div>            <script type="text/javascript">                window.PLOTLYENV=window.PLOTLYENV || {};                                if (document.getElementById("87712f4c-3408-4fe3-89bd-29aebbb0e616")) {                    Plotly.newPlot(                        "87712f4c-3408-4fe3-89bd-29aebbb0e616",                        [{"hoverinfo":"skip","line":{"color":"gray","width":2},"mode":"lines","name":"Springs","x":[0.0,1.0,null,1.0,2.0,null,2.0,3.0,null,3.0,4.0,null,0.0,1.0,null,1.0,2.0,null,2.0,3.0,null,3.0,4.0,null,0.0,1.0,null,1.0,2.0,null,2.0,3.0,null,3.0,4.0,null,0.0,1.0,null,1.0,2.0,null,2.0,3.0,null,3.0,4.0,null,0.0,0.0,null,1.0,1.0,null,2.0,2.0,null,3.0,3.0,null,4.0,4.0,null,0.0,0.0,null,1.0,1.0,null,2.0,2.0,null,3.0,3.0,null,4.0,4.0,null,0.0,0.0,null,1.0,1.0,null,2.0,2.0,null,3.0,3.0,null,4.0,4.0,null],"y":[0.0,0.0,null,0.0,0.0,null,0.0,0.0,null,0.0,0.0,null,-1.0,-1.0,null,-1.0,-1.0,null,-1.0,-1.0,null,-1.0,-1.0,null,-2.0,-2.0,null,-2.0,-2.0,null,-2.0,-2.0,null,-2.0,-2.0,null,-3.0,-3.0,null,-3.0,-3.0,null,-3.0,-3.0,null,-3.0,-3.0,null,0.0,-1.0,null,0.0,-1.0,null,0.0,-1.0,null,0.0,-1.0,null,0.0,-1.0,null,-1.0,-2.0,null,-1.0,-2.0,null,-1.0,-2.0,null,-1.0,-2.0,null,-1.0,-2.0,null,-2.0,-3.0,null,-2.0,-3.0,null,-2.0,-3.0,null,-2.0,-3.0,null,-2.0,-3.0,null],"type":"scatter"},{"marker":{"color":"crimson","size":12},"mode":"markers","name":"Anchors","x":[0.0,4.0,0.0,4.0,0.0,4.0,0.0,4.0],"y":[0.0,0.0,-1.0,-1.0,-2.0,-2.0,-3.0,-3.0],"type":"scatter"},{"marker":{"color":"steelblue","size":10},"mode":"markers","name":"Free points","x":[1.0,2.0,3.0,1.0,2.0,3.0,1.0,2.0,3.0,1.0,2.0,3.0],"y":[0.0,0.0,0.0,-1.0,-1.0,-1.0,-2.0,-2.0,-2.0,-3.0,-3.0,-3.0],"type":"scatter"}],                        {"height":450,"margin":{"b":80,"t":80},"showlegend":false,"sliders":[{"active":0,"currentvalue":{"prefix":"Gravity: ","suffix":"%","visible":true,"xanchor":"center"},"len":0.8,"pad":{"b":10,"t":50},"steps":[{"args":[["0"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"0","method":"animate"},{"args":[["1"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"5","method":"animate"},{"args":[["2"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"10","method":"animate"},{"args":[["3"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"15","method":"animate"},{"args":[["4"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"21","method":"animate"},{"args":[["5"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"26","method":"animate"},{"args":[["6"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"31","method":"animate"},{"args":[["7"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"36","method":"animate"},{"args":[["8"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"42","method":"animate"},{"args":[["9"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"47","method":"animate"},{"args":[["10"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"52","method":"animate"},{"args":[["11"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"57","method":"animate"},{"args":[["12"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"63","method":"animate"},{"args":[["13"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"68","method":"animate"},{"args":[["14"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"73","method":"animate"},{"args":[["15"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"78","method":"animate"},{"args":[["16"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"84","method":"animate"},{"args":[["17"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"89","method":"animate"},{"args":[["18"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"94","method":"animate"},{"args":[["19"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"100","method":"animate"}],"x":0.1,"xanchor":"left","y":0,"yanchor":"top"}],"title":{"text":"Spring network relaxation"},"updatemenus":[{"buttons":[{"args":[null,{"frame":{"duration":100,"redraw":true},"fromcurrent":true,"transition":{"duration":50}}],"label":"Play","method":"animate"},{"args":[[null],{"frame":{"duration":0,"redraw":false},"mode":"immediate"}],"label":"Pause","method":"animate"}],"showactive":false,"type":"buttons","x":0.5,"xanchor":"center","y":1.15}],"xaxis":{"range":[-0.5,4.5],"scaleanchor":"y","scaleratio":1,"title":{"text":"x"}},"yaxis":{"range":[-5,0.5],"title":{"text":"y"}},"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermap":[{"type":"scattermap","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}}},                        {"responsive": true}                    ).then(function(){
                            Plotly.addFrames('87712f4c-3408-4fe3-89bd-29aebbb0e616', [{"data":[{"hoverinfo":"skip","line":{"color":"gray","width":2},"mode":"lines","x":[0.0,1.0,null,1.0,2.0,null,2.0,3.0,null,3.0,4.0,null,0.0,1.0,null,1.0,2.0,null,2.0,3.0,null,3.0,4.0,null,0.0,1.0,null,1.0,2.0,null,2.0,3.0,null,3.0,4.0,null,0.0,1.0,null,1.0,2.0,null,2.0,3.0,null,3.0,4.0,null,0.0,0.0,null,1.0,1.0,null,2.0,2.0,null,3.0,3.0,null,4.0,4.0,null,0.0,0.0,null,1.0,1.0,null,2.0,2.0,null,3.0,3.0,null,4.0,4.0,null,0.0,0.0,null,1.0,1.0,null,2.0,2.0,null,3.0,3.0,null,4.0,4.0,null],"y":[0.0,0.0,null,0.0,0.0,null,0.0,0.0,null,0.0,0.0,null,-1.0,-1.0,null,-1.0,-1.0,null,-1.0,-1.0,null,-1.0,-1.0,null,-2.0,-2.0,null,-2.0,-2.0,null,-2.0,-2.0,null,-2.0,-2.0,null,-3.0,-3.0,null,-3.0,-3.0,null,-3.0,-3.0,null,-3.0,-3.0,null,0.0,-1.0,null,0.0,-1.0,null,0.0,-1.0,null,0.0,-1.0,null,0.0,-1.0,null,-1.0,-2.0,null,-1.0,-2.0,null,-1.0,-2.0,null,-1.0,-2.0,null,-1.0,-2.0,null,-2.0,-3.0,null,-2.0,-3.0,null,-2.0,-3.0,null,-2.0,-3.0,null,-2.0,-3.0,null],"type":"scatter"},{"marker":{"color":"crimson","size":12},"mode":"markers","x":[0.0,4.0,0.0,4.0,0.0,4.0,0.0,4.0],"y":[0.0,0.0,-1.0,-1.0,-2.0,-2.0,-3.0,-3.0],"type":"scatter"},{"marker":{"color":"steelblue","size":10},"mode":"markers","x":[1.0,2.0,3.0,1.0,2.0,3.0,1.0,2.0,3.0,1.0,2.0,3.0],"y":[0.0,0.0,0.0,-1.0,-1.0,-1.0,-2.0,-2.0,-2.0,-3.0,-3.0,-3.0],"type":"scatter"}],"name":"0"},{"data":[{"hoverinfo":"skip","line":{"color":"gray","width":2},"mode":"lines","x":[1.1160886104200074e-10,0.9951475858688354,null,0.9951475858688354,2.0,null,2.0,3.004852294921875,null,3.004852294921875,4.0,null,1.1203332705989055e-10,0.9951546788215637,null,0.9951546788215637,1.9999998807907104,null,1.9999998807907104,3.004845142364502,null,3.004845142364502,4.0,null,1.1144258432738141e-10,0.9951634407043457,null,0.9951634407043457,2.0,null,2.0,3.004836320877075,null,3.004836320877075,4.0,null,1.147336878282168e-10,0.9951696395874023,null,0.9951696395874023,2.0,null,2.0,3.0048303604125977,null,3.0048303604125977,4.0,null,1.1160886104200074e-10,1.1203332705989055e-10,null,0.9951475858688354,0.9951546788215637,null,2.0,1.9999998807907104,null,3.004852294921875,3.004845142364502,null,4.0,4.0,null,1.1203332705989055e-10,1.1144258432738141e-10,null,0.9951546788215637,0.9951634407043457,null,1.9999998807907104,2.0,null,3.004845142364502,3.004836320877075,null,4.0,4.0,null,1.1144258432738141e-10,1.147336878282168e-10,null,0.9951634407043457,0.9951696395874023,null,2.0,2.0,null,3.004836320877075,3.0048303604125977,null,4.0,4.0,null],"y":[4.21468276945447e-11,-0.14465686678886414,null,-0.14465686678886414,-0.18480482697486877,null,-0.18480482697486877,-0.14465686678886414,null,-0.14465686678886414,4.216122936884226e-11,null,-1.0,-1.1445614099502563,null,-1.1445614099502563,-1.1847175359725952,null,-1.1847175359725952,-1.1445612907409668,null,-1.1445612907409668,-1.0,null,-2.0,-2.1444387435913086,null,-2.1444387435913086,-2.18459415435791,null,-2.18459415435791,-2.1444387435913086,null,-2.1444387435913086,-2.0,null,-3.0,-3.1443498134613037,null,-3.1443498134613037,-3.1844961643218994,null,-3.1844961643218994,-3.1443498134613037,null,-3.1443498134613037,-3.0,null,4.21468276945447e-11,-1.0,null,-0.14465686678886414,-1.1445614099502563,null,-0.18480482697486877,-1.1847175359725952,null,-0.14465686678886414,-1.1445612907409668,null,4.216122936884226e-11,-1.0,null,-1.0,-2.0,null,-1.1445614099502563,-2.1444387435913086,null,-1.1847175359725952,-2.18459415435791,null,-1.1445612907409668,-2.1444387435913086,null,-1.0,-2.0,null,-2.0,-3.0,null,-2.1444387435913086,-3.1443498134613037,null,-2.18459415435791,-3.1844961643218994,null,-2.1444387435913086,-3.1443498134613037,null,-2.0,-3.0,null],"type":"scatter"},{"marker":{"color":"crimson","size":12},"mode":"markers","x":[1.1160886104200074e-10,4.0,1.1203332705989055e-10,4.0,1.1144258432738141e-10,4.0,1.147336878282168e-10,4.0],"y":[4.21468276945447e-11,4.216122936884226e-11,-1.0,-1.0,-2.0,-2.0,-3.0,-3.0],"type":"scatter"},{"marker":{"color":"steelblue","size":10},"mode":"markers","x":[0.9951475858688354,2.0,3.004852294921875,0.9951546788215637,1.9999998807907104,3.004845142364502,0.9951634407043457,2.0,3.004836320877075,0.9951696395874023,2.0,3.0048303604125977],"y":[-0.14465686678886414,-0.18480482697486877,-0.14465686678886414,-1.1445614099502563,-1.1847175359725952,-1.1445612907409668,-2.1444387435913086,-2.18459415435791,-2.1444387435913086,-3.1443498134613037,-3.1844961643218994,-3.1443498134613037],"type":"scatter"}],"name":"1"},{"data":[{"hoverinfo":"skip","line":{"color":"gray","width":2},"mode":"lines","x":[-7.677186658838764e-06,0.9883914589881897,null,0.9883914589881897,1.9999998807907104,null,1.9999998807907104,3.011608362197876,null,3.011608362197876,4.000007629394531,null,-7.688651749049313e-06,0.988431990146637,null,0.988431990146637,1.9999998807907104,null,1.9999998807907104,3.011568069458008,null,3.011568069458008,4.000007629394531,null,-7.668499165447429e-06,0.9884850978851318,null,0.9884850978851318,2.000000238418579,null,2.000000238418579,3.0115151405334473,null,3.0115151405334473,4.000007629394531,null,-7.642302989552263e-06,0.9885225892066956,null,0.9885225892066956,2.000000238418579,null,2.000000238418579,3.0114779472351074,null,3.0114779472351074,4.000007629394531,null,-7.677186658838764e-06,-7.688651749049313e-06,null,0.9883914589881897,0.988431990146637,null,1.9999998807907104,1.9999998807907104,null,3.011608362197876,3.011568069458008,null,4.000007629394531,4.000007629394531,null,-7.688651749049313e-06,-7.668499165447429e-06,null,0.988431990146637,0.9884850978851318,null,1.9999998807907104,2.000000238418579,null,3.011568069458008,3.0115151405334473,null,4.000007629394531,4.000007629394531,null,-7.668499165447429e-06,-7.642302989552263e-06,null,0.9884850978851318,0.9885225892066956,null,2.000000238418579,2.000000238418579,null,3.0115151405334473,3.0114779472351074,null,4.000007629394531,4.000007629394531,null],"y":[2.5876045128825353e-06,-0.22752434015274048,null,-0.22752434015274048,-0.2971022427082062,null,-0.2971022427082062,-0.2275247871875763,null,-0.2275247871875763,2.564326450738008e-06,null,-0.9999974966049194,-1.2271651029586792,null,-1.2271651029586792,-1.2967512607574463,null,-1.2967512607574463,-1.2271655797958374,null,-1.2271655797958374,-0.9999974966049194,null,-1.9999974966049194,-2.2266902923583984,null,-2.2266902923583984,-2.296268939971924,null,-2.296268939971924,-2.2266910076141357,null,-2.2266910076141357,-1.9999974966049194,null,-2.99999737739563,-3.2263364791870117,null,-3.2263364791870117,-3.2958943843841553,null,-3.2958943843841553,-3.226337432861328,null,-3.226337432861328,-2.99999737739563,null,2.5876045128825353e-06,-0.9999974966049194,null,-0.22752434015274048,-1.2271651029586792,null,-0.2971022427082062,-1.2967512607574463,null,-0.2275247871875763,-1.2271655797958374,null,2.564326450738008e-06,-0.9999974966049194,null,-0.9999974966049194,-1.9999974966049194,null,-1.2271651029586792,-2.2266902923583984,null,-1.2967512607574463,-2.296268939971924,null,-1.2271655797958374,-2.2266910076141357,null,-0.9999974966049194,-1.9999974966049194,null,-1.9999974966049194,-2.99999737739563,null,-2.2266902923583984,-3.2263364791870117,null,-2.296268939971924,-3.2958943843841553,null,-2.2266910076141357,-3.226337432861328,null,-1.9999974966049194,-2.99999737739563,null],"type":"scatter"},{"marker":{"color":"crimson","size":12},"mode":"markers","x":[-7.677186658838764e-06,4.000007629394531,-7.688651749049313e-06,4.000007629394531,-7.668499165447429e-06,4.000007629394531,-7.642302989552263e-06,4.000007629394531],"y":[2.5876045128825353e-06,2.564326450738008e-06,-0.9999974966049194,-0.9999974966049194,-1.9999974966049194,-1.9999974966049194,-2.99999737739563,-2.99999737739563],"type":"scatter"},{"marker":{"color":"steelblue","size":10},"mode":"markers","x":[0.9883914589881897,1.9999998807907104,3.011608362197876,0.988431990146637,1.9999998807907104,3.011568069458008,0.9884850978851318,2.000000238418579,3.0115151405334473,0.9885225892066956,2.000000238418579,3.0114779472351074],"y":[-0.22752434015274048,-0.2971022427082062,-0.2275247871875763,-1.2271651029586792,-1.2967512607574463,-1.2271655797958374,-2.2266902923583984,-2.296268939971924,-2.2266910076141357,-3.2263364791870117,-3.2958943843841553,-3.226337432861328],"type":"scatter"}],"name":"2"},{"data":[{"hoverinfo":"skip","line":{"color":"gray","width":2},"mode":"lines","x":[1.779041269855952e-07,0.9793235063552856,null,0.9793235063552856,2.000000476837158,null,2.000000476837158,3.0206756591796875,null,3.0206756591796875,3.999999761581421,null,1.8247129673909512e-07,0.9794453978538513,null,0.9794453978538513,2.000000238418579,null,2.000000238418579,3.0205538272857666,null,3.0205538272857666,3.999999761581421,null,1.793969062191536e-07,0.979593813419342,null,0.979593813419342,1.9999991655349731,null,1.9999991655349731,3.02040696144104,null,3.02040696144104,3.999999761581421,null,1.7040147781699488e-07,0.979694664478302,null,0.979694664478302,2.000000476837158,null,2.000000476837158,3.02030611038208,null,3.02030611038208,4.0,null,1.779041269855952e-07,1.8247129673909512e-07,null,0.9793235063552856,0.9794453978538513,null,2.000000476837158,2.000000238418579,null,3.0206756591796875,3.0205538272857666,null,3.999999761581421,3.999999761581421,null,1.8247129673909512e-07,1.793969062191536e-07,null,0.9794453978538513,0.979593813419342,null,2.000000238418579,1.9999991655349731,null,3.0205538272857666,3.02040696144104,null,3.999999761581421,3.999999761581421,null,1.793969062191536e-07,1.7040147781699488e-07,null,0.979593813419342,0.979694664478302,null,1.9999991655349731,2.000000476837158,null,3.02040696144104,3.02030611038208,null,3.999999761581421,4.0,null],"y":[9.468296013892541e-08,-0.3009803593158722,null,-0.3009803593158722,-0.38439780473709106,null,-0.38439780473709106,-0.3009805381298065,null,-0.3009805381298065,9.481118468102068e-08,null,-0.9999999403953552,-1.3001718521118164,null,-1.3001718521118164,-1.3836487531661987,null,-1.3836487531661987,-1.3001713752746582,null,-1.3001713752746582,-0.9999999403953552,null,-1.9999998807907104,-2.2991373538970947,null,-2.2991373538970947,-2.3825883865356445,null,-2.3825883865356445,-2.299138069152832,null,-2.299138069152832,-1.9999998807907104,null,-3.0,-3.298388719558716,null,-3.298388719558716,-3.3817410469055176,null,-3.3817410469055176,-3.2983882427215576,null,-3.2983882427215576,-3.0,null,9.468296013892541e-08,-0.9999999403953552,null,-0.3009803593158722,-1.3001718521118164,null,-0.38439780473709106,-1.3836487531661987,null,-0.3009805381298065,-1.3001713752746582,null,9.481118468102068e-08,-0.9999999403953552,null,-0.9999999403953552,-1.9999998807907104,null,-1.3001718521118164,-2.2991373538970947,null,-1.3836487531661987,-2.3825883865356445,null,-1.3001713752746582,-2.299138069152832,null,-0.9999999403953552,-1.9999998807907104,null,-1.9999998807907104,-3.0,null,-2.2991373538970947,-3.298388719558716,null,-2.3825883865356445,-3.3817410469055176,null,-2.299138069152832,-3.2983882427215576,null,-1.9999998807907104,-3.0,null],"type":"scatter"},{"marker":{"color":"crimson","size":12},"mode":"markers","x":[1.779041269855952e-07,3.999999761581421,1.8247129673909512e-07,3.999999761581421,1.793969062191536e-07,3.999999761581421,1.7040147781699488e-07,4.0],"y":[9.468296013892541e-08,9.481118468102068e-08,-0.9999999403953552,-0.9999999403953552,-1.9999998807907104,-1.9999998807907104,-3.0,-3.0],"type":"scatter"},{"marker":{"color":"steelblue","size":10},"mode":"markers","x":[0.9793235063552856,2.000000476837158,3.0206756591796875,0.9794453978538513,2.000000238418579,3.0205538272857666,0.979593813419342,1.9999991655349731,3.02040696144104,0.979694664478302,2.000000476837158,3.02030611038208],"y":[-0.3009803593158722,-0.38439780473709106,-0.3009805381298065,-1.3001718521118164,-1.3836487531661987,-1.3001713752746582,-2.2991373538970947,-2.3825883865356445,-2.299138069152832,-3.298388719558716,-3.3817410469055176,-3.2983882427215576],"type":"scatter"}],"name":"3"},{"data":[{"hoverinfo":"skip","line":{"color":"gray","width":2},"mode":"lines","x":[-1.4108409231994301e-06,0.9735204577445984,null,0.9735204577445984,1.9999998807907104,null,1.9999998807907104,3.0264792442321777,null,3.0264792442321777,4.000001430511475,null,-1.376474074277212e-06,0.9737300276756287,null,0.9737300276756287,1.9999998807907104,null,1.9999998807907104,3.0262699127197266,null,3.0262699127197266,4.000001430511475,null,-1.3497457302946714e-06,0.9740121364593506,null,0.9740121364593506,1.999999761581421,null,1.999999761581421,3.025987386703491,null,3.025987386703491,4.000001430511475,null,-1.3429825003186124e-06,0.9742289185523987,null,0.9742289185523987,1.9999998807907104,null,1.9999998807907104,3.025770902633667,null,3.025770902633667,4.000001430511475,null,-1.4108409231994301e-06,-1.376474074277212e-06,null,0.9735204577445984,0.9737300276756287,null,1.9999998807907104,1.9999998807907104,null,3.0264792442321777,3.0262699127197266,null,4.000001430511475,4.000001430511475,null,-1.376474074277212e-06,-1.3497457302946714e-06,null,0.9737300276756287,0.9740121364593506,null,1.9999998807907104,1.999999761581421,null,3.0262699127197266,3.025987386703491,null,4.000001430511475,4.000001430511475,null,-1.3497457302946714e-06,-1.3429825003186124e-06,null,0.9740121364593506,0.9742289185523987,null,1.999999761581421,1.9999998807907104,null,3.025987386703491,3.025770902633667,null,4.000001430511475,4.000001430511475,null],"y":[-1.5631367205060087e-06,-0.3543567657470703,null,-0.3543567657470703,-0.4799686372280121,null,-0.4799686372280121,-0.3543563783168793,null,-0.3543563783168793,-1.5646421616111184e-06,null,-1.0000015497207642,-1.3530488014221191,null,-1.3530488014221191,-1.4785410165786743,null,-1.4785410165786743,-1.3530484437942505,null,-1.3530484437942505,-1.0000015497207642,null,-2.0000014305114746,-2.3512940406799316,null,-2.3512940406799316,-2.4766733646392822,null,-2.4766733646392822,-2.3512935638427734,null,-2.3512935638427734,-2.0000014305114746,null,-3.0000014305114746,-3.3499526977539062,null,-3.3499526977539062,-3.475289821624756,null,-3.475289821624756,-3.349952459335327,null,-3.349952459335327,-3.0000014305114746,null,-1.5631367205060087e-06,-1.0000015497207642,null,-0.3543567657470703,-1.3530488014221191,null,-0.4799686372280121,-1.4785410165786743,null,-0.3543563783168793,-1.3530484437942505,null,-1.5646421616111184e-06,-1.0000015497207642,null,-1.0000015497207642,-2.0000014305114746,null,-1.3530488014221191,-2.3512940406799316,null,-1.4785410165786743,-2.4766733646392822,null,-1.3530484437942505,-2.3512935638427734,null,-1.0000015497207642,-2.0000014305114746,null,-2.0000014305114746,-3.0000014305114746,null,-2.3512940406799316,-3.3499526977539062,null,-2.4766733646392822,-3.475289821624756,null,-2.3512935638427734,-3.349952459335327,null,-2.0000014305114746,-3.0000014305114746,null],"type":"scatter"},{"marker":{"color":"crimson","size":12},"mode":"markers","x":[-1.4108409231994301e-06,4.000001430511475,-1.376474074277212e-06,4.000001430511475,-1.3497457302946714e-06,4.000001430511475,-1.3429825003186124e-06,4.000001430511475],"y":[-1.5631367205060087e-06,-1.5646421616111184e-06,-1.0000015497207642,-1.0000015497207642,-2.0000014305114746,-2.0000014305114746,-3.0000014305114746,-3.0000014305114746],"type":"scatter"},{"marker":{"color":"steelblue","size":10},"mode":"markers","x":[0.9735204577445984,1.9999998807907104,3.0264792442321777,0.9737300276756287,1.9999998807907104,3.0262699127197266,0.9740121364593506,1.999999761581421,3.025987386703491,0.9742289185523987,1.9999998807907104,3.025770902633667],"y":[-0.3543567657470703,-0.4799686372280121,-0.3543563783168793,-1.3530488014221191,-1.4785410165786743,-1.3530484437942505,-2.3512940406799316,-2.4766733646392822,-2.3512935638427734,-3.3499526977539062,-3.475289821624756,-3.349952459335327],"type":"scatter"}],"name":"4"},{"data":[{"hoverinfo":"skip","line":{"color":"gray","width":2},"mode":"lines","x":[-3.5099055821774527e-06,0.9647511839866638,null,0.9647511839866638,2.0,null,2.0,3.0352489948272705,null,3.0352489948272705,4.000003814697266,null,-3.4258468986081425e-06,0.965103805065155,null,0.965103805065155,2.0,null,2.0,3.0348963737487793,null,3.0348963737487793,4.000003337860107,null,-3.363954874657793e-06,0.9655787348747253,null,0.9655787348747253,2.0,null,2.0,3.03442120552063,null,3.03442120552063,4.000003337860107,null,-3.3461687962699216e-06,0.965945303440094,null,0.965945303440094,2.000000238418579,null,2.000000238418579,3.034054756164551,null,3.034054756164551,4.000003337860107,null,-3.5099055821774527e-06,-3.4258468986081425e-06,null,0.9647511839866638,0.965103805065155,null,2.0,2.0,null,3.0352489948272705,3.0348963737487793,null,4.000003814697266,4.000003337860107,null,-3.4258468986081425e-06,-3.363954874657793e-06,null,0.965103805065155,0.9655787348747253,null,2.0,2.0,null,3.0348963737487793,3.03442120552063,null,4.000003337860107,4.000003337860107,null,-3.363954874657793e-06,-3.3461687962699216e-06,null,0.9655787348747253,0.965945303440094,null,2.0,2.000000238418579,null,3.03442120552063,3.034054756164551,null,4.000003337860107,4.000003337860107,null],"y":[4.318603714636993e-06,-0.41166815161705017,null,-0.41166815161705017,-0.5578998923301697,null,-0.5578998923301697,-0.4116683900356293,null,-0.4116683900356293,4.3167578951397445e-06,null,-0.9999955296516418,-1.4097026586532593,null,-1.4097026586532593,-1.555711030960083,null,-1.555711030960083,-1.4097028970718384,null,-1.4097028970718384,-0.9999955296516418,null,-1.9999955892562866,-2.4070684909820557,null,-2.4070684909820557,-2.552854299545288,null,-2.552854299545288,-2.4070687294006348,null,-2.4070687294006348,-1.9999955892562866,null,-2.999995708465576,-3.4050493240356445,null,-3.4050493240356445,-3.550739049911499,null,-3.550739049911499,-3.4050495624542236,null,-3.4050495624542236,-2.999995708465576,null,4.318603714636993e-06,-0.9999955296516418,null,-0.41166815161705017,-1.4097026586532593,null,-0.5578998923301697,-1.555711030960083,null,-0.4116683900356293,-1.4097028970718384,null,4.3167578951397445e-06,-0.9999955296516418,null,-0.9999955296516418,-1.9999955892562866,null,-1.4097026586532593,-2.4070684909820557,null,-1.555711030960083,-2.552854299545288,null,-1.4097028970718384,-2.4070687294006348,null,-0.9999955296516418,-1.9999955892562866,null,-1.9999955892562866,-2.999995708465576,null,-2.4070684909820557,-3.4050493240356445,null,-2.552854299545288,-3.550739049911499,null,-2.4070687294006348,-3.4050495624542236,null,-1.9999955892562866,-2.999995708465576,null],"type":"scatter"},{"marker":{"color":"crimson","size":12},"mode":"markers","x":[-3.5099055821774527e-06,4.000003814697266,-3.4258468986081425e-06,4.000003337860107,-3.363954874657793e-06,4.000003337860107,-3.3461687962699216e-06,4.000003337860107],"y":[4.318603714636993e-06,4.3167578951397445e-06,-0.9999955296516418,-0.9999955296516418,-1.9999955892562866,-1.9999955892562866,-2.999995708465576,-2.999995708465576],"type":"scatter"},{"marker":{"color":"steelblue","size":10},"mode":"markers","x":[0.9647511839866638,2.0,3.0352489948272705,0.965103805065155,2.0,3.0348963737487793,0.9655787348747253,2.0,3.03442120552063,0.965945303440094,2.000000238418579,3.034054756164551],"y":[-0.41166815161705017,-0.5578998923301697,-0.4116683900356293,-1.4097026586532593,-1.555711030960083,-1.4097028970718384,-2.4070684909820557,-2.552854299545288,-2.4070687294006348,-3.4050493240356445,-3.550739049911499,-3.4050495624542236],"type":"scatter"}],"name":"5"},{"data":[{"hoverinfo":"skip","line":{"color":"gray","width":2},"mode":"lines","x":[-5.305071681505069e-06,0.95599764585495,null,0.95599764585495,2.0,null,2.0,3.0440022945404053,null,3.0440022945404053,4.00000524520874,null,-5.217688794800779e-06,0.9565322399139404,null,0.9565322399139404,2.0,null,2.0,3.0434677600860596,null,3.0434677600860596,4.00000524520874,null,-5.15020019520307e-06,0.9572469592094421,null,0.9572469592094421,1.9999998807907104,null,1.9999998807907104,3.042752981185913,null,3.042752981185913,4.00000524520874,null,-5.127527856529923e-06,0.9577967524528503,null,0.9577967524528503,2.0,null,2.0,3.042203187942505,null,3.042203187942505,4.00000524520874,null,-5.305071681505069e-06,-5.217688794800779e-06,null,0.95599764585495,0.9565322399139404,null,2.0,2.0,null,3.0440022945404053,3.0434677600860596,null,4.00000524520874,4.00000524520874,null,-5.217688794800779e-06,-5.15020019520307e-06,null,0.9565322399139404,0.9572469592094421,null,2.0,1.9999998807907104,null,3.0434677600860596,3.042752981185913,null,4.00000524520874,4.00000524520874,null,-5.15020019520307e-06,-5.127527856529923e-06,null,0.9572469592094421,0.9577967524528503,null,1.9999998807907104,2.0,null,3.042752981185913,3.042203187942505,null,4.00000524520874,4.00000524520874,null],"y":[4.078231540916022e-06,-0.46529701352119446,null,-0.46529701352119446,-0.6345469355583191,null,-0.6345469355583191,-0.46529701352119446,null,-0.46529701352119446,4.078372967342148e-06,null,-0.999995768070221,-1.4625654220581055,null,-1.4625654220581055,-1.6314882040023804,null,-1.6314882040023804,-1.462565541267395,null,-1.462565541267395,-0.999995768070221,null,-1.9999958276748657,-2.4589202404022217,null,-2.4589202404022217,-2.6274685859680176,null,-2.6274685859680176,-2.4589202404022217,null,-2.4589202404022217,-1.9999959468841553,null,-2.9999961853027344,-3.4561264514923096,null,-3.4561264514923096,-3.6244640350341797,null,-3.6244640350341797,-3.4561264514923096,null,-3.4561264514923096,-2.9999961853027344,null,4.078231540916022e-06,-0.999995768070221,null,-0.46529701352119446,-1.4625654220581055,null,-0.6345469355583191,-1.6314882040023804,null,-0.46529701352119446,-1.462565541267395,null,4.078372967342148e-06,-0.999995768070221,null,-0.999995768070221,-1.9999958276748657,null,-1.4625654220581055,-2.4589202404022217,null,-1.6314882040023804,-2.6274685859680176,null,-1.462565541267395,-2.4589202404022217,null,-0.999995768070221,-1.9999959468841553,null,-1.9999958276748657,-2.9999961853027344,null,-2.4589202404022217,-3.4561264514923096,null,-2.6274685859680176,-3.6244640350341797,null,-2.4589202404022217,-3.4561264514923096,null,-1.9999959468841553,-2.9999961853027344,null],"type":"scatter"},{"marker":{"color":"crimson","size":12},"mode":"markers","x":[-5.305071681505069e-06,4.00000524520874,-5.217688794800779e-06,4.00000524520874,-5.15020019520307e-06,4.00000524520874,-5.127527856529923e-06,4.00000524520874],"y":[4.078231540916022e-06,4.078372967342148e-06,-0.999995768070221,-0.999995768070221,-1.9999958276748657,-1.9999959468841553,-2.9999961853027344,-2.9999961853027344],"type":"scatter"},{"marker":{"color":"steelblue","size":10},"mode":"markers","x":[0.95599764585495,2.0,3.0440022945404053,0.9565322399139404,2.0,3.0434677600860596,0.9572469592094421,1.9999998807907104,3.042752981185913,0.9577967524528503,2.0,3.042203187942505],"y":[-0.46529701352119446,-0.6345469355583191,-0.46529701352119446,-1.4625654220581055,-1.6314882040023804,-1.462565541267395,-2.4589202404022217,-2.6274685859680176,-2.4589202404022217,-3.4561264514923096,-3.6244640350341797,-3.4561264514923096],"type":"scatter"}],"name":"6"},{"data":[{"hoverinfo":"skip","line":{"color":"gray","width":2},"mode":"lines","x":[-4.943604835716542e-06,0.9469496011734009,null,0.9469496011734009,2.0,null,2.0,3.0530505180358887,null,3.0530505180358887,4.00000524520874,null,-4.888100193056744e-06,0.947702169418335,null,0.947702169418335,2.0,null,2.0,3.052297830581665,null,3.052297830581665,4.000004768371582,null,-4.826946678804234e-06,0.9486991763114929,null,0.9486991763114929,2.0,null,2.0,3.0513007640838623,null,3.0513007640838623,4.000004768371582,null,-4.777113645104691e-06,0.9494624137878418,null,0.9494624137878418,2.0,null,2.0,3.050537586212158,null,3.050537586212158,4.000004768371582,null,-4.943604835716542e-06,-4.888100193056744e-06,null,0.9469496011734009,0.947702169418335,null,2.0,2.0,null,3.0530505180358887,3.052297830581665,null,4.00000524520874,4.000004768371582,null,-4.888100193056744e-06,-4.826946678804234e-06,null,0.947702169418335,0.9486991763114929,null,2.0,2.0,null,3.052297830581665,3.0513007640838623,null,4.000004768371582,4.000004768371582,null,-4.826946678804234e-06,-4.777113645104691e-06,null,0.9486991763114929,0.9494624137878418,null,2.0,2.0,null,3.0513007640838623,3.050537586212158,null,4.000004768371582,4.000004768371582,null],"y":[1.4502038538921624e-06,-0.5162097215652466,null,-0.5162097215652466,-0.7061066031455994,null,-0.7061066031455994,-0.5162096619606018,null,-0.5162096619606018,1.4499995586447767e-06,null,-0.9999984502792358,-1.5126127004623413,null,-1.5126127004623413,-1.7020549774169922,null,-1.7020549774169922,-1.5126125812530518,null,-1.5126125812530518,-0.9999984502792358,null,-1.9999984502792358,-2.507840156555176,null,-2.507840156555176,-2.6967086791992188,null,-2.6967086791992188,-2.507840156555176,null,-2.507840156555176,-1.9999984502792358,null,-2.9999985694885254,-3.504188060760498,null,-3.504188060760498,-3.692685842514038,null,-3.692685842514038,-3.504188060760498,null,-3.504188060760498,-2.9999985694885254,null,1.4502038538921624e-06,-0.9999984502792358,null,-0.5162097215652466,-1.5126127004623413,null,-0.7061066031455994,-1.7020549774169922,null,-0.5162096619606018,-1.5126125812530518,null,1.4499995586447767e-06,-0.9999984502792358,null,-0.9999984502792358,-1.9999984502792358,null,-1.5126127004623413,-2.507840156555176,null,-1.7020549774169922,-2.6967086791992188,null,-1.5126125812530518,-2.507840156555176,null,-0.9999984502792358,-1.9999984502792358,null,-1.9999984502792358,-2.9999985694885254,null,-2.507840156555176,-3.504188060760498,null,-2.6967086791992188,-3.692685842514038,null,-2.507840156555176,-3.504188060760498,null,-1.9999984502792358,-2.9999985694885254,null],"type":"scatter"},{"marker":{"color":"crimson","size":12},"mode":"markers","x":[-4.943604835716542e-06,4.00000524520874,-4.888100193056744e-06,4.000004768371582,-4.826946678804234e-06,4.000004768371582,-4.777113645104691e-06,4.000004768371582],"y":[1.4502038538921624e-06,1.4499995586447767e-06,-0.9999984502792358,-0.9999984502792358,-1.9999984502792358,-1.9999984502792358,-2.9999985694885254,-2.9999985694885254],"type":"scatter"},{"marker":{"color":"steelblue","size":10},"mode":"markers","x":[0.9469496011734009,2.0,3.0530505180358887,0.947702169418335,2.0,3.052297830581665,0.9486991763114929,2.0,3.0513007640838623,0.9494624137878418,2.0,3.050537586212158],"y":[-0.5162097215652466,-0.7061066031455994,-0.5162096619606018,-1.5126127004623413,-1.7020549774169922,-1.5126125812530518,-2.507840156555176,-2.6967086791992188,-2.507840156555176,-3.504188060760498,-3.692685842514038,-3.504188060760498],"type":"scatter"}],"name":"7"},{"data":[{"hoverinfo":"skip","line":{"color":"gray","width":2},"mode":"lines","x":[6.241378287086263e-06,0.9416836500167847,null,0.9416836500167847,2.0,null,2.0,3.058316469192505,null,3.058316469192505,3.9999938011169434,null,6.567664968315512e-06,0.9425926208496094,null,0.9425926208496094,2.0,null,2.0,3.0574073791503906,null,3.0574073791503906,3.999993324279785,null,6.220232990017394e-06,0.9438461065292358,null,0.9438461065292358,2.0,null,2.0,3.0561540126800537,null,3.0561540126800537,3.9999938011169434,null,5.456825419969391e-06,0.9448484778404236,null,0.9448484778404236,2.0,null,2.0,3.0551514625549316,null,3.0551514625549316,3.9999945163726807,null,6.241378287086263e-06,6.567664968315512e-06,null,0.9416836500167847,0.9425926208496094,null,2.0,2.0,null,3.058316469192505,3.0574073791503906,null,3.9999938011169434,3.999993324279785,null,6.567664968315512e-06,6.220232990017394e-06,null,0.9425926208496094,0.9438461065292358,null,2.0,2.0,null,3.0574073791503906,3.0561540126800537,null,3.999993324279785,3.9999938011169434,null,6.220232990017394e-06,5.456825419969391e-06,null,0.9438461065292358,0.9448484778404236,null,2.0,2.0,null,3.0561540126800537,3.0551514625549316,null,3.9999938011169434,3.9999945163726807,null],"y":[2.3297286588785937e-07,-0.5571091175079346,null,-0.5571091175079346,-0.7893139719963074,null,-0.7893139719963074,-0.5571091175079346,null,-0.5571091175079346,2.3296435358588496e-07,null,-0.9999994039535522,-1.5527056455612183,null,-1.5527056455612183,-1.7838608026504517,null,-1.7838608026504517,-1.5527056455612183,null,-1.5527056455612183,-0.9999994039535522,null,-1.9999990463256836,-2.5467629432678223,null,-2.5467629432678223,-2.7769155502319336,null,-2.7769155502319336,-2.5467629432678223,null,-2.5467629432678223,-1.9999990463256836,null,-2.9999988079071045,-3.542117118835449,null,-3.542117118835449,-3.771873712539673,null,-3.771873712539673,-3.54211688041687,null,-3.54211688041687,-2.9999988079071045,null,2.3297286588785937e-07,-0.9999994039535522,null,-0.5571091175079346,-1.5527056455612183,null,-0.7893139719963074,-1.7838608026504517,null,-0.5571091175079346,-1.5527056455612183,null,2.3296435358588496e-07,-0.9999994039535522,null,-0.9999994039535522,-1.9999990463256836,null,-1.5527056455612183,-2.5467629432678223,null,-1.7838608026504517,-2.7769155502319336,null,-1.5527056455612183,-2.5467629432678223,null,-0.9999994039535522,-1.9999990463256836,null,-1.9999990463256836,-2.9999988079071045,null,-2.5467629432678223,-3.542117118835449,null,-2.7769155502319336,-3.771873712539673,null,-2.5467629432678223,-3.54211688041687,null,-1.9999990463256836,-2.9999988079071045,null],"type":"scatter"},{"marker":{"color":"crimson","size":12},"mode":"markers","x":[6.241378287086263e-06,3.9999938011169434,6.567664968315512e-06,3.999993324279785,6.220232990017394e-06,3.9999938011169434,5.456825419969391e-06,3.9999945163726807],"y":[2.3297286588785937e-07,2.3296435358588496e-07,-0.9999994039535522,-0.9999994039535522,-1.9999990463256836,-1.9999990463256836,-2.9999988079071045,-2.9999988079071045],"type":"scatter"},{"marker":{"color":"steelblue","size":10},"mode":"markers","x":[0.9416836500167847,2.0,3.058316469192505,0.9425926208496094,2.0,3.0574073791503906,0.9438461065292358,2.0,3.0561540126800537,0.9448484778404236,2.0,3.0551514625549316],"y":[-0.5571091175079346,-0.7893139719963074,-0.5571091175079346,-1.5527056455612183,-1.7838608026504517,-1.5527056455612183,-2.5467629432678223,-2.7769155502319336,-2.5467629432678223,-3.542117118835449,-3.771873712539673,-3.54211688041687],"type":"scatter"}],"name":"8"},{"data":[{"hoverinfo":"skip","line":{"color":"gray","width":2},"mode":"lines","x":[6.819123427703744e-06,0.9277142286300659,null,0.9277142286300659,2.0,null,2.0,3.0722861289978027,null,3.0722861289978027,3.999993324279785,null,6.648110229434678e-06,0.928971529006958,null,0.928971529006958,2.0,null,2.0,3.071028709411621,null,3.071028709411621,3.999993324279785,null,6.349822342599509e-06,0.9306380748748779,null,0.9306380748748779,2.000000238418579,null,2.000000238418579,3.069362163543701,null,3.069362163543701,3.9999935626983643,null,6.125129857537104e-06,0.9319202899932861,null,0.9319202899932861,2.0,null,2.0,3.068079948425293,null,3.068079948425293,3.9999938011169434,null,6.819123427703744e-06,6.648110229434678e-06,null,0.9277142286300659,0.928971529006958,null,2.0,2.0,null,3.0722861289978027,3.071028709411621,null,3.999993324279785,3.999993324279785,null,6.648110229434678e-06,6.349822342599509e-06,null,0.928971529006958,0.9306380748748779,null,2.0,2.000000238418579,null,3.071028709411621,3.069362163543701,null,3.999993324279785,3.9999935626983643,null,6.349822342599509e-06,6.125129857537104e-06,null,0.9306380748748779,0.9319202899932861,null,2.000000238418579,2.0,null,3.069362163543701,3.068079948425293,null,3.9999935626983643,3.9999938011169434,null],"y":[-2.715640903261374e-07,-0.6137675046920776,null,-0.6137675046920776,-0.8392772674560547,null,-0.8392772674560547,-0.6137678027153015,null,-0.6137678027153015,-2.711050512971269e-07,null,-1.0,-1.608221173286438,null,-1.608221173286438,-1.8328869342803955,null,-1.8328869342803955,-1.6082215309143066,null,-1.6082215309143066,-1.0,null,-1.9999998807907104,-2.600902557373047,null,-2.600902557373047,-2.8244500160217285,null,-2.8244500160217285,-2.600903034210205,null,-2.600903034210205,-1.9999998807907104,null,-2.999999761581421,-3.5952911376953125,null,-3.5952911376953125,-3.818060874938965,null,-3.818060874938965,-3.5952913761138916,null,-3.5952913761138916,-2.999999761581421,null,-2.715640903261374e-07,-1.0,null,-0.6137675046920776,-1.608221173286438,null,-0.8392772674560547,-1.8328869342803955,null,-0.6137678027153015,-1.6082215309143066,null,-2.711050512971269e-07,-1.0,null,-1.0,-1.9999998807907104,null,-1.608221173286438,-2.600902557373047,null,-1.8328869342803955,-2.8244500160217285,null,-1.6082215309143066,-2.600903034210205,null,-1.0,-1.9999998807907104,null,-1.9999998807907104,-2.999999761581421,null,-2.600902557373047,-3.5952911376953125,null,-2.8244500160217285,-3.818060874938965,null,-2.600903034210205,-3.5952913761138916,null,-1.9999998807907104,-2.999999761581421,null],"type":"scatter"},{"marker":{"color":"crimson","size":12},"mode":"markers","x":[6.819123427703744e-06,3.999993324279785,6.648110229434678e-06,3.999993324279785,6.349822342599509e-06,3.9999935626983643,6.125129857537104e-06,3.9999938011169434],"y":[-2.715640903261374e-07,-2.711050512971269e-07,-1.0,-1.0,-1.9999998807907104,-1.9999998807907104,-2.999999761581421,-2.999999761581421],"type":"scatter"},{"marker":{"color":"steelblue","size":10},"mode":"markers","x":[0.9277142286300659,2.0,3.0722861289978027,0.928971529006958,2.0,3.071028709411621,0.9306380748748779,2.000000238418579,3.069362163543701,0.9319202899932861,2.0,3.068079948425293],"y":[-0.6137675046920776,-0.8392772674560547,-0.6137678027153015,-1.608221173286438,-1.8328869342803955,-1.6082215309143066,-2.600902557373047,-2.8244500160217285,-2.600903034210205,-3.5952911376953125,-3.818060874938965,-3.5952913761138916],"type":"scatter"}],"name":"9"},{"data":[{"hoverinfo":"skip","line":{"color":"gray","width":2},"mode":"lines","x":[9.917781653712154e-07,0.9206368923187256,null,0.9206368923187256,2.0,null,2.0,3.0793631076812744,null,3.0793631076812744,3.9999990463256836,null,8.427431907875871e-07,0.922181248664856,null,0.922181248664856,2.0,null,2.0,3.0778188705444336,null,3.0778188705444336,3.9999990463256836,null,8.548988716938766e-07,0.9241714477539062,null,0.9241714477539062,2.0,null,2.0,3.0758285522460938,null,3.0758285522460938,3.9999990463256836,null,9.784698704606853e-07,0.9256811141967773,null,0.9256811141967773,2.0,null,2.0,3.0743188858032227,null,3.0743188858032227,3.9999990463256836,null,9.917781653712154e-07,8.427431907875871e-07,null,0.9206368923187256,0.922181248664856,null,2.0,2.0,null,3.0793631076812744,3.0778188705444336,null,3.9999990463256836,3.9999990463256836,null,8.427431907875871e-07,8.548988716938766e-07,null,0.922181248664856,0.9241714477539062,null,2.0,2.0,null,3.0778188705444336,3.0758285522460938,null,3.9999990463256836,3.9999990463256836,null,8.548988716938766e-07,9.784698704606853e-07,null,0.9241714477539062,0.9256811141967773,null,2.0,2.0,null,3.0758285522460938,3.0743188858032227,null,3.9999990463256836,3.9999990463256836,null],"y":[-1.6636474811093649e-06,-0.6569551229476929,null,-0.6569551229476929,-0.9125226736068726,null,-0.9125226736068726,-0.6569551229476929,null,-0.6569551229476929,-1.6637815178910387e-06,null,-1.0000016689300537,-1.650328516960144,null,-1.650328516960144,-1.9048107862472534,null,-1.9048107862472534,-1.650328516960144,null,-1.650328516960144,-1.0000016689300537,null,-2.0000014305114746,-2.6416404247283936,null,-2.6416404247283936,-2.8945751190185547,null,-2.8945751190185547,-2.6416404247283936,null,-2.6416404247283936,-2.0000014305114746,null,-3.0000009536743164,-3.6349823474884033,null,-3.6349823474884033,-3.8867809772491455,null,-3.8867809772491455,-3.6349823474884033,null,-3.6349823474884033,-3.0000009536743164,null,-1.6636474811093649e-06,-1.0000016689300537,null,-0.6569551229476929,-1.650328516960144,null,-0.9125226736068726,-1.9048107862472534,null,-0.6569551229476929,-1.650328516960144,null,-1.6637815178910387e-06,-1.0000016689300537,null,-1.0000016689300537,-2.0000014305114746,null,-1.650328516960144,-2.6416404247283936,null,-1.9048107862472534,-2.8945751190185547,null,-1.650328516960144,-2.6416404247283936,null,-1.0000016689300537,-2.0000014305114746,null,-2.0000014305114746,-3.0000009536743164,null,-2.6416404247283936,-3.6349823474884033,null,-2.8945751190185547,-3.8867809772491455,null,-2.6416404247283936,-3.6349823474884033,null,-2.0000014305114746,-3.0000009536743164,null],"type":"scatter"},{"marker":{"color":"crimson","size":12},"mode":"markers","x":[9.917781653712154e-07,3.9999990463256836,8.427431907875871e-07,3.9999990463256836,8.548988716938766e-07,3.9999990463256836,9.784698704606853e-07,3.9999990463256836],"y":[-1.6636474811093649e-06,-1.6637815178910387e-06,-1.0000016689300537,-1.0000016689300537,-2.0000014305114746,-2.0000014305114746,-3.0000009536743164,-3.0000009536743164],"type":"scatter"},{"marker":{"color":"steelblue","size":10},"mode":"markers","x":[0.9206368923187256,2.0,3.0793631076812744,0.922181248664856,2.0,3.0778188705444336,0.9241714477539062,2.0,3.0758285522460938,0.9256811141967773,2.0,3.0743188858032227],"y":[-0.6569551229476929,-0.9125226736068726,-0.6569551229476929,-1.650328516960144,-1.9048107862472534,-1.650328516960144,-2.6416404247283936,-2.8945751190185547,-2.6416404247283936,-3.6349823474884033,-3.8867809772491455,-3.6349823474884033],"type":"scatter"}],"name":"10"},{"data":[{"hoverinfo":"skip","line":{"color":"gray","width":2},"mode":"lines","x":[5.273760052659782e-06,0.909149169921875,null,0.909149169921875,2.0,null,2.0,3.090850830078125,null,3.090850830078125,3.9999947547912598,null,5.043948021921096e-06,0.9109386205673218,null,0.9109386205673218,2.0,null,2.0,3.0890614986419678,null,3.0890614986419678,3.999994993209839,null,4.690547029895242e-06,0.9133359789848328,null,0.9133359789848328,2.0,null,2.0,3.0866639614105225,null,3.0866639614105225,3.999995231628418,null,4.446144430403365e-06,0.9152105450630188,null,0.9152105450630188,2.0,null,2.0,3.084789276123047,null,3.084789276123047,3.999995470046997,null,5.273760052659782e-06,5.043948021921096e-06,null,0.909149169921875,0.9109386205673218,null,2.0,2.0,null,3.090850830078125,3.0890614986419678,null,3.9999947547912598,3.999994993209839,null,5.043948021921096e-06,4.690547029895242e-06,null,0.9109386205673218,0.9133359789848328,null,2.0,2.0,null,3.0890614986419678,3.0866639614105225,null,3.999994993209839,3.999995231628418,null,4.690547029895242e-06,4.446144430403365e-06,null,0.9133359789848328,0.9152105450630188,null,2.0,2.0,null,3.0866639614105225,3.084789276123047,null,3.999995231628418,3.999995470046997,null],"y":[1.4889644717186457e-06,-0.7056605815887451,null,-0.7056605815887451,-0.9713613986968994,null,-0.9713613986968994,-0.7056605815887451,null,-0.7056605815887451,1.4889335488987854e-06,null,-0.9999982714653015,-1.6979544162750244,null,-1.6979544162750244,-1.9621877670288086,null,-1.9621877670288086,-1.6979544162750244,null,-1.6979544162750244,-0.9999982714653015,null,-1.9999980926513672,-2.687793493270874,null,-2.687793493270874,-2.950101137161255,null,-2.950101137161255,-2.687793493270874,null,-2.687793493270874,-1.9999980926513672,null,-2.999998092651367,-3.679947853088379,null,-3.679947853088379,-3.9409191608428955,null,-3.9409191608428955,-3.679947853088379,null,-3.679947853088379,-2.999998092651367,null,1.4889644717186457e-06,-0.9999982714653015,null,-0.7056605815887451,-1.6979544162750244,null,-0.9713613986968994,-1.9621877670288086,null,-0.7056605815887451,-1.6979544162750244,null,1.4889335488987854e-06,-0.9999982714653015,null,-0.9999982714653015,-1.9999980926513672,null,-1.6979544162750244,-2.687793493270874,null,-1.9621877670288086,-2.950101137161255,null,-1.6979544162750244,-2.687793493270874,null,-0.9999982714653015,-1.9999980926513672,null,-1.9999980926513672,-2.999998092651367,null,-2.687793493270874,-3.679947853088379,null,-2.950101137161255,-3.9409191608428955,null,-2.687793493270874,-3.679947853088379,null,-1.9999980926513672,-2.999998092651367,null],"type":"scatter"},{"marker":{"color":"crimson","size":12},"mode":"markers","x":[5.273760052659782e-06,3.9999947547912598,5.043948021921096e-06,3.999994993209839,4.690547029895242e-06,3.999995231628418,4.446144430403365e-06,3.999995470046997],"y":[1.4889644717186457e-06,1.4889335488987854e-06,-0.9999982714653015,-0.9999982714653015,-1.9999980926513672,-1.9999980926513672,-2.999998092651367,-2.999998092651367],"type":"scatter"},{"marker":{"color":"steelblue","size":10},"mode":"markers","x":[0.909149169921875,2.0,3.090850830078125,0.9109386205673218,2.0,3.0890614986419678,0.9133359789848328,2.0,3.0866639614105225,0.9152105450630188,2.0,3.084789276123047],"y":[-0.7056605815887451,-0.9713613986968994,-0.7056605815887451,-1.6979544162750244,-1.9621877670288086,-1.6979544162750244,-2.687793493270874,-2.950101137161255,-2.687793493270874,-3.679947853088379,-3.9409191608428955,-3.679947853088379],"type":"scatter"}],"name":"11"},{"data":[{"hoverinfo":"skip","line":{"color":"gray","width":2},"mode":"lines","x":[3.7105523915670346e-06,0.9005971550941467,null,0.9005971550941467,2.0,null,2.0,3.099402666091919,null,3.099402666091919,3.9999964237213135,null,3.5912114526581718e-06,0.9026620388031006,null,0.9026620388031006,1.9999998807907104,null,1.9999998807907104,3.0973379611968994,null,3.0973379611968994,3.9999964237213135,null,3.356662318765302e-06,0.905420184135437,null,0.905420184135437,2.0,null,2.0,3.0945796966552734,null,3.0945796966552734,3.9999966621398926,null,3.1582585506839678e-06,0.9075839519500732,null,0.9075839519500732,2.0,null,2.0,3.0924160480499268,null,3.0924160480499268,3.9999969005584717,null,3.7105523915670346e-06,3.5912114526581718e-06,null,0.9005971550941467,0.9026620388031006,null,2.0,1.9999998807907104,null,3.099402666091919,3.0973379611968994,null,3.9999964237213135,3.9999964237213135,null,3.5912114526581718e-06,3.356662318765302e-06,null,0.9026620388031006,0.905420184135437,null,1.9999998807907104,2.0,null,3.0973379611968994,3.0945796966552734,null,3.9999964237213135,3.9999966621398926,null,3.356662318765302e-06,3.1582585506839678e-06,null,0.905420184135437,0.9075839519500732,null,2.0,2.0,null,3.0945796966552734,3.0924160480499268,null,3.9999966621398926,3.9999969005584717,null],"y":[3.9723607869746047e-07,-0.7490667104721069,null,-0.7490667104721069,-1.0362601280212402,null,-1.0362601280212402,-0.7490666508674622,null,-0.7490666508674622,3.971934745550243e-07,null,-0.9999993443489075,-1.7401859760284424,null,-1.7401859760284424,-2.025524616241455,null,-2.025524616241455,-1.7401859760284424,null,-1.7401859760284424,-0.9999993443489075,null,-1.9999991655349731,-2.7285068035125732,null,-2.7285068035125732,-3.0114049911499023,null,-3.0114049911499023,-2.7285068035125732,null,-2.7285068035125732,-1.9999991655349731,null,-2.9999990463256836,-3.7194736003875732,null,-3.7194736003875732,-4.000677585601807,null,-4.000677585601807,-3.7194736003875732,null,-3.7194736003875732,-2.9999990463256836,null,3.9723607869746047e-07,-0.9999993443489075,null,-0.7490667104721069,-1.7401859760284424,null,-1.0362601280212402,-2.025524616241455,null,-0.7490666508674622,-1.7401859760284424,null,3.971934745550243e-07,-0.9999993443489075,null,-0.9999993443489075,-1.9999991655349731,null,-1.7401859760284424,-2.7285068035125732,null,-2.025524616241455,-3.0114049911499023,null,-1.7401859760284424,-2.7285068035125732,null,-0.9999993443489075,-1.9999991655349731,null,-1.9999991655349731,-2.9999990463256836,null,-2.7285068035125732,-3.7194736003875732,null,-3.0114049911499023,-4.000677585601807,null,-2.7285068035125732,-3.7194736003875732,null,-1.9999991655349731,-2.9999990463256836,null],"type":"scatter"},{"marker":{"color":"crimson","size":12},"mode":"markers","x":[3.7105523915670346e-06,3.9999964237213135,3.5912114526581718e-06,3.9999964237213135,3.356662318765302e-06,3.9999966621398926,3.1582585506839678e-06,3.9999969005584717],"y":[3.9723607869746047e-07,3.971934745550243e-07,-0.9999993443489075,-0.9999993443489075,-1.9999991655349731,-1.9999991655349731,-2.9999990463256836,-2.9999990463256836],"type":"scatter"},{"marker":{"color":"steelblue","size":10},"mode":"markers","x":[0.9005971550941467,2.0,3.099402666091919,0.9026620388031006,1.9999998807907104,3.0973379611968994,0.905420184135437,2.0,3.0945796966552734,0.9075839519500732,2.0,3.0924160480499268],"y":[-0.7490667104721069,-1.0362601280212402,-0.7490666508674622,-1.7401859760284424,-2.025524616241455,-1.7401859760284424,-2.7285068035125732,-3.0114049911499023,-2.7285068035125732,-3.7194736003875732,-4.000677585601807,-3.7194736003875732],"type":"scatter"}],"name":"12"},{"data":[{"hoverinfo":"skip","line":{"color":"gray","width":2},"mode":"lines","x":[3.870984528475674e-06,0.8917143940925598,null,0.8917143940925598,2.0,null,2.0,3.108285665512085,null,3.108285665512085,3.9999961853027344,null,3.8148236853885464e-06,0.8940228819847107,null,0.8940228819847107,2.0,null,2.0,3.1059772968292236,null,3.1059772968292236,3.9999961853027344,null,3.577872348614619e-06,0.8971462845802307,null,0.8971462845802307,2.0,null,2.0,3.102853775024414,null,3.102853775024414,3.9999964237213135,null,3.325582611068967e-06,0.8996297717094421,null,0.8996297717094421,2.0,null,2.0,3.100370168685913,null,3.100370168685913,3.9999966621398926,null,3.870984528475674e-06,3.8148236853885464e-06,null,0.8917143940925598,0.8940228819847107,null,2.0,2.0,null,3.108285665512085,3.1059772968292236,null,3.9999961853027344,3.9999961853027344,null,3.8148236853885464e-06,3.577872348614619e-06,null,0.8940228819847107,0.8971462845802307,null,2.0,2.0,null,3.1059772968292236,3.102853775024414,null,3.9999961853027344,3.9999964237213135,null,3.577872348614619e-06,3.325582611068967e-06,null,0.8971462845802307,0.8996297717094421,null,2.0,2.0,null,3.102853775024414,3.100370168685913,null,3.9999964237213135,3.9999966621398926,null],"y":[-2.7865903007295856e-07,-0.7925541400909424,null,-0.7925541400909424,-1.0994170904159546,null,-1.0994170904159546,-0.7925542593002319,null,-0.7925542593002319,-2.7857311124535045e-07,null,-0.9999999403953552,-1.7824680805206299,null,-1.7824680805206299,-2.087001085281372,null,-2.087001085281372,-1.7824681997299194,null,-1.7824681997299194,-0.9999999403953552,null,-1.999999761581421,-2.769205331802368,null,-2.769205331802368,-3.0707333087921143,null,-3.0707333087921143,-2.769205331802368,null,-2.769205331802368,-1.999999761581421,null,-2.999999761581421,-3.758913040161133,null,-3.758913040161133,-4.058388710021973,null,-4.058388710021973,-3.758913040161133,null,-3.758913040161133,-2.999999761581421,null,-2.7865903007295856e-07,-0.9999999403953552,null,-0.7925541400909424,-1.7824680805206299,null,-1.0994170904159546,-2.087001085281372,null,-0.7925542593002319,-1.7824681997299194,null,-2.7857311124535045e-07,-0.9999999403953552,null,-0.9999999403953552,-1.999999761581421,null,-1.7824680805206299,-2.769205331802368,null,-2.087001085281372,-3.0707333087921143,null,-1.7824681997299194,-2.769205331802368,null,-0.9999999403953552,-1.999999761581421,null,-1.999999761581421,-2.999999761581421,null,-2.769205331802368,-3.758913040161133,null,-3.0707333087921143,-4.058388710021973,null,-2.769205331802368,-3.758913040161133,null,-1.999999761581421,-2.999999761581421,null],"type":"scatter"},{"marker":{"color":"crimson","size":12},"mode":"markers","x":[3.870984528475674e-06,3.9999961853027344,3.8148236853885464e-06,3.9999961853027344,3.577872348614619e-06,3.9999964237213135,3.325582611068967e-06,3.9999966621398926],"y":[-2.7865903007295856e-07,-2.7857311124535045e-07,-0.9999999403953552,-0.9999999403953552,-1.999999761581421,-1.999999761581421,-2.999999761581421,-2.999999761581421],"type":"scatter"},{"marker":{"color":"steelblue","size":10},"mode":"markers","x":[0.8917143940925598,2.0,3.108285665512085,0.8940228819847107,2.0,3.1059772968292236,0.8971462845802307,2.0,3.102853775024414,0.8996297717094421,2.0,3.100370168685913],"y":[-0.7925541400909424,-1.0994170904159546,-0.7925542593002319,-1.7824680805206299,-2.087001085281372,-1.7824681997299194,-2.769205331802368,-3.0707333087921143,-2.769205331802368,-3.758913040161133,-4.058388710021973,-3.758913040161133],"type":"scatter"}],"name":"13"},{"data":[{"hoverinfo":"skip","line":{"color":"gray","width":2},"mode":"lines","x":[3.744748028111644e-06,0.8864787220954895,null,0.8864787220954895,2.0,null,2.0,3.1135213375091553,null,3.1135213375091553,3.9999961853027344,null,3.560417326298193e-06,0.8894875645637512,null,0.8894875645637512,2.0,null,2.0,3.1105124950408936,null,3.1105124950408936,3.9999964237213135,null,3.3322994568152353e-06,0.8928868770599365,null,0.8928868770599365,2.0,null,2.0,3.1071131229400635,null,3.1071131229400635,3.9999966621398926,null,3.195446879544761e-06,0.8952199220657349,null,0.8952199220657349,2.0,null,2.0,3.1047799587249756,null,3.1047799587249756,3.9999969005584717,null,3.744748028111644e-06,3.560417326298193e-06,null,0.8864787220954895,0.8894875645637512,null,2.0,2.0,null,3.1135213375091553,3.1105124950408936,null,3.9999961853027344,3.9999964237213135,null,3.560417326298193e-06,3.3322994568152353e-06,null,0.8894875645637512,0.8928868770599365,null,2.0,2.0,null,3.1105124950408936,3.1071131229400635,null,3.9999964237213135,3.9999966621398926,null,3.3322994568152353e-06,3.195446879544761e-06,null,0.8928868770599365,0.8952199220657349,null,2.0,2.0,null,3.1071131229400635,3.1047799587249756,null,3.9999966621398926,3.9999969005584717,null],"y":[-2.9568150239356328e-06,-0.8342073559761047,null,-0.8342073559761047,-1.171329140663147,null,-1.171329140663147,-0.8342073559761047,null,-0.8342073559761047,-2.956571051981882e-06,null,-1.000007152557373,-1.821995496749878,null,-1.821995496749878,-2.158026933670044,null,-2.158026933670044,-1.821995496749878,null,-1.821995496749878,-1.000007152557373,null,-2.000006914138794,-2.8070731163024902,null,-2.8070731163024902,-3.139390468597412,null,-3.139390468597412,-2.8070731163024902,null,-2.8070731163024902,-2.000006914138794,null,-3.00000262260437,-3.796156644821167,null,-3.796156644821167,-4.124497890472412,null,-4.124497890472412,-3.796156644821167,null,-3.796156644821167,-3.00000262260437,null,-2.9568150239356328e-06,-1.000007152557373,null,-0.8342073559761047,-1.821995496749878,null,-1.171329140663147,-2.158026933670044,null,-0.8342073559761047,-1.821995496749878,null,-2.956571051981882e-06,-1.000007152557373,null,-1.000007152557373,-2.000006914138794,null,-1.821995496749878,-2.8070731163024902,null,-2.158026933670044,-3.139390468597412,null,-1.821995496749878,-2.8070731163024902,null,-1.000007152557373,-2.000006914138794,null,-2.000006914138794,-3.00000262260437,null,-2.8070731163024902,-3.796156644821167,null,-3.139390468597412,-4.124497890472412,null,-2.8070731163024902,-3.796156644821167,null,-2.000006914138794,-3.00000262260437,null],"type":"scatter"},{"marker":{"color":"crimson","size":12},"mode":"markers","x":[3.744748028111644e-06,3.9999961853027344,3.560417326298193e-06,3.9999964237213135,3.3322994568152353e-06,3.9999966621398926,3.195446879544761e-06,3.9999969005584717],"y":[-2.9568150239356328e-06,-2.956571051981882e-06,-1.000007152557373,-1.000007152557373,-2.000006914138794,-2.000006914138794,-3.00000262260437,-3.00000262260437],"type":"scatter"},{"marker":{"color":"steelblue","size":10},"mode":"markers","x":[0.8864787220954895,2.0,3.1135213375091553,0.8894875645637512,2.0,3.1105124950408936,0.8928868770599365,2.0,3.1071131229400635,0.8952199220657349,2.0,3.1047799587249756],"y":[-0.8342073559761047,-1.171329140663147,-0.8342073559761047,-1.821995496749878,-2.158026933670044,-1.821995496749878,-2.8070731163024902,-3.139390468597412,-2.8070731163024902,-3.796156644821167,-4.124497890472412,-3.796156644821167],"type":"scatter"}],"name":"14"},{"data":[{"hoverinfo":"skip","line":{"color":"gray","width":2},"mode":"lines","x":[3.803904519372736e-06,0.8790102005004883,null,0.8790102005004883,2.0,null,2.0,3.1209897994995117,null,3.1209897994995117,3.9999961853027344,null,3.4841493743442697e-06,0.8818144202232361,null,0.8818144202232361,2.0,null,2.0,3.118185520172119,null,3.118185520172119,3.9999964237213135,null,3.194773853465449e-06,0.8855082988739014,null,0.8855082988739014,2.0,null,2.0,3.1144917011260986,null,3.1144917011260986,3.9999966621398926,null,3.078892405028455e-06,0.8884347081184387,null,0.8884347081184387,2.0,null,2.0,3.111565351486206,null,3.111565351486206,3.9999969005584717,null,3.803904519372736e-06,3.4841493743442697e-06,null,0.8790102005004883,0.8818144202232361,null,2.0,2.0,null,3.1209897994995117,3.118185520172119,null,3.9999961853027344,3.9999964237213135,null,3.4841493743442697e-06,3.194773853465449e-06,null,0.8818144202232361,0.8855082988739014,null,2.0,2.0,null,3.118185520172119,3.1144917011260986,null,3.9999964237213135,3.9999966621398926,null,3.194773853465449e-06,3.078892405028455e-06,null,0.8855082988739014,0.8884347081184387,null,2.0,2.0,null,3.1144917011260986,3.111565351486206,null,3.9999966621398926,3.9999969005584717,null],"y":[2.886354479869624e-07,-0.8731623291969299,null,-0.8731623291969299,-1.2341383695602417,null,-1.2341383695602417,-0.8731623291969299,null,-0.8731623291969299,2.8861671808044775e-07,null,-0.9999997615814209,-1.8604655265808105,null,-1.8604655265808105,-2.218095302581787,null,-2.218095302581787,-1.8604655265808105,null,-1.8604655265808105,-0.9999997615814209,null,-1.9999996423721313,-2.843902587890625,null,-2.843902587890625,-3.197077512741089,null,-3.197077512741089,-2.843902349472046,null,-2.843902349472046,-1.9999996423721313,null,-2.9999992847442627,-3.8310306072235107,null,-3.8310306072235107,-4.18109655380249,null,-4.18109655380249,-3.8310303688049316,null,-3.8310303688049316,-2.9999992847442627,null,2.886354479869624e-07,-0.9999997615814209,null,-0.8731623291969299,-1.8604655265808105,null,-1.2341383695602417,-2.218095302581787,null,-0.8731623291969299,-1.8604655265808105,null,2.8861671808044775e-07,-0.9999997615814209,null,-0.9999997615814209,-1.9999996423721313,null,-1.8604655265808105,-2.843902587890625,null,-2.218095302581787,-3.197077512741089,null,-1.8604655265808105,-2.843902349472046,null,-0.9999997615814209,-1.9999996423721313,null,-1.9999996423721313,-2.9999992847442627,null,-2.843902587890625,-3.8310306072235107,null,-3.197077512741089,-4.18109655380249,null,-2.843902349472046,-3.8310303688049316,null,-1.9999996423721313,-2.9999992847442627,null],"type":"scatter"},{"marker":{"color":"crimson","size":12},"mode":"markers","x":[3.803904519372736e-06,3.9999961853027344,3.4841493743442697e-06,3.9999964237213135,3.194773853465449e-06,3.9999966621398926,3.078892405028455e-06,3.9999969005584717],"y":[2.886354479869624e-07,2.8861671808044775e-07,-0.9999997615814209,-0.9999997615814209,-1.9999996423721313,-1.9999996423721313,-2.9999992847442627,-2.9999992847442627],"type":"scatter"},{"marker":{"color":"steelblue","size":10},"mode":"markers","x":[0.8790102005004883,2.0,3.1209897994995117,0.8818144202232361,2.0,3.118185520172119,0.8855082988739014,2.0,3.1144917011260986,0.8884347081184387,2.0,3.111565351486206],"y":[-0.8731623291969299,-1.2341383695602417,-0.8731623291969299,-1.8604655265808105,-2.218095302581787,-1.8604655265808105,-2.843902587890625,-3.197077512741089,-2.843902349472046,-3.8310306072235107,-4.18109655380249,-3.8310303688049316],"type":"scatter"}],"name":"15"},{"data":[{"hoverinfo":"skip","line":{"color":"gray","width":2},"mode":"lines","x":[1.7262058236156008e-06,0.8774188756942749,null,0.8774188756942749,2.0,null,2.0,3.1225810050964355,null,3.1225810050964355,3.9999983310699463,null,1.7594542214283138e-06,0.8801006078720093,null,0.8801006078720093,2.0,null,2.0,3.119899272918701,null,3.119899272918701,3.9999983310699463,null,1.5672360405005747e-06,0.8838120102882385,null,0.8838120102882385,2.0,null,2.0,3.1161880493164062,null,3.1161880493164062,3.9999983310699463,null,1.328028588432062e-06,0.8869079351425171,null,0.8869079351425171,2.0,null,2.0,3.1130919456481934,null,3.1130919456481934,3.9999988079071045,null,1.7262058236156008e-06,1.7594542214283138e-06,null,0.8774188756942749,0.8801006078720093,null,2.0,2.0,null,3.1225810050964355,3.119899272918701,null,3.9999983310699463,3.9999983310699463,null,1.7594542214283138e-06,1.5672360405005747e-06,null,0.8801006078720093,0.8838120102882385,null,2.0,2.0,null,3.119899272918701,3.1161880493164062,null,3.9999983310699463,3.9999983310699463,null,1.5672360405005747e-06,1.328028588432062e-06,null,0.8838120102882385,0.8869079351425171,null,2.0,2.0,null,3.1161880493164062,3.1130919456481934,null,3.9999983310699463,3.9999988079071045,null],"y":[1.621213101543617e-07,-0.908104419708252,null,-0.908104419708252,-1.3100366592407227,null,-1.3100366592407227,-0.908104419708252,null,-0.908104419708252,1.6223845022977912e-07,null,-0.9999998211860657,-1.8943519592285156,null,-1.8943519592285156,-2.2914507389068604,null,-2.2914507389068604,-1.8943519592285156,null,-1.8943519592285156,-0.9999998211860657,null,-1.9999996423721313,-2.8762259483337402,null,-2.8762259483337402,-3.267551898956299,null,-3.267551898956299,-2.8762259483337402,null,-2.8762259483337402,-1.9999996423721313,null,-2.9999992847442627,-3.861940622329712,null,-3.861940622329712,-4.249695777893066,null,-4.249695777893066,-3.861940622329712,null,-3.861940622329712,-2.9999992847442627,null,1.621213101543617e-07,-0.9999998211860657,null,-0.908104419708252,-1.8943519592285156,null,-1.3100366592407227,-2.2914507389068604,null,-0.908104419708252,-1.8943519592285156,null,1.6223845022977912e-07,-0.9999998211860657,null,-0.9999998211860657,-1.9999996423721313,null,-1.8943519592285156,-2.8762259483337402,null,-2.2914507389068604,-3.267551898956299,null,-1.8943519592285156,-2.8762259483337402,null,-0.9999998211860657,-1.9999996423721313,null,-1.9999996423721313,-2.9999992847442627,null,-2.8762259483337402,-3.861940622329712,null,-3.267551898956299,-4.249695777893066,null,-2.8762259483337402,-3.861940622329712,null,-1.9999996423721313,-2.9999992847442627,null],"type":"scatter"},{"marker":{"color":"crimson","size":12},"mode":"markers","x":[1.7262058236156008e-06,3.9999983310699463,1.7594542214283138e-06,3.9999983310699463,1.5672360405005747e-06,3.9999983310699463,1.328028588432062e-06,3.9999988079071045],"y":[1.621213101543617e-07,1.6223845022977912e-07,-0.9999998211860657,-0.9999998211860657,-1.9999996423721313,-1.9999996423721313,-2.9999992847442627,-2.9999992847442627],"type":"scatter"},{"marker":{"color":"steelblue","size":10},"mode":"markers","x":[0.8774188756942749,2.0,3.1225810050964355,0.8801006078720093,2.0,3.119899272918701,0.8838120102882385,2.0,3.1161880493164062,0.8869079351425171,2.0,3.1130919456481934],"y":[-0.908104419708252,-1.3100366592407227,-0.908104419708252,-1.8943519592285156,-2.2914507389068604,-1.8943519592285156,-2.8762259483337402,-3.267551898956299,-2.8762259483337402,-3.861940622329712,-4.249695777893066,-3.861940622329712],"type":"scatter"}],"name":"16"},{"data":[{"hoverinfo":"skip","line":{"color":"gray","width":2},"mode":"lines","x":[2.0088989458599826e-06,0.8634267449378967,null,0.8634267449378967,1.9999998807907104,null,1.9999998807907104,3.136573314666748,null,3.136573314666748,3.999997854232788,null,1.7633744846534682e-06,0.8671882748603821,null,0.8671882748603821,2.0,null,2.0,3.1328117847442627,null,3.1328117847442627,3.9999983310699463,null,1.551612854200357e-06,0.8714868426322937,null,0.8714868426322937,2.0,null,2.0,3.1285130977630615,null,3.1285130977630615,3.9999983310699463,null,1.4705681223858846e-06,0.8745694160461426,null,0.8745694160461426,2.0,null,2.0,3.1254305839538574,null,3.1254305839538574,3.9999985694885254,null,2.0088989458599826e-06,1.7633744846534682e-06,null,0.8634267449378967,0.8671882748603821,null,1.9999998807907104,2.0,null,3.136573314666748,3.1328117847442627,null,3.999997854232788,3.9999983310699463,null,1.7633744846534682e-06,1.551612854200357e-06,null,0.8671882748603821,0.8714868426322937,null,2.0,2.0,null,3.1328117847442627,3.1285130977630615,null,3.9999983310699463,3.9999983310699463,null,1.551612854200357e-06,1.4705681223858846e-06,null,0.8714868426322937,0.8745694160461426,null,2.0,2.0,null,3.1285130977630615,3.1254305839538574,null,3.9999983310699463,3.9999985694885254,null],"y":[-2.3597344807058107e-06,-0.9600647687911987,null,-0.9600647687911987,-1.3605823516845703,null,-1.3605823516845703,-0.9600647687911987,null,-0.9600647687911987,-2.359860218348331e-06,null,-1.0000053644180298,-1.9437026977539062,null,-1.9437026977539062,-2.3412814140319824,null,-2.3412814140319824,-1.9437026977539062,null,-1.9437026977539062,-1.0000053644180298,null,-2.0000052452087402,-2.9234838485717773,null,-2.9234838485717773,-3.3151144981384277,null,-3.3151144981384277,-2.9234838485717773,null,-2.9234838485717773,-2.0000052452087402,null,-3.000002145767212,-3.9083290100097656,null,-3.9083290100097656,-4.29466438293457,null,-4.29466438293457,-3.9083290100097656,null,-3.9083290100097656,-3.000002145767212,null,-2.3597344807058107e-06,-1.0000053644180298,null,-0.9600647687911987,-1.9437026977539062,null,-1.3605823516845703,-2.3412814140319824,null,-0.9600647687911987,-1.9437026977539062,null,-2.359860218348331e-06,-1.0000053644180298,null,-1.0000053644180298,-2.0000052452087402,null,-1.9437026977539062,-2.9234838485717773,null,-2.3412814140319824,-3.3151144981384277,null,-1.9437026977539062,-2.9234838485717773,null,-1.0000053644180298,-2.0000052452087402,null,-2.0000052452087402,-3.000002145767212,null,-2.9234838485717773,-3.9083290100097656,null,-3.3151144981384277,-4.29466438293457,null,-2.9234838485717773,-3.9083290100097656,null,-2.0000052452087402,-3.000002145767212,null],"type":"scatter"},{"marker":{"color":"crimson","size":12},"mode":"markers","x":[2.0088989458599826e-06,3.999997854232788,1.7633744846534682e-06,3.9999983310699463,1.551612854200357e-06,3.9999983310699463,1.4705681223858846e-06,3.9999985694885254],"y":[-2.3597344807058107e-06,-2.359860218348331e-06,-1.0000053644180298,-1.0000053644180298,-2.0000052452087402,-2.0000052452087402,-3.000002145767212,-3.000002145767212],"type":"scatter"},{"marker":{"color":"steelblue","size":10},"mode":"markers","x":[0.8634267449378967,1.9999998807907104,3.136573314666748,0.8671882748603821,2.0,3.1328117847442627,0.8714868426322937,2.0,3.1285130977630615,0.8745694160461426,2.0,3.1254305839538574],"y":[-0.9600647687911987,-1.3605823516845703,-0.9600647687911987,-1.9437026977539062,-2.3412814140319824,-1.9437026977539062,-2.9234838485717773,-3.3151144981384277,-2.9234838485717773,-3.9083290100097656,-4.29466438293457,-3.9083290100097656],"type":"scatter"}],"name":"17"},{"data":[{"hoverinfo":"skip","line":{"color":"gray","width":2},"mode":"lines","x":[-2.713914909691084e-06,0.8561386466026306,null,0.8561386466026306,2.0,null,2.0,3.1438612937927246,null,3.1438612937927246,4.000002861022949,null,-2.30866339734348e-06,0.8586182594299316,null,0.8586182594299316,2.0,null,2.0,3.1413817405700684,null,3.1413817405700684,4.000002384185791,null,-2.0022223452542676e-06,0.863173246383667,null,0.863173246383667,2.0,null,2.0,3.136826753616333,null,3.136826753616333,4.000001907348633,null,-1.975637360374094e-06,0.8675175309181213,null,0.8675175309181213,2.0,null,2.0,3.1324822902679443,null,3.1324822902679443,4.000001907348633,null,-2.713914909691084e-06,-2.30866339734348e-06,null,0.8561386466026306,0.8586182594299316,null,2.0,2.0,null,3.1438612937927246,3.1413817405700684,null,4.000002861022949,4.000002384185791,null,-2.30866339734348e-06,-2.0022223452542676e-06,null,0.8586182594299316,0.863173246383667,null,2.0,2.0,null,3.1413817405700684,3.136826753616333,null,4.000002384185791,4.000001907348633,null,-2.0022223452542676e-06,-1.975637360374094e-06,null,0.863173246383667,0.8675175309181213,null,2.0,2.0,null,3.136826753616333,3.1324822902679443,null,4.000001907348633,4.000001907348633,null],"y":[-1.64018467785354e-06,-1.0038822889328003,null,-1.0038822889328003,-1.4241926670074463,null,-1.4241926670074463,-1.0038822889328003,null,-1.0038822889328003,-1.6404617326770676e-06,null,-1.0000039339065552,-1.9884521961212158,null,-1.9884521961212158,-2.401500701904297,null,-2.401500701904297,-1.9884521961212158,null,-1.9884521961212158,-1.0000039339065552,null,-2.0000035762786865,-2.9663174152374268,null,-2.9663174152374268,-3.3728206157684326,null,-3.3728206157684326,-2.9663174152374268,null,-2.9663174152374268,-2.0000035762786865,null,-3.0000011920928955,-3.9478368759155273,null,-3.9478368759155273,-4.351308345794678,null,-4.351308345794678,-3.9478368759155273,null,-3.9478368759155273,-3.0000011920928955,null,-1.64018467785354e-06,-1.0000039339065552,null,-1.0038822889328003,-1.9884521961212158,null,-1.4241926670074463,-2.401500701904297,null,-1.0038822889328003,-1.9884521961212158,null,-1.6404617326770676e-06,-1.0000039339065552,null,-1.0000039339065552,-2.0000035762786865,null,-1.9884521961212158,-2.9663174152374268,null,-2.401500701904297,-3.3728206157684326,null,-1.9884521961212158,-2.9663174152374268,null,-1.0000039339065552,-2.0000035762786865,null,-2.0000035762786865,-3.0000011920928955,null,-2.9663174152374268,-3.9478368759155273,null,-3.3728206157684326,-4.351308345794678,null,-2.9663174152374268,-3.9478368759155273,null,-2.0000035762786865,-3.0000011920928955,null],"type":"scatter"},{"marker":{"color":"crimson","size":12},"mode":"markers","x":[-2.713914909691084e-06,4.000002861022949,-2.30866339734348e-06,4.000002384185791,-2.0022223452542676e-06,4.000001907348633,-1.975637360374094e-06,4.000001907348633],"y":[-1.64018467785354e-06,-1.6404617326770676e-06,-1.0000039339065552,-1.0000039339065552,-2.0000035762786865,-2.0000035762786865,-3.0000011920928955,-3.0000011920928955],"type":"scatter"},{"marker":{"color":"steelblue","size":10},"mode":"markers","x":[0.8561386466026306,2.0,3.1438612937927246,0.8586182594299316,2.0,3.1413817405700684,0.863173246383667,2.0,3.136826753616333,0.8675175309181213,2.0,3.1324822902679443],"y":[-1.0038822889328003,-1.4241926670074463,-1.0038822889328003,-1.9884521961212158,-2.401500701904297,-1.9884521961212158,-2.9663174152374268,-3.3728206157684326,-2.9663174152374268,-3.9478368759155273,-4.351308345794678,-3.9478368759155273],"type":"scatter"}],"name":"18"},{"data":[{"hoverinfo":"skip","line":{"color":"gray","width":2},"mode":"lines","x":[-2.9274781354615698e-06,0.8497791290283203,null,0.8497791290283203,2.0,null,2.0,3.1502208709716797,null,3.1502208709716797,4.000002861022949,null,-2.6144355160795385e-06,0.8524062633514404,null,0.8524062633514404,2.0,null,2.0,3.1475937366485596,null,3.1475937366485596,4.000002384185791,null,-2.3275451894733123e-06,0.8571575880050659,null,0.8571575880050659,2.0,null,2.0,3.1428422927856445,null,3.1428422927856445,4.000002384185791,null,-2.2628439637628617e-06,0.8617047071456909,null,0.8617047071456909,2.000000238418579,null,2.000000238418579,3.1382954120635986,null,3.1382954120635986,4.000002384185791,null,-2.9274781354615698e-06,-2.6144355160795385e-06,null,0.8497791290283203,0.8524062633514404,null,2.0,2.0,null,3.1502208709716797,3.1475937366485596,null,4.000002861022949,4.000002384185791,null,-2.6144355160795385e-06,-2.3275451894733123e-06,null,0.8524062633514404,0.8571575880050659,null,2.0,2.0,null,3.1475937366485596,3.1428422927856445,null,4.000002384185791,4.000002384185791,null,-2.3275451894733123e-06,-2.2628439637628617e-06,null,0.8571575880050659,0.8617047071456909,null,2.0,2.000000238418579,null,3.1428422927856445,3.1382954120635986,null,4.000002384185791,4.000002384185791,null],"y":[-1.3368824056669837e-06,-1.0449615716934204,null,-1.0449615716934204,-1.4873411655426025,null,-1.4873411655426025,-1.0449615716934204,null,-1.0449615716934204,-1.337007233814802e-06,null,-1.000003457069397,-2.0279436111450195,null,-2.0279436111450195,-2.462390661239624,null,-2.462390661239624,-2.0279436111450195,null,-2.0279436111450195,-1.000003457069397,null,-2.0000030994415283,-3.0038697719573975,null,-3.0038697719573975,-3.4308533668518066,null,-3.4308533668518066,-3.0038697719573975,null,-3.0038697719573975,-2.0000030994415283,null,-3.0000009536743164,-3.983868360519409,null,-3.983868360519409,-4.407225608825684,null,-4.407225608825684,-3.9838685989379883,null,-3.9838685989379883,-3.0000009536743164,null,-1.3368824056669837e-06,-1.000003457069397,null,-1.0449615716934204,-2.0279436111450195,null,-1.4873411655426025,-2.462390661239624,null,-1.0449615716934204,-2.0279436111450195,null,-1.337007233814802e-06,-1.000003457069397,null,-1.000003457069397,-2.0000030994415283,null,-2.0279436111450195,-3.0038697719573975,null,-2.462390661239624,-3.4308533668518066,null,-2.0279436111450195,-3.0038697719573975,null,-1.000003457069397,-2.0000030994415283,null,-2.0000030994415283,-3.0000009536743164,null,-3.0038697719573975,-3.983868360519409,null,-3.4308533668518066,-4.407225608825684,null,-3.0038697719573975,-3.9838685989379883,null,-2.0000030994415283,-3.0000009536743164,null],"type":"scatter"},{"marker":{"color":"crimson","size":12},"mode":"markers","x":[-2.9274781354615698e-06,4.000002861022949,-2.6144355160795385e-06,4.000002384185791,-2.3275451894733123e-06,4.000002384185791,-2.2628439637628617e-06,4.000002384185791],"y":[-1.3368824056669837e-06,-1.337007233814802e-06,-1.000003457069397,-1.000003457069397,-2.0000030994415283,-2.0000030994415283,-3.0000009536743164,-3.0000009536743164],"type":"scatter"},{"marker":{"color":"steelblue","size":10},"mode":"markers","x":[0.8497791290283203,2.0,3.1502208709716797,0.8524062633514404,2.0,3.1475937366485596,0.8571575880050659,2.0,3.1428422927856445,0.8617047071456909,2.000000238418579,3.1382954120635986],"y":[-1.0449615716934204,-1.4873411655426025,-1.0449615716934204,-2.0279436111450195,-2.462390661239624,-2.0279436111450195,-3.0038697719573975,-3.4308533668518066,-3.0038697719573975,-3.983868360519409,-4.407225608825684,-3.9838685989379883],"type":"scatter"}],"name":"19"}]);
                        })                };            </script>        </div></div></div>
</div>
<p>The animation shows how the spring network relaxes as gravity is progressively applied. Starting from the regular grid (0% gravity), the interior points sag downward until reaching the final equilibrium (100% gravity).</p>
<p>When to use each construction approach:</p>
<ul class="simple">
<li><p>Naive: Simpler code, good for prototyping and small problems</p></li>
<li><p>Batched: Faster problem analysis, essential for large-scale problems</p></li>
</ul>
<p>For more details, see <a class="reference internal" href="../../../api/core/#jaxls.Var" title="jaxls.Var"><code class="xref py py-class docutils literal notranslate"><span class="pre">jaxls.Var</span></code></a>, <a class="reference internal" href="../../../api/core/#jaxls.Cost" title="jaxls.Cost"><code class="xref py py-class docutils literal notranslate"><span class="pre">jaxls.Cost</span></code></a>, and <a class="reference internal" href="../../../api/core/#jaxls.LeastSquaresProblem" title="jaxls.LeastSquaresProblem"><code class="xref py py-class docutils literal notranslate"><span class="pre">jaxls.LeastSquaresProblem</span></code></a>.</p>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../cloth_draping/">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Cloth draping</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="../">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Mechanics</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2025
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              <a class="muted-link " href="https://github.com/brentyi/jaxls" aria-label="GitHub">
            <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16">
                <path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"></path>
            </svg>
        </a>
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Spring equilibrium</a><ul>
<li><a class="reference internal" href="#variables-and-costs">Variables and costs</a></li>
<li><a class="reference internal" href="#problem-setup">Problem setup</a></li>
<li><a class="reference internal" href="#approach-1-naive-construction">Approach 1: naive construction</a></li>
<li><a class="reference internal" href="#approach-2-batched-construction">Approach 2: batched construction</a></li>
<li><a class="reference internal" href="#solving">Solving</a></li>
<li><a class="reference internal" href="#visualization">Visualization</a></li>
<li><a class="reference internal" href="#relaxation-animation">Relaxation animation</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../../../_static/documentation_options.js?v=187304be"></script>
    <script src="../../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/scripts/furo.js?v=46bd48cc"></script>
    <script src="../../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../../_static/copybutton.js?v=fd10adb8"></script>
    </body>
</html>