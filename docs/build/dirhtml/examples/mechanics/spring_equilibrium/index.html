<!doctype html>
<html class="no-js" lang="en" data-content_root="../../../">
  <head><meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../../../genindex/"><link rel="search" title="Search" href="../../../search/"><link rel="next" title="Cloth Simulation" href="../cloth_simulation/"><link rel="prev" title="Mechanics" href="../">

    <!-- Generated with Sphinx 8.1.3 and Furo 2025.12.19 -->
        <title>Spring Equilibrium - jaxls</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=b86133f3" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/furo.css?v=7bdb33bb" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css?v=6644e6bb" />
    <link rel="stylesheet" type="text/css" href="../../../_static/css/custom.css?v=6517d2d4" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/furo-extensions.css?v=8dab3a3b" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  --color-code-background: #f4f4f4;
  --color-code-foreground: #000;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle site navigation sidebar">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc" aria-label="Toggle table of contents sidebar">
<label class="overlay sidebar-overlay" for="__navigation"></label>
<label class="overlay toc-overlay" for="__toc"></label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <span class="icon"><svg><use href="#svg-menu"></use></svg></span>
      </label>
    </div>
    <div class="header-center">
      <a href="../../../"><div class="brand">jaxls</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a
  class="sidebar-brand"
  href="../../../"
  style="margin-top: 0.75em"
>
  
  <span class="sidebar-brand-text">jaxls</span>

  
</a>

<div style="text-align: left; padding: 0 1em 1em 1em">
  <a href="https://github.com/brentyi/jaxls">
    <img src="https://img.shields.io/github/stars/brentyi/jaxls?style=social" alt="GitHub stars">
  </a>
</div><form class="sidebar-search-container" method="get" action="../../../search/" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../guide/basics/">Basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../guide/tips_and_gotchas/">Tips and Gotchas</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../guide/advanced/">Advanced</a><input aria-label="Toggle navigation of Advanced" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../guide/advanced/non_euclidean/">Non-Euclidean variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../guide/advanced/custom_jacobians/">Custom Jacobians</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../guide/advanced/constraints/">Constraints</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../guide/advanced/robust_costs/">Robust costs</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Examples</span></p>
<ul class="current">
<li class="toctree-l1 current has-children"><a class="reference internal" href="../">Mechanics</a><input aria-label="Toggle navigation of Mechanics" checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul class="current">
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">Spring Equilibrium</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cloth_simulation/">Cloth Simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../beam_bending/">Beam Bending</a></li>
<li class="toctree-l2"><a class="reference internal" href="../truss_analysis/">Truss Analysis</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../vision/">Perception</a><input aria-label="Toggle navigation of Perception" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../vision/camera_calibration/">Camera calibration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../vision/pose_graph_2d/">SE(2) pose graph</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../vision/pose_graph_3d/">SE(3) pose graph</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../vision/bundle_adjustment/">Bundle adjustment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../vision/imu_sensor_fusion/">IMU fusion + calibration</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../robotics/">Robotics</a><input aria-label="Toggle navigation of Robotics" class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../robotics/inverse_kinematics/">Inverse Kinematics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../robotics/obstacle_avoidance/">Obstacle Avoidance</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../robotics/cart_pole_collocation/">Cart-Pole (Collocation)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../robotics/cart_pole_shooting/">Cart-Pole (Shooting)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../robotics/cam_design/">Cam profile optimization</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../portfolio/">Portfolio Optimization</a><input aria-label="Toggle navigation of Portfolio Optimization" class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../portfolio/mean_variance/">Mean-Variance Allocation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../portfolio/manifold_allocation/">Manifold Allocation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../portfolio/reparameterized_allocation/">Reparameterized Allocation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../portfolio/cvar_optimization/">CVaR Allocation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../portfolio/black_litterman/">Black-Litterman Allocation</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../api/core/">Core API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/lie_group_variables/">Lie Group Variables</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/solver_config/">Solver Configuration</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Design Notes</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../design/typed_api/">Typed API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../design/sparse_matrices/">Sparse matrices</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../design/traced_vs_static/">What’s traced?</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="../../../_sources/examples/mechanics/spring_equilibrium.ipynb.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section class="tex2jax_ignore mathjax_ignore" id="spring-equilibrium">
<h1>Spring Equilibrium<a class="headerlink" href="#spring-equilibrium" title="Link to this heading">¶</a></h1>
<p>Finding the equilibrium of a spring network under gravity with fixed anchor points.</p>
<p>Features used:</p>
<ul class="simple">
<li><p><a class="reference internal" href="../../../api/core/#jaxls.Var" title="jaxls.Var"><code class="xref py py-class docutils literal notranslate"><span class="pre">Var</span></code></a> subclassing for custom variable types</p></li>
<li><p><a class="reference internal" href="../../../api/core/#jaxls.Cost.factory" title="jaxls.Cost.factory"><code class="xref py py-func docutils literal notranslate"><span class="pre">&#64;jaxls.Cost.factory</span></code></a> for defining costs</p></li>
<li><p>Equality constraints (<code class="docutils literal notranslate"><span class="pre">constraint_eq_zero</span></code>) for anchoring points</p></li>
<li><p>Augmented Lagrangian solver for constrained optimization</p></li>
</ul>
<p>We show two approaches:</p>
<ol class="arabic simple">
<li><p>Naive construction: Build variables and costs one-by-one (simple but slower)</p></li>
<li><p>Batched construction: Use array operations for efficiency (recommended for large problems)</p></li>
</ol>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">loguru</span><span class="w"> </span><span class="kn">import</span> <span class="n">logger</span>

<span class="n">logger</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
<span class="n">logger</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;&lt;level&gt;</span><span class="si">{level: &lt;8}</span><span class="s2">&lt;/level&gt; | </span><span class="si">{message}</span><span class="s2">&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">jax</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">jax.numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">jnp</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">jaxls</span>
</pre></div>
</div>
</div>
</div>
<section id="variables-and-costs">
<h2>Variables and costs<a class="headerlink" href="#variables-and-costs" title="Link to this heading">¶</a></h2>
<p>Variables represent the unknowns we want to solve for. We define a custom 2D point variable by subclassing <code class="docutils literal notranslate"><span class="pre">jaxls.Var</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">Point2Var</span><span class="p">(</span><span class="n">jaxls</span><span class="o">.</span><span class="n">Var</span><span class="p">[</span><span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">],</span> <span class="n">default_factory</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">2</span><span class="p">)):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A 2D point variable.&quot;&quot;&quot;</span>
</pre></div>
</div>
</div>
</div>
<p>Cost functions define what we’re optimizing. Use <a class="reference internal" href="../../../api/core/#jaxls.Cost.factory" title="jaxls.Cost.factory"><code class="xref py py-func docutils literal notranslate"><span class="pre">&#64;jaxls.Cost.factory</span></code></a> to create cost factories.</p>
<p>A cost function takes a <a class="reference internal" href="../../../api/core/#jaxls.VarValues" title="jaxls.VarValues"><code class="xref py py-class docutils literal notranslate"><span class="pre">VarValues</span></code></a> object (for looking up variable values) plus any arguments, and returns a residual vector to minimize or constrain.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@jaxls</span><span class="o">.</span><span class="n">Cost</span><span class="o">.</span><span class="n">factory</span>
<span class="k">def</span><span class="w"> </span><span class="nf">spring_cost</span><span class="p">(</span>
    <span class="n">vals</span><span class="p">:</span> <span class="n">jaxls</span><span class="o">.</span><span class="n">VarValues</span><span class="p">,</span>
    <span class="n">var_a</span><span class="p">:</span> <span class="n">Point2Var</span><span class="p">,</span>
    <span class="n">var_b</span><span class="p">:</span> <span class="n">Point2Var</span><span class="p">,</span>
    <span class="n">rest_length</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Penalize deviation from rest length.&quot;&quot;&quot;</span>
    <span class="n">diff</span> <span class="o">=</span> <span class="n">vals</span><span class="p">[</span><span class="n">var_a</span><span class="p">]</span> <span class="o">-</span> <span class="n">vals</span><span class="p">[</span><span class="n">var_b</span><span class="p">]</span>
    <span class="n">length</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">diff</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1e-6</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">length</span> <span class="o">-</span> <span class="n">rest_length</span>


<span class="nd">@jaxls</span><span class="o">.</span><span class="n">Cost</span><span class="o">.</span><span class="n">factory</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s2">&quot;constraint_eq_zero&quot;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">anchor_constraint</span><span class="p">(</span>
    <span class="n">vals</span><span class="p">:</span> <span class="n">jaxls</span><span class="o">.</span><span class="n">VarValues</span><span class="p">,</span>
    <span class="n">var</span><span class="p">:</span> <span class="n">Point2Var</span><span class="p">,</span>
    <span class="n">target</span><span class="p">:</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Pin a point to a target position (hard constraint).&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">vals</span><span class="p">[</span><span class="n">var</span><span class="p">]</span> <span class="o">-</span> <span class="n">target</span>


<span class="nd">@jaxls</span><span class="o">.</span><span class="n">Cost</span><span class="o">.</span><span class="n">factory</span>
<span class="k">def</span><span class="w"> </span><span class="nf">gravity_cost</span><span class="p">(</span>
    <span class="n">vals</span><span class="p">:</span> <span class="n">jaxls</span><span class="o">.</span><span class="n">VarValues</span><span class="p">,</span>
    <span class="n">var</span><span class="p">:</span> <span class="n">Point2Var</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Pull points downward.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">vals</span><span class="p">[</span><span class="n">var</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mf">10.0</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.15</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="problem-setup">
<h2>Problem setup<a class="headerlink" href="#problem-setup" title="Link to this heading">¶</a></h2>
<p>We’ll create a 5x4 grid of points. The left and right columns will be anchored, and springs connect adjacent points:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Grid dimensions.</span>
<span class="n">cols</span><span class="p">,</span> <span class="n">rows</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">4</span>
<span class="n">num_points</span> <span class="o">=</span> <span class="n">cols</span> <span class="o">*</span> <span class="n">rows</span>
<span class="n">spacing</span> <span class="o">=</span> <span class="mf">1.0</span>


<span class="k">def</span><span class="w"> </span><span class="nf">idx</span><span class="p">(</span><span class="n">row</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">col</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert (row, col) to flat index.</span>

<span class="sd">    Args:</span>
<span class="sd">        row: Row index</span>
<span class="sd">        col: Column index</span>

<span class="sd">    Returns:</span>
<span class="sd">        Flat index into the points array</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">row</span> <span class="o">*</span> <span class="n">cols</span> <span class="o">+</span> <span class="n">col</span>


<span class="c1"># Initial positions (regular grid)</span>
<span class="n">initial_positions</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
    <span class="p">[[</span><span class="n">c</span> <span class="o">*</span> <span class="n">spacing</span><span class="p">,</span> <span class="o">-</span><span class="n">r</span> <span class="o">*</span> <span class="n">spacing</span><span class="p">]</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">rows</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">cols</span><span class="p">)]</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Grid: </span><span class="si">{</span><span class="n">cols</span><span class="si">}</span><span class="s2">x</span><span class="si">{</span><span class="n">rows</span><span class="si">}</span><span class="s2"> = </span><span class="si">{</span><span class="n">num_points</span><span class="si">}</span><span class="s2"> points&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Grid: 5x4 = 20 points
</pre></div>
</div>
</div>
</div>
</section>
<section id="approach-1-naive-construction">
<h2>Approach 1: Naive construction<a class="headerlink" href="#approach-1-naive-construction" title="Link to this heading">¶</a></h2>
<p>The straightforward approach: create variables and costs one-by-one using Python loops.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create variables for each grid point.</span>
<span class="n">point_vars_naive</span> <span class="o">=</span> <span class="p">{</span>
    <span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span> <span class="n">Point2Var</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">idx</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">))</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">rows</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">costs_naive</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">jaxls</span><span class="o">.</span><span class="n">Cost</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># Anchor the left and right columns.</span>
<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">rows</span><span class="p">):</span>
    <span class="n">costs_naive</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
        <span class="n">anchor_constraint</span><span class="p">(</span><span class="n">point_vars_naive</span><span class="p">[(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">)],</span> <span class="n">initial_positions</span><span class="p">[</span><span class="n">idx</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">)])</span>
    <span class="p">)</span>
    <span class="n">costs_naive</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
        <span class="n">anchor_constraint</span><span class="p">(</span>
            <span class="n">point_vars_naive</span><span class="p">[(</span><span class="n">row</span><span class="p">,</span> <span class="n">cols</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)],</span> <span class="n">initial_positions</span><span class="p">[</span><span class="n">idx</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">cols</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)]</span>
        <span class="p">)</span>
    <span class="p">)</span>

<span class="c1"># Horizontal springs.</span>
<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">rows</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">cols</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">costs_naive</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">spring_cost</span><span class="p">(</span>
                <span class="n">point_vars_naive</span><span class="p">[(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">)],</span> <span class="n">point_vars_naive</span><span class="p">[(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)],</span> <span class="n">spacing</span>
            <span class="p">)</span>
        <span class="p">)</span>

<span class="c1"># Vertical springs.</span>
<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">rows</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">cols</span><span class="p">):</span>
        <span class="n">costs_naive</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">spring_cost</span><span class="p">(</span>
                <span class="n">point_vars_naive</span><span class="p">[(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">)],</span> <span class="n">point_vars_naive</span><span class="p">[(</span><span class="n">row</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">col</span><span class="p">)],</span> <span class="n">spacing</span>
            <span class="p">)</span>
        <span class="p">)</span>

<span class="c1"># Gravity on non-anchor points.</span>
<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">rows</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">cols</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">costs_naive</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">gravity_cost</span><span class="p">(</span><span class="n">point_vars_naive</span><span class="p">[(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">)]))</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Naive: Created </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">costs_naive</span><span class="p">)</span><span class="si">}</span><span class="s2"> cost objects&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Naive: Created 51 cost objects
</pre></div>
</div>
</div>
</div>
</section>
<section id="approach-2-batched-construction">
<h2>Approach 2: Batched construction<a class="headerlink" href="#approach-2-batched-construction" title="Link to this heading">¶</a></h2>
<p>When variable IDs have a leading batch axis, a batch of costs is created in one call. This reduces Python overhead and speeds up problem analysis.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create ALL point variables at once with batched IDs.</span>
<span class="n">all_point_vars</span> <span class="o">=</span> <span class="n">Point2Var</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">num_points</span><span class="p">))</span>

<span class="c1"># Precompute index arrays.</span>
<span class="n">anchor_indices</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">idx</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">rows</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">cols</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]])</span>
<span class="n">anchor_positions</span> <span class="o">=</span> <span class="n">initial_positions</span><span class="p">[</span><span class="n">anchor_indices</span><span class="p">]</span>

<span class="n">h_spring_a</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">idx</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">rows</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">cols</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)])</span>
<span class="n">h_spring_b</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">idx</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">c</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">rows</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">cols</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)])</span>

<span class="n">v_spring_a</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">idx</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">rows</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">cols</span><span class="p">)])</span>
<span class="n">v_spring_b</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">idx</span><span class="p">(</span><span class="n">r</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">rows</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">cols</span><span class="p">)])</span>

<span class="n">interior_indices</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
    <span class="p">[</span><span class="n">idx</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">rows</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">cols</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)]</span>
<span class="p">)</span>

<span class="c1"># Create all costs using batched construction (4 calls instead of 51!)</span>
<span class="n">costs_batched</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">jaxls</span><span class="o">.</span><span class="n">Cost</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">anchor_constraint</span><span class="p">(</span><span class="n">Point2Var</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">anchor_indices</span><span class="p">),</span> <span class="n">anchor_positions</span><span class="p">),</span>
    <span class="n">spring_cost</span><span class="p">(</span><span class="n">Point2Var</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">h_spring_a</span><span class="p">),</span> <span class="n">Point2Var</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">h_spring_b</span><span class="p">),</span> <span class="n">spacing</span><span class="p">),</span>
    <span class="n">spring_cost</span><span class="p">(</span><span class="n">Point2Var</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">v_spring_a</span><span class="p">),</span> <span class="n">Point2Var</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">v_spring_b</span><span class="p">),</span> <span class="n">spacing</span><span class="p">),</span>
    <span class="n">gravity_cost</span><span class="p">(</span><span class="n">Point2Var</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">interior_indices</span><span class="p">)),</span>
<span class="p">]</span>

<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;Batched: Created </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">costs_batched</span><span class="p">)</span><span class="si">}</span><span class="s2"> cost objects (representing 51 individual costs)&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Batched: Created 4 cost objects (representing 51 individual costs)
</pre></div>
</div>
</div>
</div>
</section>
<section id="solving">
<h2>Solving<a class="headerlink" href="#solving" title="Link to this heading">¶</a></h2>
<p>Both approaches produce identical results. We’ll use the batched version:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create initial values.</span>
<span class="n">initial_vals</span> <span class="o">=</span> <span class="n">jaxls</span><span class="o">.</span><span class="n">VarValues</span><span class="o">.</span><span class="n">make</span><span class="p">([</span><span class="n">all_point_vars</span><span class="o">.</span><span class="n">with_value</span><span class="p">(</span><span class="n">initial_positions</span><span class="p">)])</span>

<span class="c1"># Build and solve.</span>
<span class="n">problem</span> <span class="o">=</span> <span class="n">jaxls</span><span class="o">.</span><span class="n">LeastSquaresProblem</span><span class="p">(</span><span class="n">costs_batched</span><span class="p">,</span> <span class="p">[</span><span class="n">all_point_vars</span><span class="p">])</span><span class="o">.</span><span class="n">analyze</span><span class="p">()</span>
<span class="n">solution</span> <span class="o">=</span> <span class="n">problem</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">initial_vals</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Bold">INFO    </span> | Building optimization problem with 51 terms and 20 variables: 43 costs, 8 eq_zero, 0 leq_zero, 0 geq_zero
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing constraint group with 8 constraints (constraint_eq_zero), 1 variables each: augmented_anchor_constraint
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 31 costs, 2 variables each: spring_cost
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 12 costs, 1 variables each: gravity_cost
<span class=" -Color -Color-Bold">INFO    </span> | Augmented Lagrangian: initial snorm=0.0000e+00, csupn=0.0000e+00, max_rho=1.9845e+02, constraint_dim=16
<span class=" -Color -Color-Bold">INFO    </span> |  step #1: cost=19.8450 lambd=0.0005 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_anchor_constraint(8): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - spring_cost(31): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - gravity_cost(12): 19.84501 (avg 1.65375)
<span class=" -Color -Color-Bold">INFO    </span> |  step #2: cost=19.8450 lambd=0.0010 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_anchor_constraint(8): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - spring_cost(31): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - gravity_cost(12): 19.84501 (avg 1.65375)
<span class=" -Color -Color-Bold">INFO    </span> |  step #3: cost=19.8450 lambd=0.0020 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_anchor_constraint(8): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - spring_cost(31): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - gravity_cost(12): 19.84501 (avg 1.65375)
<span class=" -Color -Color-Bold">INFO    </span> |  step #4: cost=19.8450 lambd=0.0040 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_anchor_constraint(8): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - spring_cost(31): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - gravity_cost(12): 19.84501 (avg 1.65375)
<span class=" -Color -Color-Bold">INFO    </span> |  step #5: cost=19.8450 lambd=0.0080 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_anchor_constraint(8): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - spring_cost(31): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - gravity_cost(12): 19.84501 (avg 1.65375)
<span class=" -Color -Color-Bold">INFO    </span> |  step #6: cost=19.8450 lambd=0.0160 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_anchor_constraint(8): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - spring_cost(31): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - gravity_cost(12): 19.84501 (avg 1.65375)
<span class=" -Color -Color-Bold">INFO    </span> |  step #7: cost=19.8450 lambd=0.0320 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_anchor_constraint(8): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - spring_cost(31): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - gravity_cost(12): 19.84501 (avg 1.65375)
<span class=" -Color -Color-Bold">INFO    </span> |  step #8: cost=19.8450 lambd=0.0640 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_anchor_constraint(8): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - spring_cost(31): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - gravity_cost(12): 19.84501 (avg 1.65375)
<span class=" -Color -Color-Bold">INFO    </span> |  step #9: cost=19.8450 lambd=0.1280 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_anchor_constraint(8): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - spring_cost(31): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - gravity_cost(12): 19.84501 (avg 1.65375)
<span class=" -Color -Color-Bold">INFO    </span> |  step #10: cost=19.8450 lambd=0.2560 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_anchor_constraint(8): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - spring_cost(31): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - gravity_cost(12): 19.84501 (avg 1.65375)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=9.73e-01 cost_prev=19.8450 cost_new=17.7450
<span class=" -Color -Color-Bold">INFO    </span> |  AL update: snorm=4.9107e-10, csupn=4.9107e-10, max_rho=1.9845e+02, al_update=False
<span class=" -Color -Color-Bold">INFO    </span> |  step #11: cost=17.7450 lambd=0.1280 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_anchor_constraint(8): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - spring_cost(31): 3.55096 (avg 0.11455)
<span class=" -Color -Color-Bold">INFO    </span> |      - gravity_cost(12): 14.19406 (avg 1.18284)
<span class=" -Color -Color-Bold">INFO    </span> |  step #12: cost=17.7450 lambd=0.2560 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_anchor_constraint(8): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - spring_cost(31): 3.55096 (avg 0.11455)
<span class=" -Color -Color-Bold">INFO    </span> |      - gravity_cost(12): 14.19406 (avg 1.18284)
<span class=" -Color -Color-Bold">INFO    </span> |  step #13: cost=17.7450 lambd=0.5120 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_anchor_constraint(8): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - spring_cost(31): 3.55096 (avg 0.11455)
<span class=" -Color -Color-Bold">INFO    </span> |      - gravity_cost(12): 14.19406 (avg 1.18284)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=3.02e+00 cost_prev=17.7450 cost_new=16.9790
<span class=" -Color -Color-Bold">INFO    </span> |  AL update: snorm=1.3649e-03, csupn=1.3649e-03, max_rho=1.9845e+02, al_update=False
<span class=" -Color -Color-Bold">INFO    </span> |  step #14: cost=16.9751 lambd=0.2560 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_anchor_constraint(8): 0.00390 (avg 0.00024)
<span class=" -Color -Color-Bold">INFO    </span> |      - spring_cost(31): 2.66078 (avg 0.08583)
<span class=" -Color -Color-Bold">INFO    </span> |      - gravity_cost(12): 14.31436 (avg 1.19286)
<span class=" -Color -Color-Bold">INFO    </span> |  step #15: cost=16.9751 lambd=0.5120 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_anchor_constraint(8): 0.00390 (avg 0.00024)
<span class=" -Color -Color-Bold">INFO    </span> |      - spring_cost(31): 2.66078 (avg 0.08583)
<span class=" -Color -Color-Bold">INFO    </span> |      - gravity_cost(12): 14.31436 (avg 1.19286)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=1.80e+00 cost_prev=16.9790 cost_new=16.5303
<span class=" -Color -Color-Bold">INFO    </span> |  AL update: snorm=1.3858e-03, csupn=1.3858e-03, max_rho=1.9845e+02, al_update=False
<span class=" -Color -Color-Bold">INFO    </span> |  step #16: cost=16.5258 lambd=0.2560 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_anchor_constraint(8): 0.00455 (avg 0.00028)
<span class=" -Color -Color-Bold">INFO    </span> |      - spring_cost(31): 2.14423 (avg 0.06917)
<span class=" -Color -Color-Bold">INFO    </span> |      - gravity_cost(12): 14.38154 (avg 1.19846)
<span class=" -Color -Color-Bold">INFO    </span> |  step #17: cost=16.5258 lambd=0.5120 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_anchor_constraint(8): 0.00455 (avg 0.00028)
<span class=" -Color -Color-Bold">INFO    </span> |      - spring_cost(31): 2.14423 (avg 0.06917)
<span class=" -Color -Color-Bold">INFO    </span> |      - gravity_cost(12): 14.38154 (avg 1.19846)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=8.48e-01 cost_prev=16.5303 cost_new=16.3810
<span class=" -Color -Color-Bold">INFO    </span> |  AL update: snorm=1.4165e-03, csupn=1.4165e-03, max_rho=7.9380e+02, al_update=True
<span class=" -Color -Color-Bold">INFO    </span> |  step #18: cost=16.3774 lambd=0.2560 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_anchor_constraint(8): 0.02301 (avg 0.00144)
<span class=" -Color -Color-Bold">INFO    </span> |      - spring_cost(31): 1.76783 (avg 0.05703)
<span class=" -Color -Color-Bold">INFO    </span> |      - gravity_cost(12): 14.60952 (avg 1.21746)
<span class=" -Color -Color-Bold">INFO    </span> |  step #19: cost=16.3774 lambd=0.5120 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_anchor_constraint(8): 0.02301 (avg 0.00144)
<span class=" -Color -Color-Bold">INFO    </span> |      - spring_cost(31): 1.76783 (avg 0.05703)
<span class=" -Color -Color-Bold">INFO    </span> |      - gravity_cost(12): 14.60952 (avg 1.21746)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=3.65e+00 cost_prev=16.4004 cost_new=16.3862
<span class=" -Color -Color-Bold">INFO    </span> |  AL update: snorm=1.1158e-04, csupn=1.1158e-04, max_rho=1.9845e+02, al_update=True
<span class=" -Color -Color-Bold">INFO    </span> |  step #20: cost=16.3851 lambd=0.2560 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_anchor_constraint(8): 0.00468 (avg 0.00029)
<span class=" -Color -Color-Bold">INFO    </span> |      - spring_cost(31): 1.84823 (avg 0.05962)
<span class=" -Color -Color-Bold">INFO    </span> |      - gravity_cost(12): 14.53683 (avg 1.21140)
<span class=" -Color -Color-Bold">INFO    </span> |  step #21: cost=16.3851 lambd=0.5120 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_anchor_constraint(8): 0.00468 (avg 0.00029)
<span class=" -Color -Color-Bold">INFO    </span> |      - spring_cost(31): 1.84823 (avg 0.05962)
<span class=" -Color -Color-Bold">INFO    </span> |      - gravity_cost(12): 14.53683 (avg 1.21140)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=6.73e-01 cost_prev=16.3897 cost_new=16.3660
<span class=" -Color -Color-Bold">INFO    </span> |  AL update: snorm=3.8242e-04, csupn=3.8242e-04, max_rho=7.9380e+02, al_update=True
<span class=" -Color -Color-Bold">INFO    </span> |  step #22: cost=16.3623 lambd=0.2560 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_anchor_constraint(8): 0.00120 (avg 0.00008)
<span class=" -Color -Color-Bold">INFO    </span> |      - spring_cost(31): 1.67779 (avg 0.05412)
<span class=" -Color -Color-Bold">INFO    </span> |      - gravity_cost(12): 14.68450 (avg 1.22371)
<span class=" -Color -Color-Bold">INFO    </span> |  step #23: cost=16.3623 lambd=0.5120 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_anchor_constraint(8): 0.00120 (avg 0.00008)
<span class=" -Color -Color-Bold">INFO    </span> |      - spring_cost(31): 1.67779 (avg 0.05412)
<span class=" -Color -Color-Bold">INFO    </span> |      - gravity_cost(12): 14.68450 (avg 1.22371)
<span class=" -Color -Color-Bold">INFO    </span> |  step #24: cost=16.3623 lambd=1.0240 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_anchor_constraint(8): 0.00120 (avg 0.00008)
<span class=" -Color -Color-Bold">INFO    </span> |      - spring_cost(31): 1.67779 (avg 0.05412)
<span class=" -Color -Color-Bold">INFO    </span> |      - gravity_cost(12): 14.68450 (avg 1.22371)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=1.30e+00 cost_prev=16.3635 cost_new=16.1708
<span class=" -Color -Color-Bold">INFO    </span> |  AL update: snorm=1.0186e-04, csupn=1.0186e-04, max_rho=7.9380e+02, al_update=False
<span class=" -Color -Color-Bold">INFO    </span> |  step #25: cost=16.1696 lambd=0.5120 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_anchor_constraint(8): 0.00116 (avg 0.00007)
<span class=" -Color -Color-Bold">INFO    </span> |      - spring_cost(31): 1.50068 (avg 0.04841)
<span class=" -Color -Color-Bold">INFO    </span> |      - gravity_cost(12): 14.66897 (avg 1.22241)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=1.92e-01 cost_prev=16.1708 cost_new=16.1539
<span class=" -Color -Color-Bold">INFO    </span> |  AL update: snorm=6.1035e-05, csupn=6.1035e-05, max_rho=7.9380e+02, al_update=True
<span class=" -Color -Color-Bold">INFO    </span> |  step #26: cost=16.1528 lambd=0.2560 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_anchor_constraint(8): 0.00133 (avg 0.00008)
<span class=" -Color -Color-Bold">INFO    </span> |      - spring_cost(31): 1.31761 (avg 0.04250)
<span class=" -Color -Color-Bold">INFO    </span> |      - gravity_cost(12): 14.83516 (avg 1.23626)
<span class=" -Color -Color-Bold">INFO    </span> |  step #27: cost=16.1528 lambd=0.5120 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_anchor_constraint(8): 0.00133 (avg 0.00008)
<span class=" -Color -Color-Bold">INFO    </span> |      - spring_cost(31): 1.31761 (avg 0.04250)
<span class=" -Color -Color-Bold">INFO    </span> |      - gravity_cost(12): 14.83516 (avg 1.23626)
<span class=" -Color -Color-Bold">INFO    </span> |  step #28: cost=16.1528 lambd=1.0240 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_anchor_constraint(8): 0.00133 (avg 0.00008)
<span class=" -Color -Color-Bold">INFO    </span> |      - spring_cost(31): 1.31761 (avg 0.04250)
<span class=" -Color -Color-Bold">INFO    </span> |      - gravity_cost(12): 14.83516 (avg 1.23626)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=1.26e-01 cost_prev=16.1541 cost_new=16.1497
<span class=" -Color -Color-Bold">INFO    </span> |  AL update: snorm=2.0668e-05, csupn=2.0668e-05, max_rho=7.9380e+02, al_update=True
<span class=" -Color -Color-Bold">INFO    </span> |  step #29: cost=16.1486 lambd=0.5120 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_anchor_constraint(8): 0.00111 (avg 0.00007)
<span class=" -Color -Color-Bold">INFO    </span> |      - spring_cost(31): 1.29565 (avg 0.04180)
<span class=" -Color -Color-Bold">INFO    </span> |      - gravity_cost(12): 14.85295 (avg 1.23775)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=7.27e-02 cost_prev=16.1497 cost_new=16.1493
<span class=" -Color -Color-Bold">INFO    </span> |  AL update: snorm=9.8665e-06, csupn=9.8665e-06, max_rho=7.9380e+02, al_update=True
<span class=" -Color -Color-Bold">INFO    </span> |  step #30: cost=16.1482 lambd=0.2560 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_anchor_constraint(8): 0.00104 (avg 0.00007)
<span class=" -Color -Color-Bold">INFO    </span> |      - spring_cost(31): 1.26306 (avg 0.04074)
<span class=" -Color -Color-Bold">INFO    </span> |      - gravity_cost(12): 14.88515 (avg 1.24043)
<span class=" -Color -Color-Bold">INFO    </span> |  step #31: cost=16.1482 lambd=0.5120 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_anchor_constraint(8): 0.00104 (avg 0.00007)
<span class=" -Color -Color-Bold">INFO    </span> |      - spring_cost(31): 1.26306 (avg 0.04074)
<span class=" -Color -Color-Bold">INFO    </span> |      - gravity_cost(12): 14.88515 (avg 1.24043)
<span class=" -Color -Color-Bold">INFO    </span> |  step #32: cost=16.1482 lambd=1.0240 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_anchor_constraint(8): 0.00104 (avg 0.00007)
<span class=" -Color -Color-Bold">INFO    </span> |      - spring_cost(31): 1.26306 (avg 0.04074)
<span class=" -Color -Color-Bold">INFO    </span> |      - gravity_cost(12): 14.88515 (avg 1.24043)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=3.12e-02 cost_prev=16.1493 cost_new=16.1491
<span class=" -Color -Color-Bold">INFO    </span> |  AL update: snorm=3.0694e-06, csupn=3.0694e-06, max_rho=7.9380e+02, al_update=True
<span class=" -Color -Color-Bold">INFO    </span> |  step #33: cost=16.1480 lambd=0.5120 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_anchor_constraint(8): 0.00107 (avg 0.00007)
<span class=" -Color -Color-Bold">INFO    </span> |      - spring_cost(31): 1.25939 (avg 0.04063)
<span class=" -Color -Color-Bold">INFO    </span> |      - gravity_cost(12): 14.88860 (avg 1.24072)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=1.31e-02 cost_prev=16.1491 cost_new=16.1491
<span class=" -Color -Color-Bold">INFO    </span> |  AL update: snorm=2.1278e-06, csupn=2.1278e-06, max_rho=7.9380e+02, al_update=True
<span class=" -Color -Color-Bold">INFO    </span> | Terminated @ iteration #33: cost=16.1480 criteria=[1 0 0 0], term_deltas=8.3e-07,3.6e-03,1.4e-04
</pre></div>
</div>
</div>
</div>
</section>
<section id="visualization">
<h2>Visualization<a class="headerlink" href="#visualization" title="Link to this heading">¶</a></h2>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">plotly.graph_objects</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">go</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">plotly.subplots</span><span class="w"> </span><span class="kn">import</span> <span class="n">make_subplots</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">IPython.display</span><span class="w"> </span><span class="kn">import</span> <span class="n">HTML</span>


<span class="k">def</span><span class="w"> </span><span class="nf">get_traces</span><span class="p">(</span><span class="n">vals</span><span class="p">:</span> <span class="n">jaxls</span><span class="o">.</span><span class="n">VarValues</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get all Plotly traces for visualization.</span>

<span class="sd">    Args:</span>
<span class="sd">        vals: Variable values containing point positions</span>

<span class="sd">    Returns:</span>
<span class="sd">        List of Plotly Scatter traces for springs and points</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">positions</span> <span class="o">=</span> <span class="n">vals</span><span class="p">[</span><span class="n">all_point_vars</span><span class="p">]</span>
    <span class="n">traces</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># Spring lines.</span>
    <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="p">[(</span><span class="n">h_spring_a</span><span class="p">,</span> <span class="n">h_spring_b</span><span class="p">),</span> <span class="p">(</span><span class="n">v_spring_a</span><span class="p">,</span> <span class="n">v_spring_b</span><span class="p">)]:</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
            <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span> <span class="o">=</span> <span class="n">positions</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">positions</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
            <span class="n">traces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
                    <span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="n">p1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">p2</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
                    <span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="n">p1</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">p2</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span>
                    <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;lines&quot;</span><span class="p">,</span>
                    <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                    <span class="n">opacity</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
                    <span class="n">hoverinfo</span><span class="o">=</span><span class="s2">&quot;skip&quot;</span><span class="p">,</span>
                    <span class="n">showlegend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="p">)</span>

    <span class="c1"># Anchor points.</span>
    <span class="n">anchor_pos</span> <span class="o">=</span> <span class="n">positions</span><span class="p">[</span><span class="n">anchor_indices</span><span class="p">]</span>
    <span class="n">traces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
        <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
            <span class="n">x</span><span class="o">=</span><span class="n">anchor_pos</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="n">y</span><span class="o">=</span><span class="n">anchor_pos</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span>
            <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;markers&quot;</span><span class="p">,</span>
            <span class="n">marker</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;crimson&quot;</span><span class="p">),</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Anchors&quot;</span><span class="p">,</span>
            <span class="n">hovertemplate</span><span class="o">=</span><span class="s2">&quot;(%</span><span class="si">{x:.2f}</span><span class="s2">, %</span><span class="si">{y:.2f}</span><span class="s2">)&quot;</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="p">)</span>

    <span class="c1"># Free points.</span>
    <span class="n">free_pos</span> <span class="o">=</span> <span class="n">positions</span><span class="p">[</span><span class="n">interior_indices</span><span class="p">]</span>
    <span class="n">traces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
        <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
            <span class="n">x</span><span class="o">=</span><span class="n">free_pos</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="n">y</span><span class="o">=</span><span class="n">free_pos</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span>
            <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;markers&quot;</span><span class="p">,</span>
            <span class="n">marker</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;steelblue&quot;</span><span class="p">),</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Free points&quot;</span><span class="p">,</span>
            <span class="n">hovertemplate</span><span class="o">=</span><span class="s2">&quot;(%</span><span class="si">{x:.2f}</span><span class="s2">, %</span><span class="si">{y:.2f}</span><span class="s2">)&quot;</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">traces</span>


<span class="n">fig</span> <span class="o">=</span> <span class="n">make_subplots</span><span class="p">(</span><span class="n">rows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">subplot_titles</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;Initial&quot;</span><span class="p">,</span> <span class="s2">&quot;Optimized&quot;</span><span class="p">))</span>
<span class="k">for</span> <span class="n">trace</span> <span class="ow">in</span> <span class="n">get_traces</span><span class="p">(</span><span class="n">initial_vals</span><span class="p">):</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">trace</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="k">for</span> <span class="n">trace</span> <span class="ow">in</span> <span class="n">get_traces</span><span class="p">(</span><span class="n">solution</span><span class="p">):</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">trace</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span><span class="n">title_text</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">4.5</span><span class="p">],</span> <span class="n">scaleanchor</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">scaleratio</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="n">title_text</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">])</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">height</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span> <span class="n">showlegend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">margin</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">t</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">l</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="mi">40</span><span class="p">))</span>
<span class="n">HTML</span><span class="p">(</span><span class="n">fig</span><span class="o">.</span><span class="n">to_html</span><span class="p">(</span><span class="n">full_html</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">include_plotlyjs</span><span class="o">=</span><span class="s2">&quot;cdn&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><div>                        <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-3.3.0.min.js" integrity="sha256-bO3dS6yCpk9aK4gUpNELtCiDeSYvGYnK7jFI58NQnHI=" crossorigin="anonymous"></script>                <div id="b6299718-d37e-4ff7-af47-6944eabb4cfa" class="plotly-graph-div" style="height:400px; width:100%;"></div>            <script type="text/javascript">                window.PLOTLYENV=window.PLOTLYENV || {};                                if (document.getElementById("b6299718-d37e-4ff7-af47-6944eabb4cfa")) {                    Plotly.newPlot(                        "b6299718-d37e-4ff7-af47-6944eabb4cfa",                        [{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[0.0,1.0],"y":[0.0,0.0],"type":"scatter","xaxis":"x","yaxis":"y"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[1.0,2.0],"y":[0.0,0.0],"type":"scatter","xaxis":"x","yaxis":"y"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[2.0,3.0],"y":[0.0,0.0],"type":"scatter","xaxis":"x","yaxis":"y"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[3.0,4.0],"y":[0.0,0.0],"type":"scatter","xaxis":"x","yaxis":"y"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[0.0,1.0],"y":[-1.0,-1.0],"type":"scatter","xaxis":"x","yaxis":"y"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[1.0,2.0],"y":[-1.0,-1.0],"type":"scatter","xaxis":"x","yaxis":"y"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[2.0,3.0],"y":[-1.0,-1.0],"type":"scatter","xaxis":"x","yaxis":"y"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[3.0,4.0],"y":[-1.0,-1.0],"type":"scatter","xaxis":"x","yaxis":"y"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[0.0,1.0],"y":[-2.0,-2.0],"type":"scatter","xaxis":"x","yaxis":"y"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[1.0,2.0],"y":[-2.0,-2.0],"type":"scatter","xaxis":"x","yaxis":"y"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[2.0,3.0],"y":[-2.0,-2.0],"type":"scatter","xaxis":"x","yaxis":"y"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[3.0,4.0],"y":[-2.0,-2.0],"type":"scatter","xaxis":"x","yaxis":"y"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[0.0,1.0],"y":[-3.0,-3.0],"type":"scatter","xaxis":"x","yaxis":"y"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[1.0,2.0],"y":[-3.0,-3.0],"type":"scatter","xaxis":"x","yaxis":"y"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[2.0,3.0],"y":[-3.0,-3.0],"type":"scatter","xaxis":"x","yaxis":"y"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[3.0,4.0],"y":[-3.0,-3.0],"type":"scatter","xaxis":"x","yaxis":"y"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[0.0,0.0],"y":[0.0,-1.0],"type":"scatter","xaxis":"x","yaxis":"y"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[1.0,1.0],"y":[0.0,-1.0],"type":"scatter","xaxis":"x","yaxis":"y"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[2.0,2.0],"y":[0.0,-1.0],"type":"scatter","xaxis":"x","yaxis":"y"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[3.0,3.0],"y":[0.0,-1.0],"type":"scatter","xaxis":"x","yaxis":"y"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[4.0,4.0],"y":[0.0,-1.0],"type":"scatter","xaxis":"x","yaxis":"y"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[0.0,0.0],"y":[-1.0,-2.0],"type":"scatter","xaxis":"x","yaxis":"y"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[1.0,1.0],"y":[-1.0,-2.0],"type":"scatter","xaxis":"x","yaxis":"y"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[2.0,2.0],"y":[-1.0,-2.0],"type":"scatter","xaxis":"x","yaxis":"y"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[3.0,3.0],"y":[-1.0,-2.0],"type":"scatter","xaxis":"x","yaxis":"y"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[4.0,4.0],"y":[-1.0,-2.0],"type":"scatter","xaxis":"x","yaxis":"y"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[0.0,0.0],"y":[-2.0,-3.0],"type":"scatter","xaxis":"x","yaxis":"y"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[1.0,1.0],"y":[-2.0,-3.0],"type":"scatter","xaxis":"x","yaxis":"y"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[2.0,2.0],"y":[-2.0,-3.0],"type":"scatter","xaxis":"x","yaxis":"y"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[3.0,3.0],"y":[-2.0,-3.0],"type":"scatter","xaxis":"x","yaxis":"y"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[4.0,4.0],"y":[-2.0,-3.0],"type":"scatter","xaxis":"x","yaxis":"y"},{"hovertemplate":"(%{x:.2f}, %{y:.2f})","marker":{"color":"crimson","size":12},"mode":"markers","name":"Anchors","x":{"dtype":"f4","bdata":"AAAAAAAAgEAAAAAAAACAQAAAAAAAAIBAAAAAAAAAgEA="},"y":{"dtype":"f4","bdata":"AAAAAAAAAAAAAIC\u002fAACAvwAAAMAAAADAAABAwAAAQMA="},"type":"scatter","xaxis":"x","yaxis":"y"},{"hovertemplate":"(%{x:.2f}, %{y:.2f})","marker":{"color":"steelblue","size":10},"mode":"markers","name":"Free points","x":{"dtype":"f4","bdata":"AACAPwAAAEAAAEBAAACAPwAAAEAAAEBAAACAPwAAAEAAAEBAAACAPwAAAEAAAEBA"},"y":{"dtype":"f4","bdata":"AAAAAAAAAAAAAAAAAACAvwAAgL8AAIC\u002fAAAAwAAAAMAAAADAAABAwAAAQMAAAEDA"},"type":"scatter","xaxis":"x","yaxis":"y"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[-2.1277980977174593e-06,0.8499850630760193],"y":[7.012168623532489e-08,-1.0416276454925537],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[0.8499850630760193,2.0],"y":[-1.0416276454925537,-1.4867498874664307],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[2.0,3.150015115737915],"y":[-1.4867498874664307,-1.0416277647018433],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[3.150015115737915,4.000001907348633],"y":[-1.0416277647018433,7.031838578086536e-08],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[-1.8615219232742675e-06,0.8535533547401428],"y":[-0.9999998211860657,-2.0231454372406006],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[0.8535533547401428,2.0],"y":[-2.0231454372406006,-2.4625236988067627],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[2.0,3.146446704864502],"y":[-2.4625236988067627,-2.0231454372406006],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[3.146446704864502,4.000001907348633],"y":[-2.0231454372406006,-0.9999998211860657],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[-1.686451469140593e-06,0.8582860231399536],"y":[-1.999999761581421,-2.9991581439971924],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[0.8582860231399536,2.0],"y":[-2.9991581439971924,-3.430840253829956],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[2.0,3.141714096069336],"y":[-3.430840253829956,-2.9991583824157715],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[3.141714096069336,4.000001907348633],"y":[-2.9991583824157715,-1.999999761581421],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[-1.6669044953232515e-06,0.8621280193328857],"y":[-2.999999761581421,-3.980384111404419],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[0.8621280193328857,2.0],"y":[-3.980384111404419,-4.406599521636963],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[2.0,3.1378719806671143],"y":[-4.406599521636963,-3.980384111404419],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[3.1378719806671143,4.000001430511475],"y":[-3.980384111404419,-2.999999761581421],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[-2.1277980977174593e-06,-1.8615219232742675e-06],"y":[7.012168623532489e-08,-0.9999998211860657],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[0.8499850630760193,0.8535533547401428],"y":[-1.0416276454925537,-2.0231454372406006],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[2.0,2.0],"y":[-1.4867498874664307,-2.4625236988067627],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[3.150015115737915,3.146446704864502],"y":[-1.0416277647018433,-2.0231454372406006],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[4.000001907348633,4.000001907348633],"y":[7.031838578086536e-08,-0.9999998211860657],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[-1.8615219232742675e-06,-1.686451469140593e-06],"y":[-0.9999998211860657,-1.999999761581421],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[0.8535533547401428,0.8582860231399536],"y":[-2.0231454372406006,-2.9991581439971924],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[2.0,2.0],"y":[-2.4625236988067627,-3.430840253829956],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[3.146446704864502,3.141714096069336],"y":[-2.0231454372406006,-2.9991583824157715],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[4.000001907348633,4.000001907348633],"y":[-0.9999998211860657,-1.999999761581421],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[-1.686451469140593e-06,-1.6669044953232515e-06],"y":[-1.999999761581421,-2.999999761581421],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[0.8582860231399536,0.8621280193328857],"y":[-2.9991581439971924,-3.980384111404419],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[2.0,2.0],"y":[-3.430840253829956,-4.406599521636963],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[3.141714096069336,3.1378719806671143],"y":[-2.9991583824157715,-3.980384111404419],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[4.000001907348633,4.000001430511475],"y":[-1.999999761581421,-2.999999761581421],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"hovertemplate":"(%{x:.2f}, %{y:.2f})","marker":{"color":"crimson","size":12},"mode":"markers","name":"Anchors","x":{"dtype":"f4","bdata":"S8sOtgQAgEBo2fm1BACAQAha4rUEAIBAZ7rftQMAgEA="},"y":{"dtype":"f4","bdata":"zpWWM\u002fEBlzP9\u002f3+\u002f\u002ff9\u002fv\u002f7\u002f\u002f7\u002f+\u002f\u002f+\u002f\u002f\u002f8\u002fwP\u002f\u002fP8A="},"type":"scatter","xaxis":"x2","yaxis":"y2"},{"hovertemplate":"(%{x:.2f}, %{y:.2f})","marker":{"color":"steelblue","size":10},"mode":"markers","name":"Free points","x":{"dtype":"f4","bdata":"n5hZPwAAAEDZmUlAeYJaPwAAAEBiX0lAorhbPwAAAEDYEUlAbLRcPwAAAEDl0khA"},"y":{"dtype":"f4","bdata":"DlSFv9JNvr8PVIW\u002fN3sBwP2ZHcA3ewHANfI\u002fwOOSW8A28j\u002fAnb5+wN0CjcCdvn7A"},"type":"scatter","xaxis":"x2","yaxis":"y2"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermap":[{"type":"scattermap","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"anchor":"y","domain":[0.0,0.45],"title":{"text":"x"},"range":[-0.5,4.5],"scaleanchor":"y","scaleratio":1},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"y"},"range":[-5,0.5]},"xaxis2":{"anchor":"y2","domain":[0.55,1.0],"title":{"text":"x"},"range":[-0.5,4.5],"scaleanchor":"y","scaleratio":1},"yaxis2":{"anchor":"x2","domain":[0.0,1.0],"title":{"text":"y"},"range":[-5,0.5]},"annotations":[{"font":{"size":16},"showarrow":false,"text":"Initial","x":0.225,"xanchor":"center","xref":"paper","y":1.0,"yanchor":"bottom","yref":"paper"},{"font":{"size":16},"showarrow":false,"text":"Optimized","x":0.775,"xanchor":"center","xref":"paper","y":1.0,"yanchor":"bottom","yref":"paper"}],"margin":{"t":40,"b":40,"l":40,"r":40},"height":400,"showlegend":false},                        {"responsive": true}                    )                };            </script>        </div></div></div>
</div>
</section>
<section id="relaxation-animation">
<h2>Relaxation animation<a class="headerlink" href="#relaxation-animation" title="Link to this heading">¶</a></h2>
<p>We can visualize the relaxation process by solving a sequence of problems with progressively increasing gravity. This simulates how the network would settle from its initial configuration to the final equilibrium:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@jaxls</span><span class="o">.</span><span class="n">Cost</span><span class="o">.</span><span class="n">factory</span>
<span class="k">def</span><span class="w"> </span><span class="nf">gravity_cost_scaled</span><span class="p">(</span>
    <span class="n">vals</span><span class="p">:</span> <span class="n">jaxls</span><span class="o">.</span><span class="n">VarValues</span><span class="p">,</span>
    <span class="n">var</span><span class="p">:</span> <span class="n">Point2Var</span><span class="p">,</span>
    <span class="n">scale</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Pull points downward with adjustable strength.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">vals</span><span class="p">[</span><span class="n">var</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mf">10.0</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.15</span> <span class="o">*</span> <span class="n">scale</span>


<span class="c1"># Solve for a sequence of gravity strengths.</span>
<span class="n">n_frames</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">gravity_scales</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">n_frames</span><span class="p">)</span>
<span class="n">frame_solutions</span> <span class="o">=</span> <span class="p">[</span><span class="n">initial_vals</span><span class="p">]</span>

<span class="n">current_vals</span> <span class="o">=</span> <span class="n">initial_vals</span>
<span class="k">for</span> <span class="n">scale</span> <span class="ow">in</span> <span class="n">gravity_scales</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
    <span class="n">costs_scaled</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">jaxls</span><span class="o">.</span><span class="n">Cost</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">anchor_constraint</span><span class="p">(</span><span class="n">Point2Var</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">anchor_indices</span><span class="p">),</span> <span class="n">anchor_positions</span><span class="p">),</span>
        <span class="n">spring_cost</span><span class="p">(</span><span class="n">Point2Var</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">h_spring_a</span><span class="p">),</span> <span class="n">Point2Var</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">h_spring_b</span><span class="p">),</span> <span class="n">spacing</span><span class="p">),</span>
        <span class="n">spring_cost</span><span class="p">(</span><span class="n">Point2Var</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">v_spring_a</span><span class="p">),</span> <span class="n">Point2Var</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">v_spring_b</span><span class="p">),</span> <span class="n">spacing</span><span class="p">),</span>
        <span class="n">gravity_cost_scaled</span><span class="p">(</span><span class="n">Point2Var</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">interior_indices</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="n">scale</span><span class="p">)),</span>
    <span class="p">]</span>
    <span class="n">problem_scaled</span> <span class="o">=</span> <span class="n">jaxls</span><span class="o">.</span><span class="n">LeastSquaresProblem</span><span class="p">(</span><span class="n">costs_scaled</span><span class="p">,</span> <span class="p">[</span><span class="n">all_point_vars</span><span class="p">])</span><span class="o">.</span><span class="n">analyze</span><span class="p">()</span>
    <span class="n">current_vals</span> <span class="o">=</span> <span class="n">problem_scaled</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">current_vals</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">frame_solutions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">current_vals</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Generated </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">frame_solutions</span><span class="p">)</span><span class="si">}</span><span class="s2"> frames&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Bold">INFO    </span> | Building optimization problem with 51 terms and 20 variables: 43 costs, 8 eq_zero, 0 leq_zero, 0 geq_zero
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing constraint group with 8 constraints (constraint_eq_zero), 1 variables each: augmented_anchor_constraint
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 31 costs, 2 variables each: spring_cost
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 12 costs, 1 variables each: gravity_cost_scaled
<span class=" -Color -Color-Bold">INFO    </span> | Building optimization problem with 51 terms and 20 variables: 43 costs, 8 eq_zero, 0 leq_zero, 0 geq_zero
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 31 costs, 2 variables each: spring_cost
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing constraint group with 8 constraints (constraint_eq_zero), 1 variables each: augmented_anchor_constraint
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 12 costs, 1 variables each: gravity_cost_scaled
<span class=" -Color -Color-Bold">INFO    </span> | Building optimization problem with 51 terms and 20 variables: 43 costs, 8 eq_zero, 0 leq_zero, 0 geq_zero
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing constraint group with 8 constraints (constraint_eq_zero), 1 variables each: augmented_anchor_constraint
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 12 costs, 1 variables each: gravity_cost_scaled
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 31 costs, 2 variables each: spring_cost
<span class=" -Color -Color-Bold">INFO    </span> | Building optimization problem with 51 terms and 20 variables: 43 costs, 8 eq_zero, 0 leq_zero, 0 geq_zero
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing constraint group with 8 constraints (constraint_eq_zero), 1 variables each: augmented_anchor_constraint
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 31 costs, 2 variables each: spring_cost
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 12 costs, 1 variables each: gravity_cost_scaled
<span class=" -Color -Color-Bold">INFO    </span> | Building optimization problem with 51 terms and 20 variables: 43 costs, 8 eq_zero, 0 leq_zero, 0 geq_zero
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 31 costs, 2 variables each: spring_cost
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 12 costs, 1 variables each: gravity_cost_scaled
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing constraint group with 8 constraints (constraint_eq_zero), 1 variables each: augmented_anchor_constraint
<span class=" -Color -Color-Bold">INFO    </span> | Building optimization problem with 51 terms and 20 variables: 43 costs, 8 eq_zero, 0 leq_zero, 0 geq_zero
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 31 costs, 2 variables each: spring_cost
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing constraint group with 8 constraints (constraint_eq_zero), 1 variables each: augmented_anchor_constraint
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 12 costs, 1 variables each: gravity_cost_scaled
<span class=" -Color -Color-Bold">INFO    </span> | Building optimization problem with 51 terms and 20 variables: 43 costs, 8 eq_zero, 0 leq_zero, 0 geq_zero
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing constraint group with 8 constraints (constraint_eq_zero), 1 variables each: augmented_anchor_constraint
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 12 costs, 1 variables each: gravity_cost_scaled
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 31 costs, 2 variables each: spring_cost
<span class=" -Color -Color-Bold">INFO    </span> | Building optimization problem with 51 terms and 20 variables: 43 costs, 8 eq_zero, 0 leq_zero, 0 geq_zero
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 31 costs, 2 variables each: spring_cost
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing constraint group with 8 constraints (constraint_eq_zero), 1 variables each: augmented_anchor_constraint
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 12 costs, 1 variables each: gravity_cost_scaled
<span class=" -Color -Color-Bold">INFO    </span> | Building optimization problem with 51 terms and 20 variables: 43 costs, 8 eq_zero, 0 leq_zero, 0 geq_zero
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 31 costs, 2 variables each: spring_cost
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing constraint group with 8 constraints (constraint_eq_zero), 1 variables each: augmented_anchor_constraint
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 12 costs, 1 variables each: gravity_cost_scaled
<span class=" -Color -Color-Bold">INFO    </span> | Building optimization problem with 51 terms and 20 variables: 43 costs, 8 eq_zero, 0 leq_zero, 0 geq_zero
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 12 costs, 1 variables each: gravity_cost_scaled
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing constraint group with 8 constraints (constraint_eq_zero), 1 variables each: augmented_anchor_constraint
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 31 costs, 2 variables each: spring_cost
<span class=" -Color -Color-Bold">INFO    </span> | Building optimization problem with 51 terms and 20 variables: 43 costs, 8 eq_zero, 0 leq_zero, 0 geq_zero
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 12 costs, 1 variables each: gravity_cost_scaled
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing constraint group with 8 constraints (constraint_eq_zero), 1 variables each: augmented_anchor_constraint
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 31 costs, 2 variables each: spring_cost
<span class=" -Color -Color-Bold">INFO    </span> | Building optimization problem with 51 terms and 20 variables: 43 costs, 8 eq_zero, 0 leq_zero, 0 geq_zero
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing constraint group with 8 constraints (constraint_eq_zero), 1 variables each: augmented_anchor_constraint
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 31 costs, 2 variables each: spring_cost
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 12 costs, 1 variables each: gravity_cost_scaled
<span class=" -Color -Color-Bold">INFO    </span> | Building optimization problem with 51 terms and 20 variables: 43 costs, 8 eq_zero, 0 leq_zero, 0 geq_zero
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing constraint group with 8 constraints (constraint_eq_zero), 1 variables each: augmented_anchor_constraint
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 31 costs, 2 variables each: spring_cost
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 12 costs, 1 variables each: gravity_cost_scaled
<span class=" -Color -Color-Bold">INFO    </span> | Building optimization problem with 51 terms and 20 variables: 43 costs, 8 eq_zero, 0 leq_zero, 0 geq_zero
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 31 costs, 2 variables each: spring_cost
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 12 costs, 1 variables each: gravity_cost_scaled
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing constraint group with 8 constraints (constraint_eq_zero), 1 variables each: augmented_anchor_constraint
<span class=" -Color -Color-Bold">INFO    </span> | Building optimization problem with 51 terms and 20 variables: 43 costs, 8 eq_zero, 0 leq_zero, 0 geq_zero
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 31 costs, 2 variables each: spring_cost
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing constraint group with 8 constraints (constraint_eq_zero), 1 variables each: augmented_anchor_constraint
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 12 costs, 1 variables each: gravity_cost_scaled
<span class=" -Color -Color-Bold">INFO    </span> | Building optimization problem with 51 terms and 20 variables: 43 costs, 8 eq_zero, 0 leq_zero, 0 geq_zero
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing constraint group with 8 constraints (constraint_eq_zero), 1 variables each: augmented_anchor_constraint
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 12 costs, 1 variables each: gravity_cost_scaled
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 31 costs, 2 variables each: spring_cost
<span class=" -Color -Color-Bold">INFO    </span> | Building optimization problem with 51 terms and 20 variables: 43 costs, 8 eq_zero, 0 leq_zero, 0 geq_zero
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 12 costs, 1 variables each: gravity_cost_scaled
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing constraint group with 8 constraints (constraint_eq_zero), 1 variables each: augmented_anchor_constraint
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 31 costs, 2 variables each: spring_cost
<span class=" -Color -Color-Bold">INFO    </span> | Building optimization problem with 51 terms and 20 variables: 43 costs, 8 eq_zero, 0 leq_zero, 0 geq_zero
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 12 costs, 1 variables each: gravity_cost_scaled
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing constraint group with 8 constraints (constraint_eq_zero), 1 variables each: augmented_anchor_constraint
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 31 costs, 2 variables each: spring_cost
<span class=" -Color -Color-Bold">INFO    </span> | Building optimization problem with 51 terms and 20 variables: 43 costs, 8 eq_zero, 0 leq_zero, 0 geq_zero
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 31 costs, 2 variables each: spring_cost
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing constraint group with 8 constraints (constraint_eq_zero), 1 variables each: augmented_anchor_constraint
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 12 costs, 1 variables each: gravity_cost_scaled
Generated 20 frames
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">get_frame_data</span><span class="p">(</span><span class="n">vals</span><span class="p">:</span> <span class="n">jaxls</span><span class="o">.</span><span class="n">VarValues</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Extract position data for animation frame.&quot;&quot;&quot;</span>
    <span class="n">positions</span> <span class="o">=</span> <span class="n">vals</span><span class="p">[</span><span class="n">all_point_vars</span><span class="p">]</span>

    <span class="c1"># Build spring line coordinates.</span>
    <span class="n">spring_x</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">spring_y</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="p">[(</span><span class="n">h_spring_a</span><span class="p">,</span> <span class="n">h_spring_b</span><span class="p">),</span> <span class="p">(</span><span class="n">v_spring_a</span><span class="p">,</span> <span class="n">v_spring_b</span><span class="p">)]:</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
            <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span> <span class="o">=</span> <span class="n">positions</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">positions</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
            <span class="n">spring_x</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">p1</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">p2</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="kc">None</span><span class="p">])</span>
            <span class="n">spring_y</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">p1</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">p2</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="kc">None</span><span class="p">])</span>

    <span class="n">anchor_pos</span> <span class="o">=</span> <span class="n">positions</span><span class="p">[</span><span class="n">anchor_indices</span><span class="p">]</span>
    <span class="n">free_pos</span> <span class="o">=</span> <span class="n">positions</span><span class="p">[</span><span class="n">interior_indices</span><span class="p">]</span>

    <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span>
        <span class="n">spring_x</span><span class="o">=</span><span class="n">spring_x</span><span class="p">,</span>
        <span class="n">spring_y</span><span class="o">=</span><span class="n">spring_y</span><span class="p">,</span>
        <span class="n">anchor_x</span><span class="o">=</span><span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">anchor_pos</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]],</span>
        <span class="n">anchor_y</span><span class="o">=</span><span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">anchor_pos</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]],</span>
        <span class="n">free_x</span><span class="o">=</span><span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">free_pos</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]],</span>
        <span class="n">free_y</span><span class="o">=</span><span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">free_pos</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]],</span>
    <span class="p">)</span>


<span class="c1"># Build animation frames.</span>
<span class="n">frames</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">vals</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">frame_solutions</span><span class="p">):</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">get_frame_data</span><span class="p">(</span><span class="n">vals</span><span class="p">)</span>
    <span class="n">frames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
        <span class="n">go</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span>
            <span class="n">data</span><span class="o">=</span><span class="p">[</span>
                <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
                    <span class="n">x</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;spring_x&quot;</span><span class="p">],</span>
                    <span class="n">y</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;spring_y&quot;</span><span class="p">],</span>
                    <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;lines&quot;</span><span class="p">,</span>
                    <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span>
                    <span class="n">hoverinfo</span><span class="o">=</span><span class="s2">&quot;skip&quot;</span><span class="p">,</span>
                <span class="p">),</span>
                <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
                    <span class="n">x</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;anchor_x&quot;</span><span class="p">],</span>
                    <span class="n">y</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;anchor_y&quot;</span><span class="p">],</span>
                    <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;markers&quot;</span><span class="p">,</span>
                    <span class="n">marker</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;crimson&quot;</span><span class="p">),</span>
                <span class="p">),</span>
                <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
                    <span class="n">x</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;free_x&quot;</span><span class="p">],</span>
                    <span class="n">y</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;free_y&quot;</span><span class="p">],</span>
                    <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;markers&quot;</span><span class="p">,</span>
                    <span class="n">marker</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;steelblue&quot;</span><span class="p">),</span>
                <span class="p">),</span>
            <span class="p">],</span>
            <span class="n">name</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">),</span>
        <span class="p">)</span>
    <span class="p">)</span>

<span class="c1"># Initial frame data.</span>
<span class="n">init_data</span> <span class="o">=</span> <span class="n">get_frame_data</span><span class="p">(</span><span class="n">initial_vals</span><span class="p">)</span>

<span class="n">fig_anim</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="p">[</span>
        <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
            <span class="n">x</span><span class="o">=</span><span class="n">init_data</span><span class="p">[</span><span class="s2">&quot;spring_x&quot;</span><span class="p">],</span>
            <span class="n">y</span><span class="o">=</span><span class="n">init_data</span><span class="p">[</span><span class="s2">&quot;spring_y&quot;</span><span class="p">],</span>
            <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;lines&quot;</span><span class="p">,</span>
            <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span>
            <span class="n">hoverinfo</span><span class="o">=</span><span class="s2">&quot;skip&quot;</span><span class="p">,</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Springs&quot;</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
            <span class="n">x</span><span class="o">=</span><span class="n">init_data</span><span class="p">[</span><span class="s2">&quot;anchor_x&quot;</span><span class="p">],</span>
            <span class="n">y</span><span class="o">=</span><span class="n">init_data</span><span class="p">[</span><span class="s2">&quot;anchor_y&quot;</span><span class="p">],</span>
            <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;markers&quot;</span><span class="p">,</span>
            <span class="n">marker</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;crimson&quot;</span><span class="p">),</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Anchors&quot;</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
            <span class="n">x</span><span class="o">=</span><span class="n">init_data</span><span class="p">[</span><span class="s2">&quot;free_x&quot;</span><span class="p">],</span>
            <span class="n">y</span><span class="o">=</span><span class="n">init_data</span><span class="p">[</span><span class="s2">&quot;free_y&quot;</span><span class="p">],</span>
            <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;markers&quot;</span><span class="p">,</span>
            <span class="n">marker</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;steelblue&quot;</span><span class="p">),</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Free points&quot;</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">],</span>
    <span class="n">frames</span><span class="o">=</span><span class="n">frames</span><span class="p">,</span>
    <span class="n">layout</span><span class="o">=</span><span class="n">go</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span>
        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Spring network relaxation&quot;</span><span class="p">,</span>
        <span class="n">xaxis</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="nb">range</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">4.5</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">scaleanchor</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">scaleratio</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
        <span class="n">yaxis</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="nb">range</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">),</span>
        <span class="n">updatemenus</span><span class="o">=</span><span class="p">[</span>
            <span class="nb">dict</span><span class="p">(</span>
                <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;buttons&quot;</span><span class="p">,</span>
                <span class="n">showactive</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">y</span><span class="o">=</span><span class="mf">1.15</span><span class="p">,</span>
                <span class="n">x</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
                <span class="n">xanchor</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
                <span class="n">buttons</span><span class="o">=</span><span class="p">[</span>
                    <span class="nb">dict</span><span class="p">(</span>
                        <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Play&quot;</span><span class="p">,</span>
                        <span class="n">method</span><span class="o">=</span><span class="s2">&quot;animate&quot;</span><span class="p">,</span>
                        <span class="n">args</span><span class="o">=</span><span class="p">[</span>
                            <span class="kc">None</span><span class="p">,</span>
                            <span class="nb">dict</span><span class="p">(</span>
                                <span class="n">frame</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">redraw</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
                                <span class="n">fromcurrent</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                <span class="n">transition</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="mi">50</span><span class="p">),</span>
                            <span class="p">),</span>
                        <span class="p">],</span>
                    <span class="p">),</span>
                    <span class="nb">dict</span><span class="p">(</span>
                        <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Pause&quot;</span><span class="p">,</span>
                        <span class="n">method</span><span class="o">=</span><span class="s2">&quot;animate&quot;</span><span class="p">,</span>
                        <span class="n">args</span><span class="o">=</span><span class="p">[</span>
                            <span class="p">[</span><span class="kc">None</span><span class="p">],</span>
                            <span class="nb">dict</span><span class="p">(</span>
                                <span class="n">frame</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">redraw</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;immediate&quot;</span>
                            <span class="p">),</span>
                        <span class="p">],</span>
                    <span class="p">),</span>
                <span class="p">],</span>
            <span class="p">)</span>
        <span class="p">],</span>
        <span class="n">sliders</span><span class="o">=</span><span class="p">[</span>
            <span class="nb">dict</span><span class="p">(</span>
                <span class="n">active</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                <span class="n">yanchor</span><span class="o">=</span><span class="s2">&quot;top&quot;</span><span class="p">,</span>
                <span class="n">xanchor</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span>
                <span class="n">currentvalue</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                    <span class="n">prefix</span><span class="o">=</span><span class="s2">&quot;Gravity: &quot;</span><span class="p">,</span> <span class="n">suffix</span><span class="o">=</span><span class="s2">&quot;%&quot;</span><span class="p">,</span> <span class="n">visible</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">xanchor</span><span class="o">=</span><span class="s2">&quot;center&quot;</span>
                <span class="p">),</span>
                <span class="n">pad</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">b</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="mi">50</span><span class="p">),</span>
                <span class="n">steps</span><span class="o">=</span><span class="p">[</span>
                    <span class="nb">dict</span><span class="p">(</span>
                        <span class="n">args</span><span class="o">=</span><span class="p">[</span>
                            <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)],</span>
                            <span class="nb">dict</span><span class="p">(</span>
                                <span class="n">frame</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">redraw</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
                                <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;immediate&quot;</span><span class="p">,</span>
                                <span class="n">transition</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
                            <span class="p">),</span>
                        <span class="p">],</span>
                        <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">gravity_scales</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">100</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                        <span class="n">method</span><span class="o">=</span><span class="s2">&quot;animate&quot;</span><span class="p">,</span>
                    <span class="p">)</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_frames</span><span class="p">)</span>
                <span class="p">],</span>
                <span class="n">x</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
                <span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                <span class="nb">len</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">],</span>
        <span class="n">height</span><span class="o">=</span><span class="mi">450</span><span class="p">,</span>
        <span class="n">showlegend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">margin</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">t</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">80</span><span class="p">),</span>
    <span class="p">),</span>
<span class="p">)</span>
<span class="n">HTML</span><span class="p">(</span><span class="n">fig_anim</span><span class="o">.</span><span class="n">to_html</span><span class="p">(</span><span class="n">full_html</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">include_plotlyjs</span><span class="o">=</span><span class="s2">&quot;cdn&quot;</span><span class="p">,</span> <span class="n">auto_play</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><div>                        <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-3.3.0.min.js" integrity="sha256-bO3dS6yCpk9aK4gUpNELtCiDeSYvGYnK7jFI58NQnHI=" crossorigin="anonymous"></script>                <div id="775c95f3-8a0a-42a6-83b6-cdbcf35372e2" class="plotly-graph-div" style="height:450px; width:100%;"></div>            <script type="text/javascript">                window.PLOTLYENV=window.PLOTLYENV || {};                                if (document.getElementById("775c95f3-8a0a-42a6-83b6-cdbcf35372e2")) {                    Plotly.newPlot(                        "775c95f3-8a0a-42a6-83b6-cdbcf35372e2",                        [{"hoverinfo":"skip","line":{"color":"gray","width":2},"mode":"lines","name":"Springs","x":[0.0,1.0,null,1.0,2.0,null,2.0,3.0,null,3.0,4.0,null,0.0,1.0,null,1.0,2.0,null,2.0,3.0,null,3.0,4.0,null,0.0,1.0,null,1.0,2.0,null,2.0,3.0,null,3.0,4.0,null,0.0,1.0,null,1.0,2.0,null,2.0,3.0,null,3.0,4.0,null,0.0,0.0,null,1.0,1.0,null,2.0,2.0,null,3.0,3.0,null,4.0,4.0,null,0.0,0.0,null,1.0,1.0,null,2.0,2.0,null,3.0,3.0,null,4.0,4.0,null,0.0,0.0,null,1.0,1.0,null,2.0,2.0,null,3.0,3.0,null,4.0,4.0,null],"y":[0.0,0.0,null,0.0,0.0,null,0.0,0.0,null,0.0,0.0,null,-1.0,-1.0,null,-1.0,-1.0,null,-1.0,-1.0,null,-1.0,-1.0,null,-2.0,-2.0,null,-2.0,-2.0,null,-2.0,-2.0,null,-2.0,-2.0,null,-3.0,-3.0,null,-3.0,-3.0,null,-3.0,-3.0,null,-3.0,-3.0,null,0.0,-1.0,null,0.0,-1.0,null,0.0,-1.0,null,0.0,-1.0,null,0.0,-1.0,null,-1.0,-2.0,null,-1.0,-2.0,null,-1.0,-2.0,null,-1.0,-2.0,null,-1.0,-2.0,null,-2.0,-3.0,null,-2.0,-3.0,null,-2.0,-3.0,null,-2.0,-3.0,null,-2.0,-3.0,null],"type":"scatter"},{"marker":{"color":"crimson","size":12},"mode":"markers","name":"Anchors","x":[0.0,4.0,0.0,4.0,0.0,4.0,0.0,4.0],"y":[0.0,0.0,-1.0,-1.0,-2.0,-2.0,-3.0,-3.0],"type":"scatter"},{"marker":{"color":"steelblue","size":10},"mode":"markers","name":"Free points","x":[1.0,2.0,3.0,1.0,2.0,3.0,1.0,2.0,3.0,1.0,2.0,3.0],"y":[0.0,0.0,0.0,-1.0,-1.0,-1.0,-2.0,-2.0,-2.0,-3.0,-3.0,-3.0],"type":"scatter"}],                        {"height":450,"margin":{"b":80,"t":80},"showlegend":false,"sliders":[{"active":0,"currentvalue":{"prefix":"Gravity: ","suffix":"%","visible":true,"xanchor":"center"},"len":0.8,"pad":{"b":10,"t":50},"steps":[{"args":[["0"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"0","method":"animate"},{"args":[["1"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"5","method":"animate"},{"args":[["2"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"10","method":"animate"},{"args":[["3"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"15","method":"animate"},{"args":[["4"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"21","method":"animate"},{"args":[["5"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"26","method":"animate"},{"args":[["6"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"31","method":"animate"},{"args":[["7"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"36","method":"animate"},{"args":[["8"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"42","method":"animate"},{"args":[["9"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"47","method":"animate"},{"args":[["10"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"52","method":"animate"},{"args":[["11"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"57","method":"animate"},{"args":[["12"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"63","method":"animate"},{"args":[["13"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"68","method":"animate"},{"args":[["14"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"73","method":"animate"},{"args":[["15"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"78","method":"animate"},{"args":[["16"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"84","method":"animate"},{"args":[["17"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"89","method":"animate"},{"args":[["18"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"94","method":"animate"},{"args":[["19"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"100","method":"animate"}],"x":0.1,"xanchor":"left","y":0,"yanchor":"top"}],"title":{"text":"Spring network relaxation"},"updatemenus":[{"buttons":[{"args":[null,{"frame":{"duration":100,"redraw":true},"fromcurrent":true,"transition":{"duration":50}}],"label":"Play","method":"animate"},{"args":[[null],{"frame":{"duration":0,"redraw":false},"mode":"immediate"}],"label":"Pause","method":"animate"}],"showactive":false,"type":"buttons","x":0.5,"xanchor":"center","y":1.15}],"xaxis":{"range":[-0.5,4.5],"scaleanchor":"y","scaleratio":1,"title":{"text":"x"}},"yaxis":{"range":[-5,0.5],"title":{"text":"y"}},"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermap":[{"type":"scattermap","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}}},                        {"responsive": true}                    ).then(function(){
                            Plotly.addFrames('775c95f3-8a0a-42a6-83b6-cdbcf35372e2', [{"data":[{"hoverinfo":"skip","line":{"color":"gray","width":2},"mode":"lines","x":[0.0,1.0,null,1.0,2.0,null,2.0,3.0,null,3.0,4.0,null,0.0,1.0,null,1.0,2.0,null,2.0,3.0,null,3.0,4.0,null,0.0,1.0,null,1.0,2.0,null,2.0,3.0,null,3.0,4.0,null,0.0,1.0,null,1.0,2.0,null,2.0,3.0,null,3.0,4.0,null,0.0,0.0,null,1.0,1.0,null,2.0,2.0,null,3.0,3.0,null,4.0,4.0,null,0.0,0.0,null,1.0,1.0,null,2.0,2.0,null,3.0,3.0,null,4.0,4.0,null,0.0,0.0,null,1.0,1.0,null,2.0,2.0,null,3.0,3.0,null,4.0,4.0,null],"y":[0.0,0.0,null,0.0,0.0,null,0.0,0.0,null,0.0,0.0,null,-1.0,-1.0,null,-1.0,-1.0,null,-1.0,-1.0,null,-1.0,-1.0,null,-2.0,-2.0,null,-2.0,-2.0,null,-2.0,-2.0,null,-2.0,-2.0,null,-3.0,-3.0,null,-3.0,-3.0,null,-3.0,-3.0,null,-3.0,-3.0,null,0.0,-1.0,null,0.0,-1.0,null,0.0,-1.0,null,0.0,-1.0,null,0.0,-1.0,null,-1.0,-2.0,null,-1.0,-2.0,null,-1.0,-2.0,null,-1.0,-2.0,null,-1.0,-2.0,null,-2.0,-3.0,null,-2.0,-3.0,null,-2.0,-3.0,null,-2.0,-3.0,null,-2.0,-3.0,null],"type":"scatter"},{"marker":{"color":"crimson","size":12},"mode":"markers","x":[0.0,4.0,0.0,4.0,0.0,4.0,0.0,4.0],"y":[0.0,0.0,-1.0,-1.0,-2.0,-2.0,-3.0,-3.0],"type":"scatter"},{"marker":{"color":"steelblue","size":10},"mode":"markers","x":[1.0,2.0,3.0,1.0,2.0,3.0,1.0,2.0,3.0,1.0,2.0,3.0],"y":[0.0,0.0,0.0,-1.0,-1.0,-1.0,-2.0,-2.0,-2.0,-3.0,-3.0,-3.0],"type":"scatter"}],"name":"0"},{"data":[{"hoverinfo":"skip","line":{"color":"gray","width":2},"mode":"lines","x":[-1.2988537037017522e-06,0.9956373572349548,null,0.9956373572349548,1.9999971389770508,null,1.9999971389770508,3.0043582916259766,null,3.0043582916259766,4.000000953674316,null,-1.196219386656594e-06,0.9956445097923279,null,0.9956445097923279,1.9999988079071045,null,1.9999988079071045,3.0043532848358154,null,3.0043532848358154,4.000000953674316,null,-1.1381903277651872e-06,0.9956549406051636,null,0.9956549406051636,2.0000011920928955,null,2.0000011920928955,3.0043466091156006,null,3.0043466091156006,4.000000953674316,null,-1.0807279977598228e-06,0.9956656694412231,null,0.9956656694412231,2.000006914138794,null,2.000006914138794,3.0043442249298096,null,3.0043442249298096,4.000001430511475,null,-1.2988537037017522e-06,-1.196219386656594e-06,null,0.9956373572349548,0.9956445097923279,null,1.9999971389770508,1.9999988079071045,null,3.0043582916259766,3.0043532848358154,null,4.000000953674316,4.000000953674316,null,-1.196219386656594e-06,-1.1381903277651872e-06,null,0.9956445097923279,0.9956549406051636,null,1.9999988079071045,2.0000011920928955,null,3.0043532848358154,3.0043466091156006,null,4.000000953674316,4.000000953674316,null,-1.1381903277651872e-06,-1.0807279977598228e-06,null,0.9956549406051636,0.9956656694412231,null,2.0000011920928955,2.000006914138794,null,3.0043466091156006,3.0043442249298096,null,4.000000953674316,4.000001430511475,null],"y":[-3.8955283798713936e-07,-0.1409984827041626,null,-0.1409984827041626,-0.19002190232276917,null,-0.19002190232276917,-0.14099502563476562,null,-0.14099502563476562,-1.9166655818025902e-07,null,-1.0000004768371582,-1.1409084796905518,null,-1.1409084796905518,-1.189924716949463,null,-1.189924716949463,-1.1409063339233398,null,-1.1409063339233398,-1.0000001192092896,null,-2.000000476837158,-2.1407864093780518,null,-2.1407864093780518,-2.1897997856140137,null,-2.1897997856140137,-2.1407833099365234,null,-2.1407833099365234,-2.000000238418579,null,-3.000000476837158,-3.140690565109253,null,-3.140690565109253,-3.1897122859954834,null,-3.1897122859954834,-3.1406891345977783,null,-3.1406891345977783,-3.0,null,-3.8955283798713936e-07,-1.0000004768371582,null,-0.1409984827041626,-1.1409084796905518,null,-0.19002190232276917,-1.189924716949463,null,-0.14099502563476562,-1.1409063339233398,null,-1.9166655818025902e-07,-1.0000001192092896,null,-1.0000004768371582,-2.000000476837158,null,-1.1409084796905518,-2.1407864093780518,null,-1.189924716949463,-2.1897997856140137,null,-1.1409063339233398,-2.1407833099365234,null,-1.0000001192092896,-2.000000238418579,null,-2.000000476837158,-3.000000476837158,null,-2.1407864093780518,-3.140690565109253,null,-2.1897997856140137,-3.1897122859954834,null,-2.1407833099365234,-3.1406891345977783,null,-2.000000238418579,-3.0,null],"type":"scatter"},{"marker":{"color":"crimson","size":12},"mode":"markers","x":[-1.2988537037017522e-06,4.000000953674316,-1.196219386656594e-06,4.000000953674316,-1.1381903277651872e-06,4.000000953674316,-1.0807279977598228e-06,4.000001430511475],"y":[-3.8955283798713936e-07,-1.9166655818025902e-07,-1.0000004768371582,-1.0000001192092896,-2.000000476837158,-2.000000238418579,-3.000000476837158,-3.0],"type":"scatter"},{"marker":{"color":"steelblue","size":10},"mode":"markers","x":[0.9956373572349548,1.9999971389770508,3.0043582916259766,0.9956445097923279,1.9999988079071045,3.0043532848358154,0.9956549406051636,2.0000011920928955,3.0043466091156006,0.9956656694412231,2.000006914138794,3.0043442249298096],"y":[-0.1409984827041626,-0.19002190232276917,-0.14099502563476562,-1.1409084796905518,-1.189924716949463,-1.1409063339233398,-2.1407864093780518,-2.1897997856140137,-2.1407833099365234,-3.140690565109253,-3.1897122859954834,-3.1406891345977783],"type":"scatter"}],"name":"1"},{"data":[{"hoverinfo":"skip","line":{"color":"gray","width":2},"mode":"lines","x":[-2.211033233834314e-06,0.9891080856323242,null,0.9891080856323242,1.9999998807907104,null,1.9999998807907104,3.0108916759490967,null,3.0108916759490967,4.000001907348633,null,-2.2953638563194545e-06,0.9891460537910461,null,0.9891460537910461,2.0,null,2.0,3.0108540058135986,null,3.0108540058135986,4.000002384185791,null,-2.3049269657349214e-06,0.9891971945762634,null,0.9891971945762634,2.000000238418579,null,2.000000238418579,3.010802984237671,null,3.010802984237671,4.000002384185791,null,-2.2402189188142074e-06,0.9892361164093018,null,0.9892361164093018,2.0,null,2.0,3.0107641220092773,null,3.0107641220092773,4.000002384185791,null,-2.211033233834314e-06,-2.2953638563194545e-06,null,0.9891080856323242,0.9891460537910461,null,1.9999998807907104,2.0,null,3.0108916759490967,3.0108540058135986,null,4.000001907348633,4.000002384185791,null,-2.2953638563194545e-06,-2.3049269657349214e-06,null,0.9891460537910461,0.9891971945762634,null,2.0,2.000000238418579,null,3.0108540058135986,3.010802984237671,null,4.000002384185791,4.000002384185791,null,-2.3049269657349214e-06,-2.2402189188142074e-06,null,0.9891971945762634,0.9892361164093018,null,2.000000238418579,2.0,null,3.010802984237671,3.0107641220092773,null,4.000002384185791,4.000002384185791,null],"y":[-1.218567859950781e-07,-0.22387631237506866,null,-0.22387631237506866,-0.3009621202945709,null,-0.3009621202945709,-0.2238761931657791,null,-0.2238761931657791,-1.1037072766839628e-07,null,-1.000000238418579,-1.2235236167907715,null,-1.2235236167907715,-1.3005950450897217,null,-1.3005950450897217,-1.2235236167907715,null,-1.2235236167907715,-1.0000001192092896,null,-2.000000238418579,-2.223050355911255,null,-2.223050355911255,-2.300109624862671,null,-2.300109624862671,-2.223050117492676,null,-2.223050117492676,-2.000000238418579,null,-3.000000238418579,-3.2226908206939697,null,-3.2226908206939697,-3.2997474670410156,null,-3.2997474670410156,-3.2226908206939697,null,-3.2226908206939697,-3.000000238418579,null,-1.218567859950781e-07,-1.000000238418579,null,-0.22387631237506866,-1.2235236167907715,null,-0.3009621202945709,-1.3005950450897217,null,-0.2238761931657791,-1.2235236167907715,null,-1.1037072766839628e-07,-1.0000001192092896,null,-1.000000238418579,-2.000000238418579,null,-1.2235236167907715,-2.223050355911255,null,-1.3005950450897217,-2.300109624862671,null,-1.2235236167907715,-2.223050117492676,null,-1.0000001192092896,-2.000000238418579,null,-2.000000238418579,-3.000000238418579,null,-2.223050355911255,-3.2226908206939697,null,-2.300109624862671,-3.2997474670410156,null,-2.223050117492676,-3.2226908206939697,null,-2.000000238418579,-3.000000238418579,null],"type":"scatter"},{"marker":{"color":"crimson","size":12},"mode":"markers","x":[-2.211033233834314e-06,4.000001907348633,-2.2953638563194545e-06,4.000002384185791,-2.3049269657349214e-06,4.000002384185791,-2.2402189188142074e-06,4.000002384185791],"y":[-1.218567859950781e-07,-1.1037072766839628e-07,-1.000000238418579,-1.0000001192092896,-2.000000238418579,-2.000000238418579,-3.000000238418579,-3.000000238418579],"type":"scatter"},{"marker":{"color":"steelblue","size":10},"mode":"markers","x":[0.9891080856323242,1.9999998807907104,3.0108916759490967,0.9891460537910461,2.0,3.0108540058135986,0.9891971945762634,2.000000238418579,3.010802984237671,0.9892361164093018,2.0,3.0107641220092773],"y":[-0.22387631237506866,-0.3009621202945709,-0.2238761931657791,-1.2235236167907715,-1.3005950450897217,-1.2235236167907715,-2.223050355911255,-2.300109624862671,-2.223050117492676,-3.2226908206939697,-3.2997474670410156,-3.2226908206939697],"type":"scatter"}],"name":"2"},{"data":[{"hoverinfo":"skip","line":{"color":"gray","width":2},"mode":"lines","x":[-3.3970759432122577e-06,0.9810016751289368,null,0.9810016751289368,2.000000238418579,null,2.000000238418579,3.018998384475708,null,3.018998384475708,4.000002861022949,null,-8.462980076728854e-07,0.9811123013496399,null,0.9811123013496399,2.0,null,2.0,3.018887996673584,null,3.018887996673584,4.000000953674316,null,-3.230553375033196e-06,0.9812531471252441,null,0.9812531471252441,1.999999761581421,null,1.999999761581421,3.0187466144561768,null,3.0187466144561768,4.000003337860107,null,-8.018021162570221e-07,0.9813610315322876,null,0.9813610315322876,1.999999761581421,null,1.999999761581421,3.0186386108398438,null,3.0186386108398438,4.000000953674316,null,-3.3970759432122577e-06,-8.462980076728854e-07,null,0.9810016751289368,0.9811123013496399,null,2.000000238418579,2.0,null,3.018998384475708,3.018887996673584,null,4.000002861022949,4.000000953674316,null,-8.462980076728854e-07,-3.230553375033196e-06,null,0.9811123013496399,0.9812531471252441,null,2.0,1.999999761581421,null,3.018887996673584,3.0187466144561768,null,4.000000953674316,4.000003337860107,null,-3.230553375033196e-06,-8.018021162570221e-07,null,0.9812531471252441,0.9813610315322876,null,1.999999761581421,1.999999761581421,null,3.0187466144561768,3.0186386108398438,null,4.000003337860107,4.000000953674316,null],"y":[4.891303433396388e-06,-0.29527923464775085,null,-0.29527923464775085,-0.3920278549194336,null,-0.3920278549194336,-0.29527953267097473,null,-0.29527953267097473,4.785914370586397e-06,null,-0.9999986290931702,-1.2945032119750977,null,-1.2945032119750977,-1.3912373781204224,null,-1.3912373781204224,-1.2945034503936768,null,-1.2945034503936768,-0.9999986290931702,null,-1.9999953508377075,-2.2934749126434326,null,-2.2934749126434326,-2.3901705741882324,null,-2.3901705741882324,-2.2934751510620117,null,-2.2934751510620117,-1.999995231628418,null,-2.9999988079071045,-3.2927021980285645,null,-3.2927021980285645,-3.389357089996338,null,-3.389357089996338,-3.2927024364471436,null,-3.2927024364471436,-2.9999988079071045,null,4.891303433396388e-06,-0.9999986290931702,null,-0.29527923464775085,-1.2945032119750977,null,-0.3920278549194336,-1.3912373781204224,null,-0.29527953267097473,-1.2945034503936768,null,4.785914370586397e-06,-0.9999986290931702,null,-0.9999986290931702,-1.9999953508377075,null,-1.2945032119750977,-2.2934749126434326,null,-1.3912373781204224,-2.3901705741882324,null,-1.2945034503936768,-2.2934751510620117,null,-0.9999986290931702,-1.999995231628418,null,-1.9999953508377075,-2.9999988079071045,null,-2.2934749126434326,-3.2927021980285645,null,-2.3901705741882324,-3.389357089996338,null,-2.2934751510620117,-3.2927024364471436,null,-1.999995231628418,-2.9999988079071045,null],"type":"scatter"},{"marker":{"color":"crimson","size":12},"mode":"markers","x":[-3.3970759432122577e-06,4.000002861022949,-8.462980076728854e-07,4.000000953674316,-3.230553375033196e-06,4.000003337860107,-8.018021162570221e-07,4.000000953674316],"y":[4.891303433396388e-06,4.785914370586397e-06,-0.9999986290931702,-0.9999986290931702,-1.9999953508377075,-1.999995231628418,-2.9999988079071045,-2.9999988079071045],"type":"scatter"},{"marker":{"color":"steelblue","size":10},"mode":"markers","x":[0.9810016751289368,2.000000238418579,3.018998384475708,0.9811123013496399,2.0,3.018887996673584,0.9812531471252441,1.999999761581421,3.0187466144561768,0.9813610315322876,1.999999761581421,3.0186386108398438],"y":[-0.29527923464775085,-0.3920278549194336,-0.29527953267097473,-1.2945032119750977,-1.3912373781204224,-1.2945034503936768,-2.2934749126434326,-2.3901705741882324,-2.2934751510620117,-3.2927021980285645,-3.389357089996338,-3.2927024364471436],"type":"scatter"}],"name":"3"},{"data":[{"hoverinfo":"skip","line":{"color":"gray","width":2},"mode":"lines","x":[-1.5230035614877124e-06,0.9738957285881042,null,0.9738957285881042,1.9999992847442627,null,1.9999992847442627,3.026102304458618,null,3.026102304458618,4.000001430511475,null,-1.5332252587541007e-06,0.974104642868042,null,0.974104642868042,1.9999991655349731,null,1.9999991655349731,3.0258941650390625,null,3.0258941650390625,4.000001430511475,null,-1.5055643416417297e-06,0.9743849039077759,null,0.9743849039077759,1.9999984502792358,null,1.9999984502792358,3.0256128311157227,null,3.0256128311157227,4.000001430511475,null,-1.3985592204335262e-06,0.9746055006980896,null,0.9746055006980896,2.0000035762786865,null,2.0000035762786865,3.025400161743164,null,3.025400161743164,4.000005722045898,null,-1.5230035614877124e-06,-1.5332252587541007e-06,null,0.9738957285881042,0.974104642868042,null,1.9999992847442627,1.9999991655349731,null,3.026102304458618,3.0258941650390625,null,4.000001430511475,4.000001430511475,null,-1.5332252587541007e-06,-1.5055643416417297e-06,null,0.974104642868042,0.9743849039077759,null,1.9999991655349731,1.9999984502792358,null,3.0258941650390625,3.0256128311157227,null,4.000001430511475,4.000001430511475,null,-1.5055643416417297e-06,-1.3985592204335262e-06,null,0.9743849039077759,0.9746055006980896,null,1.9999984502792358,2.0000035762786865,null,3.0256128311157227,3.025400161743164,null,4.000001430511475,4.000005722045898,null],"y":[-8.604032473158441e-07,-0.35313326120376587,null,-0.35313326120376587,-0.48157110810279846,null,-0.48157110810279846,-0.3531315326690674,null,-0.3531315326690674,-8.653082659293432e-07,null,-1.0000008344650269,-1.3518249988555908,null,-1.3518249988555908,-1.4801379442214966,null,-1.4801379442214966,-1.3518235683441162,null,-1.3518235683441162,-1.0000008344650269,null,-2.0000009536743164,-2.3500711917877197,null,-2.3500711917877197,-2.4782707691192627,null,-2.4782707691192627,-2.3500704765319824,null,-2.3500704765319824,-2.0000009536743164,null,-3.0000007152557373,-3.348729372024536,null,-3.348729372024536,-3.476891040802002,null,-3.476891040802002,-3.348728656768799,null,-3.348728656768799,-3.0000030994415283,null,-8.604032473158441e-07,-1.0000008344650269,null,-0.35313326120376587,-1.3518249988555908,null,-0.48157110810279846,-1.4801379442214966,null,-0.3531315326690674,-1.3518235683441162,null,-8.653082659293432e-07,-1.0000008344650269,null,-1.0000008344650269,-2.0000009536743164,null,-1.3518249988555908,-2.3500711917877197,null,-1.4801379442214966,-2.4782707691192627,null,-1.3518235683441162,-2.3500704765319824,null,-1.0000008344650269,-2.0000009536743164,null,-2.0000009536743164,-3.0000007152557373,null,-2.3500711917877197,-3.348729372024536,null,-2.4782707691192627,-3.476891040802002,null,-2.3500704765319824,-3.348728656768799,null,-2.0000009536743164,-3.0000030994415283,null],"type":"scatter"},{"marker":{"color":"crimson","size":12},"mode":"markers","x":[-1.5230035614877124e-06,4.000001430511475,-1.5332252587541007e-06,4.000001430511475,-1.5055643416417297e-06,4.000001430511475,-1.3985592204335262e-06,4.000005722045898],"y":[-8.604032473158441e-07,-8.653082659293432e-07,-1.0000008344650269,-1.0000008344650269,-2.0000009536743164,-2.0000009536743164,-3.0000007152557373,-3.0000030994415283],"type":"scatter"},{"marker":{"color":"steelblue","size":10},"mode":"markers","x":[0.9738957285881042,1.9999992847442627,3.026102304458618,0.974104642868042,1.9999991655349731,3.0258941650390625,0.9743849039077759,1.9999984502792358,3.0256128311157227,0.9746055006980896,2.0000035762786865,3.025400161743164],"y":[-0.35313326120376587,-0.48157110810279846,-0.3531315326690674,-1.3518249988555908,-1.4801379442214966,-1.3518235683441162,-2.3500711917877197,-2.4782707691192627,-2.3500704765319824,-3.348729372024536,-3.476891040802002,-3.348728656768799],"type":"scatter"}],"name":"4"},{"data":[{"hoverinfo":"skip","line":{"color":"gray","width":2},"mode":"lines","x":[-1.209342917718459e-05,0.965144157409668,null,0.965144157409668,1.999997854232788,null,1.999997854232788,3.0348546504974365,null,3.0348546504974365,4.000012397766113,null,-1.223233721248107e-05,0.9654987454414368,null,0.9654987454414368,1.9999995231628418,null,1.9999995231628418,3.034498691558838,null,3.034498691558838,4.000012397766113,null,-1.1998489753750619e-05,0.9659736156463623,null,0.9659736156463623,1.9999995231628418,null,1.9999995231628418,3.034024953842163,null,3.034024953842163,4.000012397766113,null,-1.2142949344706722e-05,0.9663406610488892,null,0.9663406610488892,2.0000030994415283,null,2.0000030994415283,3.0336666107177734,null,3.0336666107177734,4.000011444091797,null,-1.209342917718459e-05,-1.223233721248107e-05,null,0.965144157409668,0.9654987454414368,null,1.999997854232788,1.9999995231628418,null,3.0348546504974365,3.034498691558838,null,4.000012397766113,4.000012397766113,null,-1.223233721248107e-05,-1.1998489753750619e-05,null,0.9654987454414368,0.9659736156463623,null,1.9999995231628418,1.9999995231628418,null,3.034498691558838,3.034024953842163,null,4.000012397766113,4.000012397766113,null,-1.1998489753750619e-05,-1.2142949344706722e-05,null,0.9659736156463623,0.9663406610488892,null,1.9999995231628418,2.0000030994415283,null,3.034024953842163,3.0336666107177734,null,4.000012397766113,4.000011444091797,null],"y":[-2.4534012936783256e-06,-0.411237895488739,null,-0.411237895488739,-0.5609261393547058,null,-0.5609261393547058,-0.41123735904693604,null,-0.41123735904693604,-2.450387682984001e-06,null,-1.0000025033950806,-1.409264087677002,null,-1.409264087677002,-1.5587646961212158,null,-1.5587646961212158,-1.409263253211975,null,-1.409263253211975,-1.0000025033950806,null,-2.000002384185791,-2.406627655029297,null,-2.406627655029297,-2.5559089183807373,null,-2.5559089183807373,-2.4066271781921387,null,-2.4066271781921387,-2.000002384185791,null,-3.000002145767212,-3.4046132564544678,null,-3.4046132564544678,-3.5537683963775635,null,-3.5537683963775635,-3.4046151638031006,null,-3.4046151638031006,-3.000002384185791,null,-2.4534012936783256e-06,-1.0000025033950806,null,-0.411237895488739,-1.409264087677002,null,-0.5609261393547058,-1.5587646961212158,null,-0.41123735904693604,-1.409263253211975,null,-2.450387682984001e-06,-1.0000025033950806,null,-1.0000025033950806,-2.000002384185791,null,-1.409264087677002,-2.406627655029297,null,-1.5587646961212158,-2.5559089183807373,null,-1.409263253211975,-2.4066271781921387,null,-1.0000025033950806,-2.000002384185791,null,-2.000002384185791,-3.000002145767212,null,-2.406627655029297,-3.4046132564544678,null,-2.5559089183807373,-3.5537683963775635,null,-2.4066271781921387,-3.4046151638031006,null,-2.000002384185791,-3.000002384185791,null],"type":"scatter"},{"marker":{"color":"crimson","size":12},"mode":"markers","x":[-1.209342917718459e-05,4.000012397766113,-1.223233721248107e-05,4.000012397766113,-1.1998489753750619e-05,4.000012397766113,-1.2142949344706722e-05,4.000011444091797],"y":[-2.4534012936783256e-06,-2.450387682984001e-06,-1.0000025033950806,-1.0000025033950806,-2.000002384185791,-2.000002384185791,-3.000002145767212,-3.000002384185791],"type":"scatter"},{"marker":{"color":"steelblue","size":10},"mode":"markers","x":[0.965144157409668,1.999997854232788,3.0348546504974365,0.9654987454414368,1.9999995231628418,3.034498691558838,0.9659736156463623,1.9999995231628418,3.034024953842163,0.9663406610488892,2.0000030994415283,3.0336666107177734],"y":[-0.411237895488739,-0.5609261393547058,-0.41123735904693604,-1.409264087677002,-1.5587646961212158,-1.409263253211975,-2.406627655029297,-2.5559089183807373,-2.4066271781921387,-3.4046132564544678,-3.5537683963775635,-3.4046151638031006],"type":"scatter"}],"name":"5"},{"data":[{"hoverinfo":"skip","line":{"color":"gray","width":2},"mode":"lines","x":[-3.642834826678154e-06,0.9557300806045532,null,0.9557300806045532,1.9999990463256836,null,1.9999990463256836,3.0442686080932617,null,3.0442686080932617,4.000003814697266,null,-3.5661626043292927e-06,0.9562739133834839,null,0.9562739133834839,1.9999996423721313,null,1.9999996423721313,3.0437254905700684,null,3.0437254905700684,4.000003814697266,null,-3.492672249194584e-06,0.9569934606552124,null,0.9569934606552124,1.999999761581421,null,1.999999761581421,3.043006181716919,null,3.043006181716919,4.000003337860107,null,-3.4881613828474656e-06,0.9575414657592773,null,0.9575414657592773,2.0000016689300537,null,2.0000016689300537,3.0424611568450928,null,3.0424611568450928,4.000003337860107,null,-3.642834826678154e-06,-3.5661626043292927e-06,null,0.9557300806045532,0.9562739133834839,null,1.9999990463256836,1.9999996423721313,null,3.0442686080932617,3.0437254905700684,null,4.000003814697266,4.000003814697266,null,-3.5661626043292927e-06,-3.492672249194584e-06,null,0.9562739133834839,0.9569934606552124,null,1.9999996423721313,1.999999761581421,null,3.0437254905700684,3.043006181716919,null,4.000003814697266,4.000003337860107,null,-3.492672249194584e-06,-3.4881613828474656e-06,null,0.9569934606552124,0.9575414657592773,null,1.999999761581421,2.0000016689300537,null,3.043006181716919,3.0424611568450928,null,4.000003337860107,4.000003337860107,null],"y":[4.274557170447224e-07,-0.46581828594207764,null,-0.46581828594207764,-0.6328831315040588,null,-0.6328831315040588,-0.46581795811653137,null,-0.46581795811653137,4.300131308809796e-07,null,-0.9999995827674866,-1.4630658626556396,null,-1.4630658626556396,-1.6298527717590332,null,-1.6298527717590332,-1.463065505027771,null,-1.463065505027771,-0.9999995231628418,null,-1.9999996423721313,-2.459413528442383,null,-2.459413528442383,-2.625840902328491,null,-2.625840902328491,-2.459414005279541,null,-2.459414005279541,-1.9999995231628418,null,-2.999999761581421,-3.4566328525543213,null,-3.4566328525543213,-3.622821092605591,null,-3.622821092605591,-3.4566335678100586,null,-3.4566335678100586,-2.999999761581421,null,4.274557170447224e-07,-0.9999995827674866,null,-0.46581828594207764,-1.4630658626556396,null,-0.6328831315040588,-1.6298527717590332,null,-0.46581795811653137,-1.463065505027771,null,4.300131308809796e-07,-0.9999995231628418,null,-0.9999995827674866,-1.9999996423721313,null,-1.4630658626556396,-2.459413528442383,null,-1.6298527717590332,-2.625840902328491,null,-1.463065505027771,-2.459414005279541,null,-0.9999995231628418,-1.9999995231628418,null,-1.9999996423721313,-2.999999761581421,null,-2.459413528442383,-3.4566328525543213,null,-2.625840902328491,-3.622821092605591,null,-2.459414005279541,-3.4566335678100586,null,-1.9999995231628418,-2.999999761581421,null],"type":"scatter"},{"marker":{"color":"crimson","size":12},"mode":"markers","x":[-3.642834826678154e-06,4.000003814697266,-3.5661626043292927e-06,4.000003814697266,-3.492672249194584e-06,4.000003337860107,-3.4881613828474656e-06,4.000003337860107],"y":[4.274557170447224e-07,4.300131308809796e-07,-0.9999995827674866,-0.9999995231628418,-1.9999996423721313,-1.9999995231628418,-2.999999761581421,-2.999999761581421],"type":"scatter"},{"marker":{"color":"steelblue","size":10},"mode":"markers","x":[0.9557300806045532,1.9999990463256836,3.0442686080932617,0.9562739133834839,1.9999996423721313,3.0437254905700684,0.9569934606552124,1.999999761581421,3.043006181716919,0.9575414657592773,2.0000016689300537,3.0424611568450928],"y":[-0.46581828594207764,-0.6328831315040588,-0.46581795811653137,-1.4630658626556396,-1.6298527717590332,-1.463065505027771,-2.459413528442383,-2.625840902328491,-2.459414005279541,-3.4566328525543213,-3.622821092605591,-3.4566335678100586],"type":"scatter"}],"name":"6"},{"data":[{"hoverinfo":"skip","line":{"color":"gray","width":2},"mode":"lines","x":[-1.6150260080394219e-06,0.9475899338722229,null,0.9475899338722229,2.0,null,2.0,3.052410125732422,null,3.052410125732422,4.000001907348633,null,-1.580415641910804e-06,0.9483292102813721,null,0.9483292102813721,2.0,null,2.0,3.051670789718628,null,3.051670789718628,4.000001430511475,null,-1.514373025202076e-06,0.9493181109428406,null,0.9493181109428406,2.0,null,2.0,3.0506818294525146,null,3.0506818294525146,4.000001430511475,null,-5.8679615904111415e-06,0.950080931186676,null,0.950080931186676,2.0,null,2.0,3.0499188899993896,null,3.0499188899993896,4.000005722045898,null,-1.6150260080394219e-06,-1.580415641910804e-06,null,0.9475899338722229,0.9483292102813721,null,2.0,2.0,null,3.052410125732422,3.051670789718628,null,4.000001907348633,4.000001430511475,null,-1.580415641910804e-06,-1.514373025202076e-06,null,0.9483292102813721,0.9493181109428406,null,2.0,2.0,null,3.051670789718628,3.0506818294525146,null,4.000001430511475,4.000001430511475,null,-1.514373025202076e-06,-5.8679615904111415e-06,null,0.9493181109428406,0.950080931186676,null,2.0,2.0,null,3.0506818294525146,3.0499188899993896,null,4.000001430511475,4.000005722045898,null],"y":[-8.278558425445226e-07,-0.5144438743591309,null,-0.5144438743591309,-0.7073013782501221,null,-0.7073013782501221,-0.5144438147544861,null,-0.5144438147544861,-8.2807252965722e-07,null,-1.0000008344650269,-1.5108658075332642,null,-1.5108658075332642,-1.7031922340393066,null,-1.7031922340393066,-1.5108658075332642,null,-1.5108658075332642,-1.0000008344650269,null,-2.0000007152557373,-2.506101131439209,null,-2.506101131439209,-2.6978249549865723,null,-2.6978249549865723,-2.506101131439209,null,-2.506101131439209,-2.0000007152557373,null,-3.0000030994415283,-3.502441644668579,null,-3.502441644668579,-3.693831443786621,null,-3.693831443786621,-3.50244140625,null,-3.50244140625,-3.0000030994415283,null,-8.278558425445226e-07,-1.0000008344650269,null,-0.5144438743591309,-1.5108658075332642,null,-0.7073013782501221,-1.7031922340393066,null,-0.5144438147544861,-1.5108658075332642,null,-8.2807252965722e-07,-1.0000008344650269,null,-1.0000008344650269,-2.0000007152557373,null,-1.5108658075332642,-2.506101131439209,null,-1.7031922340393066,-2.6978249549865723,null,-1.5108658075332642,-2.506101131439209,null,-1.0000008344650269,-2.0000007152557373,null,-2.0000007152557373,-3.0000030994415283,null,-2.506101131439209,-3.502441644668579,null,-2.6978249549865723,-3.693831443786621,null,-2.506101131439209,-3.50244140625,null,-2.0000007152557373,-3.0000030994415283,null],"type":"scatter"},{"marker":{"color":"crimson","size":12},"mode":"markers","x":[-1.6150260080394219e-06,4.000001907348633,-1.580415641910804e-06,4.000001430511475,-1.514373025202076e-06,4.000001430511475,-5.8679615904111415e-06,4.000005722045898],"y":[-8.278558425445226e-07,-8.2807252965722e-07,-1.0000008344650269,-1.0000008344650269,-2.0000007152557373,-2.0000007152557373,-3.0000030994415283,-3.0000030994415283],"type":"scatter"},{"marker":{"color":"steelblue","size":10},"mode":"markers","x":[0.9475899338722229,2.0,3.052410125732422,0.9483292102813721,2.0,3.051670789718628,0.9493181109428406,2.0,3.0506818294525146,0.950080931186676,2.0,3.0499188899993896],"y":[-0.5144438743591309,-0.7073013782501221,-0.5144438147544861,-1.5108658075332642,-1.7031922340393066,-1.5108658075332642,-2.506101131439209,-2.6978249549865723,-2.506101131439209,-3.502441644668579,-3.693831443786621,-3.50244140625],"type":"scatter"}],"name":"7"},{"data":[{"hoverinfo":"skip","line":{"color":"gray","width":2},"mode":"lines","x":[2.4223856254224074e-10,0.930804967880249,null,0.930804967880249,2.0,null,2.0,3.06919527053833,null,3.06919527053833,4.0,null,2.3135297844145697e-10,0.9319822788238525,null,0.9319822788238525,2.0,null,2.0,3.0680177211761475,null,3.0680177211761475,4.0,null,2.2280198519464278e-10,0.933406412601471,null,0.933406412601471,2.0,null,2.0,3.066593647003174,null,3.066593647003174,3.999999761581421,null,2.2039287062014523e-10,0.9343958497047424,null,0.9343958497047424,2.0,null,2.0,3.0656042098999023,null,3.0656042098999023,3.999999761581421,null,2.4223856254224074e-10,2.3135297844145697e-10,null,0.930804967880249,0.9319822788238525,null,2.0,2.0,null,3.06919527053833,3.0680177211761475,null,4.0,4.0,null,2.3135297844145697e-10,2.2280198519464278e-10,null,0.9319822788238525,0.933406412601471,null,2.0,2.0,null,3.0680177211761475,3.066593647003174,null,4.0,3.999999761581421,null,2.2280198519464278e-10,2.2039287062014523e-10,null,0.933406412601471,0.9343958497047424,null,2.0,2.0,null,3.066593647003174,3.0656042098999023,null,3.999999761581421,3.999999761581421,null],"y":[1.1632839136410666e-10,-0.5776047706604004,null,-0.5776047706604004,-0.7572165131568909,null,-0.7572165131568909,-0.5776047706604004,null,-0.5776047706604004,1.1633032037661195e-10,null,-1.0,-1.5728429555892944,null,-1.5728429555892944,-1.7524083852767944,null,-1.7524083852767944,-1.5728429555892944,null,-1.5728429555892944,-1.0,null,-2.0,-2.56675386428833,null,-2.56675386428833,-2.7457354068756104,null,-2.7457354068756104,-2.566754102706909,null,-2.566754102706909,-1.9999998807907104,null,-3.0,-3.5622544288635254,null,-3.5622544288635254,-3.7404448986053467,null,-3.7404448986053467,-3.5622546672821045,null,-3.5622546672821045,-2.999999761581421,null,1.1632839136410666e-10,-1.0,null,-0.5776047706604004,-1.5728429555892944,null,-0.7572165131568909,-1.7524083852767944,null,-0.5776047706604004,-1.5728429555892944,null,1.1633032037661195e-10,-1.0,null,-1.0,-2.0,null,-1.5728429555892944,-2.56675386428833,null,-1.7524083852767944,-2.7457354068756104,null,-1.5728429555892944,-2.566754102706909,null,-1.0,-1.9999998807907104,null,-2.0,-3.0,null,-2.56675386428833,-3.5622544288635254,null,-2.7457354068756104,-3.7404448986053467,null,-2.566754102706909,-3.5622546672821045,null,-1.9999998807907104,-2.999999761581421,null],"type":"scatter"},{"marker":{"color":"crimson","size":12},"mode":"markers","x":[2.4223856254224074e-10,4.0,2.3135297844145697e-10,4.0,2.2280198519464278e-10,3.999999761581421,2.2039287062014523e-10,3.999999761581421],"y":[1.1632839136410666e-10,1.1633032037661195e-10,-1.0,-1.0,-2.0,-1.9999998807907104,-3.0,-2.999999761581421],"type":"scatter"},{"marker":{"color":"steelblue","size":10},"mode":"markers","x":[0.930804967880249,2.0,3.06919527053833,0.9319822788238525,2.0,3.0680177211761475,0.933406412601471,2.0,3.066593647003174,0.9343958497047424,2.0,3.0656042098999023],"y":[-0.5776047706604004,-0.7572165131568909,-0.5776047706604004,-1.5728429555892944,-1.7524083852767944,-1.5728429555892944,-2.56675386428833,-2.7457354068756104,-2.566754102706909,-3.5622544288635254,-3.7404448986053467,-3.5622546672821045],"type":"scatter"}],"name":"8"},{"data":[{"hoverinfo":"skip","line":{"color":"gray","width":2},"mode":"lines","x":[3.2276450383506017e-06,0.927635908126831,null,0.927635908126831,2.0,null,2.0,3.072364091873169,null,3.072364091873169,3.9999966621398926,null,3.0153594252624316e-06,0.928930938243866,null,0.928930938243866,2.0,null,2.0,3.0710690021514893,null,3.0710690021514893,3.999997138977051,null,2.7964711080130655e-06,0.9306068420410156,null,0.9306068420410156,2.0,null,2.0,3.0693933963775635,null,3.0693933963775635,3.99999737739563,null,2.7064688765676692e-06,0.9318708777427673,null,0.9318708777427673,2.0,null,2.0,3.068129062652588,null,3.068129062652588,3.999997138977051,null,3.2276450383506017e-06,3.0153594252624316e-06,null,0.927635908126831,0.928930938243866,null,2.0,2.0,null,3.072364091873169,3.0710690021514893,null,3.9999966621398926,3.999997138977051,null,3.0153594252624316e-06,2.7964711080130655e-06,null,0.928930938243866,0.9306068420410156,null,2.0,2.0,null,3.0710690021514893,3.0693933963775635,null,3.999997138977051,3.99999737739563,null,2.7964711080130655e-06,2.7064688765676692e-06,null,0.9306068420410156,0.9318708777427673,null,2.0,2.0,null,3.0693933963775635,3.068129062652588,null,3.99999737739563,3.999997138977051,null],"y":[4.396815711515956e-06,-0.613798975944519,null,-0.613798975944519,-0.8393727540969849,null,-0.8393727540969849,-0.613798975944519,null,-0.613798975944519,4.396933945827186e-06,null,-0.999995768070221,-1.6082065105438232,null,-1.6082065105438232,-1.8330391645431519,null,-1.8330391645431519,-1.6082065105438232,null,-1.6082065105438232,-0.999995768070221,null,-1.9999958276748657,-2.60087513923645,null,-2.60087513923645,-2.8246207237243652,null,-2.8246207237243652,-2.60087513923645,null,-2.60087513923645,-1.9999958276748657,null,-2.9999959468841553,-3.5952863693237305,null,-3.5952863693237305,-3.8182079792022705,null,-3.8182079792022705,-3.5952863693237305,null,-3.5952863693237305,-2.9999959468841553,null,4.396815711515956e-06,-0.999995768070221,null,-0.613798975944519,-1.6082065105438232,null,-0.8393727540969849,-1.8330391645431519,null,-0.613798975944519,-1.6082065105438232,null,4.396933945827186e-06,-0.999995768070221,null,-0.999995768070221,-1.9999958276748657,null,-1.6082065105438232,-2.60087513923645,null,-1.8330391645431519,-2.8246207237243652,null,-1.6082065105438232,-2.60087513923645,null,-0.999995768070221,-1.9999958276748657,null,-1.9999958276748657,-2.9999959468841553,null,-2.60087513923645,-3.5952863693237305,null,-2.8246207237243652,-3.8182079792022705,null,-2.60087513923645,-3.5952863693237305,null,-1.9999958276748657,-2.9999959468841553,null],"type":"scatter"},{"marker":{"color":"crimson","size":12},"mode":"markers","x":[3.2276450383506017e-06,3.9999966621398926,3.0153594252624316e-06,3.999997138977051,2.7964711080130655e-06,3.99999737739563,2.7064688765676692e-06,3.999997138977051],"y":[4.396815711515956e-06,4.396933945827186e-06,-0.999995768070221,-0.999995768070221,-1.9999958276748657,-1.9999958276748657,-2.9999959468841553,-2.9999959468841553],"type":"scatter"},{"marker":{"color":"steelblue","size":10},"mode":"markers","x":[0.927635908126831,2.0,3.072364091873169,0.928930938243866,2.0,3.0710690021514893,0.9306068420410156,2.0,3.0693933963775635,0.9318708777427673,2.0,3.068129062652588],"y":[-0.613798975944519,-0.8393727540969849,-0.613798975944519,-1.6082065105438232,-1.8330391645431519,-1.6082065105438232,-2.60087513923645,-2.8246207237243652,-2.60087513923645,-3.5952863693237305,-3.8182079792022705,-3.5952863693237305],"type":"scatter"}],"name":"9"},{"data":[{"hoverinfo":"skip","line":{"color":"gray","width":2},"mode":"lines","x":[5.1770707614196e-06,0.9189768433570862,null,0.9189768433570862,2.0,null,2.0,3.0810232162475586,null,3.0810232162475586,3.9999947547912598,null,4.69797396362992e-06,0.9205572009086609,null,0.9205572009086609,2.0,null,2.0,3.0794427394866943,null,3.0794427394866943,3.999995231628418,null,4.310243184590945e-06,0.9225888252258301,null,0.9225888252258301,2.0,null,2.0,3.07741117477417,null,3.07741117477417,3.999995708465576,null,4.336665369919501e-06,0.9241225123405457,null,0.9241225123405457,2.0,null,2.0,3.0758774280548096,null,3.0758774280548096,3.999995708465576,null,5.1770707614196e-06,4.69797396362992e-06,null,0.9189768433570862,0.9205572009086609,null,2.0,2.0,null,3.0810232162475586,3.0794427394866943,null,3.9999947547912598,3.999995231628418,null,4.69797396362992e-06,4.310243184590945e-06,null,0.9205572009086609,0.9225888252258301,null,2.0,2.0,null,3.0794427394866943,3.07741117477417,null,3.999995231628418,3.999995708465576,null,4.310243184590945e-06,4.336665369919501e-06,null,0.9225888252258301,0.9241225123405457,null,2.0,2.0,null,3.07741117477417,3.0758774280548096,null,3.999995708465576,3.999995708465576,null],"y":[3.0268272439570865e-06,-0.6587205529212952,null,-0.6587205529212952,-0.9063071608543396,null,-0.9063071608543396,-0.6587205529212952,null,-0.6587205529212952,3.0263518056017347e-06,null,-0.9999973773956299,-1.6520363092422485,null,-1.6520363092422485,-1.8986283540725708,null,-1.8986283540725708,-1.652036190032959,null,-1.652036190032959,-0.9999973773956299,null,-1.9999973773956299,-2.6433122158050537,null,-2.6433122158050537,-2.8884389400482178,null,-2.8884389400482178,-2.6433119773864746,null,-2.6433119773864746,-1.9999973773956299,null,-2.99999737739563,-3.636655569076538,null,-3.636655569076538,-3.880671262741089,null,-3.880671262741089,-3.636655330657959,null,-3.636655330657959,-2.99999737739563,null,3.0268272439570865e-06,-0.9999973773956299,null,-0.6587205529212952,-1.6520363092422485,null,-0.9063071608543396,-1.8986283540725708,null,-0.6587205529212952,-1.652036190032959,null,3.0263518056017347e-06,-0.9999973773956299,null,-0.9999973773956299,-1.9999973773956299,null,-1.6520363092422485,-2.6433122158050537,null,-1.8986283540725708,-2.8884389400482178,null,-1.652036190032959,-2.6433119773864746,null,-0.9999973773956299,-1.9999973773956299,null,-1.9999973773956299,-2.99999737739563,null,-2.6433122158050537,-3.636655569076538,null,-2.8884389400482178,-3.880671262741089,null,-2.6433119773864746,-3.636655330657959,null,-1.9999973773956299,-2.99999737739563,null],"type":"scatter"},{"marker":{"color":"crimson","size":12},"mode":"markers","x":[5.1770707614196e-06,3.9999947547912598,4.69797396362992e-06,3.999995231628418,4.310243184590945e-06,3.999995708465576,4.336665369919501e-06,3.999995708465576],"y":[3.0268272439570865e-06,3.0263518056017347e-06,-0.9999973773956299,-0.9999973773956299,-1.9999973773956299,-1.9999973773956299,-2.99999737739563,-2.99999737739563],"type":"scatter"},{"marker":{"color":"steelblue","size":10},"mode":"markers","x":[0.9189768433570862,2.0,3.0810232162475586,0.9205572009086609,2.0,3.0794427394866943,0.9225888252258301,2.0,3.07741117477417,0.9241225123405457,2.0,3.0758774280548096],"y":[-0.6587205529212952,-0.9063071608543396,-0.6587205529212952,-1.6520363092422485,-1.8986283540725708,-1.652036190032959,-2.6433122158050537,-2.8884389400482178,-2.6433119773864746,-3.636655569076538,-3.880671262741089,-3.636655330657959],"type":"scatter"}],"name":"10"},{"data":[{"hoverinfo":"skip","line":{"color":"gray","width":2},"mode":"lines","x":[-2.390595000179019e-06,0.9106377959251404,null,0.9106377959251404,2.0,null,2.0,3.089362144470215,null,3.089362144470215,4.000002384185791,null,-2.2192762116901577e-06,0.9124413728713989,null,0.9124413728713989,2.0,null,2.0,3.0875585079193115,null,3.0875585079193115,4.000002384185791,null,-2.09722156796488e-06,0.9148069024085999,null,0.9148069024085999,2.0,null,2.0,3.085193157196045,null,3.085193157196045,4.000001907348633,null,-2.0747877442772733e-06,0.9166329503059387,null,0.9166329503059387,2.0,null,2.0,3.083367109298706,null,3.083367109298706,4.000001907348633,null,-2.390595000179019e-06,-2.2192762116901577e-06,null,0.9106377959251404,0.9124413728713989,null,2.0,2.0,null,3.089362144470215,3.0875585079193115,null,4.000002384185791,4.000002384185791,null,-2.2192762116901577e-06,-2.09722156796488e-06,null,0.9124413728713989,0.9148069024085999,null,2.0,2.0,null,3.0875585079193115,3.085193157196045,null,4.000002384185791,4.000001907348633,null,-2.09722156796488e-06,-2.0747877442772733e-06,null,0.9148069024085999,0.9166329503059387,null,2.0,2.0,null,3.085193157196045,3.083367109298706,null,4.000001907348633,4.000001907348633,null],"y":[-1.01601290225517e-06,-0.702760636806488,null,-0.702760636806488,-0.9739272594451904,null,-0.9739272594451904,-0.7027605772018433,null,-0.7027605772018433,-1.0163669230678352e-06,null,-1.0000008344650269,-1.69503915309906,null,-1.69503915309906,-1.9646979570388794,null,-1.9646979570388794,-1.69503915309906,null,-1.69503915309906,-1.0000008344650269,null,-2.0000009536743164,-2.68489933013916,null,-2.68489933013916,-2.952558994293213,null,-2.952558994293213,-2.684899091720581,null,-2.684899091720581,-2.0000009536743164,null,-3.0000009536743164,-3.6770904064178467,null,-3.6770904064178467,-3.9433674812316895,null,-3.9433674812316895,-3.6770904064178467,null,-3.6770904064178467,-3.0000009536743164,null,-1.01601290225517e-06,-1.0000008344650269,null,-0.702760636806488,-1.69503915309906,null,-0.9739272594451904,-1.9646979570388794,null,-0.7027605772018433,-1.69503915309906,null,-1.0163669230678352e-06,-1.0000008344650269,null,-1.0000008344650269,-2.0000009536743164,null,-1.69503915309906,-2.68489933013916,null,-1.9646979570388794,-2.952558994293213,null,-1.69503915309906,-2.684899091720581,null,-1.0000008344650269,-2.0000009536743164,null,-2.0000009536743164,-3.0000009536743164,null,-2.68489933013916,-3.6770904064178467,null,-2.952558994293213,-3.9433674812316895,null,-2.684899091720581,-3.6770904064178467,null,-2.0000009536743164,-3.0000009536743164,null],"type":"scatter"},{"marker":{"color":"crimson","size":12},"mode":"markers","x":[-2.390595000179019e-06,4.000002384185791,-2.2192762116901577e-06,4.000002384185791,-2.09722156796488e-06,4.000001907348633,-2.0747877442772733e-06,4.000001907348633],"y":[-1.01601290225517e-06,-1.0163669230678352e-06,-1.0000008344650269,-1.0000008344650269,-2.0000009536743164,-2.0000009536743164,-3.0000009536743164,-3.0000009536743164],"type":"scatter"},{"marker":{"color":"steelblue","size":10},"mode":"markers","x":[0.9106377959251404,2.0,3.089362144470215,0.9124413728713989,2.0,3.0875585079193115,0.9148069024085999,2.0,3.085193157196045,0.9166329503059387,2.0,3.083367109298706],"y":[-0.702760636806488,-0.9739272594451904,-0.7027605772018433,-1.69503915309906,-1.9646979570388794,-1.69503915309906,-2.68489933013916,-2.952558994293213,-2.684899091720581,-3.6770904064178467,-3.9433674812316895,-3.6770904064178467],"type":"scatter"}],"name":"11"},{"data":[{"hoverinfo":"skip","line":{"color":"gray","width":2},"mode":"lines","x":[3.7533707200054778e-06,0.9008311629295349,null,0.9008311629295349,2.0,null,2.0,3.0991687774658203,null,3.0991687774658203,3.9999964237213135,null,3.4306522138649598e-06,0.9029920697212219,null,0.9029920697212219,2.0,null,2.0,3.097007989883423,null,3.097007989883423,3.9999964237213135,null,3.155097601847956e-06,0.9057705998420715,null,0.9057705998420715,2.0,null,2.0,3.0942294597625732,null,3.0942294597625732,3.9999969005584717,null,3.0707183213962708e-06,0.9078841209411621,null,0.9078841209411621,2.0,null,2.0,3.092115879058838,null,3.092115879058838,3.9999966621398926,null,3.7533707200054778e-06,3.4306522138649598e-06,null,0.9008311629295349,0.9029920697212219,null,2.0,2.0,null,3.0991687774658203,3.097007989883423,null,3.9999964237213135,3.9999964237213135,null,3.4306522138649598e-06,3.155097601847956e-06,null,0.9029920697212219,0.9057705998420715,null,2.0,2.0,null,3.097007989883423,3.0942294597625732,null,3.9999964237213135,3.9999969005584717,null,3.155097601847956e-06,3.0707183213962708e-06,null,0.9057705998420715,0.9078841209411621,null,2.0,2.0,null,3.0942294597625732,3.092115879058838,null,3.9999969005584717,3.9999966621398926,null],"y":[3.150583324895706e-06,-0.748477578163147,null,-0.748477578163147,-1.036543846130371,null,-1.036543846130371,-0.7484775185585022,null,-0.7484775185585022,3.1507856874668505e-06,null,-0.9999970197677612,-1.7394877672195435,null,-1.7394877672195435,-2.0259368419647217,null,-2.0259368419647217,-1.7394877672195435,null,-1.7394877672195435,-0.9999970197677612,null,-1.9999971389770508,-2.7277755737304688,null,-2.7277755737304688,-3.011857509613037,null,-3.011857509613037,-2.7277755737304688,null,-2.7277755737304688,-1.9999971389770508,null,-2.999997138977051,-3.718794107437134,null,-3.718794107437134,-4.001073360443115,null,-4.001073360443115,-3.718794107437134,null,-3.718794107437134,-2.999997138977051,null,3.150583324895706e-06,-0.9999970197677612,null,-0.748477578163147,-1.7394877672195435,null,-1.036543846130371,-2.0259368419647217,null,-0.7484775185585022,-1.7394877672195435,null,3.1507856874668505e-06,-0.9999970197677612,null,-0.9999970197677612,-1.9999971389770508,null,-1.7394877672195435,-2.7277755737304688,null,-2.0259368419647217,-3.011857509613037,null,-1.7394877672195435,-2.7277755737304688,null,-0.9999970197677612,-1.9999971389770508,null,-1.9999971389770508,-2.999997138977051,null,-2.7277755737304688,-3.718794107437134,null,-3.011857509613037,-4.001073360443115,null,-2.7277755737304688,-3.718794107437134,null,-1.9999971389770508,-2.999997138977051,null],"type":"scatter"},{"marker":{"color":"crimson","size":12},"mode":"markers","x":[3.7533707200054778e-06,3.9999964237213135,3.4306522138649598e-06,3.9999964237213135,3.155097601847956e-06,3.9999969005584717,3.0707183213962708e-06,3.9999966621398926],"y":[3.150583324895706e-06,3.1507856874668505e-06,-0.9999970197677612,-0.9999970197677612,-1.9999971389770508,-1.9999971389770508,-2.999997138977051,-2.999997138977051],"type":"scatter"},{"marker":{"color":"steelblue","size":10},"mode":"markers","x":[0.9008311629295349,2.0,3.0991687774658203,0.9029920697212219,2.0,3.097007989883423,0.9057705998420715,2.0,3.0942294597625732,0.9078841209411621,2.0,3.092115879058838],"y":[-0.748477578163147,-1.036543846130371,-0.7484775185585022,-1.7394877672195435,-2.0259368419647217,-1.7394877672195435,-2.7277755737304688,-3.011857509613037,-2.7277755737304688,-3.718794107437134,-4.001073360443115,-3.718794107437134],"type":"scatter"}],"name":"12"},{"data":[{"hoverinfo":"skip","line":{"color":"gray","width":2},"mode":"lines","x":[-4.1775933823373634e-06,0.8944645524024963,null,0.8944645524024963,2.0,null,2.0,3.1055352687835693,null,3.1055352687835693,4.000004291534424,null,-3.87712316296529e-06,0.8967646956443787,null,0.8967646956443787,2.0,null,2.0,3.1032352447509766,null,3.1032352447509766,4.000003814697266,null,-3.644359367172001e-06,0.899806797504425,null,0.899806797504425,2.0,null,2.0,3.1001932621002197,null,3.1001932621002197,4.000003814697266,null,-3.58013767254306e-06,0.9021981954574585,null,0.9021981954574585,2.0,null,2.0,3.097801685333252,null,3.097801685333252,4.000003337860107,null,-4.1775933823373634e-06,-3.87712316296529e-06,null,0.8944645524024963,0.8967646956443787,null,2.0,2.0,null,3.1055352687835693,3.1032352447509766,null,4.000004291534424,4.000003814697266,null,-3.87712316296529e-06,-3.644359367172001e-06,null,0.8967646956443787,0.899806797504425,null,2.0,2.0,null,3.1032352447509766,3.1001932621002197,null,4.000003814697266,4.000003814697266,null,-3.644359367172001e-06,-3.58013767254306e-06,null,0.899806797504425,0.9021981954574585,null,2.0,2.0,null,3.1001932621002197,3.097801685333252,null,4.000003814697266,4.000003337860107,null],"y":[-1.564622721161868e-06,-0.7885861396789551,null,-0.7885861396789551,-1.1053168773651123,null,-1.1053168773651123,-0.7885861396789551,null,-0.7885861396789551,-1.5649131910322467e-06,null,-1.0000014305114746,-1.7785210609436035,null,-1.7785210609436035,-2.0927987098693848,null,-2.0927987098693848,-1.778521180152893,null,-1.778521180152893,-1.0000014305114746,null,-2.0000014305114746,-2.7653133869171143,null,-2.7653133869171143,-3.076427459716797,null,-3.076427459716797,-2.7653133869171143,null,-2.7653133869171143,-2.0000014305114746,null,-3.0000011920928955,-3.7550675868988037,null,-3.7550675868988037,-4.0640482902526855,null,-4.0640482902526855,-3.755067825317383,null,-3.755067825317383,-3.0000011920928955,null,-1.564622721161868e-06,-1.0000014305114746,null,-0.7885861396789551,-1.7785210609436035,null,-1.1053168773651123,-2.0927987098693848,null,-0.7885861396789551,-1.778521180152893,null,-1.5649131910322467e-06,-1.0000014305114746,null,-1.0000014305114746,-2.0000014305114746,null,-1.7785210609436035,-2.7653133869171143,null,-2.0927987098693848,-3.076427459716797,null,-1.778521180152893,-2.7653133869171143,null,-1.0000014305114746,-2.0000014305114746,null,-2.0000014305114746,-3.0000011920928955,null,-2.7653133869171143,-3.7550675868988037,null,-3.076427459716797,-4.0640482902526855,null,-2.7653133869171143,-3.755067825317383,null,-2.0000014305114746,-3.0000011920928955,null],"type":"scatter"},{"marker":{"color":"crimson","size":12},"mode":"markers","x":[-4.1775933823373634e-06,4.000004291534424,-3.87712316296529e-06,4.000003814697266,-3.644359367172001e-06,4.000003814697266,-3.58013767254306e-06,4.000003337860107],"y":[-1.564622721161868e-06,-1.5649131910322467e-06,-1.0000014305114746,-1.0000014305114746,-2.0000014305114746,-2.0000014305114746,-3.0000011920928955,-3.0000011920928955],"type":"scatter"},{"marker":{"color":"steelblue","size":10},"mode":"markers","x":[0.8944645524024963,2.0,3.1055352687835693,0.8967646956443787,2.0,3.1032352447509766,0.899806797504425,2.0,3.1001932621002197,0.9021981954574585,2.0,3.097801685333252],"y":[-0.7885861396789551,-1.1053168773651123,-0.7885861396789551,-1.7785210609436035,-2.0927987098693848,-1.778521180152893,-2.7653133869171143,-3.076427459716797,-2.7653133869171143,-3.7550675868988037,-4.0640482902526855,-3.755067825317383],"type":"scatter"}],"name":"13"},{"data":[{"hoverinfo":"skip","line":{"color":"gray","width":2},"mode":"lines","x":[-6.107244189479388e-06,0.88760906457901,null,0.88760906457901,2.0,null,2.0,3.1123909950256348,null,3.1123909950256348,4.000006198883057,null,-5.640011295326985e-06,0.8901002407073975,null,0.8901002407073975,2.0,null,2.0,3.1098999977111816,null,3.1098999977111816,4.000005722045898,null,-5.252389655652223e-06,0.893426775932312,null,0.893426775932312,2.0,null,2.0,3.1065733432769775,null,3.1065733432769775,4.00000524520874,null,-5.121196863910882e-06,0.8960810899734497,null,0.8960810899734497,2.0,null,2.0,3.1039187908172607,null,3.1039187908172607,4.00000524520874,null,-6.107244189479388e-06,-5.640011295326985e-06,null,0.88760906457901,0.8901002407073975,null,2.0,2.0,null,3.1123909950256348,3.1098999977111816,null,4.000006198883057,4.000005722045898,null,-5.640011295326985e-06,-5.252389655652223e-06,null,0.8901002407073975,0.893426775932312,null,2.0,2.0,null,3.1098999977111816,3.1065733432769775,null,4.000005722045898,4.00000524520874,null,-5.252389655652223e-06,-5.121196863910882e-06,null,0.893426775932312,0.8960810899734497,null,2.0,2.0,null,3.1065733432769775,3.1039187908172607,null,4.00000524520874,4.00000524520874,null],"y":[-2.6937796064885333e-06,-0.8295331001281738,null,-0.8295331001281738,-1.1718766689300537,null,-1.1718766689300537,-0.829533040523529,null,-0.829533040523529,-2.6938485007121926e-06,null,-1.0000025033950806,-1.8182581663131714,null,-1.8182581663131714,-2.1574933528900146,null,-2.1574933528900146,-1.8182581663131714,null,-1.8182581663131714,-1.0000025033950806,null,-2.000002384185791,-2.8034512996673584,null,-2.8034512996673584,-3.1387758255004883,null,-3.1387758255004883,-2.8034512996673584,null,-2.8034512996673584,-2.000002384185791,null,-3.000002384185791,-3.7919094562530518,null,-3.7919094562530518,-4.124667167663574,null,-4.124667167663574,-3.7919094562530518,null,-3.7919094562530518,-3.000002384185791,null,-2.6937796064885333e-06,-1.0000025033950806,null,-0.8295331001281738,-1.8182581663131714,null,-1.1718766689300537,-2.1574933528900146,null,-0.829533040523529,-1.8182581663131714,null,-2.6938485007121926e-06,-1.0000025033950806,null,-1.0000025033950806,-2.000002384185791,null,-1.8182581663131714,-2.8034512996673584,null,-2.1574933528900146,-3.1387758255004883,null,-1.8182581663131714,-2.8034512996673584,null,-1.0000025033950806,-2.000002384185791,null,-2.000002384185791,-3.000002384185791,null,-2.8034512996673584,-3.7919094562530518,null,-3.1387758255004883,-4.124667167663574,null,-2.8034512996673584,-3.7919094562530518,null,-2.000002384185791,-3.000002384185791,null],"type":"scatter"},{"marker":{"color":"crimson","size":12},"mode":"markers","x":[-6.107244189479388e-06,4.000006198883057,-5.640011295326985e-06,4.000005722045898,-5.252389655652223e-06,4.00000524520874,-5.121196863910882e-06,4.00000524520874],"y":[-2.6937796064885333e-06,-2.6938485007121926e-06,-1.0000025033950806,-1.0000025033950806,-2.000002384185791,-2.000002384185791,-3.000002384185791,-3.000002384185791],"type":"scatter"},{"marker":{"color":"steelblue","size":10},"mode":"markers","x":[0.88760906457901,2.0,3.1123909950256348,0.8901002407073975,2.0,3.1098999977111816,0.893426775932312,2.0,3.1065733432769775,0.8960810899734497,2.0,3.1039187908172607],"y":[-0.8295331001281738,-1.1718766689300537,-0.829533040523529,-1.8182581663131714,-2.1574933528900146,-1.8182581663131714,-2.8034512996673584,-3.1387758255004883,-2.8034512996673584,-3.7919094562530518,-4.124667167663574,-3.7919094562530518],"type":"scatter"}],"name":"14"},{"data":[{"hoverinfo":"skip","line":{"color":"gray","width":2},"mode":"lines","x":[-1.9353021798451664e-06,0.8813576698303223,null,0.8813576698303223,1.999999761581421,null,1.999999761581421,3.1186418533325195,null,3.1186418533325195,4.000000476837158,null,-7.127020126063144e-06,0.8840068578720093,null,0.8840068578720093,2.0,null,2.0,3.1159932613372803,null,3.1159932613372803,4.000007152557373,null,-1.667503738644882e-06,0.8875842690467834,null,0.8875842690467834,2.0,null,2.0,3.1124157905578613,null,3.1124157905578613,4.000001430511475,null,-1.6233004771493142e-06,0.8904839158058167,null,0.8904839158058167,1.9999998807907104,null,1.9999998807907104,3.109515905380249,null,3.109515905380249,4.0,null,-1.9353021798451664e-06,-7.127020126063144e-06,null,0.8813576698303223,0.8840068578720093,null,1.999999761581421,2.0,null,3.1186418533325195,3.1159932613372803,null,4.000000476837158,4.000007152557373,null,-7.127020126063144e-06,-1.667503738644882e-06,null,0.8840068578720093,0.8875842690467834,null,2.0,2.0,null,3.1159932613372803,3.1124157905578613,null,4.000007152557373,4.000001430511475,null,-1.667503738644882e-06,-1.6233004771493142e-06,null,0.8875842690467834,0.8904839158058167,null,2.0,1.9999998807907104,null,3.1124157905578613,3.109515905380249,null,4.000001430511475,4.0,null],"y":[-8.282940484605206e-07,-0.8699859976768494,null,-0.8699859976768494,-1.2388010025024414,null,-1.2388010025024414,-0.8699862360954285,null,-0.8699862360954285,-2.067289130991412e-07,null,-1.0000030994415283,-1.8574519157409668,null,-1.8574519157409668,-2.2224483489990234,null,-2.2224483489990234,-1.857452154159546,null,-1.857452154159546,-1.0000030994415283,null,-2.0000007152557373,-2.8409857749938965,null,-2.8409857749938965,-3.2012548446655273,null,-3.2012548446655273,-2.8409860134124756,null,-2.8409860134124756,-2.0000007152557373,null,-3.0000007152557373,-3.8280985355377197,null,-3.8280985355377197,-4.1853156089782715,null,-4.1853156089782715,-3.828099012374878,null,-3.828099012374878,-3.0,null,-8.282940484605206e-07,-1.0000030994415283,null,-0.8699859976768494,-1.8574519157409668,null,-1.2388010025024414,-2.2224483489990234,null,-0.8699862360954285,-1.857452154159546,null,-2.067289130991412e-07,-1.0000030994415283,null,-1.0000030994415283,-2.0000007152557373,null,-1.8574519157409668,-2.8409857749938965,null,-2.2224483489990234,-3.2012548446655273,null,-1.857452154159546,-2.8409860134124756,null,-1.0000030994415283,-2.0000007152557373,null,-2.0000007152557373,-3.0000007152557373,null,-2.8409857749938965,-3.8280985355377197,null,-3.2012548446655273,-4.1853156089782715,null,-2.8409860134124756,-3.828099012374878,null,-2.0000007152557373,-3.0,null],"type":"scatter"},{"marker":{"color":"crimson","size":12},"mode":"markers","x":[-1.9353021798451664e-06,4.000000476837158,-7.127020126063144e-06,4.000007152557373,-1.667503738644882e-06,4.000001430511475,-1.6233004771493142e-06,4.0],"y":[-8.282940484605206e-07,-2.067289130991412e-07,-1.0000030994415283,-1.0000030994415283,-2.0000007152557373,-2.0000007152557373,-3.0000007152557373,-3.0],"type":"scatter"},{"marker":{"color":"steelblue","size":10},"mode":"markers","x":[0.8813576698303223,1.999999761581421,3.1186418533325195,0.8840068578720093,2.0,3.1159932613372803,0.8875842690467834,2.0,3.1124157905578613,0.8904839158058167,1.9999998807907104,3.109515905380249],"y":[-0.8699859976768494,-1.2388010025024414,-0.8699862360954285,-1.8574519157409668,-2.2224483489990234,-1.857452154159546,-2.8409857749938965,-3.2012548446655273,-2.8409860134124756,-3.8280985355377197,-4.1853156089782715,-3.828099012374878],"type":"scatter"}],"name":"15"},{"data":[{"hoverinfo":"skip","line":{"color":"gray","width":2},"mode":"lines","x":[5.557192483962581e-10,0.8610390424728394,null,0.8610390424728394,2.0,null,2.0,3.138960838317871,null,3.138960838317871,4.0,null,5.170895933659381e-10,0.8646732568740845,null,0.8646732568740845,2.0,null,2.0,3.135326623916626,null,3.135326623916626,4.0,null,4.79333184255637e-10,0.8691433668136597,null,0.8691433668136597,2.0,null,2.0,3.130856513977051,null,3.130856513977051,4.0,null,4.6037082479521985e-10,0.872442364692688,null,0.872442364692688,2.0,null,2.0,3.1275575160980225,null,3.1275575160980225,4.0,null,5.557192483962581e-10,5.170895933659381e-10,null,0.8610390424728394,0.8646732568740845,null,2.0,2.0,null,3.138960838317871,3.135326623916626,null,4.0,4.0,null,5.170895933659381e-10,4.79333184255637e-10,null,0.8646732568740845,0.8691433668136597,null,2.0,2.0,null,3.135326623916626,3.130856513977051,null,4.0,4.0,null,4.79333184255637e-10,4.6037082479521985e-10,null,0.8691433668136597,0.872442364692688,null,2.0,2.0,null,3.130856513977051,3.1275575160980225,null,4.0,4.0,null],"y":[2.1802584737606878e-10,-0.9265934824943542,null,-0.9265934824943542,-1.279581069946289,null,-1.279581069946289,-0.9265934228897095,null,-0.9265934228897095,2.1803668592834669e-10,null,-1.0,-1.9120692014694214,null,-1.9120692014694214,-2.2623894214630127,null,-2.2623894214630127,-1.9120689630508423,null,-1.9120689630508423,-1.0,null,-2.0,-2.8934407234191895,null,-2.8934407234191895,-3.2393577098846436,null,-3.2393577098846436,-2.8934404850006104,null,-2.8934404850006104,-2.0,null,-3.0,-3.8791892528533936,null,-3.8791892528533936,-4.221390724182129,null,-4.221390724182129,-3.8791892528533936,null,-3.8791892528533936,-3.0,null,2.1802584737606878e-10,-1.0,null,-0.9265934824943542,-1.9120692014694214,null,-1.279581069946289,-2.2623894214630127,null,-0.9265934228897095,-1.9120689630508423,null,2.1803668592834669e-10,-1.0,null,-1.0,-2.0,null,-1.9120692014694214,-2.8934407234191895,null,-2.2623894214630127,-3.2393577098846436,null,-1.9120689630508423,-2.8934404850006104,null,-1.0,-2.0,null,-2.0,-3.0,null,-2.8934407234191895,-3.8791892528533936,null,-3.2393577098846436,-4.221390724182129,null,-2.8934404850006104,-3.8791892528533936,null,-2.0,-3.0,null],"type":"scatter"},{"marker":{"color":"crimson","size":12},"mode":"markers","x":[5.557192483962581e-10,4.0,5.170895933659381e-10,4.0,4.79333184255637e-10,4.0,4.6037082479521985e-10,4.0],"y":[2.1802584737606878e-10,2.1803668592834669e-10,-1.0,-1.0,-2.0,-2.0,-3.0,-3.0],"type":"scatter"},{"marker":{"color":"steelblue","size":10},"mode":"markers","x":[0.8610390424728394,2.0,3.138960838317871,0.8646732568740845,2.0,3.135326623916626,0.8691433668136597,2.0,3.130856513977051,0.872442364692688,2.0,3.1275575160980225],"y":[-0.9265934824943542,-1.279581069946289,-0.9265934228897095,-1.9120692014694214,-2.2623894214630127,-1.9120689630508423,-2.8934407234191895,-3.2393577098846436,-2.8934404850006104,-3.8791892528533936,-4.221390724182129,-3.8791892528533936],"type":"scatter"}],"name":"16"},{"data":[{"hoverinfo":"skip","line":{"color":"gray","width":2},"mode":"lines","x":[-6.3072652665141504e-06,0.8642479181289673,null,0.8642479181289673,2.0,null,2.0,3.135751962661743,null,3.135751962661743,4.000006198883057,null,-4.956340944772819e-06,0.8674210906028748,null,0.8674210906028748,2.0,null,2.0,3.1325788497924805,null,3.1325788497924805,4.00000524520874,null,-3.856560397252906e-06,0.8716307282447815,null,0.8716307282447815,2.0,null,2.0,3.1283693313598633,null,3.1283693313598633,4.000003814697266,null,-3.7107517982803984e-06,0.8750161528587341,null,0.8750161528587341,2.0,null,2.0,3.1249840259552,null,3.1249840259552,4.000003814697266,null,-6.3072652665141504e-06,-4.956340944772819e-06,null,0.8642479181289673,0.8674210906028748,null,2.0,2.0,null,3.135751962661743,3.1325788497924805,null,4.000006198883057,4.00000524520874,null,-4.956340944772819e-06,-3.856560397252906e-06,null,0.8674210906028748,0.8716307282447815,null,2.0,2.0,null,3.1325788497924805,3.1283693313598633,null,4.00000524520874,4.000003814697266,null,-3.856560397252906e-06,-3.7107517982803984e-06,null,0.8716307282447815,0.8750161528587341,null,2.0,2.0,null,3.1283693313598633,3.1249840259552,null,4.000003814697266,4.000003814697266,null],"y":[1.8510272639105096e-06,-0.9570938348770142,null,-0.9570938348770142,-1.3609075546264648,null,-1.3609075546264648,-0.9570937752723694,null,-0.9570937752723694,1.851609454206482e-06,null,-0.9999971389770508,-1.9416707754135132,null,-1.9416707754135132,-2.340841293334961,null,-2.340841293334961,-1.9416706562042236,null,-1.9416706562042236,-0.9999971389770508,null,-1.999996542930603,-2.921576976776123,null,-2.921576976776123,-3.314629554748535,null,-3.314629554748535,-2.921576976776123,null,-2.921576976776123,-1.999996542930603,null,-2.9999969005584717,-3.905884265899658,null,-3.905884265899658,-4.294663906097412,null,-4.294663906097412,-3.905884265899658,null,-3.905884265899658,-2.9999969005584717,null,1.8510272639105096e-06,-0.9999971389770508,null,-0.9570938348770142,-1.9416707754135132,null,-1.3609075546264648,-2.340841293334961,null,-0.9570937752723694,-1.9416706562042236,null,1.851609454206482e-06,-0.9999971389770508,null,-0.9999971389770508,-1.999996542930603,null,-1.9416707754135132,-2.921576976776123,null,-2.340841293334961,-3.314629554748535,null,-1.9416706562042236,-2.921576976776123,null,-0.9999971389770508,-1.999996542930603,null,-1.999996542930603,-2.9999969005584717,null,-2.921576976776123,-3.905884265899658,null,-3.314629554748535,-4.294663906097412,null,-2.921576976776123,-3.905884265899658,null,-1.999996542930603,-2.9999969005584717,null],"type":"scatter"},{"marker":{"color":"crimson","size":12},"mode":"markers","x":[-6.3072652665141504e-06,4.000006198883057,-4.956340944772819e-06,4.00000524520874,-3.856560397252906e-06,4.000003814697266,-3.7107517982803984e-06,4.000003814697266],"y":[1.8510272639105096e-06,1.851609454206482e-06,-0.9999971389770508,-0.9999971389770508,-1.999996542930603,-1.999996542930603,-2.9999969005584717,-2.9999969005584717],"type":"scatter"},{"marker":{"color":"steelblue","size":10},"mode":"markers","x":[0.8642479181289673,2.0,3.135751962661743,0.8674210906028748,2.0,3.1325788497924805,0.8716307282447815,2.0,3.1283693313598633,0.8750161528587341,2.0,3.1249840259552],"y":[-0.9570938348770142,-1.3609075546264648,-0.9570937752723694,-1.9416707754135132,-2.340841293334961,-1.9416706562042236,-2.921576976776123,-3.314629554748535,-2.921576976776123,-3.905884265899658,-4.294663906097412,-3.905884265899658],"type":"scatter"}],"name":"17"},{"data":[{"hoverinfo":"skip","line":{"color":"gray","width":2},"mode":"lines","x":[3.2711054700484965e-06,0.8554309606552124,null,0.8554309606552124,2.0,null,2.0,3.144569158554077,null,3.144569158554077,3.9999966621398926,null,2.5265162548748776e-06,0.8590139150619507,null,0.8590139150619507,2.0,null,2.0,3.140986204147339,null,3.140986204147339,3.99999737739563,null,2.1733064841100713e-06,0.8636415004730225,null,0.8636415004730225,2.0,null,2.0,3.1363584995269775,null,3.1363584995269775,3.999997615814209,null,8.45592967380071e-06,0.8673037886619568,null,0.8673037886619568,2.000000238418579,null,2.000000238418579,3.1326963901519775,null,3.1326963901519775,3.9999923706054688,null,3.2711054700484965e-06,2.5265162548748776e-06,null,0.8554309606552124,0.8590139150619507,null,2.0,2.0,null,3.144569158554077,3.140986204147339,null,3.9999966621398926,3.99999737739563,null,2.5265162548748776e-06,2.1733064841100713e-06,null,0.8590139150619507,0.8636415004730225,null,2.0,2.0,null,3.140986204147339,3.1363584995269775,null,3.99999737739563,3.999997615814209,null,2.1733064841100713e-06,8.45592967380071e-06,null,0.8636415004730225,0.8673037886619568,null,2.0,2.000000238418579,null,3.1363584995269775,3.1326963901519775,null,3.999997615814209,3.9999923706054688,null],"y":[1.7555333897689707e-06,-1.0009784698486328,null,-1.0009784698486328,-1.4208486080169678,null,-1.4208486080169678,-1.0009784698486328,null,-1.0009784698486328,1.7556577631694381e-06,null,-0.9999986886978149,-1.983845591545105,null,-1.983845591545105,-2.399035692214966,null,-2.399035692214966,-1.983845591545105,null,-1.983845591545105,-0.9999986886978149,null,-1.999998927116394,-2.961700201034546,null,-2.961700201034546,-3.3703248500823975,null,-3.3703248500823975,-2.961700201034546,null,-2.961700201034546,-1.999998927116394,null,-2.999994993209839,-3.9444894790649414,null,-3.9444894790649414,-4.348254203796387,null,-4.348254203796387,-3.9444894790649414,null,-3.9444894790649414,-2.999994993209839,null,1.7555333897689707e-06,-0.9999986886978149,null,-1.0009784698486328,-1.983845591545105,null,-1.4208486080169678,-2.399035692214966,null,-1.0009784698486328,-1.983845591545105,null,1.7556577631694381e-06,-0.9999986886978149,null,-0.9999986886978149,-1.999998927116394,null,-1.983845591545105,-2.961700201034546,null,-2.399035692214966,-3.3703248500823975,null,-1.983845591545105,-2.961700201034546,null,-0.9999986886978149,-1.999998927116394,null,-1.999998927116394,-2.999994993209839,null,-2.961700201034546,-3.9444894790649414,null,-3.3703248500823975,-4.348254203796387,null,-2.961700201034546,-3.9444894790649414,null,-1.999998927116394,-2.999994993209839,null],"type":"scatter"},{"marker":{"color":"crimson","size":12},"mode":"markers","x":[3.2711054700484965e-06,3.9999966621398926,2.5265162548748776e-06,3.99999737739563,2.1733064841100713e-06,3.999997615814209,8.45592967380071e-06,3.9999923706054688],"y":[1.7555333897689707e-06,1.7556577631694381e-06,-0.9999986886978149,-0.9999986886978149,-1.999998927116394,-1.999998927116394,-2.999994993209839,-2.999994993209839],"type":"scatter"},{"marker":{"color":"steelblue","size":10},"mode":"markers","x":[0.8554309606552124,2.0,3.144569158554077,0.8590139150619507,2.0,3.140986204147339,0.8636415004730225,2.0,3.1363584995269775,0.8673037886619568,2.000000238418579,3.1326963901519775],"y":[-1.0009784698486328,-1.4208486080169678,-1.0009784698486328,-1.983845591545105,-2.399035692214966,-1.983845591545105,-2.961700201034546,-3.3703248500823975,-2.961700201034546,-3.9444894790649414,-4.348254203796387,-3.9444894790649414],"type":"scatter"}],"name":"18"},{"data":[{"hoverinfo":"skip","line":{"color":"gray","width":2},"mode":"lines","x":[-1.056094333762303e-05,0.8532273769378662,null,0.8532273769378662,2.0,null,2.0,3.146772861480713,null,3.146772861480713,4.0000104904174805,null,-9.86308168648975e-06,0.8564801216125488,null,0.8564801216125488,1.9999998807907104,null,1.9999998807907104,3.143519878387451,null,3.143519878387451,4.000010013580322,null,-8.781367796473205e-06,0.8609481453895569,null,0.8609481453895569,2.0,null,2.0,3.139051675796509,null,3.139051675796509,4.000008583068848,null,-8.562135917600244e-06,0.8647201657295227,null,0.8647201657295227,2.0,null,2.0,3.135279893875122,null,3.135279893875122,4.000008583068848,null,-1.056094333762303e-05,-9.86308168648975e-06,null,0.8532273769378662,0.8564801216125488,null,2.0,1.9999998807907104,null,3.146772861480713,3.143519878387451,null,4.0000104904174805,4.000010013580322,null,-9.86308168648975e-06,-8.781367796473205e-06,null,0.8564801216125488,0.8609481453895569,null,1.9999998807907104,2.0,null,3.143519878387451,3.139051675796509,null,4.000010013580322,4.000008583068848,null,-8.781367796473205e-06,-8.562135917600244e-06,null,0.8609481453895569,0.8647201657295227,null,2.0,2.0,null,3.139051675796509,3.135279893875122,null,4.000008583068848,4.000008583068848,null],"y":[-5.437055278889602e-06,-1.038639783859253,null,-1.038639783859253,-1.492229700088501,null,-1.492229700088501,-1.038639783859253,null,-1.038639783859253,-5.436621904664207e-06,null,-1.0000052452087402,-2.020387887954712,null,-2.020387887954712,-2.467571258544922,null,-2.467571258544922,-2.020387887954712,null,-2.020387887954712,-1.0000052452087402,null,-2.000004768371582,-2.996572732925415,null,-2.996572732925415,-3.4355874061584473,null,-3.4355874061584473,-2.996572732925415,null,-2.996572732925415,-2.000004768371582,null,-3.000004768371582,-3.977825164794922,null,-3.977825164794922,-4.411299705505371,null,-4.411299705505371,-3.977825164794922,null,-3.977825164794922,-3.000004768371582,null,-5.437055278889602e-06,-1.0000052452087402,null,-1.038639783859253,-2.020387887954712,null,-1.492229700088501,-2.467571258544922,null,-1.038639783859253,-2.020387887954712,null,-5.436621904664207e-06,-1.0000052452087402,null,-1.0000052452087402,-2.000004768371582,null,-2.020387887954712,-2.996572732925415,null,-2.467571258544922,-3.4355874061584473,null,-2.020387887954712,-2.996572732925415,null,-1.0000052452087402,-2.000004768371582,null,-2.000004768371582,-3.000004768371582,null,-2.996572732925415,-3.977825164794922,null,-3.4355874061584473,-4.411299705505371,null,-2.996572732925415,-3.977825164794922,null,-2.000004768371582,-3.000004768371582,null],"type":"scatter"},{"marker":{"color":"crimson","size":12},"mode":"markers","x":[-1.056094333762303e-05,4.0000104904174805,-9.86308168648975e-06,4.000010013580322,-8.781367796473205e-06,4.000008583068848,-8.562135917600244e-06,4.000008583068848],"y":[-5.437055278889602e-06,-5.436621904664207e-06,-1.0000052452087402,-1.0000052452087402,-2.000004768371582,-2.000004768371582,-3.000004768371582,-3.000004768371582],"type":"scatter"},{"marker":{"color":"steelblue","size":10},"mode":"markers","x":[0.8532273769378662,2.0,3.146772861480713,0.8564801216125488,1.9999998807907104,3.143519878387451,0.8609481453895569,2.0,3.139051675796509,0.8647201657295227,2.0,3.135279893875122],"y":[-1.038639783859253,-1.492229700088501,-1.038639783859253,-2.020387887954712,-2.467571258544922,-2.020387887954712,-2.996572732925415,-3.4355874061584473,-2.996572732925415,-3.977825164794922,-4.411299705505371,-3.977825164794922],"type":"scatter"}],"name":"19"}]);
                        })                };            </script>        </div></div></div>
</div>
<p>The animation shows how the spring network relaxes as gravity is progressively applied. Starting from the regular grid (0% gravity), the interior points sag downward until reaching the final equilibrium (100% gravity).</p>
<p>When to use each construction approach:</p>
<ul class="simple">
<li><p>Naive: Simpler code, good for prototyping and small problems</p></li>
<li><p>Batched: Faster problem analysis, essential for large-scale problems</p></li>
</ul>
<p>For more details, see <a class="reference internal" href="../../../api/core/#jaxls.Var" title="jaxls.Var"><code class="xref py py-class docutils literal notranslate"><span class="pre">jaxls.Var</span></code></a>, <a class="reference internal" href="../../../api/core/#jaxls.Cost" title="jaxls.Cost"><code class="xref py py-class docutils literal notranslate"><span class="pre">jaxls.Cost</span></code></a>, and <a class="reference internal" href="../../../api/core/#jaxls.LeastSquaresProblem" title="jaxls.LeastSquaresProblem"><code class="xref py py-class docutils literal notranslate"><span class="pre">jaxls.LeastSquaresProblem</span></code></a>.</p>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../cloth_simulation/">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Cloth Simulation</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="../">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Mechanics</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2025
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              <a class="muted-link " href="https://github.com/brentyi/jaxls" aria-label="GitHub">
            <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16">
                <path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"></path>
            </svg>
        </a>
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Spring Equilibrium</a><ul>
<li><a class="reference internal" href="#variables-and-costs">Variables and costs</a></li>
<li><a class="reference internal" href="#problem-setup">Problem setup</a></li>
<li><a class="reference internal" href="#approach-1-naive-construction">Approach 1: Naive construction</a></li>
<li><a class="reference internal" href="#approach-2-batched-construction">Approach 2: Batched construction</a></li>
<li><a class="reference internal" href="#solving">Solving</a></li>
<li><a class="reference internal" href="#visualization">Visualization</a></li>
<li><a class="reference internal" href="#relaxation-animation">Relaxation animation</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../../../_static/documentation_options.js?v=187304be"></script>
    <script src="../../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/scripts/furo.js?v=46bd48cc"></script>
    <script src="../../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../../_static/copybutton.js?v=fd10adb8"></script>
    </body>
</html>