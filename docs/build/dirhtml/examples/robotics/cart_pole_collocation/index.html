<!doctype html>
<html class="no-js" lang="en" data-content_root="../../../">
  <head><meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../../../genindex/"><link rel="search" title="Search" href="../../../search/"><link rel="next" title="Cart-pole (shooting)" href="../cart_pole_shooting/"><link rel="prev" title="Obstacle avoidance" href="../obstacle_avoidance/">

    <!-- Generated with Sphinx 8.1.3 and Furo 2025.12.19 -->
        <title>Cart-pole (collocation) - jaxls</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=b86133f3" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/furo.css?v=7bdb33bb" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/css/custom.css?v=6517d2d4" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/furo-extensions.css?v=8dab3a3b" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  --color-code-background: #f4f4f4;
  --color-code-foreground: #000;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle site navigation sidebar">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc" aria-label="Toggle table of contents sidebar">
<label class="overlay sidebar-overlay" for="__navigation"></label>
<label class="overlay toc-overlay" for="__toc"></label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <span class="icon"><svg><use href="#svg-menu"></use></svg></span>
      </label>
    </div>
    <div class="header-center">
      <a href="../../../"><div class="brand">jaxls</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a
  class="sidebar-brand"
  href="../../../"
  style="margin-top: 0.75em"
>
  
  <span class="sidebar-brand-text">jaxls</span>

  
</a>

<div style="text-align: left; padding: 0 1em 1em 1em">
  <a href="https://github.com/brentyi/jaxls">
    <img src="https://img.shields.io/github/stars/brentyi/jaxls?style=social" alt="GitHub stars">
  </a>
</div><form class="sidebar-search-container" method="get" action="../../../search/" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../guide/basics/">Basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../guide/tips_and_gotchas/">Tips and gotchas</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../guide/advanced/">Advanced</a><input aria-label="Toggle navigation of Advanced" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../guide/advanced/non_euclidean/">Non-Euclidean variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../guide/advanced/custom_jacobians/">Custom Jacobians</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../guide/advanced/constraints/">Constraints</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../guide/advanced/robust_costs/">Robust costs</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Examples</span></p>
<ul class="current">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../mechanics/">Mechanics</a><input aria-label="Toggle navigation of Mechanics" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../mechanics/spring_equilibrium/">Spring equilibrium</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../mechanics/cloth_draping/">Cloth draping</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../mechanics/beam_bending/">Beam bending</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../mechanics/truss_analysis/">Truss analysis</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../vision/">Vision</a><input aria-label="Toggle navigation of Vision" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../vision/camera_calibration/">Camera calibration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../vision/pose_graph_2d/">SE(2) pose graph</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../vision/pose_graph_3d/">SE(3) pose graph</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../vision/bundle_adjustment/">Bundle adjustment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../vision/smplh_shape_fitting/">SMPL-H shape fitting</a></li>
</ul>
</li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="../">Robotics</a><input aria-label="Toggle navigation of Robotics" checked="" class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../inverse_kinematics/">Inverse kinematics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../obstacle_avoidance/">Obstacle avoidance</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">Cart-pole (collocation)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cart_pole_shooting/">Cart-pole (shooting)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cam_design/">Cam profile optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../imu_sensor_fusion/">IMU fusion + calibration</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../portfolio/">Portfolio optimization</a><input aria-label="Toggle navigation of Portfolio optimization" class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../portfolio/mean_variance/">Mean-variance allocation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../portfolio/manifold_allocation/">Manifold allocation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../portfolio/reparameterized_allocation/">Reparameterized allocation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../portfolio/cvar_optimization/">CVaR allocation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../portfolio/black_litterman/">Black-Litterman allocation</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../api/core/">Core API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/lie_group_variables/">Lie group variables</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/solver_config/">Solver configuration</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Design Notes</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../design/typed_api/">Typed API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../design/sparse_matrices/">Sparse matrices</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../design/traced_vs_static/">What’s traced?</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="../../../_sources/examples/robotics/cart_pole_collocation.ipynb.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section class="tex2jax_ignore mathjax_ignore" id="cart-pole-collocation">
<h1>Cart-pole (collocation)<a class="headerlink" href="#cart-pole-collocation" title="Link to this heading">¶</a></h1>
<p>In this notebook, we solve a cart-pole swing-up problem using direct collocation: an
alternative to single shooting that optimizes the full state trajectory simultaneously.</p>
<p>Features used:</p>
<ul class="simple">
<li><p><a class="reference internal" href="../../../api/core/#jaxls.Var" title="jaxls.Var"><code class="xref py py-class docutils literal notranslate"><span class="pre">Var</span></code></a> subclassing with batched IDs for state and control trajectories</p></li>
<li><p><a class="reference internal" href="../../../api/core/#jaxls.Cost.factory" title="jaxls.Cost.factory"><code class="xref py py-func docutils literal notranslate"><span class="pre">&#64;jaxls.Cost.factory</span></code></a> with batched arguments</p></li>
<li><p>Equality constraints (<code class="docutils literal notranslate"><span class="pre">constraint_eq_zero</span></code>): dynamics collocation</p></li>
<li><p>Inequality constraints (<code class="docutils literal notranslate"><span class="pre">constraint_leq_zero</span></code>): control bounds</p></li>
<li><p>Augmented Lagrangian solver for constrained optimization</p></li>
</ul>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">loguru</span><span class="w"> </span><span class="kn">import</span> <span class="n">logger</span>

<span class="n">logger</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
<span class="n">logger</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;&lt;level&gt;</span><span class="si">{level: &lt;8}</span><span class="s2">&lt;/level&gt; | </span><span class="si">{message}</span><span class="s2">&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">jax</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">jax.numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">jnp</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">jaxls</span>
</pre></div>
</div>
</div>
</div>
<section id="cart-pole-dynamics">
<h2>Cart-pole dynamics<a class="headerlink" href="#cart-pole-dynamics" title="Link to this heading">¶</a></h2>
<p>The cart-pole system has state <span class="math notranslate nohighlight">\([x, \theta, \dot{x}, \dot{\theta}]\)</span> where <span class="math notranslate nohighlight">\(x\)</span> is cart position and <span class="math notranslate nohighlight">\(\theta\)</span> is pole angle (0 = hanging down, <span class="math notranslate nohighlight">\(\pi\)</span> = upright). The control input is a horizontal force on the cart.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Physical parameters.</span>
<span class="n">m_cart</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1"># Cart mass (kg)</span>
<span class="n">m_pole</span> <span class="o">=</span> <span class="mf">0.1</span>  <span class="c1"># Pole mass (kg)</span>
<span class="n">length</span> <span class="o">=</span> <span class="mf">0.5</span>  <span class="c1"># Pole half-length (m)</span>
<span class="n">gravity</span> <span class="o">=</span> <span class="mf">9.81</span>  <span class="c1"># Gravitational acceleration (m/s^2)</span>
<span class="n">force_limit</span> <span class="o">=</span> <span class="mf">10.0</span>  <span class="c1"># Maximum control force (N)</span>

<span class="c1"># Trajectory parameters.</span>
<span class="n">n_swing</span> <span class="o">=</span> <span class="mi">50</span>  <span class="c1"># Timesteps for swing-up phase</span>
<span class="n">n_hold</span> <span class="o">=</span> <span class="mi">10</span>  <span class="c1"># Timesteps to hold upright position</span>
<span class="n">n_steps</span> <span class="o">=</span> <span class="n">n_swing</span> <span class="o">+</span> <span class="n">n_hold</span>  <span class="c1"># Total timesteps</span>
<span class="n">dt</span> <span class="o">=</span> <span class="mf">0.05</span>  <span class="c1"># Time step (s)</span>
<span class="n">total_time</span> <span class="o">=</span> <span class="n">n_steps</span> <span class="o">*</span> <span class="n">dt</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total trajectory time: </span><span class="si">{</span><span class="n">total_time</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">s (</span><span class="si">{</span><span class="n">n_swing</span><span class="si">}</span><span class="s2"> swing + </span><span class="si">{</span><span class="n">n_hold</span><span class="si">}</span><span class="s2"> hold)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total trajectory time: 3.00s (50 swing + 10 hold)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@jax</span><span class="o">.</span><span class="n">jit</span>
<span class="k">def</span><span class="w"> </span><span class="nf">cart_pole_dynamics</span><span class="p">(</span><span class="n">state</span><span class="p">:</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">,</span> <span class="n">force</span><span class="p">:</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute state derivatives for the cart-pole system.</span>

<span class="sd">    State: [x, theta, x_dot, theta_dot]</span>
<span class="sd">    theta = 0: pole hanging down, theta = pi: pole upright</span>

<span class="sd">    Note: We use the standard cart-pole equations but with theta measured</span>
<span class="sd">    from hanging down, so the gravitational term has a negative sign.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">x_dot</span><span class="p">,</span> <span class="n">theta_dot</span> <span class="o">=</span> <span class="n">state</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">force</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">sin_th</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
    <span class="n">cos_th</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>

    <span class="c1"># Total mass.</span>
    <span class="n">total_mass</span> <span class="o">=</span> <span class="n">m_cart</span> <span class="o">+</span> <span class="n">m_pole</span>
    <span class="n">pole_mass_length</span> <span class="o">=</span> <span class="n">m_pole</span> <span class="o">*</span> <span class="n">length</span>

    <span class="c1"># Equations of motion for theta=0 being DOWN (stable equilibrium)</span>
    <span class="c1"># The gravitational term is negated compared to theta=0 being UP.</span>
    <span class="n">temp</span> <span class="o">=</span> <span class="p">(</span><span class="n">f</span> <span class="o">+</span> <span class="n">pole_mass_length</span> <span class="o">*</span> <span class="n">theta_dot</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">sin_th</span><span class="p">)</span> <span class="o">/</span> <span class="n">total_mass</span>
    <span class="n">theta_ddot</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">gravity</span> <span class="o">*</span> <span class="n">sin_th</span> <span class="o">-</span> <span class="n">cos_th</span> <span class="o">*</span> <span class="n">temp</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span>
        <span class="n">length</span> <span class="o">*</span> <span class="p">(</span><span class="mf">4.0</span> <span class="o">/</span> <span class="mf">3.0</span> <span class="o">-</span> <span class="n">m_pole</span> <span class="o">*</span> <span class="n">cos_th</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="n">total_mass</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="n">x_ddot</span> <span class="o">=</span> <span class="n">temp</span> <span class="o">-</span> <span class="n">pole_mass_length</span> <span class="o">*</span> <span class="n">theta_ddot</span> <span class="o">*</span> <span class="n">cos_th</span> <span class="o">/</span> <span class="n">total_mass</span>

    <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">x_dot</span><span class="p">,</span> <span class="n">theta_dot</span><span class="p">,</span> <span class="n">x_ddot</span><span class="p">,</span> <span class="n">theta_ddot</span><span class="p">])</span>


<span class="nd">@jax</span><span class="o">.</span><span class="n">jit</span>
<span class="k">def</span><span class="w"> </span><span class="nf">rk4_step</span><span class="p">(</span><span class="n">state</span><span class="p">:</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">,</span> <span class="n">force</span><span class="p">:</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">,</span> <span class="n">dt</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Runge-Kutta 4th order integration step.&quot;&quot;&quot;</span>
    <span class="n">k1</span> <span class="o">=</span> <span class="n">cart_pole_dynamics</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">force</span><span class="p">)</span>
    <span class="n">k2</span> <span class="o">=</span> <span class="n">cart_pole_dynamics</span><span class="p">(</span><span class="n">state</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">dt</span> <span class="o">*</span> <span class="n">k1</span><span class="p">,</span> <span class="n">force</span><span class="p">)</span>
    <span class="n">k3</span> <span class="o">=</span> <span class="n">cart_pole_dynamics</span><span class="p">(</span><span class="n">state</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">dt</span> <span class="o">*</span> <span class="n">k2</span><span class="p">,</span> <span class="n">force</span><span class="p">)</span>
    <span class="n">k4</span> <span class="o">=</span> <span class="n">cart_pole_dynamics</span><span class="p">(</span><span class="n">state</span> <span class="o">+</span> <span class="n">dt</span> <span class="o">*</span> <span class="n">k3</span><span class="p">,</span> <span class="n">force</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">state</span> <span class="o">+</span> <span class="p">(</span><span class="n">dt</span> <span class="o">/</span> <span class="mf">6.0</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">k1</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">k2</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">k3</span> <span class="o">+</span> <span class="n">k4</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="variables">
<h2>Variables<a class="headerlink" href="#variables" title="Link to this heading">¶</a></h2>
<p>We define state variables at each timestep and control inputs between timesteps. Using batched IDs for efficient construction:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">StateVar</span><span class="p">(</span><span class="n">jaxls</span><span class="o">.</span><span class="n">Var</span><span class="p">[</span><span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">],</span> <span class="n">default_factory</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">4</span><span class="p">)):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;State variable: [x, theta, x_dot, theta_dot].&quot;&quot;&quot;</span>


<span class="k">class</span><span class="w"> </span><span class="nc">ControlVar</span><span class="p">(</span><span class="n">jaxls</span><span class="o">.</span><span class="n">Var</span><span class="p">[</span><span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">],</span> <span class="n">default_factory</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">1</span><span class="p">)):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Control variable: [force].&quot;&quot;&quot;</span>


<span class="c1"># Create batched variables.</span>
<span class="n">state_vars</span> <span class="o">=</span> <span class="n">StateVar</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n_steps</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>  <span class="c1"># States at t=0, 1, ..., n_steps</span>
<span class="n">control_vars</span> <span class="o">=</span> <span class="n">ControlVar</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n_steps</span><span class="p">))</span>  <span class="c1"># Controls at t=0, 1, ..., n_steps-1</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;State variables: </span><span class="si">{</span><span class="n">n_steps</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2"> (shape: </span><span class="si">{</span><span class="n">state_vars</span><span class="o">.</span><span class="n">id</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Control variables: </span><span class="si">{</span><span class="n">n_steps</span><span class="si">}</span><span class="s2"> (shape: </span><span class="si">{</span><span class="n">control_vars</span><span class="o">.</span><span class="n">id</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>State variables: 61 (shape: (61,))
Control variables: 60 (shape: (60,))
</pre></div>
</div>
</div>
</div>
</section>
<section id="cost-functions">
<h2>Cost functions<a class="headerlink" href="#cost-functions" title="Link to this heading">¶</a></h2>
<p>We define costs for:</p>
<ol class="arabic simple">
<li><p>Dynamics constraints: RK4 integration between consecutive states</p></li>
<li><p>Boundary costs: Penalize deviation from initial and target states</p></li>
<li><p>Control effort: Minimize force usage</p></li>
<li><p>Control bounds: Keep force within limits</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@jaxls</span><span class="o">.</span><span class="n">Cost</span><span class="o">.</span><span class="n">factory</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s2">&quot;constraint_eq_zero&quot;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">dynamics_constraint</span><span class="p">(</span>
    <span class="n">vals</span><span class="p">:</span> <span class="n">jaxls</span><span class="o">.</span><span class="n">VarValues</span><span class="p">,</span>
    <span class="n">state_k</span><span class="p">:</span> <span class="n">StateVar</span><span class="p">,</span>
    <span class="n">state_k1</span><span class="p">:</span> <span class="n">StateVar</span><span class="p">,</span>
    <span class="n">control_k</span><span class="p">:</span> <span class="n">ControlVar</span><span class="p">,</span>
    <span class="n">dt</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Enforce RK4 dynamics between consecutive states.&quot;&quot;&quot;</span>
    <span class="n">s_k</span> <span class="o">=</span> <span class="n">vals</span><span class="p">[</span><span class="n">state_k</span><span class="p">]</span>
    <span class="n">s_k1</span> <span class="o">=</span> <span class="n">vals</span><span class="p">[</span><span class="n">state_k1</span><span class="p">]</span>
    <span class="n">u_k</span> <span class="o">=</span> <span class="n">vals</span><span class="p">[</span><span class="n">control_k</span><span class="p">]</span>
    <span class="n">s_next</span> <span class="o">=</span> <span class="n">rk4_step</span><span class="p">(</span><span class="n">s_k</span><span class="p">,</span> <span class="n">u_k</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">s_k1</span> <span class="o">-</span> <span class="n">s_next</span>


<span class="nd">@jaxls</span><span class="o">.</span><span class="n">Cost</span><span class="o">.</span><span class="n">factory</span>
<span class="k">def</span><span class="w"> </span><span class="nf">boundary_cost</span><span class="p">(</span>
    <span class="n">vals</span><span class="p">:</span> <span class="n">jaxls</span><span class="o">.</span><span class="n">VarValues</span><span class="p">,</span>
    <span class="n">var</span><span class="p">:</span> <span class="n">StateVar</span><span class="p">,</span>
    <span class="n">target</span><span class="p">:</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Penalize deviation from target state.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">vals</span><span class="p">[</span><span class="n">var</span><span class="p">]</span> <span class="o">-</span> <span class="n">target</span><span class="p">)</span> <span class="o">*</span> <span class="mf">100.0</span>


<span class="nd">@jaxls</span><span class="o">.</span><span class="n">Cost</span><span class="o">.</span><span class="n">factory</span>
<span class="k">def</span><span class="w"> </span><span class="nf">control_cost</span><span class="p">(</span>
    <span class="n">vals</span><span class="p">:</span> <span class="n">jaxls</span><span class="o">.</span><span class="n">VarValues</span><span class="p">,</span>
    <span class="n">var</span><span class="p">:</span> <span class="n">ControlVar</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Minimize control effort.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">vals</span><span class="p">[</span><span class="n">var</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1.0</span>


<span class="nd">@jaxls</span><span class="o">.</span><span class="n">Cost</span><span class="o">.</span><span class="n">factory</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s2">&quot;constraint_leq_zero&quot;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">control_upper_bound</span><span class="p">(</span>
    <span class="n">vals</span><span class="p">:</span> <span class="n">jaxls</span><span class="o">.</span><span class="n">VarValues</span><span class="p">,</span>
    <span class="n">var</span><span class="p">:</span> <span class="n">ControlVar</span><span class="p">,</span>
    <span class="n">limit</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Control &lt;= limit.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">vals</span><span class="p">[</span><span class="n">var</span><span class="p">]</span> <span class="o">-</span> <span class="n">limit</span>


<span class="nd">@jaxls</span><span class="o">.</span><span class="n">Cost</span><span class="o">.</span><span class="n">factory</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s2">&quot;constraint_leq_zero&quot;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">control_lower_bound</span><span class="p">(</span>
    <span class="n">vals</span><span class="p">:</span> <span class="n">jaxls</span><span class="o">.</span><span class="n">VarValues</span><span class="p">,</span>
    <span class="n">var</span><span class="p">:</span> <span class="n">ControlVar</span><span class="p">,</span>
    <span class="n">limit</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;-limit &lt;= control, i.e., -limit - control &lt;= 0.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="o">-</span><span class="n">limit</span> <span class="o">-</span> <span class="n">vals</span><span class="p">[</span><span class="n">var</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="problem-construction">
<h2>Problem construction<a class="headerlink" href="#problem-construction" title="Link to this heading">¶</a></h2>
<p>Initial state: pole hanging down (<span class="math notranslate nohighlight">\(\theta = 0\)</span>). Target state: pole upright (<span class="math notranslate nohighlight">\(\theta = \pi\)</span>), centered at origin with zero velocity.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Boundary conditions.</span>
<span class="n">initial_state</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">])</span>  <span class="c1"># x=0, theta=0 (down), zero velocity</span>
<span class="n">target_state</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">jnp</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">])</span>  <span class="c1"># x=0, theta=pi (up), zero velocity</span>

<span class="c1"># State indices for dynamics constraints.</span>
<span class="n">state_k_ids</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n_steps</span><span class="p">)</span>  <span class="c1"># 0, 1, ..., n_steps-1</span>
<span class="n">state_k1_ids</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_steps</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># 1, 2, ..., n_steps</span>
<span class="n">control_k_ids</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n_steps</span><span class="p">)</span>  <span class="c1"># 0, 1, ..., n_steps-1</span>

<span class="c1"># Hold phase: penalize states during hold to stay at target.</span>
<span class="n">hold_state_ids</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n_swing</span><span class="p">,</span> <span class="n">n_steps</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># States during hold phase</span>
<span class="n">n_hold_states</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">hold_state_ids</span><span class="p">)</span>
<span class="n">hold_targets</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">target_state</span><span class="p">,</span> <span class="p">(</span><span class="n">n_hold_states</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>  <span class="c1"># Broadcast for batching</span>

<span class="c1"># Build costs using batched construction.</span>
<span class="n">costs</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">jaxls</span><span class="o">.</span><span class="n">Cost</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
    <span class="c1"># Dynamics constraints (batched)</span>
    <span class="n">dynamics_constraint</span><span class="p">(</span>
        <span class="n">StateVar</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">state_k_ids</span><span class="p">),</span>
        <span class="n">StateVar</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">state_k1_ids</span><span class="p">),</span>
        <span class="n">ControlVar</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">control_k_ids</span><span class="p">),</span>
        <span class="n">dt</span><span class="p">,</span>
    <span class="p">),</span>
    <span class="c1"># Boundary costs.</span>
    <span class="n">boundary_cost</span><span class="p">(</span><span class="n">StateVar</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="n">initial_state</span><span class="p">),</span>
    <span class="c1"># Hold phase: penalize all hold states deviating from target.</span>
    <span class="n">boundary_cost</span><span class="p">(</span><span class="n">StateVar</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">hold_state_ids</span><span class="p">),</span> <span class="n">hold_targets</span><span class="p">),</span>
    <span class="c1"># Control effort (batched)</span>
    <span class="n">control_cost</span><span class="p">(</span><span class="n">control_vars</span><span class="p">),</span>
    <span class="c1"># Control bounds (batched)</span>
    <span class="n">control_upper_bound</span><span class="p">(</span><span class="n">control_vars</span><span class="p">,</span> <span class="n">force_limit</span><span class="p">),</span>
    <span class="n">control_lower_bound</span><span class="p">(</span><span class="n">control_vars</span><span class="p">,</span> <span class="n">force_limit</span><span class="p">),</span>
<span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Created </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">costs</span><span class="p">)</span><span class="si">}</span><span class="s2"> batched cost objects&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Created 6 batched cost objects
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Initial guess: linear interpolation for states, zero controls.</span>
<span class="n">t_interp</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n_steps</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)[:,</span> <span class="kc">None</span><span class="p">]</span>
<span class="n">initial_states</span> <span class="o">=</span> <span class="n">initial_state</span> <span class="o">+</span> <span class="n">t_interp</span> <span class="o">*</span> <span class="p">(</span><span class="n">target_state</span> <span class="o">-</span> <span class="n">initial_state</span><span class="p">)</span>
<span class="n">initial_controls</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_steps</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

<span class="n">initial_vals</span> <span class="o">=</span> <span class="n">jaxls</span><span class="o">.</span><span class="n">VarValues</span><span class="o">.</span><span class="n">make</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="n">state_vars</span><span class="o">.</span><span class="n">with_value</span><span class="p">(</span><span class="n">initial_states</span><span class="p">),</span>
        <span class="n">control_vars</span><span class="o">.</span><span class="n">with_value</span><span class="p">(</span><span class="n">initial_controls</span><span class="p">),</span>
    <span class="p">]</span>
<span class="p">)</span>

<span class="c1"># Create and analyze problem.</span>
<span class="n">problem</span> <span class="o">=</span> <span class="n">jaxls</span><span class="o">.</span><span class="n">LeastSquaresProblem</span><span class="p">(</span><span class="n">costs</span><span class="p">,</span> <span class="p">[</span><span class="n">state_vars</span><span class="p">,</span> <span class="n">control_vars</span><span class="p">])</span><span class="o">.</span><span class="n">analyze</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Bold">INFO    </span> | Building optimization problem with 252 terms and 121 variables: 72 costs, 60 eq_zero, 120 leq_zero, 0 geq_zero
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing constraint group with 60 constraints (constraint_eq_zero), 3 variables each: augmented_dynamics_constraint
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing constraint group with 60 constraints (constraint_leq_zero), 1 variables each: augmented_control_upper_bound
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 60 costs, 1 variables each: control_cost
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing constraint group with 60 constraints (constraint_leq_zero), 1 variables each: augmented_control_lower_bound
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 12 costs, 1 variables each: boundary_cost
</pre></div>
</div>
</div>
</div>
</section>
<section id="solving">
<h2>Solving<a class="headerlink" href="#solving" title="Link to this heading">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">solution</span> <span class="o">=</span> <span class="n">problem</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">initial_vals</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Bold">INFO    </span> | Augmented Lagrangian: initial snorm=7.3573e-01, csupn=7.3573e-01, max_rho=1.0572e+05, constraint_dim=360
<span class=" -Color -Color-Bold">INFO    </span> |  step #0: cost=10554.9854 lambd=0.0005 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_dynamics_constraint(60): 1805924.12500 (avg 7524.68408)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_cost(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_lower_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - boundary_cost(12): 10554.98535 (avg 219.89554)
<span class=" -Color -Color-Bold">INFO    </span> |  step #1: cost=10554.9854 lambd=0.0010 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_dynamics_constraint(60): 1805924.12500 (avg 7524.68408)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_cost(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_lower_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - boundary_cost(12): 10554.98535 (avg 219.89554)
<span class=" -Color -Color-Bold">INFO    </span> |  step #2: cost=10554.9854 lambd=0.0020 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_dynamics_constraint(60): 1805924.12500 (avg 7524.68408)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_cost(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_lower_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - boundary_cost(12): 10554.98535 (avg 219.89554)
<span class=" -Color -Color-Bold">INFO    </span> |  step #3: cost=10554.9854 lambd=0.0040 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_dynamics_constraint(60): 1805924.12500 (avg 7524.68408)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_cost(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_lower_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - boundary_cost(12): 10554.98535 (avg 219.89554)
<span class=" -Color -Color-Bold">INFO    </span> |  step #4: cost=10554.9854 lambd=0.0080 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_dynamics_constraint(60): 1805924.12500 (avg 7524.68408)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_cost(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_lower_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - boundary_cost(12): 10554.98535 (avg 219.89554)
<span class=" -Color -Color-Bold">INFO    </span> |  step #5: cost=10554.9854 lambd=0.0160 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_dynamics_constraint(60): 1805924.12500 (avg 7524.68408)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_cost(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_lower_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - boundary_cost(12): 10554.98535 (avg 219.89554)
<span class=" -Color -Color-Bold">INFO    </span> |  step #6: cost=10554.9854 lambd=0.0320 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_dynamics_constraint(60): 1805924.12500 (avg 7524.68408)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_cost(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_lower_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - boundary_cost(12): 10554.98535 (avg 219.89554)
<span class=" -Color -Color-Bold">INFO    </span> |  step #7: cost=10554.9854 lambd=0.0640 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_dynamics_constraint(60): 1805924.12500 (avg 7524.68408)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_cost(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_lower_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - boundary_cost(12): 10554.98535 (avg 219.89554)
<span class=" -Color -Color-Bold">INFO    </span> |  step #8: cost=10554.9854 lambd=0.1280 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_dynamics_constraint(60): 1805924.12500 (avg 7524.68408)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_cost(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_lower_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - boundary_cost(12): 10554.98535 (avg 219.89554)
<span class=" -Color -Color-Bold">INFO    </span> |  step #9: cost=10554.9854 lambd=0.2560 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_dynamics_constraint(60): 1805924.12500 (avg 7524.68408)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_cost(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_lower_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - boundary_cost(12): 10554.98535 (avg 219.89554)
<span class=" -Color -Color-Bold">INFO    </span> |  step #10: cost=10554.9854 lambd=0.5120 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_dynamics_constraint(60): 1805924.12500 (avg 7524.68408)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_cost(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_lower_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - boundary_cost(12): 10554.98535 (avg 219.89554)
<span class=" -Color -Color-Bold">INFO    </span> |  step #11: cost=10554.9854 lambd=1.0240 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_dynamics_constraint(60): 1805924.12500 (avg 7524.68408)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_cost(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_lower_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - boundary_cost(12): 10554.98535 (avg 219.89554)
<span class=" -Color -Color-Bold">INFO    </span> |  step #12: cost=10554.9854 lambd=2.0480 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_dynamics_constraint(60): 1805924.12500 (avg 7524.68408)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_cost(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_lower_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - boundary_cost(12): 10554.98535 (avg 219.89554)
<span class=" -Color -Color-Bold">INFO    </span> |  step #13: cost=10554.9854 lambd=4.0960 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_dynamics_constraint(60): 1805924.12500 (avg 7524.68408)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_cost(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_lower_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - boundary_cost(12): 10554.98535 (avg 219.89554)
<span class=" -Color -Color-Bold">INFO    </span> |  step #14: cost=10554.9854 lambd=8.1920 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_dynamics_constraint(60): 1805924.12500 (avg 7524.68408)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_cost(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_lower_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - boundary_cost(12): 10554.98535 (avg 219.89554)
<span class=" -Color -Color-Bold">INFO    </span> |  step #15: cost=10554.9854 lambd=16.3840 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_dynamics_constraint(60): 1805924.12500 (avg 7524.68408)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_cost(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_lower_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - boundary_cost(12): 10554.98535 (avg 219.89554)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=1.64e+05 cost_prev=1816479.2500 cost_new=1205258.0000
<span class=" -Color -Color-Bold">INFO    </span> |  step #16: cost=3562.7913 lambd=8.1920 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_dynamics_constraint(60): 1201695.25000 (avg 5007.06396)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_cost(60): 1217.73413 (avg 20.29557)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_lower_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - boundary_cost(12): 2345.05713 (avg 48.85536)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=2.58e+05 cost_prev=1205258.0000 cost_new=37898.7188
<span class=" -Color -Color-Bold">INFO    </span> |  step #17: cost=1887.7095 lambd=4.0960 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_dynamics_constraint(60): 36011.00391 (avg 150.04585)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_cost(60): 1183.01208 (avg 19.71687)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_lower_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - boundary_cost(12): 704.69739 (avg 14.68120)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=4.25e+04 cost_prev=37898.7188 cost_new=2399.6958
<span class=" -Color -Color-Bold">INFO    </span> |  step #18: cost=1454.7311 lambd=2.0480 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_dynamics_constraint(60): 944.96472 (avg 3.93735)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_cost(60): 1215.33936 (avg 20.25566)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_lower_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - boundary_cost(12): 239.39171 (avg 4.98733)
<span class=" -Color -Color-Bold">INFO    </span> |  step #19: cost=1454.7311 lambd=4.0960 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_dynamics_constraint(60): 944.96472 (avg 3.93735)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_cost(60): 1215.33936 (avg 20.25566)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_lower_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - boundary_cost(12): 239.39171 (avg 4.98733)
<span class=" -Color -Color-Bold">INFO    </span> |  step #20: cost=1454.7311 lambd=8.1920 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_dynamics_constraint(60): 944.96472 (avg 3.93735)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_cost(60): 1215.33936 (avg 20.25566)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_lower_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - boundary_cost(12): 239.39171 (avg 4.98733)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=3.15e+03 cost_prev=2399.6958 cost_new=1538.2826
<span class=" -Color -Color-Bold">INFO    </span> |  step #21: cost=1296.8280 lambd=4.0960 inexact_tol=4.9e-03
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_dynamics_constraint(60): 241.45467 (avg 1.00606)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_cost(60): 1211.05554 (avg 20.18426)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_lower_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - boundary_cost(12): 85.77243 (avg 1.78693)
<span class=" -Color -Color-Bold">INFO    </span> |  step #22: cost=1296.8280 lambd=8.1920 inexact_tol=4.9e-03
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_dynamics_constraint(60): 241.45467 (avg 1.00606)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_cost(60): 1211.05554 (avg 20.18426)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_lower_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - boundary_cost(12): 85.77243 (avg 1.78693)
<span class=" -Color -Color-Bold">INFO    </span> |  step #23: cost=1296.8280 lambd=16.3840 inexact_tol=4.9e-03
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_dynamics_constraint(60): 241.45467 (avg 1.00606)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_cost(60): 1211.05554 (avg 20.18426)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_lower_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - boundary_cost(12): 85.77243 (avg 1.78693)
<span class=" -Color -Color-Bold">INFO    </span> |  step #24: cost=1296.8280 lambd=32.7680 inexact_tol=4.9e-03
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_dynamics_constraint(60): 241.45467 (avg 1.00606)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_cost(60): 1211.05554 (avg 20.18426)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_lower_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - boundary_cost(12): 85.77243 (avg 1.78693)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=1.76e+03 cost_prev=1538.2826 cost_new=1421.9125
<span class=" -Color -Color-Bold">INFO    </span> |  step #25: cost=1283.0796 lambd=16.3840 inexact_tol=4.9e-03
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_dynamics_constraint(60): 138.83307 (avg 0.57847)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_cost(60): 1211.85950 (avg 20.19766)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_lower_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - boundary_cost(12): 71.22009 (avg 1.48375)
<span class=" -Color -Color-Bold">INFO    </span> |  step #26: cost=1283.0796 lambd=32.7680 inexact_tol=4.9e-03
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_dynamics_constraint(60): 138.83307 (avg 0.57847)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_cost(60): 1211.85950 (avg 20.19766)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_lower_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - boundary_cost(12): 71.22009 (avg 1.48375)
<span class=" -Color -Color-Bold">INFO    </span> |  step #27: cost=1283.0796 lambd=65.5360 inexact_tol=4.9e-03
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_dynamics_constraint(60): 138.83307 (avg 0.57847)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_cost(60): 1211.85950 (avg 20.19766)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_lower_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - boundary_cost(12): 71.22009 (avg 1.48375)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=3.24e+01 cost_prev=1421.9125 cost_new=1405.5913
<span class=" -Color -Color-Bold">INFO    </span> |  step #28: cost=1277.0958 lambd=32.7680 inexact_tol=3.1e-04
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_dynamics_constraint(60): 127.37616 (avg 0.53073)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_cost(60): 1211.34875 (avg 20.18915)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_lower_bound(60): 1.11938 (avg 0.01866)
<span class=" -Color -Color-Bold">INFO    </span> |      - boundary_cost(12): 65.74706 (avg 1.36973)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=3.58e+02 cost_prev=1405.5913 cost_new=1376.1820
<span class=" -Color -Color-Bold">INFO    </span> |  step #29: cost=1264.5526 lambd=16.3840 inexact_tol=3.1e-04
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_dynamics_constraint(60): 111.62922 (avg 0.46512)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_cost(60): 1206.93677 (avg 20.11561)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_lower_bound(60): 0.00010 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - boundary_cost(12): 57.61587 (avg 1.20033)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=3.07e+01 cost_prev=1376.1820 cost_new=1334.4926
<span class=" -Color -Color-Bold">INFO    </span> |  step #30: cost=1243.3367 lambd=8.1920 inexact_tol=3.1e-04
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_dynamics_constraint(60): 91.15599 (avg 0.37982)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_cost(60): 1196.41345 (avg 19.94023)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_lower_bound(60): 0.00008 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - boundary_cost(12): 46.92316 (avg 0.97757)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=5.67e+01 cost_prev=1334.4926 cost_new=1282.3275
<span class=" -Color -Color-Bold">INFO    </span> |  step #31: cost=1211.0247 lambd=4.0960 inexact_tol=3.1e-04
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_dynamics_constraint(60): 71.30305 (avg 0.29710)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_cost(60): 1174.59985 (avg 19.57667)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_lower_bound(60): 0.00005 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - boundary_cost(12): 36.42485 (avg 0.75885)
<span class=" -Color -Color-Bold">INFO    </span> |  step #32: cost=1211.0247 lambd=8.1920 inexact_tol=3.1e-04
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_dynamics_constraint(60): 71.30305 (avg 0.29710)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_cost(60): 1174.59985 (avg 19.57667)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_lower_bound(60): 0.00005 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - boundary_cost(12): 36.42485 (avg 0.75885)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=1.11e+02 cost_prev=1282.3275 cost_new=1247.3287
<span class=" -Color -Color-Bold">INFO    </span> |  step #33: cost=1186.4824 lambd=4.0960 inexact_tol=3.1e-04
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_dynamics_constraint(60): 60.84604 (avg 0.25353)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_cost(60): 1155.32727 (avg 19.25546)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_lower_bound(60): 0.00003 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - boundary_cost(12): 31.15515 (avg 0.64907)
<span class=" -Color -Color-Bold">INFO    </span> |  step #34: cost=1186.4824 lambd=8.1920 inexact_tol=3.1e-04
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_dynamics_constraint(60): 60.84604 (avg 0.25353)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_cost(60): 1155.32727 (avg 19.25546)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_lower_bound(60): 0.00003 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - boundary_cost(12): 31.15515 (avg 0.64907)
<span class=" -Color -Color-Bold">INFO    </span> |  step #35: cost=1186.4824 lambd=16.3840 inexact_tol=3.1e-04
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_dynamics_constraint(60): 60.84604 (avg 0.25353)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_cost(60): 1155.32727 (avg 19.25546)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_lower_bound(60): 0.00003 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - boundary_cost(12): 31.15515 (avg 0.64907)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=6.86e+01 cost_prev=1247.3287 cost_new=1233.3572
<span class=" -Color -Color-Bold">INFO    </span> |  step #36: cost=1176.0541 lambd=8.1920 inexact_tol=3.1e-04
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_dynamics_constraint(60): 57.30305 (avg 0.23876)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_cost(60): 1146.85071 (avg 19.11418)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_lower_bound(60): 0.00003 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - boundary_cost(12): 29.20335 (avg 0.60840)
<span class=" -Color -Color-Bold">INFO    </span> |  step #37: cost=1176.0541 lambd=16.3840 inexact_tol=3.1e-04
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_dynamics_constraint(60): 57.30305 (avg 0.23876)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_cost(60): 1146.85071 (avg 19.11418)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_lower_bound(60): 0.00003 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - boundary_cost(12): 29.20335 (avg 0.60840)
<span class=" -Color -Color-Bold">INFO    </span> |  step #38: cost=1176.0541 lambd=32.7680 inexact_tol=3.1e-04
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_dynamics_constraint(60): 57.30305 (avg 0.23876)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_cost(60): 1146.85071 (avg 19.11418)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_lower_bound(60): 0.00003 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - boundary_cost(12): 29.20335 (avg 0.60840)
<span class=" -Color -Color-Bold">INFO    </span> |  step #39: cost=1176.0541 lambd=65.5360 inexact_tol=3.1e-04
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_dynamics_constraint(60): 57.30305 (avg 0.23876)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_cost(60): 1146.85071 (avg 19.11418)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_lower_bound(60): 0.00003 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - boundary_cost(12): 29.20335 (avg 0.60840)
<span class=" -Color -Color-Bold">INFO    </span> |  step #40: cost=1176.0541 lambd=131.0720 inexact_tol=3.1e-04
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_dynamics_constraint(60): 57.30305 (avg 0.23876)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_cost(60): 1146.85071 (avg 19.11418)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_lower_bound(60): 0.00003 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - boundary_cost(12): 29.20335 (avg 0.60840)
<span class=" -Color -Color-Bold">INFO    </span> |  step #41: cost=1176.0541 lambd=262.1440 inexact_tol=3.1e-04
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_dynamics_constraint(60): 57.30305 (avg 0.23876)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_cost(60): 1146.85071 (avg 19.11418)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_lower_bound(60): 0.00003 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - boundary_cost(12): 29.20335 (avg 0.60840)
<span class=" -Color -Color-Bold">INFO    </span> |  step #42: cost=1176.0541 lambd=524.2880 inexact_tol=3.1e-04
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_dynamics_constraint(60): 57.30305 (avg 0.23876)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_cost(60): 1146.85071 (avg 19.11418)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_lower_bound(60): 0.00003 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - boundary_cost(12): 29.20335 (avg 0.60840)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=1.74e+01 cost_prev=1233.3572 cost_new=1232.9381
<span class=" -Color -Color-Bold">INFO    </span> |  step #43: cost=1175.7460 lambd=262.1440 inexact_tol=3.1e-04
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_dynamics_constraint(60): 57.19214 (avg 0.23830)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_cost(60): 1146.60779 (avg 19.11013)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_lower_bound(60): 0.00003 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - boundary_cost(12): 29.13816 (avg 0.60705)
<span class=" -Color -Color-Bold">INFO    </span> |  step #44: cost=1175.7460 lambd=524.2880 inexact_tol=3.1e-04
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_dynamics_constraint(60): 57.19214 (avg 0.23830)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_cost(60): 1146.60779 (avg 19.11013)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_lower_bound(60): 0.00003 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - boundary_cost(12): 29.13816 (avg 0.60705)
<span class=" -Color -Color-Bold">INFO    </span> |  step #45: cost=1175.7460 lambd=1048.5760 inexact_tol=3.1e-04
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_dynamics_constraint(60): 57.19214 (avg 0.23830)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_cost(60): 1146.60779 (avg 19.11013)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_lower_bound(60): 0.00003 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - boundary_cost(12): 29.13816 (avg 0.60705)
<span class=" -Color -Color-Bold">INFO    </span> |  step #46: cost=1175.7460 lambd=2097.1521 inexact_tol=3.1e-04
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_dynamics_constraint(60): 57.19214 (avg 0.23830)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_cost(60): 1146.60779 (avg 19.11013)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_lower_bound(60): 0.00003 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - boundary_cost(12): 29.13816 (avg 0.60705)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=1.04e+01 cost_prev=1232.9381 cost_new=1232.8407
<span class=" -Color -Color-Bold">INFO    </span> |  step #47: cost=1175.6655 lambd=1048.5760 inexact_tol=3.1e-04
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_dynamics_constraint(60): 57.17017 (avg 0.23821)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_cost(60): 1146.54614 (avg 19.10910)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_lower_bound(60): 0.00490 (avg 0.00008)
<span class=" -Color -Color-Bold">INFO    </span> |      - boundary_cost(12): 29.11940 (avg 0.60665)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=2.36e+01 cost_prev=1232.8407 cost_new=1232.6453
<span class=" -Color -Color-Bold">INFO    </span> |  step #48: cost=1175.4600 lambd=524.2880 inexact_tol=3.1e-04
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_dynamics_constraint(60): 57.18525 (avg 0.23827)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_cost(60): 1146.37354 (avg 19.10623)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_lower_bound(60): 0.00009 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - boundary_cost(12): 29.08642 (avg 0.60597)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=1.00e+01 cost_prev=1232.6453 cost_new=1232.2632
<span class=" -Color -Color-Bold">INFO    </span> |  step #49: cost=1175.0762 lambd=262.1440 inexact_tol=3.1e-04
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_dynamics_constraint(60): 57.18707 (avg 0.23828)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_cost(60): 1146.03931 (avg 19.10066)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_lower_bound(60): 0.00009 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - boundary_cost(12): 29.03686 (avg 0.60493)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=1.00e+01 cost_prev=1232.2632 cost_new=1231.5076
<span class=" -Color -Color-Bold">INFO    </span> |  step #50: cost=1174.3444 lambd=131.0720 inexact_tol=3.1e-04
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_dynamics_constraint(60): 57.16308 (avg 0.23818)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_cost(60): 1145.38257 (avg 19.08971)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_lower_bound(60): 0.00009 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - boundary_cost(12): 28.96179 (avg 0.60337)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=9.94e+00 cost_prev=1231.5076 cost_new=1230.0244
<span class=" -Color -Color-Bold">INFO    </span> |  step #51: cost=1172.9518 lambd=65.5360 inexact_tol=3.1e-04
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_dynamics_constraint(60): 57.07256 (avg 0.23780)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_cost(60): 1144.11096 (avg 19.06852)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_lower_bound(60): 0.00009 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - boundary_cost(12): 28.84078 (avg 0.60085)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=9.84e+00 cost_prev=1230.0244 cost_new=1227.1663
<span class=" -Color -Color-Bold">INFO    </span> |  step #52: cost=1170.3425 lambd=32.7680 inexact_tol=3.1e-04
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_dynamics_constraint(60): 56.82368 (avg 0.23677)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_cost(60): 1141.70581 (avg 19.02843)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_lower_bound(60): 0.00010 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - boundary_cost(12): 28.63674 (avg 0.59660)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=9.67e+00 cost_prev=1227.1663 cost_new=1221.8278
<span class=" -Color -Color-Bold">INFO    </span> |  step #53: cost=1165.5826 lambd=16.3840 inexact_tol=3.1e-04
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_dynamics_constraint(60): 56.24492 (avg 0.23435)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_cost(60): 1137.29785 (avg 18.95497)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_lower_bound(60): 0.00010 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - boundary_cost(12): 28.28483 (avg 0.58927)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=9.64e+00 cost_prev=1221.8278 cost_new=1212.4086
<span class=" -Color -Color-Bold">INFO    </span> |  step #54: cost=1157.2345 lambd=8.1920 inexact_tol=3.1e-04
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_dynamics_constraint(60): 55.17414 (avg 0.22989)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_cost(60): 1129.54333 (avg 18.82572)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_lower_bound(60): 0.00010 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - boundary_cost(12): 27.69118 (avg 0.57690)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=1.24e+01 cost_prev=1212.4086 cost_new=1197.3881
<span class=" -Color -Color-Bold">INFO    </span> |  step #55: cost=1143.6758 lambd=4.0960 inexact_tol=3.1e-04
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_dynamics_constraint(60): 53.71211 (avg 0.22380)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_cost(60): 1116.85486 (avg 18.61425)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_lower_bound(60): 0.00010 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - boundary_cost(12): 26.82087 (avg 0.55877)
<span class=" -Color -Color-Bold">INFO    </span> |  step #56: cost=1143.6758 lambd=8.1920 inexact_tol=3.1e-04
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_dynamics_constraint(60): 53.71211 (avg 0.22380)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_cost(60): 1116.85486 (avg 18.61425)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_lower_bound(60): 0.00010 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - boundary_cost(12): 26.82087 (avg 0.55877)
<span class=" -Color -Color-Bold">INFO    </span> |  step #57: cost=1143.6758 lambd=16.3840 inexact_tol=3.1e-04
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_dynamics_constraint(60): 53.71211 (avg 0.22380)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_cost(60): 1116.85486 (avg 18.61425)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_lower_bound(60): 0.00010 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - boundary_cost(12): 26.82087 (avg 0.55877)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=2.81e+01 cost_prev=1197.3881 cost_new=1190.9600
<span class=" -Color -Color-Bold">INFO    </span> |  step #58: cost=1137.8726 lambd=8.1920 inexact_tol=3.1e-04
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_dynamics_constraint(60): 53.08727 (avg 0.22120)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_cost(60): 1111.56702 (avg 18.52612)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_lower_bound(60): 0.00010 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - boundary_cost(12): 26.30554 (avg 0.54803)
<span class=" -Color -Color-Bold">INFO    </span> |  step #59: cost=1137.8726 lambd=16.3840 inexact_tol=3.1e-04
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_dynamics_constraint(60): 53.08727 (avg 0.22120)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_cost(60): 1111.56702 (avg 18.52612)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_lower_bound(60): 0.00010 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - boundary_cost(12): 26.30554 (avg 0.54803)
<span class=" -Color -Color-Bold">INFO    </span> |  step #60: cost=1137.8726 lambd=32.7680 inexact_tol=3.1e-04
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_dynamics_constraint(60): 53.08727 (avg 0.22120)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_cost(60): 1111.56702 (avg 18.52612)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_lower_bound(60): 0.00010 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - boundary_cost(12): 26.30554 (avg 0.54803)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=9.29e+00 cost_prev=1190.9600 cost_new=1188.0045
<span class=" -Color -Color-Bold">INFO    </span> |  step #61: cost=1135.1998 lambd=16.3840 inexact_tol=3.1e-04
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_dynamics_constraint(60): 52.80459 (avg 0.22002)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_cost(60): 1109.14526 (avg 18.48576)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_lower_bound(60): 0.00010 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - boundary_cost(12): 26.05461 (avg 0.54280)
<span class=" -Color -Color-Bold">INFO    </span> |  step #62: cost=1135.1998 lambd=32.7680 inexact_tol=3.1e-04
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_dynamics_constraint(60): 52.80459 (avg 0.22002)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_cost(60): 1109.14526 (avg 18.48576)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_lower_bound(60): 0.00010 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - boundary_cost(12): 26.05461 (avg 0.54280)
<span class=" -Color -Color-Bold">INFO    </span> |  step #63: cost=1135.1998 lambd=65.5360 inexact_tol=3.1e-04
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_dynamics_constraint(60): 52.80459 (avg 0.22002)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_cost(60): 1109.14526 (avg 18.48576)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_lower_bound(60): 0.00010 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - boundary_cost(12): 26.05461 (avg 0.54280)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=7.07e+00 cost_prev=1188.0045 cost_new=1187.8376
<span class=" -Color -Color-Bold">INFO    </span> |  step #64: cost=1133.9175 lambd=32.7680 inexact_tol=3.1e-04
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_dynamics_constraint(60): 52.66771 (avg 0.21945)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_cost(60): 1107.98438 (avg 18.46641)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_lower_bound(60): 1.25248 (avg 0.02087)
<span class=" -Color -Color-Bold">INFO    </span> |      - boundary_cost(12): 25.93316 (avg 0.54027)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=3.79e+02 cost_prev=1187.8376 cost_new=1184.1113
<span class=" -Color -Color-Bold">INFO    </span> |  step #65: cost=1130.9304 lambd=16.3840 inexact_tol=3.1e-04
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_dynamics_constraint(60): 53.18079 (avg 0.22159)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_cost(60): 1104.94678 (avg 18.41578)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_lower_bound(60): 0.00015 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - boundary_cost(12): 25.98368 (avg 0.54133)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=6.45e+00 cost_prev=1184.1113 cost_new=1179.6654
<span class=" -Color -Color-Bold">INFO    </span> |  step #66: cost=1126.1221 lambd=8.1920 inexact_tol=2.6e-04
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_dynamics_constraint(60): 53.54328 (avg 0.22310)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_cost(60): 1100.06250 (avg 18.33438)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_lower_bound(60): 0.00016 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - boundary_cost(12): 26.05954 (avg 0.54291)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=7.16e+00 cost_prev=1179.6654 cost_new=1172.4539
<span class=" -Color -Color-Bold">INFO    </span> |  step #67: cost=1118.7693 lambd=4.0960 inexact_tol=2.6e-04
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_dynamics_constraint(60): 53.68436 (avg 0.22368)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_cost(60): 1092.77258 (avg 18.21288)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_lower_bound(60): 0.00017 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - boundary_cost(12): 25.99671 (avg 0.54160)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=1.34e+01 cost_prev=1172.4539 cost_new=1162.7101
<span class=" -Color -Color-Bold">INFO    </span> |  step #68: cost=1109.0679 lambd=2.0480 inexact_tol=2.6e-04
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_dynamics_constraint(60): 53.64223 (avg 0.22351)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_cost(60): 1083.38879 (avg 18.05648)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_lower_bound(60): 0.00017 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - boundary_cost(12): 25.67905 (avg 0.53498)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=3.17e+01 cost_prev=1162.7101 cost_new=1153.1166
<span class=" -Color -Color-Bold">INFO    </span> |  step #69: cost=1099.6740 lambd=1.0240 inexact_tol=2.6e-04
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_dynamics_constraint(60): 53.44236 (avg 0.22268)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_cost(60): 1074.47705 (avg 17.90795)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_lower_bound(60): 0.00019 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - boundary_cost(12): 25.19690 (avg 0.52494)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=5.65e+01 cost_prev=1153.1166 cost_new=1147.3000
<span class=" -Color -Color-Bold">INFO    </span> |  step #70: cost=1094.1512 lambd=0.5120 inexact_tol=2.6e-04
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_dynamics_constraint(60): 53.14856 (avg 0.22145)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_cost(60): 1069.49268 (avg 17.82488)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_lower_bound(60): 0.00019 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - boundary_cost(12): 24.65861 (avg 0.51372)
<span class=" -Color -Color-Bold">INFO    </span> |  step #71: cost=1094.1512 lambd=1.0240 inexact_tol=2.6e-04
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_dynamics_constraint(60): 53.14856 (avg 0.22145)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_cost(60): 1069.49268 (avg 17.82488)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_lower_bound(60): 0.00019 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - boundary_cost(12): 24.65861 (avg 0.51372)
<span class=" -Color -Color-Bold">INFO    </span> |  step #72: cost=1094.1512 lambd=2.0480 inexact_tol=2.6e-04
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_dynamics_constraint(60): 53.14856 (avg 0.22145)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_cost(60): 1069.49268 (avg 17.82488)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_lower_bound(60): 0.00019 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - boundary_cost(12): 24.65861 (avg 0.51372)
<span class=" -Color -Color-Bold">INFO    </span> |  step #73: cost=1094.1512 lambd=4.0960 inexact_tol=2.6e-04
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_dynamics_constraint(60): 53.14856 (avg 0.22145)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_cost(60): 1069.49268 (avg 17.82488)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_lower_bound(60): 0.00019 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - boundary_cost(12): 24.65861 (avg 0.51372)
<span class=" -Color -Color-Bold">INFO    </span> |  step #74: cost=1094.1512 lambd=8.1920 inexact_tol=2.6e-04
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_dynamics_constraint(60): 53.14856 (avg 0.22145)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_cost(60): 1069.49268 (avg 17.82488)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_lower_bound(60): 0.00019 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - boundary_cost(12): 24.65861 (avg 0.51372)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=5.85e+01 cost_prev=1147.3000 cost_new=1146.8005
<span class=" -Color -Color-Bold">INFO    </span> |  step #75: cost=1093.7878 lambd=4.0960 inexact_tol=2.6e-04
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_dynamics_constraint(60): 53.01266 (avg 0.22089)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_cost(60): 1069.43811 (avg 17.82397)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_lower_bound(60): 0.00018 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - boundary_cost(12): 24.34968 (avg 0.50728)
<span class=" -Color -Color-Bold">INFO    </span> |  step #76: cost=1093.7878 lambd=8.1920 inexact_tol=2.6e-04
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_dynamics_constraint(60): 53.01266 (avg 0.22089)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_cost(60): 1069.43811 (avg 17.82397)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_lower_bound(60): 0.00018 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - boundary_cost(12): 24.34968 (avg 0.50728)
<span class=" -Color -Color-Bold">INFO    </span> |  step #77: cost=1093.7878 lambd=16.3840 inexact_tol=2.6e-04
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_dynamics_constraint(60): 53.01266 (avg 0.22089)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_cost(60): 1069.43811 (avg 17.82397)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_lower_bound(60): 0.00018 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - boundary_cost(12): 24.34968 (avg 0.50728)
<span class=" -Color -Color-Bold">INFO    </span> |  step #78: cost=1093.7878 lambd=32.7680 inexact_tol=2.6e-04
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_dynamics_constraint(60): 53.01266 (avg 0.22089)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_cost(60): 1069.43811 (avg 17.82397)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_lower_bound(60): 0.00018 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - boundary_cost(12): 24.34968 (avg 0.50728)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=1.60e+00 cost_prev=1146.8005 cost_new=1146.7069
<span class=" -Color -Color-Bold">INFO    </span> |  step #79: cost=1093.7153 lambd=16.3840 inexact_tol=2.6e-04
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_dynamics_constraint(60): 52.99149 (avg 0.22080)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_cost(60): 1069.42834 (avg 17.82381)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_lower_bound(60): 0.00018 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - boundary_cost(12): 24.28695 (avg 0.50598)
<span class=" -Color -Color-Bold">INFO    </span> |  step #80: cost=1093.7153 lambd=32.7680 inexact_tol=2.6e-04
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_dynamics_constraint(60): 52.99149 (avg 0.22080)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_cost(60): 1069.42834 (avg 17.82381)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_lower_bound(60): 0.00018 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - boundary_cost(12): 24.28695 (avg 0.50598)
<span class=" -Color -Color-Bold">INFO    </span> |  step #81: cost=1093.7153 lambd=65.5360 inexact_tol=2.6e-04
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_dynamics_constraint(60): 52.99149 (avg 0.22080)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_cost(60): 1069.42834 (avg 17.82381)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_lower_bound(60): 0.00018 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - boundary_cost(12): 24.28695 (avg 0.50598)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=1.26e+00 cost_prev=1146.7069 cost_new=1146.6611
<span class=" -Color -Color-Bold">INFO    </span> |  step #82: cost=1093.6838 lambd=32.7680 inexact_tol=2.6e-04
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_dynamics_constraint(60): 52.97724 (avg 0.22074)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_cost(60): 1069.42188 (avg 17.82370)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_lower_bound(60): 0.00018 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - boundary_cost(12): 24.26200 (avg 0.50546)
<span class=" -Color -Color-Bold">INFO    </span> |  step #83: cost=1093.6838 lambd=65.5360 inexact_tol=2.6e-04
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_dynamics_constraint(60): 52.97724 (avg 0.22074)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_cost(60): 1069.42188 (avg 17.82370)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_lower_bound(60): 0.00018 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - boundary_cost(12): 24.26200 (avg 0.50546)
<span class=" -Color -Color-Bold">INFO    </span> |  step #84: cost=1093.6838 lambd=131.0720 inexact_tol=2.6e-04
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_dynamics_constraint(60): 52.97724 (avg 0.22074)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_cost(60): 1069.42188 (avg 17.82370)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_lower_bound(60): 0.00018 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - boundary_cost(12): 24.26200 (avg 0.50546)
<span class=" -Color -Color-Bold">INFO    </span> |  step #85: cost=1093.6838 lambd=262.1440 inexact_tol=2.6e-04
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_dynamics_constraint(60): 52.97724 (avg 0.22074)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_cost(60): 1069.42188 (avg 17.82370)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_lower_bound(60): 0.00018 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - boundary_cost(12): 24.26200 (avg 0.50546)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=False ATb_norm=1.24e+00 cost_prev=1146.6611 cost_new=1146.6835
<span class=" -Color -Color-Bold">INFO    </span> |  AL update: snorm=5.1754e-03, csupn=5.1754e-03, max_rho=4.2288e+05
<span class=" -Color -Color-Bold">INFO    </span> |  step #86: cost=1093.6838 lambd=262.1440 inexact_tol=2.6e-04
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_dynamics_constraint(60): 211.90892 (avg 0.88295)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_cost(60): 1069.42188 (avg 17.82370)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_lower_bound(60): 0.00112 (avg 0.00002)
<span class=" -Color -Color-Bold">INFO    </span> |      - boundary_cost(12): 24.26200 (avg 0.50546)
<span class=" -Color -Color-Bold">INFO    </span> |  step #87: cost=1093.6838 lambd=524.2880 inexact_tol=2.6e-04
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_dynamics_constraint(60): 211.90892 (avg 0.88295)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_cost(60): 1069.42188 (avg 17.82370)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_lower_bound(60): 0.00112 (avg 0.00002)
<span class=" -Color -Color-Bold">INFO    </span> |      - boundary_cost(12): 24.26200 (avg 0.50546)
<span class=" -Color -Color-Bold">INFO    </span> |  step #88: cost=1093.6838 lambd=1048.5760 inexact_tol=2.6e-04
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_dynamics_constraint(60): 211.90892 (avg 0.88295)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_cost(60): 1069.42188 (avg 17.82370)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_lower_bound(60): 0.00112 (avg 0.00002)
<span class=" -Color -Color-Bold">INFO    </span> |      - boundary_cost(12): 24.26200 (avg 0.50546)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=4.95e+02 cost_prev=1305.5939 cost_new=1305.5302
<span class=" -Color -Color-Bold">INFO    </span> |  step #89: cost=1108.5138 lambd=524.2880 inexact_tol=2.6e-04
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_dynamics_constraint(60): 188.32970 (avg 0.78471)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_cost(60): 1070.64124 (avg 17.84402)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_lower_bound(60): 8.68647 (avg 0.14477)
<span class=" -Color -Color-Bold">INFO    </span> |      - boundary_cost(12): 37.87255 (avg 0.78901)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=9.93e+02 cost_prev=1305.5302 cost_new=1292.9443
<span class=" -Color -Color-Bold">INFO    </span> |  step #90: cost=1116.5272 lambd=262.1440 inexact_tol=2.6e-04
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_dynamics_constraint(60): 176.41428 (avg 0.73506)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_cost(60): 1072.40100 (avg 17.87335)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_lower_bound(60): 0.00285 (avg 0.00005)
<span class=" -Color -Color-Bold">INFO    </span> |      - boundary_cost(12): 44.12624 (avg 0.91930)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=3.00e+01 cost_prev=1292.9443 cost_new=1288.6990
<span class=" -Color -Color-Bold">INFO    </span> |  step #91: cost=1124.4653 lambd=131.0720 inexact_tol=2.6e-04
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_dynamics_constraint(60): 164.23210 (avg 0.68430)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_cost(60): 1075.99036 (avg 17.93317)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_lower_bound(60): 0.00168 (avg 0.00003)
<span class=" -Color -Color-Bold">INFO    </span> |      - boundary_cost(12): 48.47496 (avg 1.00990)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=2.23e+01 cost_prev=1288.6990 cost_new=1283.2782
<span class=" -Color -Color-Bold">INFO    </span> |  step #92: cost=1133.1582 lambd=65.5360 inexact_tol=2.6e-04
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_dynamics_constraint(60): 150.11871 (avg 0.62549)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_cost(60): 1082.27686 (avg 18.03795)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_lower_bound(60): 0.00140 (avg 0.00002)
<span class=" -Color -Color-Bold">INFO    </span> |      - boundary_cost(12): 50.88136 (avg 1.06003)
<span class=" -Color -Color-Bold">INFO    </span> |  step #93: cost=1133.1582 lambd=131.0720 inexact_tol=2.6e-04
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_dynamics_constraint(60): 150.11871 (avg 0.62549)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_cost(60): 1082.27686 (avg 18.03795)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_lower_bound(60): 0.00140 (avg 0.00002)
<span class=" -Color -Color-Bold">INFO    </span> |      - boundary_cost(12): 50.88136 (avg 1.06003)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=1.80e+01 cost_prev=1283.2782 cost_new=1279.3987
<span class=" -Color -Color-Bold">INFO    </span> |  step #94: cost=1139.3712 lambd=65.5360 inexact_tol=2.6e-04
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_dynamics_constraint(60): 140.02646 (avg 0.58344)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_cost(60): 1087.85461 (avg 18.13091)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_lower_bound(60): 0.00118 (avg 0.00002)
<span class=" -Color -Color-Bold">INFO    </span> |      - boundary_cost(12): 51.51657 (avg 1.07326)
<span class=" -Color -Color-Bold">INFO    </span> |  step #95: cost=1139.3712 lambd=131.0720 inexact_tol=2.6e-04
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_dynamics_constraint(60): 140.02646 (avg 0.58344)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_cost(60): 1087.85461 (avg 18.13091)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_lower_bound(60): 0.00118 (avg 0.00002)
<span class=" -Color -Color-Bold">INFO    </span> |      - boundary_cost(12): 51.51657 (avg 1.07326)
<span class=" -Color -Color-Bold">INFO    </span> |  step #96: cost=1139.3712 lambd=262.1440 inexact_tol=2.6e-04
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_dynamics_constraint(60): 140.02646 (avg 0.58344)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_cost(60): 1087.85461 (avg 18.13091)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_lower_bound(60): 0.00118 (avg 0.00002)
<span class=" -Color -Color-Bold">INFO    </span> |      - boundary_cost(12): 51.51657 (avg 1.07326)
<span class=" -Color -Color-Bold">INFO    </span> |  step #97: cost=1139.3712 lambd=524.2880 inexact_tol=2.6e-04
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_dynamics_constraint(60): 140.02646 (avg 0.58344)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_cost(60): 1087.85461 (avg 18.13091)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_lower_bound(60): 0.00118 (avg 0.00002)
<span class=" -Color -Color-Bold">INFO    </span> |      - boundary_cost(12): 51.51657 (avg 1.07326)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=1.54e+01 cost_prev=1279.3987 cost_new=1278.5505
<span class=" -Color -Color-Bold">INFO    </span> |  step #98: cost=1140.8026 lambd=262.1440 inexact_tol=2.6e-04
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_dynamics_constraint(60): 137.74684 (avg 0.57395)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_cost(60): 1089.20874 (avg 18.15348)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_lower_bound(60): 0.00111 (avg 0.00002)
<span class=" -Color -Color-Bold">INFO    </span> |      - boundary_cost(12): 51.59391 (avg 1.07487)
<span class=" -Color -Color-Bold">INFO    </span> |  step #99: cost=1140.8026 lambd=524.2880 inexact_tol=2.6e-04
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_dynamics_constraint(60): 137.74684 (avg 0.57395)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_upper_bound(60): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_cost(60): 1089.20874 (avg 18.15348)
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_control_lower_bound(60): 0.00111 (avg 0.00002)
<span class=" -Color -Color-Bold">INFO    </span> |      - boundary_cost(12): 51.59391 (avg 1.07487)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=False ATb_norm=1.48e+01 cost_prev=1278.5505 cost_new=1286.9772
<span class=" -Color -Color-Bold">INFO    </span> | Terminated @ iteration #100: cost=1140.8026 criteria=[0 0 0], term_deltas=1.2e-03,6.1e+00,7.4e-05
</pre></div>
</div>
</div>
</div>
</section>
<section id="visualization">
<h2>Visualization<a class="headerlink" href="#visualization" title="Link to this heading">¶</a></h2>
<p>Extract solution trajectories and create animated visualization:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Extract solution trajectories.</span>
<span class="n">states</span> <span class="o">=</span> <span class="n">solution</span><span class="p">[</span><span class="n">state_vars</span><span class="p">]</span>  <span class="c1"># Shape: (n_steps+1, 4)</span>
<span class="n">controls</span> <span class="o">=</span> <span class="n">solution</span><span class="p">[</span><span class="n">control_vars</span><span class="p">]</span>  <span class="c1"># Shape: (n_steps, 1)</span>

<span class="n">times</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">total_time</span><span class="p">,</span> <span class="n">n_steps</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">control_times</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">total_time</span> <span class="o">-</span> <span class="n">dt</span><span class="p">,</span> <span class="n">n_steps</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Final state: x=</span><span class="si">{</span><span class="nb">float</span><span class="p">(</span><span class="n">states</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">])</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">, theta=</span><span class="si">{</span><span class="nb">float</span><span class="p">(</span><span class="n">states</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">])</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Target theta (pi): </span><span class="si">{</span><span class="n">jnp</span><span class="o">.</span><span class="n">pi</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Final state: x=0.001, theta=3.141
Target theta (pi): 3.142
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">plotly.graph_objects</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">go</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">plotly.subplots</span><span class="w"> </span><span class="kn">import</span> <span class="n">make_subplots</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">IPython.display</span><span class="w"> </span><span class="kn">import</span> <span class="n">HTML</span>

<span class="c1"># Animation of cart-pole swing-up.</span>
<span class="n">cart_y_offset</span> <span class="o">=</span> <span class="mf">1.2</span>  <span class="c1"># Raise cart so pole can swing freely above ground.</span>
<span class="n">wheel_radius</span> <span class="o">=</span> <span class="mf">0.05</span>


<span class="k">def</span><span class="w"> </span><span class="nf">create_cart_pole_frame</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">theta</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a single frame of cart-pole visualization.&quot;&quot;&quot;</span>
    <span class="n">cart_width</span><span class="p">,</span> <span class="n">cart_height</span> <span class="o">=</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.15</span>
    <span class="n">pole_len</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">length</span>  <span class="c1"># Full pole length.</span>
    <span class="n">pole_x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">pole_len</span> <span class="o">*</span> <span class="n">jnp</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
    <span class="n">pole_y</span> <span class="o">=</span> <span class="n">cart_y_offset</span> <span class="o">-</span> <span class="n">pole_len</span> <span class="o">*</span> <span class="n">jnp</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>

    <span class="c1"># Wheel positions.</span>
    <span class="n">wheel_y</span> <span class="o">=</span> <span class="n">cart_y_offset</span> <span class="o">-</span> <span class="n">cart_height</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">wheel_radius</span>

    <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span>
        <span class="n">cart_x</span><span class="o">=</span><span class="p">[</span>
            <span class="n">x</span> <span class="o">-</span> <span class="n">cart_width</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span>
            <span class="n">x</span> <span class="o">+</span> <span class="n">cart_width</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span>
            <span class="n">x</span> <span class="o">+</span> <span class="n">cart_width</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span>
            <span class="n">x</span> <span class="o">-</span> <span class="n">cart_width</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span>
            <span class="n">x</span> <span class="o">-</span> <span class="n">cart_width</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span>
        <span class="p">],</span>
        <span class="n">cart_y</span><span class="o">=</span><span class="p">[</span>
            <span class="n">cart_y_offset</span> <span class="o">-</span> <span class="n">cart_height</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span>
            <span class="n">cart_y_offset</span> <span class="o">-</span> <span class="n">cart_height</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span>
            <span class="n">cart_y_offset</span> <span class="o">+</span> <span class="n">cart_height</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span>
            <span class="n">cart_y_offset</span> <span class="o">+</span> <span class="n">cart_height</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span>
            <span class="n">cart_y_offset</span> <span class="o">-</span> <span class="n">cart_height</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span>
        <span class="p">],</span>
        <span class="n">pole_x</span><span class="o">=</span><span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="n">pole_x</span><span class="p">)],</span>
        <span class="n">pole_y</span><span class="o">=</span><span class="p">[</span><span class="n">cart_y_offset</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="n">pole_y</span><span class="p">)],</span>
        <span class="n">mass_x</span><span class="o">=</span><span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">pole_x</span><span class="p">)],</span>
        <span class="n">mass_y</span><span class="o">=</span><span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">pole_y</span><span class="p">)],</span>
        <span class="n">wheel1_x</span><span class="o">=</span><span class="p">[</span><span class="n">x</span> <span class="o">-</span> <span class="n">cart_width</span> <span class="o">/</span> <span class="mi">3</span><span class="p">],</span>
        <span class="n">wheel1_y</span><span class="o">=</span><span class="p">[</span><span class="n">wheel_y</span><span class="p">],</span>
        <span class="n">wheel2_x</span><span class="o">=</span><span class="p">[</span><span class="n">x</span> <span class="o">+</span> <span class="n">cart_width</span> <span class="o">/</span> <span class="mi">3</span><span class="p">],</span>
        <span class="n">wheel2_y</span><span class="o">=</span><span class="p">[</span><span class="n">wheel_y</span><span class="p">],</span>
    <span class="p">)</span>


<span class="c1"># Create animation frames (use every 2nd timestep for performance).</span>
<span class="n">frame_step</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">frame_indices</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n_steps</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">frame_step</span><span class="p">))</span>
<span class="n">frames</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">frame_indices</span><span class="p">:</span>
    <span class="n">frame_data</span> <span class="o">=</span> <span class="n">create_cart_pole_frame</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">states</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">states</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">]))</span>
    <span class="n">frames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
        <span class="n">go</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span>
            <span class="n">data</span><span class="o">=</span><span class="p">[</span>
                <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
                    <span class="n">x</span><span class="o">=</span><span class="n">frame_data</span><span class="p">[</span><span class="s2">&quot;cart_x&quot;</span><span class="p">],</span>
                    <span class="n">y</span><span class="o">=</span><span class="n">frame_data</span><span class="p">[</span><span class="s2">&quot;cart_y&quot;</span><span class="p">],</span>
                    <span class="n">fill</span><span class="o">=</span><span class="s2">&quot;toself&quot;</span><span class="p">,</span>
                    <span class="n">fillcolor</span><span class="o">=</span><span class="s2">&quot;steelblue&quot;</span><span class="p">,</span>
                    <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;darkblue&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span>
                <span class="p">),</span>
                <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
                    <span class="n">x</span><span class="o">=</span><span class="n">frame_data</span><span class="p">[</span><span class="s2">&quot;pole_x&quot;</span><span class="p">],</span>
                    <span class="n">y</span><span class="o">=</span><span class="n">frame_data</span><span class="p">[</span><span class="s2">&quot;pole_y&quot;</span><span class="p">],</span>
                    <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;lines&quot;</span><span class="p">,</span>
                    <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;sienna&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">8</span><span class="p">),</span>
                <span class="p">),</span>
                <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
                    <span class="n">x</span><span class="o">=</span><span class="n">frame_data</span><span class="p">[</span><span class="s2">&quot;mass_x&quot;</span><span class="p">],</span>
                    <span class="n">y</span><span class="o">=</span><span class="n">frame_data</span><span class="p">[</span><span class="s2">&quot;mass_y&quot;</span><span class="p">],</span>
                    <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;markers&quot;</span><span class="p">,</span>
                    <span class="n">marker</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                        <span class="n">size</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;sienna&quot;</span><span class="p">,</span> <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                    <span class="p">),</span>
                <span class="p">),</span>
                <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
                    <span class="n">x</span><span class="o">=</span><span class="n">frame_data</span><span class="p">[</span><span class="s2">&quot;wheel1_x&quot;</span><span class="p">],</span>
                    <span class="n">y</span><span class="o">=</span><span class="n">frame_data</span><span class="p">[</span><span class="s2">&quot;wheel1_y&quot;</span><span class="p">],</span>
                    <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;markers&quot;</span><span class="p">,</span>
                    <span class="n">marker</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">symbol</span><span class="o">=</span><span class="s2">&quot;circle&quot;</span><span class="p">),</span>
                <span class="p">),</span>
                <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
                    <span class="n">x</span><span class="o">=</span><span class="n">frame_data</span><span class="p">[</span><span class="s2">&quot;wheel2_x&quot;</span><span class="p">],</span>
                    <span class="n">y</span><span class="o">=</span><span class="n">frame_data</span><span class="p">[</span><span class="s2">&quot;wheel2_y&quot;</span><span class="p">],</span>
                    <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;markers&quot;</span><span class="p">,</span>
                    <span class="n">marker</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">symbol</span><span class="o">=</span><span class="s2">&quot;circle&quot;</span><span class="p">),</span>
                <span class="p">),</span>
            <span class="p">],</span>
            <span class="n">name</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">),</span>
        <span class="p">)</span>
    <span class="p">)</span>

<span class="c1"># Initial frame.</span>
<span class="n">init_frame</span> <span class="o">=</span> <span class="n">create_cart_pole_frame</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">states</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">states</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]))</span>
<span class="n">rail_y</span> <span class="o">=</span> <span class="n">cart_y_offset</span> <span class="o">-</span> <span class="mf">0.15</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">wheel_radius</span> <span class="o">*</span> <span class="mi">2</span>

<span class="n">fig_anim</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="p">[</span>
        <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
            <span class="n">x</span><span class="o">=</span><span class="n">init_frame</span><span class="p">[</span><span class="s2">&quot;cart_x&quot;</span><span class="p">],</span>
            <span class="n">y</span><span class="o">=</span><span class="n">init_frame</span><span class="p">[</span><span class="s2">&quot;cart_y&quot;</span><span class="p">],</span>
            <span class="n">fill</span><span class="o">=</span><span class="s2">&quot;toself&quot;</span><span class="p">,</span>
            <span class="n">fillcolor</span><span class="o">=</span><span class="s2">&quot;steelblue&quot;</span><span class="p">,</span>
            <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;darkblue&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Cart&quot;</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
            <span class="n">x</span><span class="o">=</span><span class="n">init_frame</span><span class="p">[</span><span class="s2">&quot;pole_x&quot;</span><span class="p">],</span>
            <span class="n">y</span><span class="o">=</span><span class="n">init_frame</span><span class="p">[</span><span class="s2">&quot;pole_y&quot;</span><span class="p">],</span>
            <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;lines&quot;</span><span class="p">,</span>
            <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;sienna&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">8</span><span class="p">),</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Pole&quot;</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
            <span class="n">x</span><span class="o">=</span><span class="n">init_frame</span><span class="p">[</span><span class="s2">&quot;mass_x&quot;</span><span class="p">],</span>
            <span class="n">y</span><span class="o">=</span><span class="n">init_frame</span><span class="p">[</span><span class="s2">&quot;mass_y&quot;</span><span class="p">],</span>
            <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;markers&quot;</span><span class="p">,</span>
            <span class="n">marker</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;sienna&quot;</span><span class="p">,</span> <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">1</span><span class="p">)),</span>
            <span class="n">showlegend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
            <span class="n">x</span><span class="o">=</span><span class="n">init_frame</span><span class="p">[</span><span class="s2">&quot;wheel1_x&quot;</span><span class="p">],</span>
            <span class="n">y</span><span class="o">=</span><span class="n">init_frame</span><span class="p">[</span><span class="s2">&quot;wheel1_y&quot;</span><span class="p">],</span>
            <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;markers&quot;</span><span class="p">,</span>
            <span class="n">marker</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">symbol</span><span class="o">=</span><span class="s2">&quot;circle&quot;</span><span class="p">),</span>
            <span class="n">showlegend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
            <span class="n">x</span><span class="o">=</span><span class="n">init_frame</span><span class="p">[</span><span class="s2">&quot;wheel2_x&quot;</span><span class="p">],</span>
            <span class="n">y</span><span class="o">=</span><span class="n">init_frame</span><span class="p">[</span><span class="s2">&quot;wheel2_y&quot;</span><span class="p">],</span>
            <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;markers&quot;</span><span class="p">,</span>
            <span class="n">marker</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">symbol</span><span class="o">=</span><span class="s2">&quot;circle&quot;</span><span class="p">),</span>
            <span class="n">showlegend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
            <span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">2.5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">],</span>
            <span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="n">rail_y</span><span class="p">,</span> <span class="n">rail_y</span><span class="p">],</span>
            <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;lines&quot;</span><span class="p">,</span>
            <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">6</span><span class="p">),</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Rail&quot;</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">],</span>
    <span class="n">frames</span><span class="o">=</span><span class="n">frames</span><span class="p">,</span>
    <span class="n">layout</span><span class="o">=</span><span class="n">go</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span>
        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Cart-Pole (Collocation)&quot;</span><span class="p">,</span>
        <span class="n">xaxis</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
            <span class="nb">range</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">2.5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;x (m)&quot;</span><span class="p">,</span> <span class="n">constrain</span><span class="o">=</span><span class="s2">&quot;domain&quot;</span><span class="p">,</span> <span class="n">showgrid</span><span class="o">=</span><span class="kc">False</span>
        <span class="p">),</span>
        <span class="n">yaxis</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
            <span class="nb">range</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">],</span>
            <span class="n">title</span><span class="o">=</span><span class="s2">&quot;y (m)&quot;</span><span class="p">,</span>
            <span class="n">scaleanchor</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span>
            <span class="n">scaleratio</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">showgrid</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">updatemenus</span><span class="o">=</span><span class="p">[</span>
            <span class="nb">dict</span><span class="p">(</span>
                <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;buttons&quot;</span><span class="p">,</span>
                <span class="n">showactive</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">y</span><span class="o">=</span><span class="mf">1.15</span><span class="p">,</span>
                <span class="n">x</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
                <span class="n">xanchor</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
                <span class="n">buttons</span><span class="o">=</span><span class="p">[</span>
                    <span class="nb">dict</span><span class="p">(</span>
                        <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Play&quot;</span><span class="p">,</span>
                        <span class="n">method</span><span class="o">=</span><span class="s2">&quot;animate&quot;</span><span class="p">,</span>
                        <span class="n">args</span><span class="o">=</span><span class="p">[</span>
                            <span class="kc">None</span><span class="p">,</span>
                            <span class="nb">dict</span><span class="p">(</span>
                                <span class="n">frame</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">redraw</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
                                <span class="n">fromcurrent</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                <span class="n">transition</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
                            <span class="p">),</span>
                        <span class="p">],</span>
                    <span class="p">),</span>
                    <span class="nb">dict</span><span class="p">(</span>
                        <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Pause&quot;</span><span class="p">,</span>
                        <span class="n">method</span><span class="o">=</span><span class="s2">&quot;animate&quot;</span><span class="p">,</span>
                        <span class="n">args</span><span class="o">=</span><span class="p">[</span>
                            <span class="p">[</span><span class="kc">None</span><span class="p">],</span>
                            <span class="nb">dict</span><span class="p">(</span>
                                <span class="n">frame</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">redraw</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span>
                                <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;immediate&quot;</span><span class="p">,</span>
                            <span class="p">),</span>
                        <span class="p">],</span>
                    <span class="p">),</span>
                <span class="p">],</span>
            <span class="p">)</span>
        <span class="p">],</span>
        <span class="n">sliders</span><span class="o">=</span><span class="p">[</span>
            <span class="nb">dict</span><span class="p">(</span>
                <span class="n">active</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                <span class="n">yanchor</span><span class="o">=</span><span class="s2">&quot;top&quot;</span><span class="p">,</span>
                <span class="n">xanchor</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span>
                <span class="n">currentvalue</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                    <span class="n">prefix</span><span class="o">=</span><span class="s2">&quot;Time: &quot;</span><span class="p">,</span>
                    <span class="n">suffix</span><span class="o">=</span><span class="s2">&quot;s&quot;</span><span class="p">,</span>
                    <span class="n">visible</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">xanchor</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
                    <span class="n">offset</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
                <span class="p">),</span>
                <span class="n">pad</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">b</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="mi">60</span><span class="p">),</span>
                <span class="n">steps</span><span class="o">=</span><span class="p">[</span>
                    <span class="nb">dict</span><span class="p">(</span>
                        <span class="n">args</span><span class="o">=</span><span class="p">[</span>
                            <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)],</span>
                            <span class="nb">dict</span><span class="p">(</span>
                                <span class="n">frame</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">redraw</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
                                <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;immediate&quot;</span><span class="p">,</span>
                                <span class="n">transition</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
                            <span class="p">),</span>
                        <span class="p">],</span>
                        <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">float</span><span class="p">(</span><span class="n">times</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                        <span class="n">method</span><span class="o">=</span><span class="s2">&quot;animate&quot;</span><span class="p">,</span>
                    <span class="p">)</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">frame_indices</span>
                <span class="p">],</span>
                <span class="n">x</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
                <span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                <span class="nb">len</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">],</span>
        <span class="n">height</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span>
        <span class="n">showlegend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">margin</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">t</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">100</span><span class="p">),</span>
        <span class="n">plot_bgcolor</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span>
    <span class="p">),</span>
<span class="p">)</span>
<span class="n">HTML</span><span class="p">(</span><span class="n">fig_anim</span><span class="o">.</span><span class="n">to_html</span><span class="p">(</span><span class="n">full_html</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">include_plotlyjs</span><span class="o">=</span><span class="s2">&quot;cdn&quot;</span><span class="p">,</span> <span class="n">auto_play</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><div>                        <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-3.3.0.min.js" integrity="sha256-bO3dS6yCpk9aK4gUpNELtCiDeSYvGYnK7jFI58NQnHI=" crossorigin="anonymous"></script>                <div id="7854ff96-3fcd-45b6-ad7f-205d8450e02a" class="plotly-graph-div" style="height:500px; width:100%;"></div>            <script type="text/javascript">                window.PLOTLYENV=window.PLOTLYENV || {};                                if (document.getElementById("7854ff96-3fcd-45b6-ad7f-205d8450e02a")) {                    Plotly.newPlot(                        "7854ff96-3fcd-45b6-ad7f-205d8450e02a",                        [{"fill":"toself","fillcolor":"steelblue","line":{"color":"darkblue","width":2},"name":"Cart","x":[-0.21251407060772182,0.1874859293922782,0.1874859293922782,-0.21251407060772182,-0.21251407060772182],"y":[1.125,1.125,1.275,1.275,1.125],"type":"scatter"},{"line":{"color":"sienna","width":8},"mode":"lines","name":"Pole","x":[-0.012514070607721806,0.048742081969976425],"y":[1.2,0.20187795162200928],"type":"scatter"},{"marker":{"color":"sienna","line":{"color":"black","width":1},"size":18},"mode":"markers","showlegend":false,"x":[0.048742081969976425],"y":[0.20187795162200928],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","showlegend":false,"x":[-0.14584740394105514],"y":[1.075],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","showlegend":false,"x":[0.12081926272561153],"y":[1.075],"type":"scatter"},{"line":{"color":"gray","width":6},"mode":"lines","name":"Rail","x":[-2.5,2.5],"y":[1.025,1.025],"type":"scatter"}],                        {"height":500,"margin":{"b":100,"t":80},"plot_bgcolor":"white","showlegend":false,"sliders":[{"active":0,"currentvalue":{"offset":20,"prefix":"Time: ","suffix":"s","visible":true,"xanchor":"center"},"len":0.8,"pad":{"b":10,"t":60},"steps":[{"args":[["0"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"0.00","method":"animate"},{"args":[["2"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"0.10","method":"animate"},{"args":[["4"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"0.20","method":"animate"},{"args":[["6"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"0.30","method":"animate"},{"args":[["8"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"0.40","method":"animate"},{"args":[["10"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"0.50","method":"animate"},{"args":[["12"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"0.60","method":"animate"},{"args":[["14"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"0.70","method":"animate"},{"args":[["16"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"0.80","method":"animate"},{"args":[["18"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"0.90","method":"animate"},{"args":[["20"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"1.00","method":"animate"},{"args":[["22"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"1.10","method":"animate"},{"args":[["24"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"1.20","method":"animate"},{"args":[["26"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"1.30","method":"animate"},{"args":[["28"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"1.40","method":"animate"},{"args":[["30"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"1.50","method":"animate"},{"args":[["32"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"1.60","method":"animate"},{"args":[["34"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"1.70","method":"animate"},{"args":[["36"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"1.80","method":"animate"},{"args":[["38"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"1.90","method":"animate"},{"args":[["40"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"2.00","method":"animate"},{"args":[["42"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"2.10","method":"animate"},{"args":[["44"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"2.20","method":"animate"},{"args":[["46"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"2.30","method":"animate"},{"args":[["48"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"2.40","method":"animate"},{"args":[["50"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"2.50","method":"animate"},{"args":[["52"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"2.60","method":"animate"},{"args":[["54"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"2.70","method":"animate"},{"args":[["56"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"2.80","method":"animate"},{"args":[["58"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"2.90","method":"animate"},{"args":[["60"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"3.00","method":"animate"}],"x":0.1,"xanchor":"left","y":0,"yanchor":"top"}],"title":{"text":"Cart-Pole (Collocation)"},"updatemenus":[{"buttons":[{"args":[null,{"frame":{"duration":50,"redraw":true},"fromcurrent":true,"transition":{"duration":0}}],"label":"Play","method":"animate"},{"args":[[null],{"frame":{"duration":0,"redraw":false},"mode":"immediate"}],"label":"Pause","method":"animate"}],"showactive":false,"type":"buttons","x":0.5,"xanchor":"center","y":1.15}],"xaxis":{"constrain":"domain","range":[-2.5,2.5],"showgrid":false,"title":{"text":"x (m)"}},"yaxis":{"range":[-0.1,2.5],"scaleanchor":"x","scaleratio":1,"showgrid":false,"title":{"text":"y (m)"}},"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermap":[{"type":"scattermap","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}}},                        {"responsive": true}                    ).then(function(){
                            Plotly.addFrames('7854ff96-3fcd-45b6-ad7f-205d8450e02a', [{"data":[{"fill":"toself","fillcolor":"steelblue","line":{"color":"darkblue","width":2},"x":[-0.21251407060772182,0.1874859293922782,0.1874859293922782,-0.21251407060772182,-0.21251407060772182],"y":[1.125,1.125,1.275,1.275,1.125],"type":"scatter"},{"line":{"color":"sienna","width":8},"mode":"lines","x":[-0.012514070607721806,0.048742081969976425],"y":[1.2,0.20187795162200928],"type":"scatter"},{"marker":{"color":"sienna","line":{"color":"black","width":1},"size":18},"mode":"markers","x":[0.048742081969976425],"y":[0.20187795162200928],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[-0.14584740394105514],"y":[1.075],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[0.12081926272561153],"y":[1.075],"type":"scatter"}],"name":"0"},{"data":[{"fill":"toself","fillcolor":"steelblue","line":{"color":"darkblue","width":2},"x":[-0.19869066162500532,0.2013093383749947,0.2013093383749947,-0.19869066162500532,-0.19869066162500532],"y":[1.125,1.125,1.275,1.275,1.125],"type":"scatter"},{"line":{"color":"sienna","width":8},"mode":"lines","x":[0.0013093383749946952,0.034171223640441895],"y":[1.2,0.20054012537002563],"type":"scatter"},{"marker":{"color":"sienna","line":{"color":"black","width":1},"size":18},"mode":"markers","x":[0.034171223640441895],"y":[0.20054012537002563],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[-0.13202399495833864],"y":[1.075],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[0.13464267170832803],"y":[1.075],"type":"scatter"}],"name":"2"},{"data":[{"fill":"toself","fillcolor":"steelblue","line":{"color":"darkblue","width":2},"x":[-0.13564422428607942,0.2643557757139206,0.2643557757139206,-0.13564422428607942,-0.13564422428607942],"y":[1.125,1.125,1.275,1.275,1.125],"type":"scatter"},{"line":{"color":"sienna","width":8},"mode":"lines","x":[0.0643557757139206,-0.01110348105430603],"y":[1.2,0.20285117626190186],"type":"scatter"},{"marker":{"color":"sienna","line":{"color":"black","width":1},"size":18},"mode":"markers","x":[-0.01110348105430603],"y":[0.20285117626190186],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[-0.06897755761941274],"y":[1.075],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[0.19768910904725392],"y":[1.075],"type":"scatter"}],"name":"4"},{"data":[{"fill":"toself","fillcolor":"steelblue","line":{"color":"darkblue","width":2},"x":[-0.0094514161348343,0.3905485838651657,0.3905485838651657,-0.0094514161348343,-0.0094514161348343],"y":[1.125,1.125,1.275,1.275,1.125],"type":"scatter"},{"line":{"color":"sienna","width":8},"mode":"lines","x":[0.1905485838651657,-0.07486359775066376],"y":[1.2,0.23586499691009521],"type":"scatter"},{"marker":{"color":"sienna","line":{"color":"black","width":1},"size":18},"mode":"markers","x":[-0.07486359775066376],"y":[0.23586499691009521],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[0.05721525053183238],"y":[1.075],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[0.323881917198499],"y":[1.075],"type":"scatter"}],"name":"6"},{"data":[{"fill":"toself","fillcolor":"steelblue","line":{"color":"darkblue","width":2},"x":[0.1725135028362274,0.5725135028362274,0.5725135028362274,0.1725135028362274,0.1725135028362274],"y":[1.125,1.125,1.275,1.275,1.125],"type":"scatter"},{"line":{"color":"sienna","width":8},"mode":"lines","x":[0.3725135028362274,-0.11156296730041504],"y":[1.2,0.3249743580818176],"type":"scatter"},{"marker":{"color":"sienna","line":{"color":"black","width":1},"size":18},"mode":"markers","x":[-0.11156296730041504],"y":[0.3249743580818176],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[0.23918016950289409],"y":[1.075],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[0.5058468361695607],"y":[1.075],"type":"scatter"}],"name":"8"},{"data":[{"fill":"toself","fillcolor":"steelblue","line":{"color":"darkblue","width":2},"x":[0.3838255286216736,0.7838255286216735,0.7838255286216735,0.3838255286216736,0.3838255286216736],"y":[1.125,1.125,1.275,1.275,1.125],"type":"scatter"},{"line":{"color":"sienna","width":8},"mode":"lines","x":[0.5838255286216736,-0.06973057985305786],"y":[1.2,0.4431219696998596],"type":"scatter"},{"marker":{"color":"sienna","line":{"color":"black","width":1},"size":18},"mode":"markers","x":[-0.06973057985305786],"y":[0.4431219696998596],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[0.4504921952883403],"y":[1.075],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[0.7171588619550069],"y":[1.075],"type":"scatter"}],"name":"10"},{"data":[{"fill":"toself","fillcolor":"steelblue","line":{"color":"darkblue","width":2},"x":[0.5941107153892518,0.9941107153892517,0.9941107153892517,0.5941107153892518,0.5941107153892518],"y":[1.125,1.125,1.275,1.275,1.125],"type":"scatter"},{"line":{"color":"sienna","width":8},"mode":"lines","x":[0.7941107153892517,0.059961795806884766],"y":[1.2,0.5210115909576416],"type":"scatter"},{"marker":{"color":"sienna","line":{"color":"black","width":1},"size":18},"mode":"markers","x":[0.059961795806884766],"y":[0.5210115909576416],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[0.6607773820559184],"y":[1.075],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[0.927444048722585],"y":[1.075],"type":"scatter"}],"name":"12"},{"data":[{"fill":"toself","fillcolor":"steelblue","line":{"color":"darkblue","width":2},"x":[0.7792450666427613,1.1792450666427612,1.1792450666427612,0.7792450666427613,0.7792450666427613],"y":[1.125,1.125,1.275,1.275,1.125],"type":"scatter"},{"line":{"color":"sienna","width":8},"mode":"lines","x":[0.9792450666427612,0.25909119844436646],"y":[1.2,0.5061856508255005],"type":"scatter"},{"marker":{"color":"sienna","line":{"color":"black","width":1},"size":18},"mode":"markers","x":[0.25909119844436646],"y":[0.5061856508255005],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[0.8459117333094279],"y":[1.075],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[1.1125783999760945],"y":[1.075],"type":"scatter"}],"name":"14"},{"data":[{"fill":"toself","fillcolor":"steelblue","line":{"color":"darkblue","width":2},"x":[0.9173243522644043,1.3173243522644043,1.3173243522644043,0.9173243522644043,0.9173243522644043],"y":[1.125,1.125,1.275,1.275,1.125],"type":"scatter"},{"line":{"color":"sienna","width":8},"mode":"lines","x":[1.1173243522644043,0.5291191339492798],"y":[1.2,0.3912883400917053],"type":"scatter"},{"marker":{"color":"sienna","line":{"color":"black","width":1},"size":18},"mode":"markers","x":[0.5291191339492798],"y":[0.3912883400917053],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[0.983991018931071],"y":[1.075],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[1.2506576855977376],"y":[1.075],"type":"scatter"}],"name":"16"},{"data":[{"fill":"toself","fillcolor":"steelblue","line":{"color":"darkblue","width":2},"x":[0.9791045665740967,1.3791045665740966,1.3791045665740966,0.9791045665740967,0.9791045665740967],"y":[1.125,1.125,1.275,1.275,1.125],"type":"scatter"},{"line":{"color":"sienna","width":8},"mode":"lines","x":[1.1791045665740967,0.908180296421051],"y":[1.2,0.2373993992805481],"type":"scatter"},{"marker":{"color":"sienna","line":{"color":"black","width":1},"size":18},"mode":"markers","x":[0.908180296421051],"y":[0.2373993992805481],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[1.0457712332407634],"y":[1.075],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[1.31243789990743],"y":[1.075],"type":"scatter"}],"name":"18"},{"data":[{"fill":"toself","fillcolor":"steelblue","line":{"color":"darkblue","width":2},"x":[0.9423990726470948,1.3423990726470947,1.3423990726470947,0.9423990726470948,0.9423990726470948],"y":[1.125,1.125,1.275,1.275,1.125],"type":"scatter"},{"line":{"color":"sienna","width":8},"mode":"lines","x":[1.1423990726470947,1.3997901678085327],"y":[1.2,0.23369276523590088],"type":"scatter"},{"marker":{"color":"sienna","line":{"color":"black","width":1},"size":18},"mode":"markers","x":[1.3997901678085327],"y":[0.23369276523590088],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[1.0090657393137614],"y":[1.075],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[1.275732405980428],"y":[1.075],"type":"scatter"}],"name":"20"},{"data":[{"fill":"toself","fillcolor":"steelblue","line":{"color":"darkblue","width":2},"x":[0.8153609514236451,1.215360951423645,1.215360951423645,0.8153609514236451,0.8153609514236451],"y":[1.125,1.125,1.275,1.275,1.125],"type":"scatter"},{"line":{"color":"sienna","width":8},"mode":"lines","x":[1.015360951423645,1.7917211055755615],"y":[1.2,0.5697104930877686],"type":"scatter"},{"marker":{"color":"sienna","line":{"color":"black","width":1},"size":18},"mode":"markers","x":[1.7917211055755615],"y":[0.5697104930877686],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[0.8820276180903117],"y":[1.075],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[1.1486942847569783],"y":[1.075],"type":"scatter"}],"name":"22"},{"data":[{"fill":"toself","fillcolor":"steelblue","line":{"color":"darkblue","width":2},"x":[0.6308420181274415,1.0308420181274414,1.0308420181274414,0.6308420181274415,0.6308420181274415],"y":[1.125,1.125,1.275,1.275,1.125],"type":"scatter"},{"line":{"color":"sienna","width":8},"mode":"lines","x":[0.8308420181274414,1.8257007598876953],"y":[1.2,1.0987279415130615],"type":"scatter"},{"marker":{"color":"sienna","line":{"color":"black","width":1},"size":18},"mode":"markers","x":[1.8257007598876953],"y":[1.0987279415130615],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[0.6975086847941081],"y":[1.075],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[0.9641753514607747],"y":[1.075],"type":"scatter"}],"name":"24"},{"data":[{"fill":"toself","fillcolor":"steelblue","line":{"color":"darkblue","width":2},"x":[0.44148443937301635,0.8414844393730163,0.8414844393730163,0.44148443937301635,0.44148443937301635],"y":[1.125,1.125,1.275,1.275,1.125],"type":"scatter"},{"line":{"color":"sienna","width":8},"mode":"lines","x":[0.6414844393730164,1.5835347175598145],"y":[1.2,1.5354716777801514],"type":"scatter"},{"marker":{"color":"sienna","line":{"color":"black","width":1},"size":18},"mode":"markers","x":[1.5835347175598145],"y":[1.5354716777801514],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[0.508151106039683],"y":[1.075],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[0.7748177727063497],"y":[1.075],"type":"scatter"}],"name":"26"},{"data":[{"fill":"toself","fillcolor":"steelblue","line":{"color":"darkblue","width":2},"x":[0.2731284976005554,0.6731284976005554,0.6731284976005554,0.2731284976005554,0.2731284976005554],"y":[1.125,1.125,1.275,1.275,1.125],"type":"scatter"},{"line":{"color":"sienna","width":8},"mode":"lines","x":[0.4731284976005554,1.2639498710632324],"y":[1.2,1.812047004699707],"type":"scatter"},{"marker":{"color":"sienna","line":{"color":"black","width":1},"size":18},"mode":"markers","x":[1.2639498710632324],"y":[1.812047004699707],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[0.3397951642672221],"y":[1.075],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[0.6064618309338887],"y":[1.075],"type":"scatter"}],"name":"28"},{"data":[{"fill":"toself","fillcolor":"steelblue","line":{"color":"darkblue","width":2},"x":[0.13209186792373656,0.5320918679237365,0.5320918679237365,0.13209186792373656,0.13209186792373656],"y":[1.125,1.125,1.275,1.275,1.125],"type":"scatter"},{"line":{"color":"sienna","width":8},"mode":"lines","x":[0.3320918679237366,0.9671840667724609],"y":[1.2,1.9724364280700684],"type":"scatter"},{"marker":{"color":"sienna","line":{"color":"black","width":1},"size":18},"mode":"markers","x":[0.9671840667724609],"y":[1.9724364280700684],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[0.19875853459040324],"y":[1.075],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[0.4654252012570699],"y":[1.075],"type":"scatter"}],"name":"30"},{"data":[{"fill":"toself","fillcolor":"steelblue","line":{"color":"darkblue","width":2},"x":[0.016935575008392323,0.41693557500839235,0.41693557500839235,0.016935575008392323,0.016935575008392323],"y":[1.125,1.125,1.275,1.275,1.125],"type":"scatter"},{"line":{"color":"sienna","width":8},"mode":"lines","x":[0.21693557500839233,0.7215051651000977],"y":[1.2,2.063371181488037],"type":"scatter"},{"marker":{"color":"sienna","line":{"color":"black","width":1},"size":18},"mode":"markers","x":[0.7215051651000977],"y":[2.063371181488037],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[0.083602241675059],"y":[1.075],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[0.35026890834172564],"y":[1.075],"type":"scatter"}],"name":"32"},{"data":[{"fill":"toself","fillcolor":"steelblue","line":{"color":"darkblue","width":2},"x":[-0.0748028874397278,0.32519711256027223,0.32519711256027223,-0.0748028874397278,-0.0748028874397278],"y":[1.125,1.125,1.275,1.275,1.125],"type":"scatter"},{"line":{"color":"sienna","width":8},"mode":"lines","x":[0.12519711256027222,0.5279780030250549],"y":[1.2,2.1152963638305664],"type":"scatter"},{"marker":{"color":"sienna","line":{"color":"black","width":1},"size":18},"mode":"markers","x":[0.5279780030250549],"y":[2.1152963638305664],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[-0.008136220773061115],"y":[1.075],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[0.2585304458936055],"y":[1.075],"type":"scatter"}],"name":"34"},{"data":[{"fill":"toself","fillcolor":"steelblue","line":{"color":"darkblue","width":2},"x":[-0.14532908871769906,0.25467091128230096,0.25467091128230096,-0.14532908871769906,-0.14532908871769906],"y":[1.125,1.125,1.275,1.275,1.125],"type":"scatter"},{"line":{"color":"sienna","width":8},"mode":"lines","x":[0.05467091128230095,0.379707396030426],"y":[1.2,2.1457014083862305],"type":"scatter"},{"marker":{"color":"sienna","line":{"color":"black","width":1},"size":18},"mode":"markers","x":[0.379707396030426],"y":[2.1457014083862305],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[-0.07866242205103238],"y":[1.075],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[0.18800424461563428],"y":[1.075],"type":"scatter"}],"name":"36"},{"data":[{"fill":"toself","fillcolor":"steelblue","line":{"color":"darkblue","width":2},"x":[-0.19595037382096053,0.2040496261790395,0.2040496261790395,-0.19595037382096053,-0.19595037382096053],"y":[1.125,1.125,1.275,1.275,1.125],"type":"scatter"},{"line":{"color":"sienna","width":8},"mode":"lines","x":[0.004049626179039478,0.2684304416179657],"y":[1.2,2.1644184589385986],"type":"scatter"},{"marker":{"color":"sienna","line":{"color":"black","width":1},"size":18},"mode":"markers","x":[0.2684304416179657],"y":[2.1644184589385986],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[-0.12928370715429385],"y":[1.075],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[0.1373829595123728],"y":[1.075],"type":"scatter"}],"name":"38"},{"data":[{"fill":"toself","fillcolor":"steelblue","line":{"color":"darkblue","width":2},"x":[-0.22744557149708272,0.1725544285029173,0.1725544285029173,-0.22744557149708272,-0.22744557149708272],"y":[1.125,1.125,1.275,1.275,1.125],"type":"scatter"},{"line":{"color":"sienna","width":8},"mode":"lines","x":[-0.02744557149708271,0.1863998919725418],"y":[1.2,2.1768674850463867],"type":"scatter"},{"marker":{"color":"sienna","line":{"color":"black","width":1},"size":18},"mode":"markers","x":[0.1863998919725418],"y":[2.1768674850463867],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[-0.16077890483041604],"y":[1.075],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[0.10588776183625062],"y":[1.075],"type":"scatter"}],"name":"40"},{"data":[{"fill":"toself","fillcolor":"steelblue","line":{"color":"darkblue","width":2},"x":[-0.24081303626298906,0.15918696373701097,0.15918696373701097,-0.24081303626298906,-0.24081303626298906],"y":[1.125,1.125,1.275,1.275,1.125],"type":"scatter"},{"line":{"color":"sienna","width":8},"mode":"lines","x":[-0.040813036262989044,0.1267615556716919],"y":[1.2,2.185859441757202],"type":"scatter"},{"marker":{"color":"sienna","line":{"color":"black","width":1},"size":18},"mode":"markers","x":[0.1267615556716919],"y":[2.185859441757202],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[-0.17414636959632238],"y":[1.075],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[0.09252029707034429],"y":[1.075],"type":"scatter"}],"name":"42"},{"data":[{"fill":"toself","fillcolor":"steelblue","line":{"color":"darkblue","width":2},"x":[-0.23818474709987641,0.1618152529001236,0.1618152529001236,-0.23818474709987641,-0.23818474709987641],"y":[1.125,1.125,1.275,1.275,1.125],"type":"scatter"},{"line":{"color":"sienna","width":8},"mode":"lines","x":[-0.038184747099876404,0.08356858044862747],"y":[1.2,2.1925604343414307],"type":"scatter"},{"marker":{"color":"sienna","line":{"color":"black","width":1},"size":18},"mode":"markers","x":[0.08356858044862747],"y":[2.1925604343414307],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[-0.17151808043320974],"y":[1.075],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[0.09514858623345693],"y":[1.075],"type":"scatter"}],"name":"44"},{"data":[{"fill":"toself","fillcolor":"steelblue","line":{"color":"darkblue","width":2},"x":[-0.22388051711022855,0.17611948288977147,0.17611948288977147,-0.22388051711022855,-0.22388051711022855],"y":[1.125,1.125,1.275,1.275,1.125],"type":"scatter"},{"line":{"color":"sienna","width":8},"mode":"lines","x":[-0.02388051711022854,0.051963262259960175],"y":[1.2,2.19711971282959],"type":"scatter"},{"marker":{"color":"sienna","line":{"color":"black","width":1},"size":18},"mode":"markers","x":[0.051963262259960175],"y":[2.19711971282959],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[-0.15721385044356187],"y":[1.075],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[0.10945281622310479],"y":[1.075],"type":"scatter"}],"name":"46"},{"data":[{"fill":"toself","fillcolor":"steelblue","line":{"color":"darkblue","width":2},"x":[-0.20573000591248275,0.19426999408751727,0.19426999408751727,-0.20573000591248275,-0.20573000591248275],"y":[1.125,1.125,1.275,1.275,1.125],"type":"scatter"},{"line":{"color":"sienna","width":8},"mode":"lines","x":[-0.0057300059124827385,0.028895903378725052],"y":[1.2,2.1994004249572754],"type":"scatter"},{"marker":{"color":"sienna","line":{"color":"black","width":1},"size":18},"mode":"markers","x":[0.028895903378725052],"y":[2.1994004249572754],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[-0.13906333924581607],"y":[1.075],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[0.1276033274208506],"y":[1.075],"type":"scatter"}],"name":"48"},{"data":[{"fill":"toself","fillcolor":"steelblue","line":{"color":"darkblue","width":2},"x":[-0.19706588638946415,0.20293411361053587,0.20293411361053587,-0.19706588638946415,-0.19706588638946415],"y":[1.125,1.125,1.275,1.275,1.125],"type":"scatter"},{"line":{"color":"sienna","width":8},"mode":"lines","x":[0.00293411361053586,0.014839176088571548],"y":[1.2,2.1999292373657227],"type":"scatter"},{"marker":{"color":"sienna","line":{"color":"black","width":1},"size":18},"mode":"markers","x":[0.014839176088571548],"y":[2.1999292373657227],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[-0.13039921972279747],"y":[1.075],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[0.1362674469438692],"y":[1.075],"type":"scatter"}],"name":"50"},{"data":[{"fill":"toself","fillcolor":"steelblue","line":{"color":"darkblue","width":2},"x":[-0.19842080823145808,0.20157919176854194,0.20157919176854194,-0.19842080823145808,-0.19842080823145808],"y":[1.125,1.125,1.275,1.275,1.125],"type":"scatter"},{"line":{"color":"sienna","width":8},"mode":"lines","x":[0.001579191768541932,0.008466485887765884],"y":[1.2,2.1999764442443848],"type":"scatter"},{"marker":{"color":"sienna","line":{"color":"black","width":1},"size":18},"mode":"markers","x":[0.008466485887765884],"y":[2.1999764442443848],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[-0.1317541415647914],"y":[1.075],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[0.13491252510187526],"y":[1.075],"type":"scatter"}],"name":"52"},{"data":[{"fill":"toself","fillcolor":"steelblue","line":{"color":"darkblue","width":2},"x":[-0.19910158052807675,0.20089841947192327,0.20089841947192327,-0.19910158052807675,-0.19910158052807675],"y":[1.125,1.125,1.275,1.275,1.125],"type":"scatter"},{"line":{"color":"sienna","width":8},"mode":"lines","x":[0.0008984194719232619,0.004516564775258303],"y":[1.2,2.19999361038208],"type":"scatter"},{"marker":{"color":"sienna","line":{"color":"black","width":1},"size":18},"mode":"markers","x":[0.004516564775258303],"y":[2.19999361038208],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[-0.13243491386141007],"y":[1.075],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[0.1342317528052566],"y":[1.075],"type":"scatter"}],"name":"54"},{"data":[{"fill":"toself","fillcolor":"steelblue","line":{"color":"darkblue","width":2},"x":[-0.19940016464097426,0.20059983535902576,0.20059983535902576,-0.19940016464097426,-0.19940016464097426],"y":[1.125,1.125,1.275,1.275,1.125],"type":"scatter"},{"line":{"color":"sienna","width":8},"mode":"lines","x":[0.0005998353590257466,0.002406721469014883],"y":[1.2,2.199998378753662],"type":"scatter"},{"marker":{"color":"sienna","line":{"color":"black","width":1},"size":18},"mode":"markers","x":[0.002406721469014883],"y":[2.199998378753662],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[-0.13273349797430758],"y":[1.075],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[0.13393316869235908],"y":[1.075],"type":"scatter"}],"name":"56"},{"data":[{"fill":"toself","fillcolor":"steelblue","line":{"color":"darkblue","width":2},"x":[-0.19949980631936343,0.2005001936806366,0.2005001936806366,-0.19949980631936343,-0.19949980631936343],"y":[1.125,1.125,1.275,1.275,1.125],"type":"scatter"},{"line":{"color":"sienna","width":8},"mode":"lines","x":[0.0005001936806365848,0.0015307895373553038],"y":[1.2,2.1999995708465576],"type":"scatter"},{"marker":{"color":"sienna","line":{"color":"black","width":1},"size":18},"mode":"markers","x":[0.0015307895373553038],"y":[2.1999995708465576],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[-0.13283313965269675],"y":[1.075],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[0.13383352701396992],"y":[1.075],"type":"scatter"}],"name":"58"},{"data":[{"fill":"toself","fillcolor":"steelblue","line":{"color":"darkblue","width":2},"x":[-0.19945778405526654,0.20054221594473348,0.20054221594473348,-0.19945778405526654,-0.19945778405526654],"y":[1.125,1.125,1.275,1.275,1.125],"type":"scatter"},{"line":{"color":"sienna","width":8},"mode":"lines","x":[0.0005422159447334707,0.0014338139444589615],"y":[1.2,2.1999995708465576],"type":"scatter"},{"marker":{"color":"sienna","line":{"color":"black","width":1},"size":18},"mode":"markers","x":[0.0014338139444589615],"y":[2.1999995708465576],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[-0.13279111738859986],"y":[1.075],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[0.1338755492780668],"y":[1.075],"type":"scatter"}],"name":"60"}]);
                        })                };            </script>        </div></div></div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># State and control trajectories.</span>
<span class="n">fig_traj</span> <span class="o">=</span> <span class="n">make_subplots</span><span class="p">(</span>
    <span class="n">rows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">cols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">subplot_titles</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;Cart Position&quot;</span><span class="p">,</span> <span class="s2">&quot;Pole Angle&quot;</span><span class="p">,</span> <span class="s2">&quot;Velocities&quot;</span><span class="p">,</span> <span class="s2">&quot;Control Force&quot;</span><span class="p">),</span>
    <span class="n">vertical_spacing</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span>
    <span class="n">horizontal_spacing</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Cart position.</span>
<span class="n">fig_traj</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
    <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">times</span><span class="p">],</span>
        <span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">states</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]],</span>
        <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;lines&quot;</span><span class="p">,</span>
        <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;steelblue&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span>
    <span class="p">),</span>
    <span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">col</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Pole angle.</span>
<span class="n">fig_traj</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
    <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">times</span><span class="p">],</span>
        <span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">states</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]],</span>
        <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;lines&quot;</span><span class="p">,</span>
        <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;coral&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;θ&quot;</span><span class="p">,</span>
    <span class="p">),</span>
    <span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">col</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">fig_traj</span><span class="o">.</span><span class="n">add_hline</span><span class="p">(</span>
    <span class="n">y</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">pi</span><span class="p">),</span>
    <span class="n">line_dash</span><span class="o">=</span><span class="s2">&quot;dash&quot;</span><span class="p">,</span>
    <span class="n">line_color</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">,</span>
    <span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">col</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">annotation_text</span><span class="o">=</span><span class="s2">&quot;π&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Velocities.</span>
<span class="n">fig_traj</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
    <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">times</span><span class="p">],</span>
        <span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">states</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]],</span>
        <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;lines&quot;</span><span class="p">,</span>
        <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;steelblue&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;ẋ&quot;</span><span class="p">,</span>
    <span class="p">),</span>
    <span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">col</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">fig_traj</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
    <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">times</span><span class="p">],</span>
        <span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">states</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">]],</span>
        <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;lines&quot;</span><span class="p">,</span>
        <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;coral&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">dash</span><span class="o">=</span><span class="s2">&quot;dash&quot;</span><span class="p">),</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;θ̇&quot;</span><span class="p">,</span>
    <span class="p">),</span>
    <span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">col</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Control force.</span>
<span class="n">fig_traj</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
    <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">control_times</span><span class="p">],</span>
        <span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">u</span><span class="p">)</span> <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="n">controls</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]],</span>
        <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;lines&quot;</span><span class="p">,</span>
        <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;forestgreen&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;F&quot;</span><span class="p">,</span>
        <span class="n">fill</span><span class="o">=</span><span class="s2">&quot;tozeroy&quot;</span><span class="p">,</span>
        <span class="n">fillcolor</span><span class="o">=</span><span class="s2">&quot;rgba(34, 139, 34, 0.2)&quot;</span><span class="p">,</span>
    <span class="p">),</span>
    <span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">col</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">fig_traj</span><span class="o">.</span><span class="n">add_hline</span><span class="p">(</span>
    <span class="n">y</span><span class="o">=</span><span class="n">force_limit</span><span class="p">,</span> <span class="n">line_dash</span><span class="o">=</span><span class="s2">&quot;dash&quot;</span><span class="p">,</span> <span class="n">line_color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">2</span>
<span class="p">)</span>
<span class="n">fig_traj</span><span class="o">.</span><span class="n">add_hline</span><span class="p">(</span>
    <span class="n">y</span><span class="o">=-</span><span class="n">force_limit</span><span class="p">,</span> <span class="n">line_dash</span><span class="o">=</span><span class="s2">&quot;dash&quot;</span><span class="p">,</span> <span class="n">line_color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">2</span>
<span class="p">)</span>

<span class="c1"># Axis labels.</span>
<span class="n">fig_traj</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span><span class="n">title_text</span><span class="o">=</span><span class="s2">&quot;Time (s)&quot;</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">fig_traj</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="n">title_text</span><span class="o">=</span><span class="s2">&quot;Position (m)&quot;</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">fig_traj</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span><span class="n">title_text</span><span class="o">=</span><span class="s2">&quot;Time (s)&quot;</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">fig_traj</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="n">title_text</span><span class="o">=</span><span class="s2">&quot;Angle (rad)&quot;</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">fig_traj</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span><span class="n">title_text</span><span class="o">=</span><span class="s2">&quot;Time (s)&quot;</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">fig_traj</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="n">title_text</span><span class="o">=</span><span class="s2">&quot;Velocity&quot;</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">fig_traj</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span><span class="n">title_text</span><span class="o">=</span><span class="s2">&quot;Time (s)&quot;</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">fig_traj</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="n">title_text</span><span class="o">=</span><span class="s2">&quot;Force (N)&quot;</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="n">fig_traj</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">height</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">showlegend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">margin</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">t</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">40</span><span class="p">))</span>
<span class="n">HTML</span><span class="p">(</span><span class="n">fig_traj</span><span class="o">.</span><span class="n">to_html</span><span class="p">(</span><span class="n">full_html</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">include_plotlyjs</span><span class="o">=</span><span class="s2">&quot;cdn&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><div>                        <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-3.3.0.min.js" integrity="sha256-bO3dS6yCpk9aK4gUpNELtCiDeSYvGYnK7jFI58NQnHI=" crossorigin="anonymous"></script>                <div id="cdba72b4-c055-4471-943e-24ec2564e6c8" class="plotly-graph-div" style="height:500px; width:100%;"></div>            <script type="text/javascript">                window.PLOTLYENV=window.PLOTLYENV || {};                                if (document.getElementById("cdba72b4-c055-4471-943e-24ec2564e6c8")) {                    Plotly.newPlot(                        "cdba72b4-c055-4471-943e-24ec2564e6c8",                        [{"line":{"color":"steelblue","width":2},"mode":"lines","name":"x","x":[0.0,0.05000000447034836,0.10000000894069672,0.15000000596046448,0.20000001788139343,0.2500000298023224,0.30000001192092896,0.3500000238418579,0.40000003576278687,0.4500000476837158,0.5000000596046448,0.5500000715255737,0.6000000238418579,0.6500000357627869,0.7000000476837158,0.7500000596046448,0.8000000715255737,0.8500000834465027,0.9000000953674316,0.9500001072883606,1.0000001192092896,1.0500000715255737,1.1000001430511475,1.1500000953674316,1.2000000476837158,1.2500001192092896,1.3000000715255737,1.3500001430511475,1.4000000953674316,1.4500001668930054,1.5000001192092896,1.5500001907348633,1.6000001430511475,1.6500000953674316,1.7000001668930054,1.7500001192092896,1.8000001907348633,1.8500001430511475,1.9000002145767212,1.9500001668930054,2.000000238418579,2.0500001907348633,2.1000001430511475,2.1500000953674316,2.200000286102295,2.250000238418579,2.3000001907348633,2.3500001430511475,2.4000000953674316,2.450000286102295,2.500000238418579,2.5500001907348633,2.6000001430511475,2.6500003337860107,2.700000286102295,2.750000238418579,2.8000001907348633,2.8500001430511475,2.9000003337860107,2.950000286102295,3.0],"y":[-0.012514070607721806,-0.010199697688221931,0.0013093383749946952,0.025367997586727142,0.0643557757139206,0.11947906017303467,0.1905485838651657,0.2758960723876953,0.3725135028362274,0.4765002429485321,0.5838255286216736,0.6907750368118286,0.7941107153892517,0.8911110758781433,0.9792450666427612,1.0557591915130615,1.1173243522644043,1.1598947048187256,1.1791045665740967,1.1729751825332642,1.1423990726470947,1.0891587734222412,1.015360951423645,0.926527202129364,0.8308420181274414,0.7345051169395447,0.6414844393730164,0.5539980530738831,0.4731284976005554,0.39921990036964417,0.3320918679237366,0.27142763137817383,0.21693557500839233,0.16829617321491241,0.12519711256027222,0.08738440275192261,0.05467091128230095,0.026924986392259598,0.004049626179039478,-0.014041264541447163,-0.02744557149708271,-0.03630031272768974,-0.040813036262989044,-0.041292954236269,-0.038184747099876404,-0.0321044996380806,-0.02388051711022854,-0.014608734287321568,-0.0057300059124827385,0.000894304655957967,0.00293411361053586,0.00216255197301507,0.001579191768541932,0.001173312426544726,0.0008984194719232619,0.0007163831614889205,0.0005998353590257466,0.0005310209235176444,0.0005001936806365848,0.0005037643713876605,0.0005422159447334707],"type":"scatter","xaxis":"x","yaxis":"y"},{"line":{"color":"coral","width":2},"mode":"lines","name":"\u03b8","x":[0.0,0.05000000447034836,0.10000000894069672,0.15000000596046448,0.20000001788139343,0.2500000298023224,0.30000001192092896,0.3500000238418579,0.40000003576278687,0.4500000476837158,0.5000000596046448,0.5500000715255737,0.6000000238418579,0.6500000357627869,0.7000000476837158,0.7500000596046448,0.8000000715255737,0.8500000834465027,0.9000000953674316,0.9500001072883606,1.0000001192092896,1.0500000715255737,1.1000001430511475,1.1500000953674316,1.2000000476837158,1.2500001192092896,1.3000000715255737,1.3500001430511475,1.4000000953674316,1.4500001668930054,1.5000001192092896,1.5500001907348633,1.6000001430511475,1.6500000953674316,1.7000001668930054,1.7500001192092896,1.8000001907348633,1.8500001430511475,1.9000002145767212,1.9500001668930054,2.000000238418579,2.0500001907348633,2.1000001430511475,2.1500000953674316,2.200000286102295,2.250000238418579,2.3000001907348633,2.3500001430511475,2.4000000953674316,2.450000286102295,2.500000238418579,2.5500001907348633,2.6000001430511475,2.6500003337860107,2.700000286102295,2.750000238418579,2.8000001907348633,2.8500001430511475,2.9000003337860107,2.950000286102295,3.0],"y":[0.06129452586174011,0.05522708222270012,0.03286780044436455,-0.010040711611509323,-0.07553105056285858,-0.16296464204788208,-0.2686313986778259,-0.3857777416706085,-0.5053074359893799,-0.6171977519989014,-0.712273359298706,-0.7831569910049438,-0.8244124054908752,-0.8322883248329163,-0.8040240406990051,-0.7371388673782349,-0.6288377642631531,-0.47570982575416565,-0.2743530869483948,-0.02611766941845417,0.26032137870788574,0.5710206627845764,0.8888701796531677,1.19378662109375,1.4693503379821777,1.708945631980896,1.9129021167755127,2.0848608016967773,2.229442834854126,2.351069688796997,2.4534647464752197,2.5397751331329346,2.6127092838287354,2.674509048461914,2.7270395755767822,2.7719101905822754,2.810542345046997,2.8442044258117676,2.874030828475952,2.901029109954834,2.9260828495025635,2.949946165084839,2.9732236862182617,2.9963459968566895,3.0195364952087402,3.0427627563476562,3.065675973892212,3.0875141620635986,3.106959819793701,3.121980905532837,3.1296873092651367,3.1324329376220703,3.1347053050994873,3.136545181274414,3.137974500656128,3.1390371322631836,3.1397857666015625,3.1402764320373535,3.140562057495117,3.1406896114349365,3.1407010555267334],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"line":{"color":"steelblue","width":2},"mode":"lines","name":"\u1e8b","x":[0.0,0.05000000447034836,0.10000000894069672,0.15000000596046448,0.20000001788139343,0.2500000298023224,0.30000001192092896,0.3500000238418579,0.40000003576278687,0.4500000476837158,0.5000000596046448,0.5500000715255737,0.6000000238418579,0.6500000357627869,0.7000000476837158,0.7500000596046448,0.8000000715255737,0.8500000834465027,0.9000000953674316,0.9500001072883606,1.0000001192092896,1.0500000715255737,1.1000001430511475,1.1500000953674316,1.2000000476837158,1.2500001192092896,1.3000000715255737,1.3500001430511475,1.4000000953674316,1.4500001668930054,1.5000001192092896,1.5500001907348633,1.6000001430511475,1.6500000953674316,1.7000001668930054,1.7500001192092896,1.8000001907348633,1.8500001430511475,1.9000002145767212,1.9500001668930054,2.000000238418579,2.0500001907348633,2.1000001430511475,2.1500000953674316,2.200000286102295,2.250000238418579,2.3000001907348633,2.3500001430511475,2.4000000953674316,2.450000286102295,2.500000238418579,2.5500001907348633,2.6000001430511475,2.6500003337860107,2.700000286102295,2.750000238418579,2.8000001907348633,2.8500001430511475,2.9000003337860107,2.950000286102295,3.0],"y":[-0.016989190131425858,0.12886931002140045,0.3507364094257355,0.6307448744773865,0.9477149844169617,1.2759052515029907,1.5853219032287598,1.8469626903533936,2.0363616943359375,2.1421942710876465,2.170325756072998,2.1273536682128906,2.025669813156128,1.873592495918274,1.6705307960510254,1.4082818031311035,1.0721629858016968,0.6484724879264832,0.13875393569469452,-0.36239439249038696,-0.8360605239868164,-1.2678892612457275,-1.6606080532073975,-1.8744374513626099,-1.9381080865859985,-1.9012619256973267,-1.8047527074813843,-1.6788631677627563,-1.5392061471939087,-1.3998181819915771,-1.267593502998352,-1.1410142183303833,-1.0205459594726562,-0.9068059921264648,-0.7988606691360474,-0.6952973008155823,-0.594843327999115,-0.49654924869537354,-0.3999742269515991,-0.30512240529060364,-0.21246105432510376,-0.12308809161186218,-0.03872843459248543,0.03827532380819321,0.10484515875577927,0.1572018414735794,0.1906326860189438,0.19914302229881287,0.17492827773094177,0.10896842181682587,-0.008470444008708,-0.006518797483295202,-0.0038134362548589706,-0.00185210641939193,-0.0005553810624405742,0.00024796678917482495,0.0007148923468776047,0.0009796841768547893,0.0011494255159050226,0.0012957063736394048,0.0014457815559580922],"type":"scatter","xaxis":"x3","yaxis":"y3"},{"line":{"color":"coral","dash":"dash","width":2},"mode":"lines","name":"\u03b8\u0307","x":[0.0,0.05000000447034836,0.10000000894069672,0.15000000596046448,0.20000001788139343,0.2500000298023224,0.30000001192092896,0.3500000238418579,0.40000003576278687,0.4500000476837158,0.5000000596046448,0.5500000715255737,0.6000000238418579,0.6500000357627869,0.7000000476837158,0.7500000596046448,0.8000000715255737,0.8500000834465027,0.9000000953674316,0.9500001072883606,1.0000001192092896,1.0500000715255737,1.1000001430511475,1.1500000953674316,1.2000000476837158,1.2500001192092896,1.3000000715255737,1.3500001430511475,1.4000000953674316,1.4500001668930054,1.5000001192092896,1.5500001907348633,1.6000001430511475,1.6500000953674316,1.7000001668930054,1.7500001192092896,1.8000001907348633,1.8500001430511475,1.9000002145767212,1.9500001668930054,2.000000238418579,2.0500001907348633,2.1000001430511475,2.1500000953674316,2.200000286102295,2.250000238418579,2.3000001907348633,2.3500001430511475,2.4000000953674316,2.450000286102295,2.500000238418579,2.5500001907348633,2.6000001430511475,2.6500003337860107,2.700000286102295,2.750000238418579,2.8000001907348633,2.8500001430511475,2.9000003337860107,2.950000286102295,3.0],"y":[-0.015021748840808868,-0.2782568633556366,-0.6455984711647034,-1.0768065452575684,-1.5233983993530273,-1.9277467727661133,-2.2264859676361084,-2.364187240600586,-2.305419683456421,-2.049487590789795,-1.6295384168624878,-1.0822174549102783,-0.4465444087982178,0.250099778175354,0.9957584738731384,1.7909821271896362,2.646852731704712,3.5741677284240723,4.555115699768066,5.408510208129883,6.0287604331970215,6.3258585929870605,6.276508331298828,5.805497169494629,5.115114688873291,4.382330894470215,3.70396089553833,3.1146950721740723,2.6192216873168945,2.2048068046569824,1.8565952777862549,1.566766381263733,1.3257746696472168,1.1246415376663208,0.9574199914932251,0.8199462294578552,0.7089417576789856,0.6216489672660828,0.555458664894104,0.5078948736190796,0.476490318775177,0.4584420919418335,0.4505029022693634,0.4488663971424103,0.4488453269004822,0.4447479546070099,0.42932459712028503,0.39298996329307556,0.3226945698261261,0.20236517488956451,0.013085405342280865,0.006857922300696373,0.004235075321048498,0.002505086362361908,0.0013270617928355932,0.0005383362295106053,1.6916150343604386e-05,-0.00032644844031892717,-0.0005613465909846127,-0.0007602681289426982,-0.001024787430651486],"type":"scatter","xaxis":"x3","yaxis":"y3"},{"fill":"tozeroy","fillcolor":"rgba(34, 139, 34, 0.2)","line":{"color":"forestgreen","width":2},"mode":"lines","name":"F","x":[0.0,0.05000000074505806,0.10000000149011612,0.15000000596046448,0.20000000298023224,0.25,0.30000001192092896,0.3499999940395355,0.4000000059604645,0.45000001788139343,0.5,0.550000011920929,0.6000000238418579,0.6500000357627869,0.699999988079071,0.75,0.800000011920929,0.8500000238418579,0.9000000357627869,0.949999988079071,1.0,1.0500000715255737,1.100000023841858,1.149999976158142,1.2000000476837158,1.25,1.3000000715255737,1.350000023841858,1.399999976158142,1.4500000476837158,1.5,1.5500000715255737,1.600000023841858,1.649999976158142,1.7000000476837158,1.75,1.8000000715255737,1.850000023841858,1.899999976158142,1.9500000476837158,2.0,2.049999952316284,2.1000001430511475,2.1500000953674316,2.200000047683716,2.25,2.299999952316284,2.3500001430511475,2.4000000953674316,2.450000047683716,2.5,2.549999952316284,2.6000001430511475,2.6500000953674316,2.700000047683716,2.75,2.799999952316284,2.8500001430511475,2.9000000953674316,2.950000047683716],"y":[2.9616448879241943,4.528749942779541,5.743241310119629,6.544960975646973,6.8500590324401855,6.574462890625,5.722368240356445,4.348266124725342,2.681253433227539,1.0632052421569824,-0.47269171476364136,-1.7664868831634521,-2.8665781021118164,-3.936491012573242,-5.125353813171387,-6.5710272789001465,-8.276078224182129,-10.000062942504883,-10.000017166137695,-10.000018119812012,-10.000017166137695,-9.997318267822266,-6.510191440582275,-3.0066137313842773,-0.2995810806751251,1.4926166534423828,2.4865238666534424,3.0048534870147705,3.121005058288574,3.0271191596984863,2.9276974201202393,2.7967755794525146,2.641697883605957,2.501020908355713,2.3879809379577637,2.3013713359832764,2.235302686691284,2.1795356273651123,2.124852180480957,2.0615007877349854,1.9762284755706787,1.855879545211792,1.6875622272491455,1.456081748008728,1.147099256515503,0.7416917681694031,0.21400950849056244,-0.4723256826400757,-1.341091275215149,-2.4051995277404785,0.04356364905834198,0.06183989718556404,0.04849853739142418,0.035662923008203506,0.025413839146494865,0.017746534198522568,0.012439539656043053,0.009099762886762619,0.0070842718705534935,0.005505304783582687],"type":"scatter","xaxis":"x4","yaxis":"y4"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermap":[{"type":"scattermap","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"anchor":"y","domain":[0.0,0.45],"title":{"text":"Time (s)"}},"yaxis":{"anchor":"x","domain":[0.575,1.0],"title":{"text":"Position (m)"}},"xaxis2":{"anchor":"y2","domain":[0.55,1.0],"title":{"text":"Time (s)"}},"yaxis2":{"anchor":"x2","domain":[0.575,1.0],"title":{"text":"Angle (rad)"}},"xaxis3":{"anchor":"y3","domain":[0.0,0.45],"title":{"text":"Time (s)"}},"yaxis3":{"anchor":"x3","domain":[0.0,0.425],"title":{"text":"Velocity"}},"xaxis4":{"anchor":"y4","domain":[0.55,1.0],"title":{"text":"Time (s)"}},"yaxis4":{"anchor":"x4","domain":[0.0,0.425],"title":{"text":"Force (N)"}},"annotations":[{"font":{"size":16},"showarrow":false,"text":"Cart Position","x":0.225,"xanchor":"center","xref":"paper","y":1.0,"yanchor":"bottom","yref":"paper"},{"font":{"size":16},"showarrow":false,"text":"Pole Angle","x":0.775,"xanchor":"center","xref":"paper","y":1.0,"yanchor":"bottom","yref":"paper"},{"font":{"size":16},"showarrow":false,"text":"Velocities","x":0.225,"xanchor":"center","xref":"paper","y":0.425,"yanchor":"bottom","yref":"paper"},{"font":{"size":16},"showarrow":false,"text":"Control Force","x":0.775,"xanchor":"center","xref":"paper","y":0.425,"yanchor":"bottom","yref":"paper"},{"showarrow":false,"text":"\u03c0","x":1,"xanchor":"right","xref":"x2 domain","y":3.141592653589793,"yanchor":"bottom","yref":"y2"}],"shapes":[{"line":{"color":"gray","dash":"dash"},"type":"line","x0":0,"x1":1,"xref":"x2 domain","y0":3.141592653589793,"y1":3.141592653589793,"yref":"y2"},{"line":{"color":"red","dash":"dash"},"opacity":0.5,"type":"line","x0":0,"x1":1,"xref":"x4 domain","y0":10.0,"y1":10.0,"yref":"y4"},{"line":{"color":"red","dash":"dash"},"opacity":0.5,"type":"line","x0":0,"x1":1,"xref":"x4 domain","y0":-10.0,"y1":-10.0,"yref":"y4"}],"margin":{"t":40,"b":40},"height":500,"showlegend":false},                        {"responsive": true}                    )                };            </script>        </div></div></div>
</div>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../cart_pole_shooting/">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Cart-pole (shooting)</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="../obstacle_avoidance/">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Obstacle avoidance</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2025
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              <a class="muted-link " href="https://github.com/brentyi/jaxls" aria-label="GitHub">
            <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16">
                <path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"></path>
            </svg>
        </a>
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Cart-pole (collocation)</a><ul>
<li><a class="reference internal" href="#cart-pole-dynamics">Cart-pole dynamics</a></li>
<li><a class="reference internal" href="#variables">Variables</a></li>
<li><a class="reference internal" href="#cost-functions">Cost functions</a></li>
<li><a class="reference internal" href="#problem-construction">Problem construction</a></li>
<li><a class="reference internal" href="#solving">Solving</a></li>
<li><a class="reference internal" href="#visualization">Visualization</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../../../_static/documentation_options.js?v=187304be"></script>
    <script src="../../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/scripts/furo.js?v=46bd48cc"></script>
    <script src="../../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../../_static/copybutton.js?v=fd10adb8"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>