<!doctype html>
<html class="no-js" lang="en" data-content_root="../../../">
  <head><meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../../../genindex/"><link rel="search" title="Search" href="../../../search/"><link rel="next" title="Cam profile optimization" href="../cam_design/"><link rel="prev" title="Cart-pole (collocation)" href="../cart_pole_collocation/">

    <!-- Generated with Sphinx 8.1.3 and Furo 2025.12.19 -->
        <title>Cart-pole (shooting) - jaxls</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=b86133f3" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/furo.css?v=7bdb33bb" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/css/custom.css?v=6517d2d4" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/furo-extensions.css?v=8dab3a3b" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  --color-code-background: #f4f4f4;
  --color-code-foreground: #000;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle site navigation sidebar">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc" aria-label="Toggle table of contents sidebar">
<label class="overlay sidebar-overlay" for="__navigation"></label>
<label class="overlay toc-overlay" for="__toc"></label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <span class="icon"><svg><use href="#svg-menu"></use></svg></span>
      </label>
    </div>
    <div class="header-center">
      <a href="../../../"><div class="brand">jaxls</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a
  class="sidebar-brand"
  href="../../../"
  style="margin-top: 0.75em"
>
  
  <span class="sidebar-brand-text">jaxls</span>

  
</a>

<div style="text-align: left; padding: 0 1em 1em 1em">
  <a href="https://github.com/brentyi/jaxls">
    <img src="https://img.shields.io/github/stars/brentyi/jaxls?style=social" alt="GitHub stars">
  </a>
</div><form class="sidebar-search-container" method="get" action="../../../search/" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../guide/basics/">Basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../guide/tips_and_gotchas/">Tips and gotchas</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../guide/advanced/">Advanced</a><input aria-label="Toggle navigation of Advanced" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../guide/advanced/non_euclidean/">Non-Euclidean variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../guide/advanced/custom_jacobians/">Custom Jacobians</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../guide/advanced/constraints/">Constraints</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../guide/advanced/robust_costs/">Robust costs</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Examples</span></p>
<ul class="current">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../mechanics/">Mechanics</a><input aria-label="Toggle navigation of Mechanics" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../mechanics/spring_equilibrium/">Spring equilibrium</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../mechanics/cloth_draping/">Cloth draping</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../mechanics/beam_bending/">Beam bending</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../mechanics/truss_analysis/">Truss analysis</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../vision/">Vision</a><input aria-label="Toggle navigation of Vision" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../vision/camera_calibration/">Camera calibration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../vision/pose_graph_2d/">SE(2) pose graph</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../vision/pose_graph_3d/">SE(3) pose graph</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../vision/bundle_adjustment/">Bundle adjustment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../vision/smplh_shape_fitting/">SMPL-H shape fitting</a></li>
</ul>
</li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="../">Robotics</a><input aria-label="Toggle navigation of Robotics" checked="" class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../inverse_kinematics/">Inverse kinematics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../obstacle_avoidance/">Obstacle avoidance</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cart_pole_collocation/">Cart-pole (collocation)</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">Cart-pole (shooting)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cam_design/">Cam profile optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../imu_sensor_fusion/">IMU fusion + calibration</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../portfolio/">Portfolio optimization</a><input aria-label="Toggle navigation of Portfolio optimization" class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../portfolio/mean_variance/">Mean-variance allocation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../portfolio/manifold_allocation/">Manifold allocation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../portfolio/reparameterized_allocation/">Reparameterized allocation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../portfolio/cvar_optimization/">CVaR allocation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../portfolio/black_litterman/">Black-Litterman allocation</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../api/core/">Core API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/lie_group_variables/">Lie group variables</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/solver_config/">Solver configuration</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Design Notes</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../design/typed_api/">Typed API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../design/sparse_matrices/">Sparse matrices</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../design/traced_vs_static/">What’s traced?</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="../../../_sources/examples/robotics/cart_pole_shooting.ipynb.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section class="tex2jax_ignore mathjax_ignore" id="cart-pole-shooting">
<h1>Cart-pole (shooting)<a class="headerlink" href="#cart-pole-shooting" title="Link to this heading">¶</a></h1>
<p>In this notebook, we solve a cart-pole swing-up problem using single shooting: finding
control inputs that swing a pendulum from hanging down to balancing upright.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This notebook demonstrates the shooting method, where we optimize only the control trajectory
and compute states by forward simulation. For contrast, see <a class="reference internal" href="../cart_pole_collocation/"><span class="doc">Cart-pole (collocation)</span></a>, which uses
direct collocation to optimize both states and controls with dynamics as constraints.</p>
</div>
<p>Key difference from direct collocation:</p>
<ul class="simple">
<li><p>Shooting: Optimizes only controls; states are computed by simulating dynamics forward</p></li>
<li><p>Direct collocation: Optimizes both states and controls, with dynamics enforced as equality constraints</p></li>
</ul>
<p>Shooting is simpler but can struggle with long time horizons due to sensitivity of the initial value problem.</p>
<p>Features used:</p>
<ul class="simple">
<li><p><a class="reference internal" href="../../../api/core/#jaxls.Var" title="jaxls.Var"><code class="xref py py-class docutils literal notranslate"><span class="pre">Var</span></code></a> for control trajectory (single variable containing all controls)</p></li>
<li><p><a class="reference internal" href="../../../api/core/#jaxls.Cost.factory" title="jaxls.Cost.factory"><code class="xref py py-func docutils literal notranslate"><span class="pre">&#64;jaxls.Cost.factory</span></code></a> for terminal state cost and control regularization</p></li>
<li><p>Forward simulation with <code class="docutils literal notranslate"><span class="pre">jax.lax.scan</span></code></p></li>
</ul>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">loguru</span><span class="w"> </span><span class="kn">import</span> <span class="n">logger</span>

<span class="n">logger</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
<span class="n">logger</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;&lt;level&gt;</span><span class="si">{level: &lt;8}</span><span class="s2">&lt;/level&gt; | </span><span class="si">{message}</span><span class="s2">&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">jax</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">jax.numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">jnp</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">jaxls</span>
</pre></div>
</div>
</div>
</div>
<section id="cart-pole-dynamics">
<h2>Cart-pole dynamics<a class="headerlink" href="#cart-pole-dynamics" title="Link to this heading">¶</a></h2>
<p>The cart-pole system has state <span class="math notranslate nohighlight">\([x, \theta, \dot{x}, \dot{\theta}]\)</span> where <span class="math notranslate nohighlight">\(x\)</span> is cart position and <span class="math notranslate nohighlight">\(\theta\)</span> is pole angle (0 = hanging down, <span class="math notranslate nohighlight">\(\pi\)</span> = upright). The control input is a horizontal force on the cart.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Physical parameters.</span>
<span class="n">m_cart</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1"># Cart mass (kg)</span>
<span class="n">m_pole</span> <span class="o">=</span> <span class="mf">0.1</span>  <span class="c1"># Pole mass (kg)</span>
<span class="n">length</span> <span class="o">=</span> <span class="mf">0.5</span>  <span class="c1"># Pole half-length (m)</span>
<span class="n">gravity</span> <span class="o">=</span> <span class="mf">9.81</span>  <span class="c1"># Gravitational acceleration (m/s^2)</span>

<span class="c1"># Trajectory parameters.</span>
<span class="n">n_swing</span> <span class="o">=</span> <span class="mi">50</span>  <span class="c1"># Timesteps for swing-up phase</span>
<span class="n">n_hold</span> <span class="o">=</span> <span class="mi">10</span>  <span class="c1"># Timesteps to hold upright position</span>
<span class="n">n_steps</span> <span class="o">=</span> <span class="n">n_swing</span> <span class="o">+</span> <span class="n">n_hold</span>  <span class="c1"># Total timesteps</span>
<span class="n">dt</span> <span class="o">=</span> <span class="mf">0.05</span>  <span class="c1"># Time step (s)</span>
<span class="n">total_time</span> <span class="o">=</span> <span class="n">n_steps</span> <span class="o">*</span> <span class="n">dt</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total trajectory time: </span><span class="si">{</span><span class="n">total_time</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">s (</span><span class="si">{</span><span class="n">n_swing</span><span class="si">}</span><span class="s2"> swing + </span><span class="si">{</span><span class="n">n_hold</span><span class="si">}</span><span class="s2"> hold)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total trajectory time: 3.00s (50 swing + 10 hold)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@jax</span><span class="o">.</span><span class="n">jit</span>
<span class="k">def</span><span class="w"> </span><span class="nf">cart_pole_dynamics</span><span class="p">(</span><span class="n">state</span><span class="p">:</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">,</span> <span class="n">force</span><span class="p">:</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute state derivatives for the cart-pole system.</span>

<span class="sd">    State: [x, theta, x_dot, theta_dot]</span>
<span class="sd">    theta = 0: pole hanging down, theta = pi: pole upright</span>

<span class="sd">    Args:</span>
<span class="sd">        state: Current state [x, theta, x_dot, theta_dot]</span>
<span class="sd">        force: Control force [f]</span>

<span class="sd">    Returns:</span>
<span class="sd">        State derivatives [x_dot, theta_dot, x_ddot, theta_ddot]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">x_dot</span><span class="p">,</span> <span class="n">theta_dot</span> <span class="o">=</span> <span class="n">state</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">force</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">sin_th</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
    <span class="n">cos_th</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>

    <span class="c1"># Total mass.</span>
    <span class="n">total_mass</span> <span class="o">=</span> <span class="n">m_cart</span> <span class="o">+</span> <span class="n">m_pole</span>
    <span class="n">pole_mass_length</span> <span class="o">=</span> <span class="n">m_pole</span> <span class="o">*</span> <span class="n">length</span>

    <span class="c1"># Equations of motion for theta=0 being DOWN (stable equilibrium)</span>
    <span class="n">temp</span> <span class="o">=</span> <span class="p">(</span><span class="n">f</span> <span class="o">+</span> <span class="n">pole_mass_length</span> <span class="o">*</span> <span class="n">theta_dot</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">sin_th</span><span class="p">)</span> <span class="o">/</span> <span class="n">total_mass</span>
    <span class="n">theta_ddot</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">gravity</span> <span class="o">*</span> <span class="n">sin_th</span> <span class="o">-</span> <span class="n">cos_th</span> <span class="o">*</span> <span class="n">temp</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span>
        <span class="n">length</span> <span class="o">*</span> <span class="p">(</span><span class="mf">4.0</span> <span class="o">/</span> <span class="mf">3.0</span> <span class="o">-</span> <span class="n">m_pole</span> <span class="o">*</span> <span class="n">cos_th</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="n">total_mass</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="n">x_ddot</span> <span class="o">=</span> <span class="n">temp</span> <span class="o">-</span> <span class="n">pole_mass_length</span> <span class="o">*</span> <span class="n">theta_ddot</span> <span class="o">*</span> <span class="n">cos_th</span> <span class="o">/</span> <span class="n">total_mass</span>

    <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">x_dot</span><span class="p">,</span> <span class="n">theta_dot</span><span class="p">,</span> <span class="n">x_ddot</span><span class="p">,</span> <span class="n">theta_ddot</span><span class="p">])</span>


<span class="nd">@jax</span><span class="o">.</span><span class="n">jit</span>
<span class="k">def</span><span class="w"> </span><span class="nf">rk4_step</span><span class="p">(</span><span class="n">state</span><span class="p">:</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">,</span> <span class="n">force</span><span class="p">:</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">,</span> <span class="n">dt</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Runge-Kutta 4th order integration step.</span>

<span class="sd">    Args:</span>
<span class="sd">        state: Current state [x, theta, x_dot, theta_dot]</span>
<span class="sd">        force: Control force [f]</span>
<span class="sd">        dt: Time step</span>

<span class="sd">    Returns:</span>
<span class="sd">        Next state after integration</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">k1</span> <span class="o">=</span> <span class="n">cart_pole_dynamics</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">force</span><span class="p">)</span>
    <span class="n">k2</span> <span class="o">=</span> <span class="n">cart_pole_dynamics</span><span class="p">(</span><span class="n">state</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">dt</span> <span class="o">*</span> <span class="n">k1</span><span class="p">,</span> <span class="n">force</span><span class="p">)</span>
    <span class="n">k3</span> <span class="o">=</span> <span class="n">cart_pole_dynamics</span><span class="p">(</span><span class="n">state</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">dt</span> <span class="o">*</span> <span class="n">k2</span><span class="p">,</span> <span class="n">force</span><span class="p">)</span>
    <span class="n">k4</span> <span class="o">=</span> <span class="n">cart_pole_dynamics</span><span class="p">(</span><span class="n">state</span> <span class="o">+</span> <span class="n">dt</span> <span class="o">*</span> <span class="n">k3</span><span class="p">,</span> <span class="n">force</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">state</span> <span class="o">+</span> <span class="p">(</span><span class="n">dt</span> <span class="o">/</span> <span class="mf">6.0</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">k1</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">k2</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">k3</span> <span class="o">+</span> <span class="n">k4</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="forward-simulation">
<h2>Forward simulation<a class="headerlink" href="#forward-simulation" title="Link to this heading">¶</a></h2>
<p>The key difference from direct collocation: we simulate the entire trajectory forward using <code class="docutils literal notranslate"><span class="pre">jax.lax.scan</span></code>. Given a control sequence, we compute all states by integrating the dynamics.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Initial and target states.</span>
<span class="n">initial_state</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">])</span>  <span class="c1"># x=0, theta=0 (down), zero velocity</span>
<span class="n">target_state</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">jnp</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">])</span>  <span class="c1"># x=0, theta=pi (up), zero velocity</span>


<span class="nd">@jax</span><span class="o">.</span><span class="n">jit</span>
<span class="k">def</span><span class="w"> </span><span class="nf">simulate_trajectory</span><span class="p">(</span><span class="n">controls</span><span class="p">:</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Simulate the cart-pole system forward given a control sequence.</span>

<span class="sd">    Args:</span>
<span class="sd">        controls: Control forces, shape (n_steps, 1)</span>

<span class="sd">    Returns:</span>
<span class="sd">        State trajectory, shape (n_steps + 1, 4)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">step</span><span class="p">(</span><span class="n">state</span><span class="p">:</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">,</span> <span class="n">control</span><span class="p">:</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">,</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">]:</span>
        <span class="n">next_state</span> <span class="o">=</span> <span class="n">rk4_step</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">control</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">next_state</span><span class="p">,</span> <span class="n">next_state</span>

    <span class="n">_</span><span class="p">,</span> <span class="n">trajectory</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">lax</span><span class="o">.</span><span class="n">scan</span><span class="p">(</span><span class="n">step</span><span class="p">,</span> <span class="n">initial_state</span><span class="p">,</span> <span class="n">controls</span><span class="p">)</span>
    <span class="c1"># Prepend initial state.</span>
    <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">initial_state</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="p">:],</span> <span class="n">trajectory</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>


<span class="c1"># Test forward simulation with zero controls.</span>
<span class="n">test_controls</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_steps</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">test_trajectory</span> <span class="o">=</span> <span class="n">simulate_trajectory</span><span class="p">(</span><span class="n">test_controls</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Trajectory shape: </span><span class="si">{</span><span class="n">test_trajectory</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Final state with zero controls: </span><span class="si">{</span><span class="n">test_trajectory</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Trajectory shape: (61, 4)
Final state with zero controls: [0. 0. 0. 0.]
</pre></div>
</div>
</div>
</div>
</section>
<section id="control-variable-and-costs">
<h2>Control variable and costs<a class="headerlink" href="#control-variable-and-costs" title="Link to this heading">¶</a></h2>
<p>In the shooting method, we optimize a single variable containing the entire control trajectory. The costs include:</p>
<ol class="arabic simple">
<li><p>Terminal cost: Penalize deviation from upright position at final time</p></li>
<li><p>Control regularization: Penalize large control inputs</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">ControlTrajectoryVar</span><span class="p">(</span>
    <span class="n">jaxls</span><span class="o">.</span><span class="n">Var</span><span class="p">[</span><span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">],</span> <span class="n">default_factory</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_steps</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Control trajectory variable: (n_steps, 1) array of forces.&quot;&quot;&quot;</span>


<span class="n">control_var</span> <span class="o">=</span> <span class="n">ControlTrajectoryVar</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@jaxls</span><span class="o">.</span><span class="n">Cost</span><span class="o">.</span><span class="n">factory</span>
<span class="k">def</span><span class="w"> </span><span class="nf">terminal_cost</span><span class="p">(</span>
    <span class="n">vals</span><span class="p">:</span> <span class="n">jaxls</span><span class="o">.</span><span class="n">VarValues</span><span class="p">,</span>
    <span class="n">var</span><span class="p">:</span> <span class="n">ControlTrajectoryVar</span><span class="p">,</span>
    <span class="n">target</span><span class="p">:</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Penalize deviation from target state at final time.</span>

<span class="sd">    Forward simulate the trajectory, then compute error at final state.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">controls</span> <span class="o">=</span> <span class="n">vals</span><span class="p">[</span><span class="n">var</span><span class="p">]</span>
    <span class="n">trajectory</span> <span class="o">=</span> <span class="n">simulate_trajectory</span><span class="p">(</span><span class="n">controls</span><span class="p">)</span>
    <span class="n">final_state</span> <span class="o">=</span> <span class="n">trajectory</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="c1"># Weight position and angle errors more heavily.</span>
    <span class="n">weights</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">10.0</span><span class="p">,</span> <span class="mf">20.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">])</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">final_state</span> <span class="o">-</span> <span class="n">target</span><span class="p">)</span> <span class="o">*</span> <span class="n">weights</span>


<span class="nd">@jaxls</span><span class="o">.</span><span class="n">Cost</span><span class="o">.</span><span class="n">factory</span>
<span class="k">def</span><span class="w"> </span><span class="nf">hold_cost</span><span class="p">(</span>
    <span class="n">vals</span><span class="p">:</span> <span class="n">jaxls</span><span class="o">.</span><span class="n">VarValues</span><span class="p">,</span>
    <span class="n">var</span><span class="p">:</span> <span class="n">ControlTrajectoryVar</span><span class="p">,</span>
    <span class="n">target</span><span class="p">:</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Penalize deviation from upright during the hold phase.&quot;&quot;&quot;</span>
    <span class="n">controls</span> <span class="o">=</span> <span class="n">vals</span><span class="p">[</span><span class="n">var</span><span class="p">]</span>
    <span class="n">trajectory</span> <span class="o">=</span> <span class="n">simulate_trajectory</span><span class="p">(</span><span class="n">controls</span><span class="p">)</span>
    <span class="c1"># Get states during hold phase (use static slice with captured n_swing)</span>
    <span class="n">hold_states</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">lax</span><span class="o">.</span><span class="n">slice_in_dim</span><span class="p">(</span><span class="n">trajectory</span><span class="p">,</span> <span class="n">n_swing</span><span class="p">,</span> <span class="n">n_steps</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="c1"># Penalize deviation from target for each hold state.</span>
    <span class="n">weights</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">5.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">])</span>
    <span class="n">errors</span> <span class="o">=</span> <span class="p">(</span><span class="n">hold_states</span> <span class="o">-</span> <span class="n">target</span><span class="p">)</span> <span class="o">*</span> <span class="n">weights</span>
    <span class="k">return</span> <span class="n">errors</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>


<span class="nd">@jaxls</span><span class="o">.</span><span class="n">Cost</span><span class="o">.</span><span class="n">factory</span>
<span class="k">def</span><span class="w"> </span><span class="nf">control_regularization</span><span class="p">(</span>
    <span class="n">vals</span><span class="p">:</span> <span class="n">jaxls</span><span class="o">.</span><span class="n">VarValues</span><span class="p">,</span>
    <span class="n">var</span><span class="p">:</span> <span class="n">ControlTrajectoryVar</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Penalize control effort (L2 regularization).&quot;&quot;&quot;</span>
    <span class="n">controls</span> <span class="o">=</span> <span class="n">vals</span><span class="p">[</span><span class="n">var</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">controls</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span> <span class="o">*</span> <span class="mf">0.1</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="solving">
<h2>Solving<a class="headerlink" href="#solving" title="Link to this heading">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">costs</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">jaxls</span><span class="o">.</span><span class="n">Cost</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">terminal_cost</span><span class="p">(</span><span class="n">control_var</span><span class="p">,</span> <span class="n">target_state</span><span class="p">),</span>
    <span class="n">hold_cost</span><span class="p">(</span><span class="n">control_var</span><span class="p">,</span> <span class="n">target_state</span><span class="p">),</span>
    <span class="n">control_regularization</span><span class="p">(</span><span class="n">control_var</span><span class="p">),</span>
<span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Created </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">costs</span><span class="p">)</span><span class="si">}</span><span class="s2"> cost functions&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Control variable shape: (</span><span class="si">{</span><span class="n">n_steps</span><span class="si">}</span><span class="s2">, 1)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Created 3 cost functions
Control variable shape: (60, 1)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Initial guess: small random controls to break symmetry.</span>
<span class="n">key</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">PRNGKey</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">initial_controls</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="p">(</span><span class="n">n_steps</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">*</span> <span class="mf">0.1</span>

<span class="n">initial_vals</span> <span class="o">=</span> <span class="n">jaxls</span><span class="o">.</span><span class="n">VarValues</span><span class="o">.</span><span class="n">make</span><span class="p">([</span><span class="n">control_var</span><span class="o">.</span><span class="n">with_value</span><span class="p">(</span><span class="n">initial_controls</span><span class="p">)])</span>

<span class="c1"># Create and analyze problem.</span>
<span class="n">problem</span> <span class="o">=</span> <span class="n">jaxls</span><span class="o">.</span><span class="n">LeastSquaresProblem</span><span class="p">(</span><span class="n">costs</span><span class="p">,</span> <span class="p">[</span><span class="n">control_var</span><span class="p">])</span><span class="o">.</span><span class="n">analyze</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Bold">INFO    </span> | Building optimization problem with 3 terms and 1 variables: 3 costs, 0 eq_zero, 0 leq_zero, 0 geq_zero
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 1 costs, 1 variables each: terminal_cost
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 1 costs, 1 variables each: hold_cost
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 1 costs, 1 variables each: control_regularization
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">solution</span> <span class="o">=</span> <span class="n">problem</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">initial_vals</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Bold">INFO    </span> |  step #0: cost=14820.0186 lambd=0.0005 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - terminal_cost(1): 3938.88013 (avg 984.72003)
<span class=" -Color -Color-Bold">INFO    </span> |      - hold_cost(1):   10881.13477 (avg 247.29852)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_regularization(1): 0.00345 (avg 0.00006)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=5.20e+02 cost_prev=14820.0186 cost_new=10036.3008
<span class=" -Color -Color-Bold">INFO    </span> |  step #1: cost=10036.2979 lambd=0.0003 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - terminal_cost(1): 623.13776 (avg 155.78444)
<span class=" -Color -Color-Bold">INFO    </span> |      - hold_cost(1):   9330.73438 (avg 212.06215)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_regularization(1): 82.42606 (avg 1.37377)
<span class=" -Color -Color-Bold">INFO    </span> |  step #2: cost=10036.2979 lambd=0.0005 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - terminal_cost(1): 623.13776 (avg 155.78444)
<span class=" -Color -Color-Bold">INFO    </span> |      - hold_cost(1):   9330.73438 (avg 212.06215)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_regularization(1): 82.42606 (avg 1.37377)
<span class=" -Color -Color-Bold">INFO    </span> |  step #3: cost=10036.2979 lambd=0.0010 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - terminal_cost(1): 623.13776 (avg 155.78444)
<span class=" -Color -Color-Bold">INFO    </span> |      - hold_cost(1):   9330.73438 (avg 212.06215)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_regularization(1): 82.42606 (avg 1.37377)
<span class=" -Color -Color-Bold">INFO    </span> |  step #4: cost=10036.2979 lambd=0.0020 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - terminal_cost(1): 623.13776 (avg 155.78444)
<span class=" -Color -Color-Bold">INFO    </span> |      - hold_cost(1):   9330.73438 (avg 212.06215)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_regularization(1): 82.42606 (avg 1.37377)
<span class=" -Color -Color-Bold">INFO    </span> |  step #5: cost=10036.2979 lambd=0.0040 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - terminal_cost(1): 623.13776 (avg 155.78444)
<span class=" -Color -Color-Bold">INFO    </span> |      - hold_cost(1):   9330.73438 (avg 212.06215)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_regularization(1): 82.42606 (avg 1.37377)
<span class=" -Color -Color-Bold">INFO    </span> |  step #6: cost=10036.2979 lambd=0.0080 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - terminal_cost(1): 623.13776 (avg 155.78444)
<span class=" -Color -Color-Bold">INFO    </span> |      - hold_cost(1):   9330.73438 (avg 212.06215)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_regularization(1): 82.42606 (avg 1.37377)
<span class=" -Color -Color-Bold">INFO    </span> |  step #7: cost=10036.2979 lambd=0.0160 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - terminal_cost(1): 623.13776 (avg 155.78444)
<span class=" -Color -Color-Bold">INFO    </span> |      - hold_cost(1):   9330.73438 (avg 212.06215)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_regularization(1): 82.42606 (avg 1.37377)
<span class=" -Color -Color-Bold">INFO    </span> |  step #8: cost=10036.2979 lambd=0.0320 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - terminal_cost(1): 623.13776 (avg 155.78444)
<span class=" -Color -Color-Bold">INFO    </span> |      - hold_cost(1):   9330.73438 (avg 212.06215)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_regularization(1): 82.42606 (avg 1.37377)
<span class=" -Color -Color-Bold">INFO    </span> |  step #9: cost=10036.2979 lambd=0.0640 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - terminal_cost(1): 623.13776 (avg 155.78444)
<span class=" -Color -Color-Bold">INFO    </span> |      - hold_cost(1):   9330.73438 (avg 212.06215)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_regularization(1): 82.42606 (avg 1.37377)
<span class=" -Color -Color-Bold">INFO    </span> |  step #10: cost=10036.2979 lambd=0.1280 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - terminal_cost(1): 623.13776 (avg 155.78444)
<span class=" -Color -Color-Bold">INFO    </span> |      - hold_cost(1):   9330.73438 (avg 212.06215)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_regularization(1): 82.42606 (avg 1.37377)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=2.84e+03 cost_prev=10036.3008 cost_new=4684.3662
<span class=" -Color -Color-Bold">INFO    </span> |  step #11: cost=4684.3662 lambd=0.0640 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - terminal_cost(1): 513.90247 (avg 128.47562)
<span class=" -Color -Color-Bold">INFO    </span> |      - hold_cost(1):   4061.28027 (avg 92.30183)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_regularization(1): 109.18370 (avg 1.81973)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=1.40e+03 cost_prev=4684.3662 cost_new=4028.7876
<span class=" -Color -Color-Bold">INFO    </span> |  step #12: cost=4028.7878 lambd=0.0320 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - terminal_cost(1): 970.49084 (avg 242.62271)
<span class=" -Color -Color-Bold">INFO    </span> |      - hold_cost(1):   2844.49316 (avg 64.64758)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_regularization(1): 213.80394 (avg 3.56340)
<span class=" -Color -Color-Bold">INFO    </span> |  step #13: cost=4028.7878 lambd=0.0640 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - terminal_cost(1): 970.49084 (avg 242.62271)
<span class=" -Color -Color-Bold">INFO    </span> |      - hold_cost(1):   2844.49316 (avg 64.64758)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_regularization(1): 213.80394 (avg 3.56340)
<span class=" -Color -Color-Bold">INFO    </span> |  step #14: cost=4028.7878 lambd=0.1280 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - terminal_cost(1): 970.49084 (avg 242.62271)
<span class=" -Color -Color-Bold">INFO    </span> |      - hold_cost(1):   2844.49316 (avg 64.64758)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_regularization(1): 213.80394 (avg 3.56340)
<span class=" -Color -Color-Bold">INFO    </span> |  step #15: cost=4028.7878 lambd=0.2560 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - terminal_cost(1): 970.49084 (avg 242.62271)
<span class=" -Color -Color-Bold">INFO    </span> |      - hold_cost(1):   2844.49316 (avg 64.64758)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_regularization(1): 213.80394 (avg 3.56340)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=1.27e+03 cost_prev=4028.7876 cost_new=3628.3013
<span class=" -Color -Color-Bold">INFO    </span> |  step #16: cost=3628.3010 lambd=0.1280 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - terminal_cost(1): 1181.71997 (avg 295.42999)
<span class=" -Color -Color-Bold">INFO    </span> |      - hold_cost(1):   2341.52197 (avg 53.21641)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_regularization(1): 105.05909 (avg 1.75098)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=1.14e+03 cost_prev=3628.3013 cost_new=1633.5022
<span class=" -Color -Color-Bold">INFO    </span> |  step #17: cost=1633.5022 lambd=0.0640 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - terminal_cost(1): 345.59445 (avg 86.39861)
<span class=" -Color -Color-Bold">INFO    </span> |      - hold_cost(1):   1256.49683 (avg 28.55675)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_regularization(1): 31.41090 (avg 0.52351)
<span class=" -Color -Color-Bold">INFO    </span> |  step #18: cost=1633.5022 lambd=0.1280 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - terminal_cost(1): 345.59445 (avg 86.39861)
<span class=" -Color -Color-Bold">INFO    </span> |      - hold_cost(1):   1256.49683 (avg 28.55675)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_regularization(1): 31.41090 (avg 0.52351)
<span class=" -Color -Color-Bold">INFO    </span> |  step #19: cost=1633.5022 lambd=0.2560 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - terminal_cost(1): 345.59445 (avg 86.39861)
<span class=" -Color -Color-Bold">INFO    </span> |      - hold_cost(1):   1256.49683 (avg 28.55675)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_regularization(1): 31.41090 (avg 0.52351)
<span class=" -Color -Color-Bold">INFO    </span> |  step #20: cost=1633.5022 lambd=0.5120 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - terminal_cost(1): 345.59445 (avg 86.39861)
<span class=" -Color -Color-Bold">INFO    </span> |      - hold_cost(1):   1256.49683 (avg 28.55675)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_regularization(1): 31.41090 (avg 0.52351)
<span class=" -Color -Color-Bold">INFO    </span> |  step #21: cost=1633.5022 lambd=1.0240 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - terminal_cost(1): 345.59445 (avg 86.39861)
<span class=" -Color -Color-Bold">INFO    </span> |      - hold_cost(1):   1256.49683 (avg 28.55675)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_regularization(1): 31.41090 (avg 0.52351)
<span class=" -Color -Color-Bold">INFO    </span> |  step #22: cost=1633.5022 lambd=2.0480 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - terminal_cost(1): 345.59445 (avg 86.39861)
<span class=" -Color -Color-Bold">INFO    </span> |      - hold_cost(1):   1256.49683 (avg 28.55675)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_regularization(1): 31.41090 (avg 0.52351)
<span class=" -Color -Color-Bold">INFO    </span> |  step #23: cost=1633.5022 lambd=4.0960 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - terminal_cost(1): 345.59445 (avg 86.39861)
<span class=" -Color -Color-Bold">INFO    </span> |      - hold_cost(1):   1256.49683 (avg 28.55675)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_regularization(1): 31.41090 (avg 0.52351)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=3.72e+02 cost_prev=1633.5022 cost_new=1007.1594
<span class=" -Color -Color-Bold">INFO    </span> |  step #24: cost=1007.1594 lambd=2.0480 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - terminal_cost(1): 319.02032 (avg 79.75508)
<span class=" -Color -Color-Bold">INFO    </span> |      - hold_cost(1):   653.23999 (avg 14.84636)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_regularization(1): 34.89909 (avg 0.58165)
<span class=" -Color -Color-Bold">INFO    </span> |  step #25: cost=1007.1594 lambd=4.0960 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - terminal_cost(1): 319.02032 (avg 79.75508)
<span class=" -Color -Color-Bold">INFO    </span> |      - hold_cost(1):   653.23999 (avg 14.84636)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_regularization(1): 34.89909 (avg 0.58165)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=4.61e+02 cost_prev=1007.1594 cost_new=572.4126
<span class=" -Color -Color-Bold">INFO    </span> |  step #26: cost=572.4127 lambd=2.0480 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - terminal_cost(1): 145.04785 (avg 36.26196)
<span class=" -Color -Color-Bold">INFO    </span> |      - hold_cost(1):   390.94324 (avg 8.88507)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_regularization(1): 36.42155 (avg 0.60703)
<span class=" -Color -Color-Bold">INFO    </span> |  step #27: cost=572.4127 lambd=4.0960 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - terminal_cost(1): 145.04785 (avg 36.26196)
<span class=" -Color -Color-Bold">INFO    </span> |      - hold_cost(1):   390.94324 (avg 8.88507)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_regularization(1): 36.42155 (avg 0.60703)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=3.69e+02 cost_prev=572.4126 cost_new=340.4744
<span class=" -Color -Color-Bold">INFO    </span> |  step #28: cost=340.4744 lambd=2.0480 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - terminal_cost(1): 42.54160 (avg 10.63540)
<span class=" -Color -Color-Bold">INFO    </span> |      - hold_cost(1):   260.97519 (avg 5.93125)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_regularization(1): 36.95764 (avg 0.61596)
<span class=" -Color -Color-Bold">INFO    </span> |  step #29: cost=340.4744 lambd=4.0960 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - terminal_cost(1): 42.54160 (avg 10.63540)
<span class=" -Color -Color-Bold">INFO    </span> |      - hold_cost(1):   260.97519 (avg 5.93125)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_regularization(1): 36.95764 (avg 0.61596)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=2.10e+02 cost_prev=340.4744 cost_new=258.7848
<span class=" -Color -Color-Bold">INFO    </span> |  step #30: cost=258.7848 lambd=2.0480 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - terminal_cost(1): 17.60720 (avg 4.40180)
<span class=" -Color -Color-Bold">INFO    </span> |      - hold_cost(1):   203.89160 (avg 4.63390)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_regularization(1): 37.28600 (avg 0.62143)
<span class=" -Color -Color-Bold">INFO    </span> |  step #31: cost=258.7848 lambd=4.0960 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - terminal_cost(1): 17.60720 (avg 4.40180)
<span class=" -Color -Color-Bold">INFO    </span> |      - hold_cost(1):   203.89160 (avg 4.63390)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_regularization(1): 37.28600 (avg 0.62143)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=1.31e+02 cost_prev=258.7848 cost_new=217.3717
<span class=" -Color -Color-Bold">INFO    </span> |  step #32: cost=217.3717 lambd=2.0480 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - terminal_cost(1): 9.49219 (avg 2.37305)
<span class=" -Color -Color-Bold">INFO    </span> |      - hold_cost(1):   170.40802 (avg 3.87291)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_regularization(1): 37.47153 (avg 0.62453)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=8.43e+01 cost_prev=217.3717 cost_new=205.9092
<span class=" -Color -Color-Bold">INFO    </span> |  step #33: cost=205.9092 lambd=1.0240 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - terminal_cost(1): 24.00981 (avg 6.00245)
<span class=" -Color -Color-Bold">INFO    </span> |      - hold_cost(1):   144.31160 (avg 3.27981)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_regularization(1): 37.58778 (avg 0.62646)
<span class=" -Color -Color-Bold">INFO    </span> |  step #34: cost=205.9092 lambd=2.0480 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - terminal_cost(1): 24.00981 (avg 6.00245)
<span class=" -Color -Color-Bold">INFO    </span> |      - hold_cost(1):   144.31160 (avg 3.27981)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_regularization(1): 37.58778 (avg 0.62646)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=2.04e+02 cost_prev=205.9092 cost_new=155.5018
<span class=" -Color -Color-Bold">INFO    </span> |  step #35: cost=155.5017 lambd=1.0240 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - terminal_cost(1): 7.42080 (avg 1.85520)
<span class=" -Color -Color-Bold">INFO    </span> |      - hold_cost(1):   110.72858 (avg 2.51656)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_regularization(1): 37.35236 (avg 0.62254)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=9.93e+01 cost_prev=155.5018 cost_new=150.3035
<span class=" -Color -Color-Bold">INFO    </span> |  step #36: cost=150.3035 lambd=0.5120 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - terminal_cost(1): 21.09509 (avg 5.27377)
<span class=" -Color -Color-Bold">INFO    </span> |      - hold_cost(1):   92.15547 (avg 2.09444)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_regularization(1): 37.05294 (avg 0.61755)
<span class=" -Color -Color-Bold">INFO    </span> |  step #37: cost=150.3035 lambd=1.0240 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - terminal_cost(1): 21.09509 (avg 5.27377)
<span class=" -Color -Color-Bold">INFO    </span> |      - hold_cost(1):   92.15547 (avg 2.09444)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_regularization(1): 37.05294 (avg 0.61755)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=2.25e+02 cost_prev=150.3035 cost_new=107.0154
<span class=" -Color -Color-Bold">INFO    </span> |  step #38: cost=107.0154 lambd=0.5120 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - terminal_cost(1): 5.88594 (avg 1.47149)
<span class=" -Color -Color-Bold">INFO    </span> |      - hold_cost(1):   64.37170 (avg 1.46299)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_regularization(1): 36.75779 (avg 0.61263)
<span class=" -Color -Color-Bold">INFO    </span> |  step #39: cost=107.0154 lambd=1.0240 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - terminal_cost(1): 5.88594 (avg 1.47149)
<span class=" -Color -Color-Bold">INFO    </span> |      - hold_cost(1):   64.37170 (avg 1.46299)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_regularization(1): 36.75779 (avg 0.61263)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=1.15e+02 cost_prev=107.0154 cost_new=88.8110
<span class=" -Color -Color-Bold">INFO    </span> |  step #40: cost=88.8110 lambd=0.5120 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - terminal_cost(1): 2.51078 (avg 0.62770)
<span class=" -Color -Color-Bold">INFO    </span> |      - hold_cost(1):   49.79275 (avg 1.13165)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_regularization(1): 36.50744 (avg 0.60846)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=6.90e+01 cost_prev=88.8110 cost_new=83.8815
<span class=" -Color -Color-Bold">INFO    </span> |  step #41: cost=83.8814 lambd=0.2560 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - terminal_cost(1): 9.01481 (avg 2.25370)
<span class=" -Color -Color-Bold">INFO    </span> |      - hold_cost(1):   38.66769 (avg 0.87881)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_regularization(1): 36.19894 (avg 0.60332)
<span class=" -Color -Color-Bold">INFO    </span> |  step #42: cost=83.8814 lambd=0.5120 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - terminal_cost(1): 9.01481 (avg 2.25370)
<span class=" -Color -Color-Bold">INFO    </span> |      - hold_cost(1):   38.66769 (avg 0.87881)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_regularization(1): 36.19894 (avg 0.60332)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=1.68e+02 cost_prev=83.8815 cost_new=64.7548
<span class=" -Color -Color-Bold">INFO    </span> |  step #43: cost=64.7548 lambd=0.2560 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - terminal_cost(1): 3.24689 (avg 0.81172)
<span class=" -Color -Color-Bold">INFO    </span> |      - hold_cost(1):   25.47734 (avg 0.57903)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_regularization(1): 36.03053 (avg 0.60051)
<span class=" -Color -Color-Bold">INFO    </span> |  step #44: cost=64.7548 lambd=0.5120 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - terminal_cost(1): 3.24689 (avg 0.81172)
<span class=" -Color -Color-Bold">INFO    </span> |      - hold_cost(1):   25.47734 (avg 0.57903)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_regularization(1): 36.03053 (avg 0.60051)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=1.01e+02 cost_prev=64.7548 cost_new=55.5099
<span class=" -Color -Color-Bold">INFO    </span> |  step #45: cost=55.5099 lambd=0.2560 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - terminal_cost(1): 1.41236 (avg 0.35309)
<span class=" -Color -Color-Bold">INFO    </span> |      - hold_cost(1):   18.26465 (avg 0.41511)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_regularization(1): 35.83292 (avg 0.59722)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=6.48e+01 cost_prev=55.5099 cost_new=55.2921
<span class=" -Color -Color-Bold">INFO    </span> |  step #46: cost=55.2921 lambd=0.1280 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - terminal_cost(1): 5.59101 (avg 1.39775)
<span class=" -Color -Color-Bold">INFO    </span> |      - hold_cost(1):   14.36527 (avg 0.32648)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_regularization(1): 35.33578 (avg 0.58893)
<span class=" -Color -Color-Bold">INFO    </span> |  step #47: cost=55.2921 lambd=0.2560 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - terminal_cost(1): 5.59101 (avg 1.39775)
<span class=" -Color -Color-Bold">INFO    </span> |      - hold_cost(1):   14.36527 (avg 0.32648)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_regularization(1): 35.33578 (avg 0.58893)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=1.48e+02 cost_prev=55.2921 cost_new=45.7453
<span class=" -Color -Color-Bold">INFO    </span> |  step #48: cost=45.7453 lambd=0.1280 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - terminal_cost(1): 2.02972 (avg 0.50743)
<span class=" -Color -Color-Bold">INFO    </span> |      - hold_cost(1):   8.95305 (avg 0.20348)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_regularization(1): 34.76252 (avg 0.57938)
<span class=" -Color -Color-Bold">INFO    </span> |  step #49: cost=45.7453 lambd=0.2560 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - terminal_cost(1): 2.02972 (avg 0.50743)
<span class=" -Color -Color-Bold">INFO    </span> |      - hold_cost(1):   8.95305 (avg 0.20348)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_regularization(1): 34.76252 (avg 0.57938)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=8.89e+01 cost_prev=45.7453 cost_new=41.8801
<span class=" -Color -Color-Bold">INFO    </span> |  step #50: cost=41.8801 lambd=0.1280 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - terminal_cost(1): 1.12498 (avg 0.28124)
<span class=" -Color -Color-Bold">INFO    </span> |      - hold_cost(1):   6.62376 (avg 0.15054)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_regularization(1): 34.13136 (avg 0.56886)
<span class=" -Color -Color-Bold">INFO    </span> |  step #51: cost=41.8801 lambd=0.2560 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - terminal_cost(1): 1.12498 (avg 0.28124)
<span class=" -Color -Color-Bold">INFO    </span> |      - hold_cost(1):   6.62376 (avg 0.15054)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_regularization(1): 34.13136 (avg 0.56886)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=6.54e+01 cost_prev=41.8801 cost_new=39.5404
<span class=" -Color -Color-Bold">INFO    </span> |  step #52: cost=39.5404 lambd=0.1280 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - terminal_cost(1): 0.73957 (avg 0.18489)
<span class=" -Color -Color-Bold">INFO    </span> |      - hold_cost(1):   5.34821 (avg 0.12155)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_regularization(1): 33.45261 (avg 0.55754)
<span class=" -Color -Color-Bold">INFO    </span> |  step #53: cost=39.5404 lambd=0.2560 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - terminal_cost(1): 0.73957 (avg 0.18489)
<span class=" -Color -Color-Bold">INFO    </span> |      - hold_cost(1):   5.34821 (avg 0.12155)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_regularization(1): 33.45261 (avg 0.55754)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=5.19e+01 cost_prev=39.5404 cost_new=37.9006
<span class=" -Color -Color-Bold">INFO    </span> |  step #54: cost=37.9006 lambd=0.1280 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - terminal_cost(1): 0.55865 (avg 0.13966)
<span class=" -Color -Color-Bold">INFO    </span> |      - hold_cost(1):   4.59287 (avg 0.10438)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_regularization(1): 32.74909 (avg 0.54582)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=4.43e+01 cost_prev=37.9006 cost_new=40.9190
<span class=" -Color -Color-Bold">INFO    </span> |  step #55: cost=40.9190 lambd=0.0640 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - terminal_cost(1): 3.78697 (avg 0.94674)
<span class=" -Color -Color-Bold">INFO    </span> |      - hold_cost(1):   5.69330 (avg 0.12939)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_regularization(1): 31.43876 (avg 0.52398)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=1.41e+02 cost_prev=40.9190 cost_new=82.7037
<span class=" -Color -Color-Bold">INFO    </span> |  step #56: cost=82.7037 lambd=0.0320 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - terminal_cost(1): 31.58258 (avg 7.89565)
<span class=" -Color -Color-Bold">INFO    </span> |      - hold_cost(1):   21.73989 (avg 0.49409)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_regularization(1): 29.38120 (avg 0.48969)
<span class=" -Color -Color-Bold">INFO    </span> |  step #57: cost=82.7037 lambd=0.0640 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - terminal_cost(1): 31.58258 (avg 7.89565)
<span class=" -Color -Color-Bold">INFO    </span> |      - hold_cost(1):   21.73989 (avg 0.49409)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_regularization(1): 29.38120 (avg 0.48969)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=4.51e+02 cost_prev=82.7037 cost_new=58.5050
<span class=" -Color -Color-Bold">INFO    </span> |  step #58: cost=58.5050 lambd=0.0320 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - terminal_cost(1): 17.82385 (avg 4.45596)
<span class=" -Color -Color-Bold">INFO    </span> |      - hold_cost(1):   13.26104 (avg 0.30139)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_regularization(1): 27.42006 (avg 0.45700)
<span class=" -Color -Color-Bold">INFO    </span> |  step #59: cost=58.5050 lambd=0.0640 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - terminal_cost(1): 17.82385 (avg 4.45596)
<span class=" -Color -Color-Bold">INFO    </span> |      - hold_cost(1):   13.26104 (avg 0.30139)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_regularization(1): 27.42006 (avg 0.45700)
<span class=" -Color -Color-Bold">INFO    </span> |  step #60: cost=58.5050 lambd=0.1280 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - terminal_cost(1): 17.82385 (avg 4.45596)
<span class=" -Color -Color-Bold">INFO    </span> |      - hold_cost(1):   13.26104 (avg 0.30139)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_regularization(1): 27.42006 (avg 0.45700)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=3.59e+02 cost_prev=58.5050 cost_new=31.9685
<span class=" -Color -Color-Bold">INFO    </span> |  step #61: cost=31.9685 lambd=0.0640 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - terminal_cost(1): 1.86539 (avg 0.46635)
<span class=" -Color -Color-Bold">INFO    </span> |      - hold_cost(1):   3.80649 (avg 0.08651)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_regularization(1): 26.29662 (avg 0.43828)
<span class=" -Color -Color-Bold">INFO    </span> |  step #62: cost=31.9685 lambd=0.1280 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - terminal_cost(1): 1.86539 (avg 0.46635)
<span class=" -Color -Color-Bold">INFO    </span> |      - hold_cost(1):   3.80649 (avg 0.08651)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_regularization(1): 26.29662 (avg 0.43828)
<span class=" -Color -Color-Bold">INFO    </span> |  step #63: cost=31.9685 lambd=0.2560 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - terminal_cost(1): 1.86539 (avg 0.46635)
<span class=" -Color -Color-Bold">INFO    </span> |      - hold_cost(1):   3.80649 (avg 0.08651)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_regularization(1): 26.29662 (avg 0.43828)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=1.12e+02 cost_prev=31.9685 cost_new=29.1282
<span class=" -Color -Color-Bold">INFO    </span> |  step #64: cost=29.1282 lambd=0.1280 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - terminal_cost(1): 0.36223 (avg 0.09056)
<span class=" -Color -Color-Bold">INFO    </span> |      - hold_cost(1):   2.98873 (avg 0.06793)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_regularization(1): 25.77723 (avg 0.42962)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=4.02e+01 cost_prev=29.1282 cost_new=32.2756
<span class=" -Color -Color-Bold">INFO    </span> |  step #65: cost=32.2756 lambd=0.0640 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - terminal_cost(1): 3.00576 (avg 0.75144)
<span class=" -Color -Color-Bold">INFO    </span> |      - hold_cost(1):   4.37940 (avg 0.09953)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_regularization(1): 24.89044 (avg 0.41484)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=1.51e+02 cost_prev=32.2756 cost_new=70.9422
<span class=" -Color -Color-Bold">INFO    </span> |  step #66: cost=70.9422 lambd=0.0320 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - terminal_cost(1): 28.18815 (avg 7.04704)
<span class=" -Color -Color-Bold">INFO    </span> |      - hold_cost(1):   19.29500 (avg 0.43852)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_regularization(1): 23.45909 (avg 0.39098)
<span class=" -Color -Color-Bold">INFO    </span> |  step #67: cost=70.9422 lambd=0.0640 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - terminal_cost(1): 28.18815 (avg 7.04704)
<span class=" -Color -Color-Bold">INFO    </span> |      - hold_cost(1):   19.29500 (avg 0.43852)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_regularization(1): 23.45909 (avg 0.39098)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=5.10e+02 cost_prev=70.9422 cost_new=68.8171
<span class=" -Color -Color-Bold">INFO    </span> |  step #68: cost=68.8171 lambd=0.0320 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - terminal_cost(1): 27.73076 (avg 6.93269)
<span class=" -Color -Color-Bold">INFO    </span> |      - hold_cost(1):   19.00603 (avg 0.43196)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_regularization(1): 22.08033 (avg 0.36801)
<span class=" -Color -Color-Bold">INFO    </span> |  step #69: cost=68.8171 lambd=0.0640 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - terminal_cost(1): 27.73076 (avg 6.93269)
<span class=" -Color -Color-Bold">INFO    </span> |      - hold_cost(1):   19.00603 (avg 0.43196)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_regularization(1): 22.08033 (avg 0.36801)
<span class=" -Color -Color-Bold">INFO    </span> |  step #70: cost=68.8171 lambd=0.1280 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - terminal_cost(1): 27.73076 (avg 6.93269)
<span class=" -Color -Color-Bold">INFO    </span> |      - hold_cost(1):   19.00603 (avg 0.43196)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_regularization(1): 22.08033 (avg 0.36801)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=5.35e+02 cost_prev=68.8171 cost_new=28.8338
<span class=" -Color -Color-Bold">INFO    </span> |  step #71: cost=28.8338 lambd=0.0640 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - terminal_cost(1): 3.20780 (avg 0.80195)
<span class=" -Color -Color-Bold">INFO    </span> |      - hold_cost(1):   4.35866 (avg 0.09906)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_regularization(1): 21.26731 (avg 0.35446)
<span class=" -Color -Color-Bold">INFO    </span> |  step #72: cost=28.8338 lambd=0.1280 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - terminal_cost(1): 3.20780 (avg 0.80195)
<span class=" -Color -Color-Bold">INFO    </span> |      - hold_cost(1):   4.35866 (avg 0.09906)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_regularization(1): 21.26731 (avg 0.35446)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=1.80e+02 cost_prev=28.8338 cost_new=27.9708
<span class=" -Color -Color-Bold">INFO    </span> |  step #73: cost=27.9708 lambd=0.0640 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - terminal_cost(1): 3.12860 (avg 0.78215)
<span class=" -Color -Color-Bold">INFO    </span> |      - hold_cost(1):   4.24473 (avg 0.09647)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_regularization(1): 20.59751 (avg 0.34329)
<span class=" -Color -Color-Bold">INFO    </span> |  step #74: cost=27.9708 lambd=0.1280 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - terminal_cost(1): 3.12860 (avg 0.78215)
<span class=" -Color -Color-Bold">INFO    </span> |      - hold_cost(1):   4.24473 (avg 0.09647)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_regularization(1): 20.59751 (avg 0.34329)
<span class=" -Color -Color-Bold">INFO    </span> |  step #75: cost=27.9708 lambd=0.2560 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - terminal_cost(1): 3.12860 (avg 0.78215)
<span class=" -Color -Color-Bold">INFO    </span> |      - hold_cost(1):   4.24473 (avg 0.09647)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_regularization(1): 20.59751 (avg 0.34329)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=1.82e+02 cost_prev=27.9708 cost_new=23.3691
<span class=" -Color -Color-Bold">INFO    </span> |  step #76: cost=23.3691 lambd=0.1280 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - terminal_cost(1): 0.39292 (avg 0.09823)
<span class=" -Color -Color-Bold">INFO    </span> |      - hold_cost(1):   2.72641 (avg 0.06196)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_regularization(1): 20.24974 (avg 0.33750)
<span class=" -Color -Color-Bold">INFO    </span> |  step #77: cost=23.3691 lambd=0.2560 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - terminal_cost(1): 0.39292 (avg 0.09823)
<span class=" -Color -Color-Bold">INFO    </span> |      - hold_cost(1):   2.72641 (avg 0.06196)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_regularization(1): 20.24974 (avg 0.33750)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=5.24e+01 cost_prev=23.3691 cost_new=23.0268
<span class=" -Color -Color-Bold">INFO    </span> |  step #78: cost=23.0268 lambd=0.1280 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - terminal_cost(1): 0.40640 (avg 0.10160)
<span class=" -Color -Color-Bold">INFO    </span> |      - hold_cost(1):   2.69457 (avg 0.06124)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_regularization(1): 19.92582 (avg 0.33210)
<span class=" -Color -Color-Bold">INFO    </span> |  step #79: cost=23.0268 lambd=0.2560 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - terminal_cost(1): 0.40640 (avg 0.10160)
<span class=" -Color -Color-Bold">INFO    </span> |      - hold_cost(1):   2.69457 (avg 0.06124)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_regularization(1): 19.92582 (avg 0.33210)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=5.46e+01 cost_prev=23.0268 cost_new=22.6713
<span class=" -Color -Color-Bold">INFO    </span> |  step #80: cost=22.6713 lambd=0.1280 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - terminal_cost(1): 0.40498 (avg 0.10124)
<span class=" -Color -Color-Bold">INFO    </span> |      - hold_cost(1):   2.66189 (avg 0.06050)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_regularization(1): 19.60442 (avg 0.32674)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=5.53e+01 cost_prev=22.6713 cost_new=26.3223
<span class=" -Color -Color-Bold">INFO    </span> |  step #81: cost=26.3223 lambd=0.0640 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - terminal_cost(1): 3.17506 (avg 0.79376)
<span class=" -Color -Color-Bold">INFO    </span> |      - hold_cost(1):   4.11187 (avg 0.09345)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_regularization(1): 19.03540 (avg 0.31726)
<span class=" -Color -Color-Bold">INFO    </span> |  step #82: cost=26.3223 lambd=0.1280 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - terminal_cost(1): 3.17506 (avg 0.79376)
<span class=" -Color -Color-Bold">INFO    </span> |      - hold_cost(1):   4.11187 (avg 0.09345)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_regularization(1): 19.03540 (avg 0.31726)
<span class=" -Color -Color-Bold">INFO    </span> |  step #83: cost=26.3223 lambd=0.2560 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - terminal_cost(1): 3.17506 (avg 0.79376)
<span class=" -Color -Color-Bold">INFO    </span> |      - hold_cost(1):   4.11187 (avg 0.09345)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_regularization(1): 19.03540 (avg 0.31726)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=1.98e+02 cost_prev=26.3223 cost_new=21.6792
<span class=" -Color -Color-Bold">INFO    </span> |  step #84: cost=21.6792 lambd=0.1280 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - terminal_cost(1): 0.38231 (avg 0.09558)
<span class=" -Color -Color-Bold">INFO    </span> |      - hold_cost(1):   2.55796 (avg 0.05814)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_regularization(1): 18.73889 (avg 0.31231)
<span class=" -Color -Color-Bold">INFO    </span> |  step #85: cost=21.6792 lambd=0.2560 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - terminal_cost(1): 0.38231 (avg 0.09558)
<span class=" -Color -Color-Bold">INFO    </span> |      - hold_cost(1):   2.55796 (avg 0.05814)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_regularization(1): 18.73889 (avg 0.31231)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=5.58e+01 cost_prev=21.6792 cost_new=21.3778
<span class=" -Color -Color-Bold">INFO    </span> |  step #86: cost=21.3778 lambd=0.1280 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - terminal_cost(1): 0.39291 (avg 0.09823)
<span class=" -Color -Color-Bold">INFO    </span> |      - hold_cost(1):   2.53188 (avg 0.05754)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_regularization(1): 18.45297 (avg 0.30755)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=5.78e+01 cost_prev=21.3778 cost_new=24.9109
<span class=" -Color -Color-Bold">INFO    </span> |  step #87: cost=24.9109 lambd=0.0640 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - terminal_cost(1): 3.04330 (avg 0.76083)
<span class=" -Color -Color-Bold">INFO    </span> |      - hold_cost(1):   3.91643 (avg 0.08901)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_regularization(1): 17.95120 (avg 0.29919)
<span class=" -Color -Color-Bold">INFO    </span> |  step #88: cost=24.9109 lambd=0.1280 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - terminal_cost(1): 3.04330 (avg 0.76083)
<span class=" -Color -Color-Bold">INFO    </span> |      - hold_cost(1):   3.91643 (avg 0.08901)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_regularization(1): 17.95120 (avg 0.29919)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=2.05e+02 cost_prev=24.9109 cost_new=24.8942
<span class=" -Color -Color-Bold">INFO    </span> |  step #89: cost=24.8942 lambd=0.0640 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - terminal_cost(1): 3.36977 (avg 0.84244)
<span class=" -Color -Color-Bold">INFO    </span> |      - hold_cost(1):   4.03785 (avg 0.09177)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_regularization(1): 17.48660 (avg 0.29144)
<span class=" -Color -Color-Bold">INFO    </span> |  step #90: cost=24.8942 lambd=0.1280 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - terminal_cost(1): 3.36977 (avg 0.84244)
<span class=" -Color -Color-Bold">INFO    </span> |      - hold_cost(1):   4.03785 (avg 0.09177)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_regularization(1): 17.48660 (avg 0.29144)
<span class=" -Color -Color-Bold">INFO    </span> |  step #91: cost=24.8942 lambd=0.2560 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - terminal_cost(1): 3.36977 (avg 0.84244)
<span class=" -Color -Color-Bold">INFO    </span> |      - hold_cost(1):   4.03785 (avg 0.09177)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_regularization(1): 17.48660 (avg 0.29144)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=2.22e+02 cost_prev=24.8942 cost_new=19.9573
<span class=" -Color -Color-Bold">INFO    </span> |  step #92: cost=19.9573 lambd=0.1280 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - terminal_cost(1): 0.35839 (avg 0.08960)
<span class=" -Color -Color-Bold">INFO    </span> |      - hold_cost(1):   2.34783 (avg 0.05336)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_regularization(1): 17.25113 (avg 0.28752)
<span class=" -Color -Color-Bold">INFO    </span> |  step #93: cost=19.9573 lambd=0.2560 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - terminal_cost(1): 0.35839 (avg 0.08960)
<span class=" -Color -Color-Bold">INFO    </span> |      - hold_cost(1):   2.34783 (avg 0.05336)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_regularization(1): 17.25113 (avg 0.28752)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=5.85e+01 cost_prev=19.9573 cost_new=19.7023
<span class=" -Color -Color-Bold">INFO    </span> |  step #94: cost=19.7023 lambd=0.1280 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - terminal_cost(1): 0.36276 (avg 0.09069)
<span class=" -Color -Color-Bold">INFO    </span> |      - hold_cost(1):   2.31201 (avg 0.05255)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_regularization(1): 17.02754 (avg 0.28379)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=6.01e+01 cost_prev=19.7023 cost_new=22.8621
<span class=" -Color -Color-Bold">INFO    </span> |  step #95: cost=22.8621 lambd=0.0640 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - terminal_cost(1): 2.71344 (avg 0.67836)
<span class=" -Color -Color-Bold">INFO    </span> |      - hold_cost(1):   3.53635 (avg 0.08037)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_regularization(1): 16.61228 (avg 0.27687)
<span class=" -Color -Color-Bold">INFO    </span> |  step #96: cost=22.8621 lambd=0.1280 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - terminal_cost(1): 2.71344 (avg 0.67836)
<span class=" -Color -Color-Bold">INFO    </span> |      - hold_cost(1):   3.53635 (avg 0.08037)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_regularization(1): 16.61228 (avg 0.27687)
<span class=" -Color -Color-Bold">INFO    </span> |  step #97: cost=22.8621 lambd=0.2560 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - terminal_cost(1): 2.71344 (avg 0.67836)
<span class=" -Color -Color-Bold">INFO    </span> |      - hold_cost(1):   3.53635 (avg 0.08037)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_regularization(1): 16.61228 (avg 0.27687)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=2.09e+02 cost_prev=22.8621 cost_new=18.9556
<span class=" -Color -Color-Bold">INFO    </span> |  step #98: cost=18.9556 lambd=0.1280 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - terminal_cost(1): 0.33499 (avg 0.08375)
<span class=" -Color -Color-Bold">INFO    </span> |      - hold_cost(1):   2.21210 (avg 0.05028)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_regularization(1): 16.40852 (avg 0.27348)
<span class=" -Color -Color-Bold">INFO    </span> |  step #99: cost=18.9556 lambd=0.2560 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - terminal_cost(1): 0.33499 (avg 0.08375)
<span class=" -Color -Color-Bold">INFO    </span> |      - hold_cost(1):   2.21210 (avg 0.05028)
<span class=" -Color -Color-Bold">INFO    </span> |      - control_regularization(1): 16.40852 (avg 0.27348)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=5.92e+01 cost_prev=18.9556 cost_new=18.7348
<span class=" -Color -Color-Bold">INFO    </span> | Terminated @ iteration #100: cost=18.7348 criteria=[0 0 0], term_deltas=1.2e-02,1.8e+01,2.3e-02
</pre></div>
</div>
</div>
</div>
</section>
<section id="visualization">
<h2>Visualization<a class="headerlink" href="#visualization" title="Link to this heading">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Extract solution.</span>
<span class="n">optimal_controls</span> <span class="o">=</span> <span class="n">solution</span><span class="p">[</span><span class="n">control_var</span><span class="p">]</span>
<span class="n">optimal_trajectory</span> <span class="o">=</span> <span class="n">simulate_trajectory</span><span class="p">(</span><span class="n">optimal_controls</span><span class="p">)</span>

<span class="n">times</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">total_time</span><span class="p">,</span> <span class="n">n_steps</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">control_times</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">total_time</span> <span class="o">-</span> <span class="n">dt</span><span class="p">,</span> <span class="n">n_steps</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;Final state: x=</span><span class="si">{</span><span class="nb">float</span><span class="p">(</span><span class="n">optimal_trajectory</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">])</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">, theta=</span><span class="si">{</span><span class="nb">float</span><span class="p">(</span><span class="n">optimal_trajectory</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">])</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Target theta (pi): </span><span class="si">{</span><span class="n">jnp</span><span class="o">.</span><span class="n">pi</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Terminal angle error: </span><span class="si">{</span><span class="nb">abs</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">optimal_trajectory</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">])</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">jnp</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> rad&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Final state: x=-0.003, theta=3.153
Target theta (pi): 3.142
Terminal angle error: 0.0112 rad
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">plotly.graph_objects</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">go</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">plotly.subplots</span><span class="w"> </span><span class="kn">import</span> <span class="n">make_subplots</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">IPython.display</span><span class="w"> </span><span class="kn">import</span> <span class="n">HTML</span>

<span class="c1"># Animation of cart-pole swing-up.</span>
<span class="n">cart_y_offset</span> <span class="o">=</span> <span class="mf">1.2</span>  <span class="c1"># Raise cart so pole can swing freely above ground.</span>
<span class="n">wheel_radius</span> <span class="o">=</span> <span class="mf">0.05</span>


<span class="k">def</span><span class="w"> </span><span class="nf">create_cart_pole_frame</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">theta</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a single frame of cart-pole visualization.</span>

<span class="sd">    Args:</span>
<span class="sd">        x: Cart position.</span>
<span class="sd">        theta: Pole angle (0 = down, pi = up).</span>

<span class="sd">    Returns:</span>
<span class="sd">        Dictionary with cart, pole, mass, and wheel coordinates.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">cart_width</span><span class="p">,</span> <span class="n">cart_height</span> <span class="o">=</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.15</span>
    <span class="n">pole_len</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">length</span>  <span class="c1"># Full pole length.</span>
    <span class="n">pole_x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">pole_len</span> <span class="o">*</span> <span class="n">jnp</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
    <span class="n">pole_y</span> <span class="o">=</span> <span class="n">cart_y_offset</span> <span class="o">-</span> <span class="n">pole_len</span> <span class="o">*</span> <span class="n">jnp</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>

    <span class="c1"># Wheel positions.</span>
    <span class="n">wheel_y</span> <span class="o">=</span> <span class="n">cart_y_offset</span> <span class="o">-</span> <span class="n">cart_height</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">wheel_radius</span>

    <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span>
        <span class="n">cart_x</span><span class="o">=</span><span class="p">[</span>
            <span class="n">x</span> <span class="o">-</span> <span class="n">cart_width</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span>
            <span class="n">x</span> <span class="o">+</span> <span class="n">cart_width</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span>
            <span class="n">x</span> <span class="o">+</span> <span class="n">cart_width</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span>
            <span class="n">x</span> <span class="o">-</span> <span class="n">cart_width</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span>
            <span class="n">x</span> <span class="o">-</span> <span class="n">cart_width</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span>
        <span class="p">],</span>
        <span class="n">cart_y</span><span class="o">=</span><span class="p">[</span>
            <span class="n">cart_y_offset</span> <span class="o">-</span> <span class="n">cart_height</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span>
            <span class="n">cart_y_offset</span> <span class="o">-</span> <span class="n">cart_height</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span>
            <span class="n">cart_y_offset</span> <span class="o">+</span> <span class="n">cart_height</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span>
            <span class="n">cart_y_offset</span> <span class="o">+</span> <span class="n">cart_height</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span>
            <span class="n">cart_y_offset</span> <span class="o">-</span> <span class="n">cart_height</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span>
        <span class="p">],</span>
        <span class="n">pole_x</span><span class="o">=</span><span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="n">pole_x</span><span class="p">)],</span>
        <span class="n">pole_y</span><span class="o">=</span><span class="p">[</span><span class="n">cart_y_offset</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="n">pole_y</span><span class="p">)],</span>
        <span class="n">mass_x</span><span class="o">=</span><span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">pole_x</span><span class="p">)],</span>
        <span class="n">mass_y</span><span class="o">=</span><span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">pole_y</span><span class="p">)],</span>
        <span class="n">wheel1_x</span><span class="o">=</span><span class="p">[</span><span class="n">x</span> <span class="o">-</span> <span class="n">cart_width</span> <span class="o">/</span> <span class="mi">3</span><span class="p">],</span>
        <span class="n">wheel1_y</span><span class="o">=</span><span class="p">[</span><span class="n">wheel_y</span><span class="p">],</span>
        <span class="n">wheel2_x</span><span class="o">=</span><span class="p">[</span><span class="n">x</span> <span class="o">+</span> <span class="n">cart_width</span> <span class="o">/</span> <span class="mi">3</span><span class="p">],</span>
        <span class="n">wheel2_y</span><span class="o">=</span><span class="p">[</span><span class="n">wheel_y</span><span class="p">],</span>
    <span class="p">)</span>


<span class="c1"># Create animation frames (use every 2nd timestep for performance).</span>
<span class="n">frame_step</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">frame_indices</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n_steps</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">frame_step</span><span class="p">))</span>
<span class="n">frames</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">frame_indices</span><span class="p">:</span>
    <span class="n">frame_data</span> <span class="o">=</span> <span class="n">create_cart_pole_frame</span><span class="p">(</span>
        <span class="nb">float</span><span class="p">(</span><span class="n">optimal_trajectory</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">optimal_trajectory</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
    <span class="p">)</span>
    <span class="n">frames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
        <span class="n">go</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span>
            <span class="n">data</span><span class="o">=</span><span class="p">[</span>
                <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
                    <span class="n">x</span><span class="o">=</span><span class="n">frame_data</span><span class="p">[</span><span class="s2">&quot;cart_x&quot;</span><span class="p">],</span>
                    <span class="n">y</span><span class="o">=</span><span class="n">frame_data</span><span class="p">[</span><span class="s2">&quot;cart_y&quot;</span><span class="p">],</span>
                    <span class="n">fill</span><span class="o">=</span><span class="s2">&quot;toself&quot;</span><span class="p">,</span>
                    <span class="n">fillcolor</span><span class="o">=</span><span class="s2">&quot;steelblue&quot;</span><span class="p">,</span>
                    <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;darkblue&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span>
                <span class="p">),</span>
                <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
                    <span class="n">x</span><span class="o">=</span><span class="n">frame_data</span><span class="p">[</span><span class="s2">&quot;pole_x&quot;</span><span class="p">],</span>
                    <span class="n">y</span><span class="o">=</span><span class="n">frame_data</span><span class="p">[</span><span class="s2">&quot;pole_y&quot;</span><span class="p">],</span>
                    <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;lines&quot;</span><span class="p">,</span>
                    <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;sienna&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">8</span><span class="p">),</span>
                <span class="p">),</span>
                <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
                    <span class="n">x</span><span class="o">=</span><span class="n">frame_data</span><span class="p">[</span><span class="s2">&quot;mass_x&quot;</span><span class="p">],</span>
                    <span class="n">y</span><span class="o">=</span><span class="n">frame_data</span><span class="p">[</span><span class="s2">&quot;mass_y&quot;</span><span class="p">],</span>
                    <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;markers&quot;</span><span class="p">,</span>
                    <span class="n">marker</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                        <span class="n">size</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;sienna&quot;</span><span class="p">,</span> <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                    <span class="p">),</span>
                <span class="p">),</span>
                <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
                    <span class="n">x</span><span class="o">=</span><span class="n">frame_data</span><span class="p">[</span><span class="s2">&quot;wheel1_x&quot;</span><span class="p">],</span>
                    <span class="n">y</span><span class="o">=</span><span class="n">frame_data</span><span class="p">[</span><span class="s2">&quot;wheel1_y&quot;</span><span class="p">],</span>
                    <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;markers&quot;</span><span class="p">,</span>
                    <span class="n">marker</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">symbol</span><span class="o">=</span><span class="s2">&quot;circle&quot;</span><span class="p">),</span>
                <span class="p">),</span>
                <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
                    <span class="n">x</span><span class="o">=</span><span class="n">frame_data</span><span class="p">[</span><span class="s2">&quot;wheel2_x&quot;</span><span class="p">],</span>
                    <span class="n">y</span><span class="o">=</span><span class="n">frame_data</span><span class="p">[</span><span class="s2">&quot;wheel2_y&quot;</span><span class="p">],</span>
                    <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;markers&quot;</span><span class="p">,</span>
                    <span class="n">marker</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">symbol</span><span class="o">=</span><span class="s2">&quot;circle&quot;</span><span class="p">),</span>
                <span class="p">),</span>
            <span class="p">],</span>
            <span class="n">name</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">),</span>
        <span class="p">)</span>
    <span class="p">)</span>

<span class="c1"># Initial frame.</span>
<span class="n">init_frame</span> <span class="o">=</span> <span class="n">create_cart_pole_frame</span><span class="p">(</span>
    <span class="nb">float</span><span class="p">(</span><span class="n">optimal_trajectory</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">optimal_trajectory</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="p">)</span>
<span class="n">rail_y</span> <span class="o">=</span> <span class="n">cart_y_offset</span> <span class="o">-</span> <span class="mf">0.15</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">wheel_radius</span> <span class="o">*</span> <span class="mi">2</span>

<span class="n">fig_anim</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="p">[</span>
        <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
            <span class="n">x</span><span class="o">=</span><span class="n">init_frame</span><span class="p">[</span><span class="s2">&quot;cart_x&quot;</span><span class="p">],</span>
            <span class="n">y</span><span class="o">=</span><span class="n">init_frame</span><span class="p">[</span><span class="s2">&quot;cart_y&quot;</span><span class="p">],</span>
            <span class="n">fill</span><span class="o">=</span><span class="s2">&quot;toself&quot;</span><span class="p">,</span>
            <span class="n">fillcolor</span><span class="o">=</span><span class="s2">&quot;steelblue&quot;</span><span class="p">,</span>
            <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;darkblue&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Cart&quot;</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
            <span class="n">x</span><span class="o">=</span><span class="n">init_frame</span><span class="p">[</span><span class="s2">&quot;pole_x&quot;</span><span class="p">],</span>
            <span class="n">y</span><span class="o">=</span><span class="n">init_frame</span><span class="p">[</span><span class="s2">&quot;pole_y&quot;</span><span class="p">],</span>
            <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;lines&quot;</span><span class="p">,</span>
            <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;sienna&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">8</span><span class="p">),</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Pole&quot;</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
            <span class="n">x</span><span class="o">=</span><span class="n">init_frame</span><span class="p">[</span><span class="s2">&quot;mass_x&quot;</span><span class="p">],</span>
            <span class="n">y</span><span class="o">=</span><span class="n">init_frame</span><span class="p">[</span><span class="s2">&quot;mass_y&quot;</span><span class="p">],</span>
            <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;markers&quot;</span><span class="p">,</span>
            <span class="n">marker</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;sienna&quot;</span><span class="p">,</span> <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">1</span><span class="p">)),</span>
            <span class="n">showlegend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
            <span class="n">x</span><span class="o">=</span><span class="n">init_frame</span><span class="p">[</span><span class="s2">&quot;wheel1_x&quot;</span><span class="p">],</span>
            <span class="n">y</span><span class="o">=</span><span class="n">init_frame</span><span class="p">[</span><span class="s2">&quot;wheel1_y&quot;</span><span class="p">],</span>
            <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;markers&quot;</span><span class="p">,</span>
            <span class="n">marker</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">symbol</span><span class="o">=</span><span class="s2">&quot;circle&quot;</span><span class="p">),</span>
            <span class="n">showlegend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
            <span class="n">x</span><span class="o">=</span><span class="n">init_frame</span><span class="p">[</span><span class="s2">&quot;wheel2_x&quot;</span><span class="p">],</span>
            <span class="n">y</span><span class="o">=</span><span class="n">init_frame</span><span class="p">[</span><span class="s2">&quot;wheel2_y&quot;</span><span class="p">],</span>
            <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;markers&quot;</span><span class="p">,</span>
            <span class="n">marker</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">symbol</span><span class="o">=</span><span class="s2">&quot;circle&quot;</span><span class="p">),</span>
            <span class="n">showlegend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
            <span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">2.5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">],</span>
            <span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="n">rail_y</span><span class="p">,</span> <span class="n">rail_y</span><span class="p">],</span>
            <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;lines&quot;</span><span class="p">,</span>
            <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">6</span><span class="p">),</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Rail&quot;</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">],</span>
    <span class="n">frames</span><span class="o">=</span><span class="n">frames</span><span class="p">,</span>
    <span class="n">layout</span><span class="o">=</span><span class="n">go</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span>
        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Cart-Pole (Shooting)&quot;</span><span class="p">,</span>
        <span class="n">xaxis</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
            <span class="nb">range</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">2.5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;x (m)&quot;</span><span class="p">,</span> <span class="n">constrain</span><span class="o">=</span><span class="s2">&quot;domain&quot;</span><span class="p">,</span> <span class="n">showgrid</span><span class="o">=</span><span class="kc">False</span>
        <span class="p">),</span>
        <span class="n">yaxis</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
            <span class="nb">range</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">],</span>
            <span class="n">title</span><span class="o">=</span><span class="s2">&quot;y (m)&quot;</span><span class="p">,</span>
            <span class="n">scaleanchor</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span>
            <span class="n">scaleratio</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">showgrid</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">updatemenus</span><span class="o">=</span><span class="p">[</span>
            <span class="nb">dict</span><span class="p">(</span>
                <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;buttons&quot;</span><span class="p">,</span>
                <span class="n">showactive</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">y</span><span class="o">=</span><span class="mf">1.15</span><span class="p">,</span>
                <span class="n">x</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
                <span class="n">xanchor</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
                <span class="n">buttons</span><span class="o">=</span><span class="p">[</span>
                    <span class="nb">dict</span><span class="p">(</span>
                        <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Play&quot;</span><span class="p">,</span>
                        <span class="n">method</span><span class="o">=</span><span class="s2">&quot;animate&quot;</span><span class="p">,</span>
                        <span class="n">args</span><span class="o">=</span><span class="p">[</span>
                            <span class="kc">None</span><span class="p">,</span>
                            <span class="nb">dict</span><span class="p">(</span>
                                <span class="n">frame</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">redraw</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
                                <span class="n">fromcurrent</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                <span class="n">transition</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
                            <span class="p">),</span>
                        <span class="p">],</span>
                    <span class="p">),</span>
                    <span class="nb">dict</span><span class="p">(</span>
                        <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Pause&quot;</span><span class="p">,</span>
                        <span class="n">method</span><span class="o">=</span><span class="s2">&quot;animate&quot;</span><span class="p">,</span>
                        <span class="n">args</span><span class="o">=</span><span class="p">[</span>
                            <span class="p">[</span><span class="kc">None</span><span class="p">],</span>
                            <span class="nb">dict</span><span class="p">(</span>
                                <span class="n">frame</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">redraw</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span>
                                <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;immediate&quot;</span><span class="p">,</span>
                            <span class="p">),</span>
                        <span class="p">],</span>
                    <span class="p">),</span>
                <span class="p">],</span>
            <span class="p">)</span>
        <span class="p">],</span>
        <span class="n">sliders</span><span class="o">=</span><span class="p">[</span>
            <span class="nb">dict</span><span class="p">(</span>
                <span class="n">active</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                <span class="n">yanchor</span><span class="o">=</span><span class="s2">&quot;top&quot;</span><span class="p">,</span>
                <span class="n">xanchor</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span>
                <span class="n">currentvalue</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                    <span class="n">prefix</span><span class="o">=</span><span class="s2">&quot;Time: &quot;</span><span class="p">,</span>
                    <span class="n">suffix</span><span class="o">=</span><span class="s2">&quot;s&quot;</span><span class="p">,</span>
                    <span class="n">visible</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">xanchor</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
                    <span class="n">offset</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
                <span class="p">),</span>
                <span class="n">pad</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">b</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="mi">60</span><span class="p">),</span>
                <span class="n">steps</span><span class="o">=</span><span class="p">[</span>
                    <span class="nb">dict</span><span class="p">(</span>
                        <span class="n">args</span><span class="o">=</span><span class="p">[</span>
                            <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)],</span>
                            <span class="nb">dict</span><span class="p">(</span>
                                <span class="n">frame</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">redraw</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
                                <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;immediate&quot;</span><span class="p">,</span>
                                <span class="n">transition</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
                            <span class="p">),</span>
                        <span class="p">],</span>
                        <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">float</span><span class="p">(</span><span class="n">times</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                        <span class="n">method</span><span class="o">=</span><span class="s2">&quot;animate&quot;</span><span class="p">,</span>
                    <span class="p">)</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">frame_indices</span>
                <span class="p">],</span>
                <span class="n">x</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
                <span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                <span class="nb">len</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">],</span>
        <span class="n">height</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span>
        <span class="n">showlegend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">margin</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">t</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">100</span><span class="p">),</span>
        <span class="n">plot_bgcolor</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span>
    <span class="p">),</span>
<span class="p">)</span>
<span class="n">HTML</span><span class="p">(</span><span class="n">fig_anim</span><span class="o">.</span><span class="n">to_html</span><span class="p">(</span><span class="n">full_html</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">include_plotlyjs</span><span class="o">=</span><span class="s2">&quot;cdn&quot;</span><span class="p">,</span> <span class="n">auto_play</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><div>                        <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-3.3.0.min.js" integrity="sha256-bO3dS6yCpk9aK4gUpNELtCiDeSYvGYnK7jFI58NQnHI=" crossorigin="anonymous"></script>                <div id="c2472311-c845-489d-a5c9-0edf5b141b18" class="plotly-graph-div" style="height:500px; width:100%;"></div>            <script type="text/javascript">                window.PLOTLYENV=window.PLOTLYENV || {};                                if (document.getElementById("c2472311-c845-489d-a5c9-0edf5b141b18")) {                    Plotly.newPlot(                        "c2472311-c845-489d-a5c9-0edf5b141b18",                        [{"fill":"toself","fillcolor":"steelblue","line":{"color":"darkblue","width":2},"name":"Cart","x":[-0.2,0.2,0.2,-0.2,-0.2],"y":[1.125,1.125,1.275,1.275,1.125],"type":"scatter"},{"line":{"color":"sienna","width":8},"mode":"lines","name":"Pole","x":[0.0,0.0],"y":[1.2,0.20000004768371582],"type":"scatter"},{"marker":{"color":"sienna","line":{"color":"black","width":1},"size":18},"mode":"markers","showlegend":false,"x":[0.0],"y":[0.20000004768371582],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","showlegend":false,"x":[-0.13333333333333333],"y":[1.075],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","showlegend":false,"x":[0.13333333333333333],"y":[1.075],"type":"scatter"},{"line":{"color":"gray","width":6},"mode":"lines","name":"Rail","x":[-2.5,2.5],"y":[1.025,1.025],"type":"scatter"}],                        {"height":500,"margin":{"b":100,"t":80},"plot_bgcolor":"white","showlegend":false,"sliders":[{"active":0,"currentvalue":{"offset":20,"prefix":"Time: ","suffix":"s","visible":true,"xanchor":"center"},"len":0.8,"pad":{"b":10,"t":60},"steps":[{"args":[["0"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"0.00","method":"animate"},{"args":[["2"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"0.10","method":"animate"},{"args":[["4"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"0.20","method":"animate"},{"args":[["6"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"0.30","method":"animate"},{"args":[["8"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"0.40","method":"animate"},{"args":[["10"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"0.50","method":"animate"},{"args":[["12"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"0.60","method":"animate"},{"args":[["14"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"0.70","method":"animate"},{"args":[["16"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"0.80","method":"animate"},{"args":[["18"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"0.90","method":"animate"},{"args":[["20"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"1.00","method":"animate"},{"args":[["22"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"1.10","method":"animate"},{"args":[["24"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"1.20","method":"animate"},{"args":[["26"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"1.30","method":"animate"},{"args":[["28"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"1.40","method":"animate"},{"args":[["30"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"1.50","method":"animate"},{"args":[["32"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"1.60","method":"animate"},{"args":[["34"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"1.70","method":"animate"},{"args":[["36"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"1.80","method":"animate"},{"args":[["38"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"1.90","method":"animate"},{"args":[["40"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"2.00","method":"animate"},{"args":[["42"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"2.10","method":"animate"},{"args":[["44"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"2.20","method":"animate"},{"args":[["46"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"2.30","method":"animate"},{"args":[["48"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"2.40","method":"animate"},{"args":[["50"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"2.50","method":"animate"},{"args":[["52"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"2.60","method":"animate"},{"args":[["54"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"2.70","method":"animate"},{"args":[["56"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"2.80","method":"animate"},{"args":[["58"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"2.90","method":"animate"},{"args":[["60"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"3.00","method":"animate"}],"x":0.1,"xanchor":"left","y":0,"yanchor":"top"}],"title":{"text":"Cart-Pole (Shooting)"},"updatemenus":[{"buttons":[{"args":[null,{"frame":{"duration":50,"redraw":true},"fromcurrent":true,"transition":{"duration":0}}],"label":"Play","method":"animate"},{"args":[[null],{"frame":{"duration":0,"redraw":false},"mode":"immediate"}],"label":"Pause","method":"animate"}],"showactive":false,"type":"buttons","x":0.5,"xanchor":"center","y":1.15}],"xaxis":{"constrain":"domain","range":[-2.5,2.5],"showgrid":false,"title":{"text":"x (m)"}},"yaxis":{"range":[-0.1,2.5],"scaleanchor":"x","scaleratio":1,"showgrid":false,"title":{"text":"y (m)"}},"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermap":[{"type":"scattermap","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}}},                        {"responsive": true}                    ).then(function(){
                            Plotly.addFrames('c2472311-c845-489d-a5c9-0edf5b141b18', [{"data":[{"fill":"toself","fillcolor":"steelblue","line":{"color":"darkblue","width":2},"x":[-0.2,0.2,0.2,-0.2,-0.2],"y":[1.125,1.125,1.275,1.275,1.125],"type":"scatter"},{"line":{"color":"sienna","width":8},"mode":"lines","x":[0.0,0.0],"y":[1.2,0.20000004768371582],"type":"scatter"},{"marker":{"color":"sienna","line":{"color":"black","width":1},"size":18},"mode":"markers","x":[0.0],"y":[0.20000004768371582],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[-0.13333333333333333],"y":[1.075],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[0.13333333333333333],"y":[1.075],"type":"scatter"}],"name":"0"},{"data":[{"fill":"toself","fillcolor":"steelblue","line":{"color":"darkblue","width":2},"x":[-0.2615144707262516,0.1384855292737484,0.1384855292737484,-0.2615144707262516,-0.2615144707262516],"y":[1.125,1.125,1.275,1.275,1.125],"type":"scatter"},{"line":{"color":"sienna","width":8},"mode":"lines","x":[-0.0615144707262516,0.029437165707349777],"y":[1.2,0.20414471626281738],"type":"scatter"},{"marker":{"color":"sienna","line":{"color":"black","width":1},"size":18},"mode":"markers","x":[0.029437165707349777],"y":[0.20414471626281738],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[-0.19484780405958493],"y":[1.075],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[0.07181886260708173],"y":[1.075],"type":"scatter"}],"name":"2"},{"data":[{"fill":"toself","fillcolor":"steelblue","line":{"color":"darkblue","width":2},"x":[-0.41382497251033784,-0.013824972510337818,-0.013824972510337818,-0.41382497251033784,-0.41382497251033784],"y":[1.125,1.125,1.275,1.275,1.125],"type":"scatter"},{"line":{"color":"sienna","width":8},"mode":"lines","x":[-0.21382497251033783,0.08432386815547943],"y":[1.2,0.24548065662384033],"type":"scatter"},{"marker":{"color":"sienna","line":{"color":"black","width":1},"size":18},"mode":"markers","x":[0.08432386815547943],"y":[0.24548065662384033],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[-0.34715830584367113],"y":[1.075],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[-0.0804916391770045],"y":[1.075],"type":"scatter"}],"name":"4"},{"data":[{"fill":"toself","fillcolor":"steelblue","line":{"color":"darkblue","width":2},"x":[-0.6076919555664062,-0.20769195556640624,-0.20769195556640624,-0.6076919555664062,-0.6076919555664062],"y":[1.125,1.125,1.275,1.275,1.125],"type":"scatter"},{"line":{"color":"sienna","width":8},"mode":"lines","x":[-0.40769195556640625,0.09830600023269653],"y":[1.2,0.3374653458595276],"type":"scatter"},{"marker":{"color":"sienna","line":{"color":"black","width":1},"size":18},"mode":"markers","x":[0.09830600023269653],"y":[0.3374653458595276],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[-0.5410252888997396],"y":[1.075],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[-0.27435862223307295],"y":[1.075],"type":"scatter"}],"name":"6"},{"data":[{"fill":"toself","fillcolor":"steelblue","line":{"color":"darkblue","width":2},"x":[-0.8087679266929626,-0.40876792669296264,-0.40876792669296264,-0.8087679266929626,-0.8087679266929626],"y":[1.125,1.125,1.275,1.275,1.125],"type":"scatter"},{"line":{"color":"sienna","width":8},"mode":"lines","x":[-0.6087679266929626,0.03142106533050537],"y":[1.2,0.431782603263855],"type":"scatter"},{"marker":{"color":"sienna","line":{"color":"black","width":1},"size":18},"mode":"markers","x":[0.03142106533050537],"y":[0.431782603263855],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[-0.742101260026296],"y":[1.075],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[-0.47543459335962934],"y":[1.075],"type":"scatter"}],"name":"8"},{"data":[{"fill":"toself","fillcolor":"steelblue","line":{"color":"darkblue","width":2},"x":[-0.9998325824737548,-0.5998325824737549,-0.5998325824737549,-0.9998325824737548,-0.9998325824737548],"y":[1.125,1.125,1.275,1.275,1.125],"type":"scatter"},{"line":{"color":"sienna","width":8},"mode":"lines","x":[-0.7998325824737549,-0.11493813991546631],"y":[1.2,0.4713577628135681],"type":"scatter"},{"marker":{"color":"sienna","line":{"color":"black","width":1},"size":18},"mode":"markers","x":[-0.11493813991546631],"y":[0.4713577628135681],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[-0.9331659158070882],"y":[1.075],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[-0.6664992491404216],"y":[1.075],"type":"scatter"}],"name":"10"},{"data":[{"fill":"toself","fillcolor":"steelblue","line":{"color":"darkblue","width":2},"x":[-1.1698647260665893,-0.7698647260665894,-0.7698647260665894,-1.1698647260665893,-1.1698647260665893],"y":[1.125,1.125,1.275,1.275,1.125],"type":"scatter"},{"line":{"color":"sienna","width":8},"mode":"lines","x":[-0.9698647260665894,-0.33233028650283813],"y":[1.2,0.42957818508148193],"type":"scatter"},{"marker":{"color":"sienna","line":{"color":"black","width":1},"size":18},"mode":"markers","x":[-0.33233028650283813],"y":[0.42957818508148193],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[-1.1031980593999227],"y":[1.075],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[-0.836531392733256],"y":[1.075],"type":"scatter"}],"name":"12"},{"data":[{"fill":"toself","fillcolor":"steelblue","line":{"color":"darkblue","width":2},"x":[-1.3046347618103027,-0.9046347618103028,-0.9046347618103028,-1.3046347618103027,-1.3046347618103027],"y":[1.125,1.125,1.275,1.275,1.125],"type":"scatter"},{"line":{"color":"sienna","width":8},"mode":"lines","x":[-1.1046347618103027,-0.6302095651626587],"y":[1.2,0.31970423460006714],"type":"scatter"},{"marker":{"color":"sienna","line":{"color":"black","width":1},"size":18},"mode":"markers","x":[-0.6302095651626587],"y":[0.31970423460006714],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[-1.237968095143636],"y":[1.075],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[-0.9713014284769694],"y":[1.075],"type":"scatter"}],"name":"14"},{"data":[{"fill":"toself","fillcolor":"steelblue","line":{"color":"darkblue","width":2},"x":[-1.385741901397705,-0.9857419013977051,-0.9857419013977051,-1.385741901397705,-1.385741901397705],"y":[1.125,1.125,1.275,1.275,1.125],"type":"scatter"},{"line":{"color":"sienna","width":8},"mode":"lines","x":[-1.185741901397705,-1.0283722877502441],"y":[1.2,0.21246027946472168],"type":"scatter"},{"marker":{"color":"sienna","line":{"color":"black","width":1},"size":18},"mode":"markers","x":[-1.0283722877502441],"y":[0.21246027946472168],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[-1.3190752347310384],"y":[1.075],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[-1.0524085680643718],"y":[1.075],"type":"scatter"}],"name":"16"},{"data":[{"fill":"toself","fillcolor":"steelblue","line":{"color":"darkblue","width":2},"x":[-1.402040672302246,-1.0020406723022461,-1.0020406723022461,-1.402040672302246,-1.402040672302246],"y":[1.125,1.125,1.275,1.275,1.125],"type":"scatter"},{"line":{"color":"sienna","width":8},"mode":"lines","x":[-1.202040672302246,-1.4924280643463135],"y":[1.2,0.24309086799621582],"type":"scatter"},{"marker":{"color":"sienna","line":{"color":"black","width":1},"size":18},"mode":"markers","x":[-1.4924280643463135],"y":[0.24309086799621582],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[-1.3353740056355794],"y":[1.075],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[-1.0687073389689128],"y":[1.075],"type":"scatter"}],"name":"18"},{"data":[{"fill":"toself","fillcolor":"steelblue","line":{"color":"darkblue","width":2},"x":[-1.3674554347991943,-0.9674554347991944,-0.9674554347991944,-1.3674554347991943,-1.3674554347991943],"y":[1.125,1.125,1.275,1.275,1.125],"type":"scatter"},{"line":{"color":"sienna","width":8},"mode":"lines","x":[-1.1674554347991943,-1.8690760135650635],"y":[1.2,0.4874492287635803],"type":"scatter"},{"marker":{"color":"sienna","line":{"color":"black","width":1},"size":18},"mode":"markers","x":[-1.8690760135650635],"y":[0.4874492287635803],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[-1.3007887681325276],"y":[1.075],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[-1.034122101465861],"y":[1.075],"type":"scatter"}],"name":"20"},{"data":[{"fill":"toself","fillcolor":"steelblue","line":{"color":"darkblue","width":2},"x":[-1.314929437637329,-0.9149294376373291,-0.9149294376373291,-1.314929437637329,-1.314929437637329],"y":[1.125,1.125,1.275,1.275,1.125],"type":"scatter"},{"line":{"color":"sienna","width":8},"mode":"lines","x":[-1.114929437637329,-2.040060043334961],"y":[1.2,0.8203513622283936],"type":"scatter"},{"marker":{"color":"sienna","line":{"color":"black","width":1},"size":18},"mode":"markers","x":[-2.040060043334961],"y":[0.8203513622283936],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[-1.2482627709706624],"y":[1.075],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[-0.9815961043039958],"y":[1.075],"type":"scatter"}],"name":"22"},{"data":[{"fill":"toself","fillcolor":"steelblue","line":{"color":"darkblue","width":2},"x":[-1.2653040409088134,-0.8653040409088135,-0.8653040409088135,-1.2653040409088134,-1.2653040409088134],"y":[1.125,1.125,1.275,1.275,1.125],"type":"scatter"},{"line":{"color":"sienna","width":8},"mode":"lines","x":[-1.0653040409088135,-2.057997226715088],"y":[1.2,1.0793348550796509],"type":"scatter"},{"marker":{"color":"sienna","line":{"color":"black","width":1},"size":18},"mode":"markers","x":[-2.057997226715088],"y":[1.0793348550796509],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[-1.1986373742421468],"y":[1.075],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[-0.9319707075754802],"y":[1.075],"type":"scatter"}],"name":"24"},{"data":[{"fill":"toself","fillcolor":"steelblue","line":{"color":"darkblue","width":2},"x":[-1.213884663581848,-0.8138846635818482,-0.8138846635818482,-1.213884663581848,-1.213884663581848],"y":[1.125,1.125,1.275,1.275,1.125],"type":"scatter"},{"line":{"color":"sienna","width":8},"mode":"lines","x":[-1.0138846635818481,-2.013883113861084],"y":[1.2,1.2017732858657837],"type":"scatter"},{"marker":{"color":"sienna","line":{"color":"black","width":1},"size":18},"mode":"markers","x":[-2.013883113861084],"y":[1.2017732858657837],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[-1.1472179969151814],"y":[1.075],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[-0.8805513302485148],"y":[1.075],"type":"scatter"}],"name":"26"},{"data":[{"fill":"toself","fillcolor":"steelblue","line":{"color":"darkblue","width":2},"x":[-1.1409842491149902,-0.7409842491149903,-0.7409842491149903,-1.1409842491149902,-1.1409842491149902],"y":[1.125,1.125,1.275,1.275,1.125],"type":"scatter"},{"line":{"color":"sienna","width":8},"mode":"lines","x":[-0.9409842491149902,-1.9407305717468262],"y":[1.2,1.1774762868881226],"type":"scatter"},{"marker":{"color":"sienna","line":{"color":"black","width":1},"size":18},"mode":"markers","x":[-1.9407305717468262],"y":[1.1774762868881226],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[-1.0743175824483235],"y":[1.075],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[-0.8076509157816569],"y":[1.075],"type":"scatter"}],"name":"28"},{"data":[{"fill":"toself","fillcolor":"steelblue","line":{"color":"darkblue","width":2},"x":[-1.0300567269325256,-0.6300567269325257,-0.6300567269325257,-1.0300567269325256,-1.0300567269325256],"y":[1.125,1.125,1.275,1.275,1.125],"type":"scatter"},{"line":{"color":"sienna","width":8},"mode":"lines","x":[-0.8300567269325256,-1.8117562532424927],"y":[1.2,1.0095634460449219],"type":"scatter"},{"marker":{"color":"sienna","line":{"color":"black","width":1},"size":18},"mode":"markers","x":[-1.8117562532424927],"y":[1.0095634460449219],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[-0.9633900602658589],"y":[1.075],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[-0.6967233935991923],"y":[1.075],"type":"scatter"}],"name":"30"},{"data":[{"fill":"toself","fillcolor":"steelblue","line":{"color":"darkblue","width":2},"x":[-0.8858449578285217,-0.4858449578285217,-0.4858449578285217,-0.8858449578285217,-0.8858449578285217],"y":[1.125,1.125,1.275,1.275,1.125],"type":"scatter"},{"line":{"color":"sienna","width":8},"mode":"lines","x":[-0.6858449578285217,-1.5656559467315674],"y":[1.2,0.7246763110160828],"type":"scatter"},{"marker":{"color":"sienna","line":{"color":"black","width":1},"size":18},"mode":"markers","x":[-1.5656559467315674],"y":[0.7246763110160828],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[-0.819178291161855],"y":[1.075],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[-0.5525116244951884],"y":[1.075],"type":"scatter"}],"name":"32"},{"data":[{"fill":"toself","fillcolor":"steelblue","line":{"color":"darkblue","width":2},"x":[-0.7435550212860107,-0.34355502128601073,-0.34355502128601073,-0.7435550212860107,-0.7435550212860107],"y":[1.125,1.125,1.275,1.275,1.125],"type":"scatter"},{"line":{"color":"sienna","width":8},"mode":"lines","x":[-0.5435550212860107,-1.1401190757751465],"y":[1.2,0.3974345922470093],"type":"scatter"},{"marker":{"color":"sienna","line":{"color":"black","width":1},"size":18},"mode":"markers","x":[-1.1401190757751465],"y":[0.3974345922470093],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[-0.676888354619344],"y":[1.075],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[-0.41022168795267744],"y":[1.075],"type":"scatter"}],"name":"34"},{"data":[{"fill":"toself","fillcolor":"steelblue","line":{"color":"darkblue","width":2},"x":[-0.6560104012489318,-0.2560104012489319,-0.2560104012489319,-0.6560104012489318,-0.6560104012489318],"y":[1.125,1.125,1.275,1.275,1.125],"type":"scatter"},{"line":{"color":"sienna","width":8},"mode":"lines","x":[-0.4560104012489319,-0.5057450532913208],"y":[1.2,0.20123755931854248],"type":"scatter"},{"marker":{"color":"sienna","line":{"color":"black","width":1},"size":18},"mode":"markers","x":[-0.5057450532913208],"y":[0.20123755931854248],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[-0.5893437345822652],"y":[1.075],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[-0.3226770679155986],"y":[1.075],"type":"scatter"}],"name":"36"},{"data":[{"fill":"toself","fillcolor":"steelblue","line":{"color":"darkblue","width":2},"x":[-0.649024498462677,-0.249024498462677,-0.249024498462677,-0.649024498462677,-0.649024498462677],"y":[1.125,1.125,1.275,1.275,1.125],"type":"scatter"},{"line":{"color":"sienna","width":8},"mode":"lines","x":[-0.449024498462677,0.16579586267471313],"y":[1.2,0.411332905292511],"type":"scatter"},{"marker":{"color":"sienna","line":{"color":"black","width":1},"size":18},"mode":"markers","x":[0.16579586267471313],"y":[0.411332905292511],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[-0.5823578317960103],"y":[1.075],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[-0.3156911651293437],"y":[1.075],"type":"scatter"}],"name":"38"},{"data":[{"fill":"toself","fillcolor":"steelblue","line":{"color":"darkblue","width":2},"x":[-0.6751139879226684,-0.27511398792266845,-0.27511398792266845,-0.6751139879226684,-0.6751139879226684],"y":[1.125,1.125,1.275,1.275,1.125],"type":"scatter"},{"line":{"color":"sienna","width":8},"mode":"lines","x":[-0.47511398792266846,0.49693000316619873],"y":[1.2,0.9652013182640076],"type":"scatter"},{"marker":{"color":"sienna","line":{"color":"black","width":1},"size":18},"mode":"markers","x":[0.49693000316619873],"y":[0.9652013182640076],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[-0.6084473212560018],"y":[1.075],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[-0.34178065458933515],"y":[1.075],"type":"scatter"}],"name":"40"},{"data":[{"fill":"toself","fillcolor":"steelblue","line":{"color":"darkblue","width":2},"x":[-0.6590137302875518,-0.25901373028755187,-0.25901373028755187,-0.6590137302875518,-0.6590137302875518],"y":[1.125,1.125,1.275,1.275,1.125],"type":"scatter"},{"line":{"color":"sienna","width":8},"mode":"lines","x":[-0.4590137302875519,0.49928054213523865],"y":[1.2,1.485783338546753],"type":"scatter"},{"marker":{"color":"sienna","line":{"color":"black","width":1},"size":18},"mode":"markers","x":[0.49928054213523865],"y":[1.485783338546753],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[-0.5923470636208852],"y":[1.075],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[-0.3256803969542186],"y":[1.075],"type":"scatter"}],"name":"42"},{"data":[{"fill":"toself","fillcolor":"steelblue","line":{"color":"darkblue","width":2},"x":[-0.5670322000980377,-0.1670322000980377,-0.1670322000980377,-0.5670322000980377,-0.5670322000980377],"y":[1.125,1.125,1.275,1.275,1.125],"type":"scatter"},{"line":{"color":"sienna","width":8},"mode":"lines","x":[-0.3670322000980377,0.3915540874004364],"y":[1.2,1.8515727519989014],"type":"scatter"},{"marker":{"color":"sienna","line":{"color":"black","width":1},"size":18},"mode":"markers","x":[0.3915540874004364],"y":[1.8515727519989014],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[-0.500365533431371],"y":[1.075],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[-0.2336988667647044],"y":[1.075],"type":"scatter"}],"name":"44"},{"data":[{"fill":"toself","fillcolor":"steelblue","line":{"color":"darkblue","width":2},"x":[-0.41627745032310487,-0.016277450323104847,-0.016277450323104847,-0.41627745032310487,-0.41627745032310487],"y":[1.125,1.125,1.275,1.275,1.125],"type":"scatter"},{"line":{"color":"sienna","width":8},"mode":"lines","x":[-0.21627745032310486,0.2616582214832306],"y":[1.2,2.078394889831543],"type":"scatter"},{"marker":{"color":"sienna","line":{"color":"black","width":1},"size":18},"mode":"markers","x":[0.2616582214832306],"y":[2.078394889831543],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[-0.34961078365643816],"y":[1.075],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[-0.08294411698977153],"y":[1.075],"type":"scatter"}],"name":"46"},{"data":[{"fill":"toself","fillcolor":"steelblue","line":{"color":"darkblue","width":2},"x":[-0.2623938962817192,0.1376061037182808,0.1376061037182808,-0.2623938962817192,-0.2623938962817192],"y":[1.125,1.125,1.275,1.275,1.125],"type":"scatter"},{"line":{"color":"sienna","width":8},"mode":"lines","x":[-0.06239389628171921,0.14075642824172974],"y":[1.2,2.179147720336914],"type":"scatter"},{"marker":{"color":"sienna","line":{"color":"black","width":1},"size":18},"mode":"markers","x":[0.14075642824172974],"y":[2.179147720336914],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[-0.19572722961505254],"y":[1.075],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[0.07093943705161412],"y":[1.075],"type":"scatter"}],"name":"48"},{"data":[{"fill":"toself","fillcolor":"steelblue","line":{"color":"darkblue","width":2},"x":[-0.18493732232600452,0.2150626776739955,0.2150626776739955,-0.18493732232600452,-0.18493732232600452],"y":[1.125,1.125,1.275,1.275,1.125],"type":"scatter"},{"line":{"color":"sienna","width":8},"mode":"lines","x":[0.015062677673995495,0.06992113590240479],"y":[1.2,2.1984941959381104],"type":"scatter"},{"marker":{"color":"sienna","line":{"color":"black","width":1},"size":18},"mode":"markers","x":[0.06992113590240479],"y":[2.1984941959381104],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[-0.11827065565933784],"y":[1.075],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[0.14839601100732883],"y":[1.075],"type":"scatter"}],"name":"50"},{"data":[{"fill":"toself","fillcolor":"steelblue","line":{"color":"darkblue","width":2},"x":[-0.1845722643658519,0.21542773563414813,0.21542773563414813,-0.1845722643658519,-0.1845722643658519],"y":[1.125,1.125,1.275,1.275,1.125],"type":"scatter"},{"line":{"color":"sienna","width":8},"mode":"lines","x":[0.015427735634148121,0.045549426227808],"y":[1.2,2.1995463371276855],"type":"scatter"},{"marker":{"color":"sienna","line":{"color":"black","width":1},"size":18},"mode":"markers","x":[0.045549426227808],"y":[2.1995463371276855],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[-0.11790559769918521],"y":[1.075],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[0.14876106896748145],"y":[1.075],"type":"scatter"}],"name":"52"},{"data":[{"fill":"toself","fillcolor":"steelblue","line":{"color":"darkblue","width":2},"x":[-0.18962276708334685,0.21037723291665317,0.21037723291665317,-0.18962276708334685,-0.18962276708334685],"y":[1.125,1.125,1.275,1.275,1.125],"type":"scatter"},{"line":{"color":"sienna","width":8},"mode":"lines","x":[0.010377232916653156,0.02841014787554741],"y":[1.2,2.1998374462127686],"type":"scatter"},{"marker":{"color":"sienna","line":{"color":"black","width":1},"size":18},"mode":"markers","x":[0.02841014787554741],"y":[2.1998374462127686],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[-0.12295610041668018],"y":[1.075],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[0.1437105662499865],"y":[1.075],"type":"scatter"}],"name":"54"},{"data":[{"fill":"toself","fillcolor":"steelblue","line":{"color":"darkblue","width":2},"x":[-0.19439259339123965,0.20560740660876037,0.20560740660876037,-0.19439259339123965,-0.19439259339123965],"y":[1.125,1.125,1.275,1.275,1.125],"type":"scatter"},{"line":{"color":"sienna","width":8},"mode":"lines","x":[0.005607406608760357,0.013807395473122597],"y":[1.2,2.1999664306640625],"type":"scatter"},{"marker":{"color":"sienna","line":{"color":"black","width":1},"size":18},"mode":"markers","x":[0.013807395473122597],"y":[2.1999664306640625],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[-0.12772592672457297],"y":[1.075],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[0.1389407399420937],"y":[1.075],"type":"scatter"}],"name":"56"},{"data":[{"fill":"toself","fillcolor":"steelblue","line":{"color":"darkblue","width":2},"x":[-0.1986106640426442,0.2013893359573558,0.2013893359573558,-0.1986106640426442,-0.1986106640426442],"y":[1.125,1.125,1.275,1.275,1.125],"type":"scatter"},{"line":{"color":"sienna","width":8},"mode":"lines","x":[0.0013893359573557973,0.00013874343130737543],"y":[1.2,2.1999993324279785],"type":"scatter"},{"marker":{"color":"sienna","line":{"color":"black","width":1},"size":18},"mode":"markers","x":[0.00013874343130737543],"y":[2.1999993324279785],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[-0.13194399737597753],"y":[1.075],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[0.13472266929068913],"y":[1.075],"type":"scatter"}],"name":"58"},{"data":[{"fill":"toself","fillcolor":"steelblue","line":{"color":"darkblue","width":2},"x":[-0.2026572325732559,0.19734276742674411,0.19734276742674411,-0.2026572325732559,-0.2026572325732559],"y":[1.125,1.125,1.275,1.275,1.125],"type":"scatter"},{"line":{"color":"sienna","width":8},"mode":"lines","x":[-0.0026572325732558966,-0.013807449489831924],"y":[1.2,2.1999378204345703],"type":"scatter"},{"marker":{"color":"sienna","line":{"color":"black","width":1},"size":18},"mode":"markers","x":[-0.013807449489831924],"y":[2.1999378204345703],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[-0.13599056590658923],"y":[1.075],"type":"scatter"},{"marker":{"color":"black","size":12,"symbol":"circle"},"mode":"markers","x":[0.13067610076007743],"y":[1.075],"type":"scatter"}],"name":"60"}]);
                        })                };            </script>        </div></div></div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># State and control trajectories.</span>
<span class="n">fig_traj</span> <span class="o">=</span> <span class="n">make_subplots</span><span class="p">(</span>
    <span class="n">rows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">cols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">subplot_titles</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;Cart Position&quot;</span><span class="p">,</span> <span class="s2">&quot;Pole Angle&quot;</span><span class="p">,</span> <span class="s2">&quot;Velocities&quot;</span><span class="p">,</span> <span class="s2">&quot;Control Force&quot;</span><span class="p">),</span>
    <span class="n">vertical_spacing</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span>
    <span class="n">horizontal_spacing</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Cart position.</span>
<span class="n">fig_traj</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
    <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">times</span><span class="p">],</span>
        <span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">optimal_trajectory</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]],</span>
        <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;lines&quot;</span><span class="p">,</span>
        <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;steelblue&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span>
    <span class="p">),</span>
    <span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">col</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Pole angle.</span>
<span class="n">fig_traj</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
    <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">times</span><span class="p">],</span>
        <span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">optimal_trajectory</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]],</span>
        <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;lines&quot;</span><span class="p">,</span>
        <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;coral&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;theta&quot;</span><span class="p">,</span>
    <span class="p">),</span>
    <span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">col</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">fig_traj</span><span class="o">.</span><span class="n">add_hline</span><span class="p">(</span>
    <span class="n">y</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">pi</span><span class="p">),</span>
    <span class="n">line_dash</span><span class="o">=</span><span class="s2">&quot;dash&quot;</span><span class="p">,</span>
    <span class="n">line_color</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">,</span>
    <span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">col</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">annotation_text</span><span class="o">=</span><span class="s2">&quot;pi&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Velocities.</span>
<span class="n">fig_traj</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
    <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">times</span><span class="p">],</span>
        <span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">optimal_trajectory</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]],</span>
        <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;lines&quot;</span><span class="p">,</span>
        <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;steelblue&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;x_dot&quot;</span><span class="p">,</span>
    <span class="p">),</span>
    <span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">col</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">fig_traj</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
    <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">times</span><span class="p">],</span>
        <span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">optimal_trajectory</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">]],</span>
        <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;lines&quot;</span><span class="p">,</span>
        <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;coral&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">dash</span><span class="o">=</span><span class="s2">&quot;dash&quot;</span><span class="p">),</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;theta_dot&quot;</span><span class="p">,</span>
    <span class="p">),</span>
    <span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">col</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Control force.</span>
<span class="n">fig_traj</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
    <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">control_times</span><span class="p">],</span>
        <span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">u</span><span class="p">)</span> <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="n">optimal_controls</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]],</span>
        <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;lines&quot;</span><span class="p">,</span>
        <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;forestgreen&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;F&quot;</span><span class="p">,</span>
        <span class="n">fill</span><span class="o">=</span><span class="s2">&quot;tozeroy&quot;</span><span class="p">,</span>
        <span class="n">fillcolor</span><span class="o">=</span><span class="s2">&quot;rgba(34, 139, 34, 0.2)&quot;</span><span class="p">,</span>
    <span class="p">),</span>
    <span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">col</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Axis labels.</span>
<span class="n">fig_traj</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span><span class="n">title_text</span><span class="o">=</span><span class="s2">&quot;Time (s)&quot;</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">fig_traj</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="n">title_text</span><span class="o">=</span><span class="s2">&quot;Position (m)&quot;</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">fig_traj</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span><span class="n">title_text</span><span class="o">=</span><span class="s2">&quot;Time (s)&quot;</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">fig_traj</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="n">title_text</span><span class="o">=</span><span class="s2">&quot;Angle (rad)&quot;</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">fig_traj</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span><span class="n">title_text</span><span class="o">=</span><span class="s2">&quot;Time (s)&quot;</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">fig_traj</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="n">title_text</span><span class="o">=</span><span class="s2">&quot;Velocity&quot;</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">fig_traj</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span><span class="n">title_text</span><span class="o">=</span><span class="s2">&quot;Time (s)&quot;</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">fig_traj</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="n">title_text</span><span class="o">=</span><span class="s2">&quot;Force (N)&quot;</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="n">fig_traj</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">height</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">showlegend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">margin</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">t</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">40</span><span class="p">))</span>
<span class="n">HTML</span><span class="p">(</span><span class="n">fig_traj</span><span class="o">.</span><span class="n">to_html</span><span class="p">(</span><span class="n">full_html</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">include_plotlyjs</span><span class="o">=</span><span class="s2">&quot;cdn&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><div>                        <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-3.3.0.min.js" integrity="sha256-bO3dS6yCpk9aK4gUpNELtCiDeSYvGYnK7jFI58NQnHI=" crossorigin="anonymous"></script>                <div id="896eb77c-10fc-4406-a362-a74435eed44d" class="plotly-graph-div" style="height:500px; width:100%;"></div>            <script type="text/javascript">                window.PLOTLYENV=window.PLOTLYENV || {};                                if (document.getElementById("896eb77c-10fc-4406-a362-a74435eed44d")) {                    Plotly.newPlot(                        "896eb77c-10fc-4406-a362-a74435eed44d",                        [{"line":{"color":"steelblue","width":2},"mode":"lines","name":"x","x":[0.0,0.05000000447034836,0.10000000894069672,0.15000000596046448,0.20000001788139343,0.2500000298023224,0.30000001192092896,0.3500000238418579,0.40000003576278687,0.4500000476837158,0.5000000596046448,0.5500000715255737,0.6000000238418579,0.6500000357627869,0.7000000476837158,0.7500000596046448,0.8000000715255737,0.8500000834465027,0.9000000953674316,0.9500001072883606,1.0000001192092896,1.0500000715255737,1.1000001430511475,1.1500000953674316,1.2000000476837158,1.2500001192092896,1.3000000715255737,1.3500001430511475,1.4000000953674316,1.4500001668930054,1.5000001192092896,1.5500001907348633,1.6000001430511475,1.6500000953674316,1.7000001668930054,1.7500001192092896,1.8000001907348633,1.8500001430511475,1.9000002145767212,1.9500001668930054,2.000000238418579,2.0500001907348633,2.1000001430511475,2.1500000953674316,2.200000286102295,2.250000238418579,2.3000001907348633,2.3500001430511475,2.4000000953674316,2.450000286102295,2.500000238418579,2.5500001907348633,2.6000001430511475,2.6500003337860107,2.700000286102295,2.750000238418579,2.8000001907348633,2.8500001430511475,2.9000003337860107,2.950000286102295,3.0],"y":[0.0,-0.016157647594809532,-0.0615144707262516,-0.12959453463554382,-0.21382497251033783,-0.3081841468811035,-0.40769195556640625,-0.5087015628814697,-0.6087679266929626,-0.7062442302703857,-0.7998325824737549,-0.8882245421409607,-0.9698647260665894,-1.0427805185317993,-1.1046347618103027,-1.1529889106750488,-1.185741901397705,-1.2018413543701172,-1.202040672302246,-1.1891456842422485,-1.1674554347991943,-1.1415297985076904,-1.114929437637329,-1.0895049571990967,-1.0653040409088135,-1.0408991575241089,-1.0138846635818481,-0.9814519286155701,-0.9409842491149902,-0.890662431716919,-0.8300567269325256,-0.7606083750724792,-0.6858449578285217,-0.6112254858016968,-0.5435550212860107,-0.4899246394634247,-0.4560104012489319,-0.4436674416065216,-0.449024498462677,-0.4631108343601227,-0.47511398792266846,-0.4757513999938965,-0.4590137302875519,-0.42249399423599243,-0.3670322000980377,-0.29627010226249695,-0.21627745032310486,-0.13513906300067902,-0.06239389628171921,-0.008535676635801792,0.015062677673995495,0.017225705087184906,0.015427735634148121,0.012926070019602776,0.010377232916653156,0.007925731129944324,0.005607406608760357,0.003430686891078949,0.0013893359573557973,-0.0005624835612252355,-0.0026572325732558966],"type":"scatter","xaxis":"x","yaxis":"y"},{"line":{"color":"coral","width":2},"mode":"lines","name":"theta","x":[0.0,0.05000000447034836,0.10000000894069672,0.15000000596046448,0.20000001788139343,0.2500000298023224,0.30000001192092896,0.3500000238418579,0.40000003576278687,0.4500000476837158,0.5000000596046448,0.5500000715255737,0.6000000238418579,0.6500000357627869,0.7000000476837158,0.7500000596046448,0.8000000715255737,0.8500000834465027,0.9000000953674316,0.9500001072883606,1.0000001192092896,1.0500000715255737,1.1000001430511475,1.1500000953674316,1.2000000476837158,1.2500001192092896,1.3000000715255737,1.3500001430511475,1.4000000953674316,1.4500001668930054,1.5000001192092896,1.5500001907348633,1.6000001430511475,1.6500000953674316,1.7000001668930054,1.7500001192092896,1.8000001907348633,1.8500001430511475,1.9000002145767212,1.9500001668930054,2.000000238418579,2.0500001907348633,2.1000001430511475,2.1500000953674316,2.200000286102295,2.250000238418579,2.3000001907348633,2.3500001430511475,2.4000000953674316,2.450000286102295,2.500000238418579,2.5500001907348633,2.6000001430511475,2.6500003337860107,2.700000286102295,2.750000238418579,2.8000001907348633,2.8500001430511475,2.9000003337860107,2.950000286102295,3.0],"y":[0.0,0.0241615641862154,0.09107749909162521,0.1884840428829193,0.30275270342826843,0.4205886721611023,0.5305385589599609,0.6239157915115356,0.6947442889213562,0.7391146421432495,0.7544588446617126,0.738983690738678,0.6912937164306641,0.610113799571991,0.4943109452724457,0.3433113098144531,0.15802650153636932,-0.05753340572118759,-0.294631689786911,-0.5398409366607666,-0.7776691913604736,-0.9945337176322937,-1.181379795074463,-1.333677887916565,-1.4498363733291626,-1.5295071601867676,-1.5725696086883545,-1.578839659690857,-1.5482707023620605,-1.4813271760940552,-1.3791894912719727,-1.2434875965118408,-1.0754643678665161,-0.8748555183410645,-0.6392130851745605,-0.36472830176353455,-0.04975515231490135,0.2989455461502075,0.662158191204071,1.0138493776321411,1.333784818649292,1.614807367324829,1.8606200218200684,2.0797290802001953,2.280452013015747,2.4680371284484863,2.643289566040039,2.8022830486297607,2.937018394470215,3.0364274978637695,3.0867066383361816,3.1027796268463135,3.111466407775879,3.11798357963562,3.123558759689331,3.128614902496338,3.133392572402954,3.1380808353424072,3.142843246459961,3.1477863788604736,3.152743101119995],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"line":{"color":"steelblue","width":2},"mode":"lines","name":"x_dot","x":[0.0,0.05000000447034836,0.10000000894069672,0.15000000596046448,0.20000001788139343,0.2500000298023224,0.30000001192092896,0.3500000238418579,0.40000003576278687,0.4500000476837158,0.5000000596046448,0.5500000715255737,0.6000000238418579,0.6500000357627869,0.7000000476837158,0.7500000596046448,0.8000000715255737,0.8500000834465027,0.9000000953674316,0.9500001072883606,1.0000001192092896,1.0500000715255737,1.1000001430511475,1.1500000953674316,1.2000000476837158,1.2500001192092896,1.3000000715255737,1.3500001430511475,1.4000000953674316,1.4500001668930054,1.5000001192092896,1.5500001907348633,1.6000001430511475,1.6500000953674316,1.7000001668930054,1.7500001192092896,1.8000001907348633,1.8500001430511475,1.9000002145767212,1.9500001668930054,2.000000238418579,2.0500001907348633,2.1000001430511475,2.1500000953674316,2.200000286102295,2.250000238418579,2.3000001907348633,2.3500001430511475,2.4000000953674316,2.450000286102295,2.500000238418579,2.5500001907348633,2.6000001430511475,2.6500003337860107,2.700000286102295,2.750000238418579,2.8000001907348633,2.8500001430511475,2.9000003337860107,2.950000286102295,3.0],"y":[0.0,-0.6461472511291504,-1.1675825119018555,-1.5546846389770508,-1.81344735622406,-1.9600542783737183,-2.0198380947113037,-2.0205395221710205,-1.9823375940322876,-1.9169572591781616,-1.8266838788986206,-1.7088757753372192,-1.5563771724700928,-1.359741449356079,-1.113968014717102,-0.8202186226844788,-0.4910162091255188,-0.15565864741802216,0.14377695322036743,0.3684288263320923,0.4974988102912903,0.5400406122207642,0.5258035063743591,0.4933025538921356,0.4765665531158447,0.5009355545043945,0.5803605914115906,0.7170531749725342,0.9011456370353699,1.1106523275375366,1.3120670318603516,1.4641273021697998,1.5246467590332031,1.458573579788208,1.2473843097686768,0.8989300727844238,0.46275660395622253,0.0404350720345974,-0.24575269222259521,-0.3150414228439331,-0.16817429661750793,0.1380244493484497,0.5278668403625488,0.9307904839515686,1.2865816354751587,1.543277382850647,1.6559144258499146,1.5891532897949219,1.3203816413879395,0.8339605927467346,0.11009905487298965,-0.023487836122512817,-0.04837946593761444,-0.051648203283548355,-0.050271883606910706,-0.04775788635015488,-0.04494643583893776,-0.04209422692656517,-0.03953123837709427,-0.03851189836859703,-0.045248325914144516],"type":"scatter","xaxis":"x3","yaxis":"y3"},{"line":{"color":"coral","dash":"dash","width":2},"mode":"lines","name":"theta_dot","x":[0.0,0.05000000447034836,0.10000000894069672,0.15000000596046448,0.20000001788139343,0.2500000298023224,0.30000001192092896,0.3500000238418579,0.40000003576278687,0.4500000476837158,0.5000000596046448,0.5500000715255737,0.6000000238418579,0.6500000357627869,0.7000000476837158,0.7500000596046448,0.8000000715255737,0.8500000834465027,0.9000000953674316,0.9500001072883606,1.0000001192092896,1.0500000715255737,1.1000001430511475,1.1500000953674316,1.2000000476837158,1.2500001192092896,1.3000000715255737,1.3500001430511475,1.4000000953674316,1.4500001668930054,1.5000001192092896,1.5500001907348633,1.6000001430511475,1.6500000953674316,1.7000001668930054,1.7500001192092896,1.8000001907348633,1.8500001430511475,1.9000002145767212,1.9500001668930054,2.000000238418579,2.0500001907348633,2.1000001430511475,2.1500000953674316,2.200000286102295,2.250000238418579,2.3000001907348633,2.3500001430511475,2.4000000953674316,2.450000286102295,2.500000238418579,2.5500001907348633,2.6000001430511475,2.6500003337860107,2.700000286102295,2.750000238418579,2.8000001907348633,2.8500001430511475,2.9000003337860107,2.950000286102295,3.0],"y":[0.0,0.9632047414779663,1.7039406299591064,2.1778347492218018,2.376006841659546,2.321237325668335,2.0635058879852295,1.6620030403137207,1.1649690866470337,0.6065055727958679,0.006240229122340679,-0.624289870262146,-1.2804884910583496,-1.9618257284164429,-2.6625282764434814,-3.3650476932525635,-4.0265607833862305,-4.566446781158447,-4.880208969116211,-4.890395164489746,-4.593118667602539,-4.063389778137207,-3.401685953140259,-2.686650276184082,-1.958128809928894,-1.2275923490524292,-0.49397364258766174,0.2433825135231018,0.9779483079910278,1.6959284543991089,2.3830630779266357,3.0364456176757812,3.6749844551086426,4.339625835418701,5.07454776763916,5.885431289672852,6.675511360168457,7.212068557739258,7.253632545471191,6.778080940246582,6.0166916847229,5.242956161499023,4.61735200881958,4.176640510559082,3.8801441192626953,3.647561550140381,3.382573127746582,2.9932990074157715,2.409242868423462,1.5773518085479736,0.4394546449184418,0.20554976165294647,0.1430705338716507,0.118479423224926,0.10526584088802338,0.09765195101499557,0.09408929198980331,0.09405912458896637,0.09706251323223114,0.10131704062223434,0.0976046547293663],"type":"scatter","xaxis":"x3","yaxis":"y3"},{"fill":"tozeroy","fillcolor":"rgba(34, 139, 34, 0.2)","line":{"color":"forestgreen","width":2},"mode":"lines","name":"F","x":[0.0,0.05000000074505806,0.10000000149011612,0.15000000596046448,0.20000000298023224,0.25,0.30000001192092896,0.3499999940395355,0.4000000059604645,0.45000001788139343,0.5,0.550000011920929,0.6000000238418579,0.6500000357627869,0.699999988079071,0.75,0.800000011920929,0.8500000238418579,0.9000000357627869,0.949999988079071,1.0,1.0500000715255737,1.100000023841858,1.149999976158142,1.2000000476837158,1.25,1.3000000715255737,1.350000023841858,1.399999976158142,1.4500000476837158,1.5,1.5500000715255737,1.600000023841858,1.649999976158142,1.7000000476837158,1.75,1.8000000715255737,1.850000023841858,1.899999976158142,1.9500000476837158,2.0,2.049999952316284,2.1000001430511475,2.1500000953674316,2.200000047683716,2.25,2.299999952316284,2.3500001430511475,2.4000000953674316,2.450000047683716,2.5,2.549999952316284,2.6000001430511475,2.6500000953674316,2.700000047683716,2.75,2.799999952316284,2.8500001430511475,2.9000000953674316,2.950000047683716],"y":[-13.252338409423828,-10.73762035369873,-8.07384967803955,-5.564094066619873,-3.374363660812378,-1.6543455123901367,-0.44640493392944336,0.38651809096336365,0.9916712641716003,1.5423229932785034,2.1257948875427246,2.829909324645996,3.704634666442871,4.67108678817749,5.637609481811523,6.434704780578613,6.795289993286133,6.47650671005249,5.417361259460449,3.7617242336273193,1.9946744441986084,0.6094523668289185,-0.05469018220901489,0.026620596647262573,0.7217170596122742,1.7988941669464111,3.0043978691101074,4.074010372161865,4.738639831542969,4.733400821685791,3.8676960468292236,2.1020243167877197,-0.418253093957901,-3.3556675910949707,-6.240297317504883,-8.426647186279297,-9.065889358520508,-7.467798709869385,-3.6624391078948975,1.0609302520751953,5.093044757843018,7.487637519836426,8.148799896240234,7.334228038787842,5.324512481689453,2.3577239513397217,-1.3201688528060913,-5.449374675750732,-9.910932540893555,-14.795160293579102,-2.705514430999756,-0.48522651195526123,-0.047353025525808334,0.043476738035678864,0.0629129633307457,0.06540949642658234,0.06277614831924438,0.053381841629743576,0.01817280799150467,-0.14448486268520355],"type":"scatter","xaxis":"x4","yaxis":"y4"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermap":[{"type":"scattermap","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"anchor":"y","domain":[0.0,0.45],"title":{"text":"Time (s)"}},"yaxis":{"anchor":"x","domain":[0.575,1.0],"title":{"text":"Position (m)"}},"xaxis2":{"anchor":"y2","domain":[0.55,1.0],"title":{"text":"Time (s)"}},"yaxis2":{"anchor":"x2","domain":[0.575,1.0],"title":{"text":"Angle (rad)"}},"xaxis3":{"anchor":"y3","domain":[0.0,0.45],"title":{"text":"Time (s)"}},"yaxis3":{"anchor":"x3","domain":[0.0,0.425],"title":{"text":"Velocity"}},"xaxis4":{"anchor":"y4","domain":[0.55,1.0],"title":{"text":"Time (s)"}},"yaxis4":{"anchor":"x4","domain":[0.0,0.425],"title":{"text":"Force (N)"}},"annotations":[{"font":{"size":16},"showarrow":false,"text":"Cart Position","x":0.225,"xanchor":"center","xref":"paper","y":1.0,"yanchor":"bottom","yref":"paper"},{"font":{"size":16},"showarrow":false,"text":"Pole Angle","x":0.775,"xanchor":"center","xref":"paper","y":1.0,"yanchor":"bottom","yref":"paper"},{"font":{"size":16},"showarrow":false,"text":"Velocities","x":0.225,"xanchor":"center","xref":"paper","y":0.425,"yanchor":"bottom","yref":"paper"},{"font":{"size":16},"showarrow":false,"text":"Control Force","x":0.775,"xanchor":"center","xref":"paper","y":0.425,"yanchor":"bottom","yref":"paper"},{"showarrow":false,"text":"pi","x":1,"xanchor":"right","xref":"x2 domain","y":3.141592653589793,"yanchor":"bottom","yref":"y2"}],"shapes":[{"line":{"color":"gray","dash":"dash"},"type":"line","x0":0,"x1":1,"xref":"x2 domain","y0":3.141592653589793,"y1":3.141592653589793,"yref":"y2"}],"margin":{"t":40,"b":40},"height":500,"showlegend":false},                        {"responsive": true}                    )                };            </script>        </div></div></div>
</div>
</section>
<section id="comparison-with-direct-collocation">
<h2>Comparison with direct collocation<a class="headerlink" href="#comparison-with-direct-collocation" title="Link to this heading">¶</a></h2>
<p>The shooting method optimizes only the control trajectory (60 decision variables for 60 timesteps), while direct collocation in <a class="reference internal" href="../cart_pole_collocation/"><span class="doc">Cart-pole (collocation)</span></a> optimizes both states and controls (305 decision variables: 61 states x 4 + 60 controls).</p>
<p>Shooting method advantages:</p>
<ul class="simple">
<li><p>Fewer decision variables</p></li>
<li><p>Dynamics are satisfied by construction (no defect constraints)</p></li>
<li><p>Simpler problem formulation</p></li>
</ul>
<p>Shooting method disadvantages:</p>
<ul class="simple">
<li><p>Sensitivity to initial conditions grows exponentially with time horizon</p></li>
<li><p>Harder to add state constraints (must be handled through cost)</p></li>
<li><p>Can struggle with long horizons or unstable dynamics</p></li>
</ul>
<p>For this cart-pole problem, both methods work well because the time horizon is short. For longer horizons or more complex systems, direct collocation often provides better convergence.</p>
<p>For solver configuration options, see <a class="reference internal" href="../../../api/solver_config/#jaxls.TrustRegionConfig" title="jaxls.TrustRegionConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">jaxls.TrustRegionConfig</span></code></a> and <a class="reference internal" href="../../../api/solver_config/#jaxls.TerminationConfig" title="jaxls.TerminationConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">jaxls.TerminationConfig</span></code></a>.</p>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../cam_design/">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Cam profile optimization</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="../cart_pole_collocation/">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Cart-pole (collocation)</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2025
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              <a class="muted-link " href="https://github.com/brentyi/jaxls" aria-label="GitHub">
            <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16">
                <path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"></path>
            </svg>
        </a>
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Cart-pole (shooting)</a><ul>
<li><a class="reference internal" href="#cart-pole-dynamics">Cart-pole dynamics</a></li>
<li><a class="reference internal" href="#forward-simulation">Forward simulation</a></li>
<li><a class="reference internal" href="#control-variable-and-costs">Control variable and costs</a></li>
<li><a class="reference internal" href="#solving">Solving</a></li>
<li><a class="reference internal" href="#visualization">Visualization</a></li>
<li><a class="reference internal" href="#comparison-with-direct-collocation">Comparison with direct collocation</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../../../_static/documentation_options.js?v=187304be"></script>
    <script src="../../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/scripts/furo.js?v=46bd48cc"></script>
    <script src="../../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../../_static/copybutton.js?v=fd10adb8"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>