
<!DOCTYPE html>


<html lang="en" data-content_root="../../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Robust costs &#8212; jaxls</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=b86133f3" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css?v=6644e6bb" />
    <link rel="stylesheet" type="text/css" href="../../../_static/css/custom.css?v=2a1f1aab" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../../_static/documentation_options.js?v=55b5f74b"></script>
    <script src="../../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../../_static/copybutton.js?v=fd10adb8"></script>
    <script src="../../../_static/js/custom.js?v=58150dd0"></script>
    <script src="../../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'guide/advanced/robust_costs';</script>
    <link rel="index" title="Index" href="../../../genindex/" />
    <link rel="search" title="Search" href="../../../search/" />
    <link rel="next" title="Covariance estimation" href="../covariance/" />
    <link rel="prev" title="Constraints" href="../constraints/" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../../search/"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../../">
  
  
  
  
  
  
    <p class="title logo__title">jaxls</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Guide</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../basics/">Basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tips_and_gotchas/">Tips and gotchas</a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../">Advanced</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../non_euclidean/">Non-Euclidean variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../custom_jacobians/">Custom Jacobians</a></li>
<li class="toctree-l2"><a class="reference internal" href="../constraints/">Constraints</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Robust costs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../covariance/">Covariance estimation</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Examples</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../examples/mechanics/">Mechanics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../examples/mechanics/spring_equilibrium/">Spring equilibrium</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../examples/mechanics/cloth_draping/">Cloth draping</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../examples/mechanics/truss_analysis/">Truss analysis</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../examples/vision/">Vision</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../examples/vision/camera_calibration/">Camera calibration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../examples/vision/pose_graph_2d/">SE(2) pose graph</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../examples/vision/pose_graph_3d/">SE(3) pose graph</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../examples/vision/bundle_adjustment/">Bundle adjustment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../examples/vision/smplh_shape_fitting/">SMPL-H shape fitting</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../examples/robotics/">Robotics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../examples/robotics/inverse_kinematics/">Inverse kinematics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../examples/robotics/obstacle_avoidance/">Obstacle avoidance</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../examples/robotics/cart_pole_collocation/">Cart-pole (collocation)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../examples/robotics/cart_pole_shooting/">Cart-pole (shooting)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../examples/robotics/cam_design/">Cam profile optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../examples/robotics/imu_sensor_fusion/">IMU fusion + calibration</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../examples/portfolio/">Portfolio optimization</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../examples/portfolio/mean_variance/">Mean-variance allocation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../examples/portfolio/manifold_allocation/">Manifold allocation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../examples/portfolio/reparameterized_allocation/">Reparameterized allocation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../examples/portfolio/cvar_optimization/">CVaR allocation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../examples/portfolio/black_litterman/">Black-Litterman allocation</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../api/core/">Core API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/lie_group_variables/">Lie group variables</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/solver_config/">Solver configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/covariance/">Covariance Estimation</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Design Notes</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../design/typed_api/">Typed API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../design/sparse_matrices/">Sparse matrices</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../design/traced_vs_static/">What’s traced?</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/brentyi/jaxls" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/brentyi/jaxls/issues/new?title=Issue%20on%20page%20%2Fguide/advanced/robust_costs.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../../_sources/guide/advanced/robust_costs.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Robust costs</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-outlier-problem">The outlier problem</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#standard-least-squares">Standard least squares</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#robust-cost-functions-m-estimators">Robust cost functions (M-estimators)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#irls-with-jaxls">IRLS with jaxls</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#robust-fitting-with-cauchy-weights">Robust fitting with Cauchy weights</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#visualization">Visualization</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#weight-visualization">Weight visualization</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#comparing-m-estimators">Comparing M-estimators</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summary">Summary</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="robust-costs">
<h1>Robust costs<a class="headerlink" href="#robust-costs" title="Link to this heading">#</a></h1>
<p>Using M-estimators and <code class="docutils literal notranslate"><span class="pre">jax.lax.stop_gradient</span></code> to handle outliers robustly in jaxls.</p>
<p>Standard least squares is sensitive to outliers – a few bad measurements can pull the solution away from the true parameters. By using <code class="docutils literal notranslate"><span class="pre">stop_gradient</span></code> to compute adaptive weights within cost functions, we can down-weight outliers and recover accurate estimates even with corrupted data.</p>
<p>Features used:</p>
<ul class="simple">
<li><p><a class="reference internal" href="../../../api/core/#jaxls.Var" title="jaxls.Var"><code class="xref py py-class docutils literal notranslate"><span class="pre">Var</span></code></a> subclass for circle parameters</p></li>
<li><p><a class="reference internal" href="../../../api/core/#jaxls.Cost.factory" title="jaxls.Cost.factory"><code class="xref py py-func docutils literal notranslate"><span class="pre">&#64;jaxls.Cost.factory</span></code></a> for robust residuals</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">jax.lax.stop_gradient</span></code> for IRLS-style weight updates</p></li>
</ul>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">loguru</span><span class="w"> </span><span class="kn">import</span> <span class="n">logger</span>

<span class="n">logger</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
<span class="n">logger</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;&lt;level&gt;</span><span class="si">{level: &lt;8}</span><span class="s2">&lt;/level&gt; | </span><span class="si">{message}</span><span class="s2">&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">jax</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">jax.numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">jnp</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">jaxls</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
</pre></div>
</div>
</div>
</div>
<section id="the-outlier-problem">
<h2>The outlier problem<a class="headerlink" href="#the-outlier-problem" title="Link to this heading">#</a></h2>
<p>Consider fitting a circle to 2D points. With clean data, least squares works well.
But real-world data often contains outliers – points that don’t follow the expected
model due to sensor errors, misassociations, or other anomalies.</p>
<p>Standard least squares minimizes the sum of squared residuals:</p>
<div class="math notranslate nohighlight">
\[\min_\theta \sum_i r_i(\theta)^2\]</div>
<p>The squaring amplifies large residuals, giving outliers disproportionate influence.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Generate synthetic circle data with outliers.</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>

<span class="c1"># Ground truth circle.</span>
<span class="n">true_cx</span><span class="p">,</span> <span class="n">true_cy</span><span class="p">,</span> <span class="n">true_r</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span>

<span class="c1"># Inlier points (on the circle with small noise).</span>
<span class="n">n_inliers</span> <span class="o">=</span> <span class="mi">40</span>
<span class="n">theta_inliers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">n_inliers</span><span class="p">)</span>
<span class="n">noise_inliers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="n">n_inliers</span><span class="p">)</span>
<span class="n">inlier_x</span> <span class="o">=</span> <span class="n">true_cx</span> <span class="o">+</span> <span class="p">(</span><span class="n">true_r</span> <span class="o">+</span> <span class="n">noise_inliers</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta_inliers</span><span class="p">)</span>
<span class="n">inlier_y</span> <span class="o">=</span> <span class="n">true_cy</span> <span class="o">+</span> <span class="p">(</span><span class="n">true_r</span> <span class="o">+</span> <span class="n">noise_inliers</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta_inliers</span><span class="p">)</span>

<span class="c1"># Outlier points (scattered far from the circle).</span>
<span class="n">n_outliers</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">outlier_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="n">n_outliers</span><span class="p">)</span>
<span class="n">outlier_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="n">n_outliers</span><span class="p">)</span>

<span class="c1"># Combine all points.</span>
<span class="n">all_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">inlier_x</span><span class="p">,</span> <span class="n">outlier_x</span><span class="p">])</span>
<span class="n">all_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">inlier_y</span><span class="p">,</span> <span class="n">outlier_y</span><span class="p">])</span>
<span class="n">points</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">all_x</span><span class="p">,</span> <span class="n">all_y</span><span class="p">],</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">n_points</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>

<span class="c1"># Track which points are outliers for visualization.</span>
<span class="n">is_outlier</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="kc">False</span><span class="p">]</span> <span class="o">*</span> <span class="n">n_inliers</span> <span class="o">+</span> <span class="p">[</span><span class="kc">True</span><span class="p">]</span> <span class="o">*</span> <span class="n">n_outliers</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;Generated </span><span class="si">{</span><span class="n">n_inliers</span><span class="si">}</span><span class="s2"> inliers and </span><span class="si">{</span><span class="n">n_outliers</span><span class="si">}</span><span class="s2"> outliers (</span><span class="si">{</span><span class="n">n_outliers</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">n_points</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">100</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2">% outliers)&quot;</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;True circle: center=(</span><span class="si">{</span><span class="n">true_cx</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">true_cy</span><span class="si">}</span><span class="s2">), radius=</span><span class="si">{</span><span class="n">true_r</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generated 40 inliers and 10 outliers (20% outliers)
True circle: center=(1.0, 1.0), radius=2.0
</pre></div>
</div>
</div>
</div>
</section>
<section id="standard-least-squares">
<h2>Standard least squares<a class="headerlink" href="#standard-least-squares" title="Link to this heading">#</a></h2>
<p>First, let’s see how standard (unweighted) least squares performs:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">CircleVar</span><span class="p">(</span>
    <span class="n">jaxls</span><span class="o">.</span><span class="n">Var</span><span class="p">[</span><span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">],</span> <span class="n">default_factory</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Circle parameters: [cx, cy, r].&quot;&quot;&quot;</span>


<span class="nd">@jaxls</span><span class="o">.</span><span class="n">Cost</span><span class="o">.</span><span class="n">factory</span>
<span class="k">def</span><span class="w"> </span><span class="nf">circle_residual</span><span class="p">(</span>
    <span class="n">vals</span><span class="p">:</span> <span class="n">jaxls</span><span class="o">.</span><span class="n">VarValues</span><span class="p">,</span>
    <span class="n">circle</span><span class="p">:</span> <span class="n">CircleVar</span><span class="p">,</span>
    <span class="n">point</span><span class="p">:</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;2D residual: error vector from closest circle point to observed point.&quot;&quot;&quot;</span>
    <span class="n">params</span> <span class="o">=</span> <span class="n">vals</span><span class="p">[</span><span class="n">circle</span><span class="p">]</span>
    <span class="n">cx</span><span class="p">,</span> <span class="n">cy</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">params</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">params</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">diff</span> <span class="o">=</span> <span class="n">point</span> <span class="o">-</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">cx</span><span class="p">,</span> <span class="n">cy</span><span class="p">])</span>
    <span class="n">dist</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">diff</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1e-8</span><span class="p">)</span>
    <span class="n">direction</span> <span class="o">=</span> <span class="n">diff</span> <span class="o">/</span> <span class="n">dist</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">dist</span> <span class="o">-</span> <span class="n">r</span><span class="p">)</span> <span class="o">*</span> <span class="n">direction</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create variable and costs.</span>
<span class="n">circle_var</span> <span class="o">=</span> <span class="n">CircleVar</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Initial guess: centroid of points, average distance as radius.</span>
<span class="n">centroid</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">avg_dist</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">points</span> <span class="o">-</span> <span class="n">centroid</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)))</span>
<span class="n">initial_params</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">centroid</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">centroid</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">avg_dist</span><span class="p">])</span>

<span class="c1"># Build problem with batched point indices.</span>
<span class="n">costs_standard</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">circle_residual</span><span class="p">(</span><span class="n">CircleVar</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_points</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">int32</span><span class="p">)),</span> <span class="n">points</span><span class="p">)</span>
<span class="p">]</span>

<span class="n">initial_vals</span> <span class="o">=</span> <span class="n">jaxls</span><span class="o">.</span><span class="n">VarValues</span><span class="o">.</span><span class="n">make</span><span class="p">([</span><span class="n">circle_var</span><span class="o">.</span><span class="n">with_value</span><span class="p">(</span><span class="n">initial_params</span><span class="p">)])</span>

<span class="c1"># Build the problem.</span>
<span class="n">problem_standard</span> <span class="o">=</span> <span class="n">jaxls</span><span class="o">.</span><span class="n">LeastSquaresProblem</span><span class="p">(</span><span class="n">costs_standard</span><span class="p">,</span> <span class="p">[</span><span class="n">circle_var</span><span class="p">])</span>

<span class="c1"># Visualize the problem structure structure.</span>
<span class="n">problem_standard</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
        <iframe
            width="100%"
            height="500"
            src="data:text/html;base64,PCFET0NUWVBFIGh0bWw+CjxodG1sPgo8aGVhZD4KICAgIDxtZXRhIGNoYXJzZXQ9InV0Zi04Ij4KICAgIDxzdHlsZT4KICAgICAgICBib2R5IHsgbWFyZ2luOiAwOyBvdmVyZmxvdzogaGlkZGVuOyB9CiAgICAgICAgI2NvbnRhaW5lciB7IHdpZHRoOiAxMDAlOyBoZWlnaHQ6IDEwMHZoOyBwb3NpdGlvbjogcmVsYXRpdmU7IH0KICAgICAgICBjYW52YXMgeyBkaXNwbGF5OiBibG9jazsgd2lkdGg6IDEwMCU7IGhlaWdodDogMTAwJTsgfQogICAgICAgIC5zdGF0dXMgeyBwb3NpdGlvbjogYWJzb2x1dGU7IGJvdHRvbTogNXB4OyByaWdodDogMTBweDsgZm9udC1zaXplOiAxMHB4OyBjb2xvcjogIzY2NjsgZm9udC1mYW1pbHk6IEhlbHZldGljYSwgQXJpYWwsIHNhbnMtc2VyaWY7IGJhY2tncm91bmQ6IHJnYmEoMjU1LDI1NSwyNTUsMC44KTsgcGFkZGluZzogMnB4IDVweDsgYm9yZGVyLXJhZGl1czogM3B4OyB9CiAgICA8L3N0eWxlPgo8L2hlYWQ+Cjxib2R5PgogICAgPGRpdiBpZD0iY29udGFpbmVyIj4KICAgICAgICA8Y2FudmFzPjwvY2FudmFzPgogICAgICAgIDxkaXYgY2xhc3M9InN0YXR1cyI+NTAgY29zdHMsIDEgdmFyaWFibGVzPC9kaXY+CiAgICA8L2Rpdj4KICAgIDxzY3JpcHQgc3JjPSJodHRwczovL2QzanMub3JnL2QzLnY3Lm1pbi5qcyI+PC9zY3JpcHQ+CiAgICA8c2NyaXB0PgogICAgKGZ1bmN0aW9uKCkgewogICAgICAgIGNvbnN0IGRhdGEgPSB7Im5vZGVzIjogW3siaWQiOiAidmFyXzAiLCAibGFiZWwiOiAiQ2lyY2xlVmFyKDApIiwgInR5cGUiOiAidmFyaWFibGUiLCAidmFyX3R5cGUiOiAiQ2lyY2xlVmFyIiwgImZpbGwiOiAiI2ZmY2NjYyIsICJzdHJva2UiOiAiI2NjNjY2NiJ9LCB7ImlkIjogImNvc3RfMCIsICJsYWJlbCI6ICJjaXJjbGVfcmVzaWR1YWwiLCAidHlwZSI6ICJjb3N0IiwgImtpbmQiOiAibDJfc3F1YXJlZCIsICJmaWxsIjogIiNhOGQ1ZmYiLCAic3Ryb2tlIjogIiM0YTkwZDkifSwgeyJpZCI6ICJjb3N0XzEiLCAibGFiZWwiOiAiY2lyY2xlX3Jlc2lkdWFsIiwgInR5cGUiOiAiY29zdCIsICJraW5kIjogImwyX3NxdWFyZWQiLCAiZmlsbCI6ICIjYThkNWZmIiwgInN0cm9rZSI6ICIjNGE5MGQ5In0sIHsiaWQiOiAiY29zdF8yIiwgImxhYmVsIjogImNpcmNsZV9yZXNpZHVhbCIsICJ0eXBlIjogImNvc3QiLCAia2luZCI6ICJsMl9zcXVhcmVkIiwgImZpbGwiOiAiI2E4ZDVmZiIsICJzdHJva2UiOiAiIzRhOTBkOSJ9LCB7ImlkIjogImNvc3RfMyIsICJsYWJlbCI6ICJjaXJjbGVfcmVzaWR1YWwiLCAidHlwZSI6ICJjb3N0IiwgImtpbmQiOiAibDJfc3F1YXJlZCIsICJmaWxsIjogIiNhOGQ1ZmYiLCAic3Ryb2tlIjogIiM0YTkwZDkifSwgeyJpZCI6ICJjb3N0XzQiLCAibGFiZWwiOiAiY2lyY2xlX3Jlc2lkdWFsIiwgInR5cGUiOiAiY29zdCIsICJraW5kIjogImwyX3NxdWFyZWQiLCAiZmlsbCI6ICIjYThkNWZmIiwgInN0cm9rZSI6ICIjNGE5MGQ5In0sIHsiaWQiOiAiY29zdF81IiwgImxhYmVsIjogImNpcmNsZV9yZXNpZHVhbCIsICJ0eXBlIjogImNvc3QiLCAia2luZCI6ICJsMl9zcXVhcmVkIiwgImZpbGwiOiAiI2E4ZDVmZiIsICJzdHJva2UiOiAiIzRhOTBkOSJ9LCB7ImlkIjogImNvc3RfNiIsICJsYWJlbCI6ICJjaXJjbGVfcmVzaWR1YWwiLCAidHlwZSI6ICJjb3N0IiwgImtpbmQiOiAibDJfc3F1YXJlZCIsICJmaWxsIjogIiNhOGQ1ZmYiLCAic3Ryb2tlIjogIiM0YTkwZDkifSwgeyJpZCI6ICJjb3N0XzciLCAibGFiZWwiOiAiY2lyY2xlX3Jlc2lkdWFsIiwgInR5cGUiOiAiY29zdCIsICJraW5kIjogImwyX3NxdWFyZWQiLCAiZmlsbCI6ICIjYThkNWZmIiwgInN0cm9rZSI6ICIjNGE5MGQ5In0sIHsiaWQiOiAiY29zdF84IiwgImxhYmVsIjogImNpcmNsZV9yZXNpZHVhbCIsICJ0eXBlIjogImNvc3QiLCAia2luZCI6ICJsMl9zcXVhcmVkIiwgImZpbGwiOiAiI2E4ZDVmZiIsICJzdHJva2UiOiAiIzRhOTBkOSJ9LCB7ImlkIjogImNvc3RfOSIsICJsYWJlbCI6ICJjaXJjbGVfcmVzaWR1YWwiLCAidHlwZSI6ICJjb3N0IiwgImtpbmQiOiAibDJfc3F1YXJlZCIsICJmaWxsIjogIiNhOGQ1ZmYiLCAic3Ryb2tlIjogIiM0YTkwZDkifSwgeyJpZCI6ICJjb3N0XzEwIiwgImxhYmVsIjogImNpcmNsZV9yZXNpZHVhbCIsICJ0eXBlIjogImNvc3QiLCAia2luZCI6ICJsMl9zcXVhcmVkIiwgImZpbGwiOiAiI2E4ZDVmZiIsICJzdHJva2UiOiAiIzRhOTBkOSJ9LCB7ImlkIjogImNvc3RfMTEiLCAibGFiZWwiOiAiY2lyY2xlX3Jlc2lkdWFsIiwgInR5cGUiOiAiY29zdCIsICJraW5kIjogImwyX3NxdWFyZWQiLCAiZmlsbCI6ICIjYThkNWZmIiwgInN0cm9rZSI6ICIjNGE5MGQ5In0sIHsiaWQiOiAiY29zdF8xMiIsICJsYWJlbCI6ICJjaXJjbGVfcmVzaWR1YWwiLCAidHlwZSI6ICJjb3N0IiwgImtpbmQiOiAibDJfc3F1YXJlZCIsICJmaWxsIjogIiNhOGQ1ZmYiLCAic3Ryb2tlIjogIiM0YTkwZDkifSwgeyJpZCI6ICJjb3N0XzEzIiwgImxhYmVsIjogImNpcmNsZV9yZXNpZHVhbCIsICJ0eXBlIjogImNvc3QiLCAia2luZCI6ICJsMl9zcXVhcmVkIiwgImZpbGwiOiAiI2E4ZDVmZiIsICJzdHJva2UiOiAiIzRhOTBkOSJ9LCB7ImlkIjogImNvc3RfMTQiLCAibGFiZWwiOiAiY2lyY2xlX3Jlc2lkdWFsIiwgInR5cGUiOiAiY29zdCIsICJraW5kIjogImwyX3NxdWFyZWQiLCAiZmlsbCI6ICIjYThkNWZmIiwgInN0cm9rZSI6ICIjNGE5MGQ5In0sIHsiaWQiOiAiY29zdF8xNSIsICJsYWJlbCI6ICJjaXJjbGVfcmVzaWR1YWwiLCAidHlwZSI6ICJjb3N0IiwgImtpbmQiOiAibDJfc3F1YXJlZCIsICJmaWxsIjogIiNhOGQ1ZmYiLCAic3Ryb2tlIjogIiM0YTkwZDkifSwgeyJpZCI6ICJjb3N0XzE2IiwgImxhYmVsIjogImNpcmNsZV9yZXNpZHVhbCIsICJ0eXBlIjogImNvc3QiLCAia2luZCI6ICJsMl9zcXVhcmVkIiwgImZpbGwiOiAiI2E4ZDVmZiIsICJzdHJva2UiOiAiIzRhOTBkOSJ9LCB7ImlkIjogImNvc3RfMTciLCAibGFiZWwiOiAiY2lyY2xlX3Jlc2lkdWFsIiwgInR5cGUiOiAiY29zdCIsICJraW5kIjogImwyX3NxdWFyZWQiLCAiZmlsbCI6ICIjYThkNWZmIiwgInN0cm9rZSI6ICIjNGE5MGQ5In0sIHsiaWQiOiAiY29zdF8xOCIsICJsYWJlbCI6ICJjaXJjbGVfcmVzaWR1YWwiLCAidHlwZSI6ICJjb3N0IiwgImtpbmQiOiAibDJfc3F1YXJlZCIsICJmaWxsIjogIiNhOGQ1ZmYiLCAic3Ryb2tlIjogIiM0YTkwZDkifSwgeyJpZCI6ICJjb3N0XzE5IiwgImxhYmVsIjogImNpcmNsZV9yZXNpZHVhbCIsICJ0eXBlIjogImNvc3QiLCAia2luZCI6ICJsMl9zcXVhcmVkIiwgImZpbGwiOiAiI2E4ZDVmZiIsICJzdHJva2UiOiAiIzRhOTBkOSJ9LCB7ImlkIjogImNvc3RfMjAiLCAibGFiZWwiOiAiY2lyY2xlX3Jlc2lkdWFsIiwgInR5cGUiOiAiY29zdCIsICJraW5kIjogImwyX3NxdWFyZWQiLCAiZmlsbCI6ICIjYThkNWZmIiwgInN0cm9rZSI6ICIjNGE5MGQ5In0sIHsiaWQiOiAiY29zdF8yMSIsICJsYWJlbCI6ICJjaXJjbGVfcmVzaWR1YWwiLCAidHlwZSI6ICJjb3N0IiwgImtpbmQiOiAibDJfc3F1YXJlZCIsICJmaWxsIjogIiNhOGQ1ZmYiLCAic3Ryb2tlIjogIiM0YTkwZDkifSwgeyJpZCI6ICJjb3N0XzIyIiwgImxhYmVsIjogImNpcmNsZV9yZXNpZHVhbCIsICJ0eXBlIjogImNvc3QiLCAia2luZCI6ICJsMl9zcXVhcmVkIiwgImZpbGwiOiAiI2E4ZDVmZiIsICJzdHJva2UiOiAiIzRhOTBkOSJ9LCB7ImlkIjogImNvc3RfMjMiLCAibGFiZWwiOiAiY2lyY2xlX3Jlc2lkdWFsIiwgInR5cGUiOiAiY29zdCIsICJraW5kIjogImwyX3NxdWFyZWQiLCAiZmlsbCI6ICIjYThkNWZmIiwgInN0cm9rZSI6ICIjNGE5MGQ5In0sIHsiaWQiOiAiY29zdF8yNCIsICJsYWJlbCI6ICJjaXJjbGVfcmVzaWR1YWwiLCAidHlwZSI6ICJjb3N0IiwgImtpbmQiOiAibDJfc3F1YXJlZCIsICJmaWxsIjogIiNhOGQ1ZmYiLCAic3Ryb2tlIjogIiM0YTkwZDkifSwgeyJpZCI6ICJjb3N0XzI1IiwgImxhYmVsIjogImNpcmNsZV9yZXNpZHVhbCIsICJ0eXBlIjogImNvc3QiLCAia2luZCI6ICJsMl9zcXVhcmVkIiwgImZpbGwiOiAiI2E4ZDVmZiIsICJzdHJva2UiOiAiIzRhOTBkOSJ9LCB7ImlkIjogImNvc3RfMjYiLCAibGFiZWwiOiAiY2lyY2xlX3Jlc2lkdWFsIiwgInR5cGUiOiAiY29zdCIsICJraW5kIjogImwyX3NxdWFyZWQiLCAiZmlsbCI6ICIjYThkNWZmIiwgInN0cm9rZSI6ICIjNGE5MGQ5In0sIHsiaWQiOiAiY29zdF8yNyIsICJsYWJlbCI6ICJjaXJjbGVfcmVzaWR1YWwiLCAidHlwZSI6ICJjb3N0IiwgImtpbmQiOiAibDJfc3F1YXJlZCIsICJmaWxsIjogIiNhOGQ1ZmYiLCAic3Ryb2tlIjogIiM0YTkwZDkifSwgeyJpZCI6ICJjb3N0XzI4IiwgImxhYmVsIjogImNpcmNsZV9yZXNpZHVhbCIsICJ0eXBlIjogImNvc3QiLCAia2luZCI6ICJsMl9zcXVhcmVkIiwgImZpbGwiOiAiI2E4ZDVmZiIsICJzdHJva2UiOiAiIzRhOTBkOSJ9LCB7ImlkIjogImNvc3RfMjkiLCAibGFiZWwiOiAiY2lyY2xlX3Jlc2lkdWFsIiwgInR5cGUiOiAiY29zdCIsICJraW5kIjogImwyX3NxdWFyZWQiLCAiZmlsbCI6ICIjYThkNWZmIiwgInN0cm9rZSI6ICIjNGE5MGQ5In0sIHsiaWQiOiAiY29zdF8zMCIsICJsYWJlbCI6ICJjaXJjbGVfcmVzaWR1YWwiLCAidHlwZSI6ICJjb3N0IiwgImtpbmQiOiAibDJfc3F1YXJlZCIsICJmaWxsIjogIiNhOGQ1ZmYiLCAic3Ryb2tlIjogIiM0YTkwZDkifSwgeyJpZCI6ICJjb3N0XzMxIiwgImxhYmVsIjogImNpcmNsZV9yZXNpZHVhbCIsICJ0eXBlIjogImNvc3QiLCAia2luZCI6ICJsMl9zcXVhcmVkIiwgImZpbGwiOiAiI2E4ZDVmZiIsICJzdHJva2UiOiAiIzRhOTBkOSJ9LCB7ImlkIjogImNvc3RfMzIiLCAibGFiZWwiOiAiY2lyY2xlX3Jlc2lkdWFsIiwgInR5cGUiOiAiY29zdCIsICJraW5kIjogImwyX3NxdWFyZWQiLCAiZmlsbCI6ICIjYThkNWZmIiwgInN0cm9rZSI6ICIjNGE5MGQ5In0sIHsiaWQiOiAiY29zdF8zMyIsICJsYWJlbCI6ICJjaXJjbGVfcmVzaWR1YWwiLCAidHlwZSI6ICJjb3N0IiwgImtpbmQiOiAibDJfc3F1YXJlZCIsICJmaWxsIjogIiNhOGQ1ZmYiLCAic3Ryb2tlIjogIiM0YTkwZDkifSwgeyJpZCI6ICJjb3N0XzM0IiwgImxhYmVsIjogImNpcmNsZV9yZXNpZHVhbCIsICJ0eXBlIjogImNvc3QiLCAia2luZCI6ICJsMl9zcXVhcmVkIiwgImZpbGwiOiAiI2E4ZDVmZiIsICJzdHJva2UiOiAiIzRhOTBkOSJ9LCB7ImlkIjogImNvc3RfMzUiLCAibGFiZWwiOiAiY2lyY2xlX3Jlc2lkdWFsIiwgInR5cGUiOiAiY29zdCIsICJraW5kIjogImwyX3NxdWFyZWQiLCAiZmlsbCI6ICIjYThkNWZmIiwgInN0cm9rZSI6ICIjNGE5MGQ5In0sIHsiaWQiOiAiY29zdF8zNiIsICJsYWJlbCI6ICJjaXJjbGVfcmVzaWR1YWwiLCAidHlwZSI6ICJjb3N0IiwgImtpbmQiOiAibDJfc3F1YXJlZCIsICJmaWxsIjogIiNhOGQ1ZmYiLCAic3Ryb2tlIjogIiM0YTkwZDkifSwgeyJpZCI6ICJjb3N0XzM3IiwgImxhYmVsIjogImNpcmNsZV9yZXNpZHVhbCIsICJ0eXBlIjogImNvc3QiLCAia2luZCI6ICJsMl9zcXVhcmVkIiwgImZpbGwiOiAiI2E4ZDVmZiIsICJzdHJva2UiOiAiIzRhOTBkOSJ9LCB7ImlkIjogImNvc3RfMzgiLCAibGFiZWwiOiAiY2lyY2xlX3Jlc2lkdWFsIiwgInR5cGUiOiAiY29zdCIsICJraW5kIjogImwyX3NxdWFyZWQiLCAiZmlsbCI6ICIjYThkNWZmIiwgInN0cm9rZSI6ICIjNGE5MGQ5In0sIHsiaWQiOiAiY29zdF8zOSIsICJsYWJlbCI6ICJjaXJjbGVfcmVzaWR1YWwiLCAidHlwZSI6ICJjb3N0IiwgImtpbmQiOiAibDJfc3F1YXJlZCIsICJmaWxsIjogIiNhOGQ1ZmYiLCAic3Ryb2tlIjogIiM0YTkwZDkifSwgeyJpZCI6ICJjb3N0XzQwIiwgImxhYmVsIjogImNpcmNsZV9yZXNpZHVhbCIsICJ0eXBlIjogImNvc3QiLCAia2luZCI6ICJsMl9zcXVhcmVkIiwgImZpbGwiOiAiI2E4ZDVmZiIsICJzdHJva2UiOiAiIzRhOTBkOSJ9LCB7ImlkIjogImNvc3RfNDEiLCAibGFiZWwiOiAiY2lyY2xlX3Jlc2lkdWFsIiwgInR5cGUiOiAiY29zdCIsICJraW5kIjogImwyX3NxdWFyZWQiLCAiZmlsbCI6ICIjYThkNWZmIiwgInN0cm9rZSI6ICIjNGE5MGQ5In0sIHsiaWQiOiAiY29zdF80MiIsICJsYWJlbCI6ICJjaXJjbGVfcmVzaWR1YWwiLCAidHlwZSI6ICJjb3N0IiwgImtpbmQiOiAibDJfc3F1YXJlZCIsICJmaWxsIjogIiNhOGQ1ZmYiLCAic3Ryb2tlIjogIiM0YTkwZDkifSwgeyJpZCI6ICJjb3N0XzQzIiwgImxhYmVsIjogImNpcmNsZV9yZXNpZHVhbCIsICJ0eXBlIjogImNvc3QiLCAia2luZCI6ICJsMl9zcXVhcmVkIiwgImZpbGwiOiAiI2E4ZDVmZiIsICJzdHJva2UiOiAiIzRhOTBkOSJ9LCB7ImlkIjogImNvc3RfNDQiLCAibGFiZWwiOiAiY2lyY2xlX3Jlc2lkdWFsIiwgInR5cGUiOiAiY29zdCIsICJraW5kIjogImwyX3NxdWFyZWQiLCAiZmlsbCI6ICIjYThkNWZmIiwgInN0cm9rZSI6ICIjNGE5MGQ5In0sIHsiaWQiOiAiY29zdF80NSIsICJsYWJlbCI6ICJjaXJjbGVfcmVzaWR1YWwiLCAidHlwZSI6ICJjb3N0IiwgImtpbmQiOiAibDJfc3F1YXJlZCIsICJmaWxsIjogIiNhOGQ1ZmYiLCAic3Ryb2tlIjogIiM0YTkwZDkifSwgeyJpZCI6ICJjb3N0XzQ2IiwgImxhYmVsIjogImNpcmNsZV9yZXNpZHVhbCIsICJ0eXBlIjogImNvc3QiLCAia2luZCI6ICJsMl9zcXVhcmVkIiwgImZpbGwiOiAiI2E4ZDVmZiIsICJzdHJva2UiOiAiIzRhOTBkOSJ9LCB7ImlkIjogImNvc3RfNDciLCAibGFiZWwiOiAiY2lyY2xlX3Jlc2lkdWFsIiwgInR5cGUiOiAiY29zdCIsICJraW5kIjogImwyX3NxdWFyZWQiLCAiZmlsbCI6ICIjYThkNWZmIiwgInN0cm9rZSI6ICIjNGE5MGQ5In0sIHsiaWQiOiAiY29zdF80OCIsICJsYWJlbCI6ICJjaXJjbGVfcmVzaWR1YWwiLCAidHlwZSI6ICJjb3N0IiwgImtpbmQiOiAibDJfc3F1YXJlZCIsICJmaWxsIjogIiNhOGQ1ZmYiLCAic3Ryb2tlIjogIiM0YTkwZDkifSwgeyJpZCI6ICJjb3N0XzQ5IiwgImxhYmVsIjogImNpcmNsZV9yZXNpZHVhbCIsICJ0eXBlIjogImNvc3QiLCAia2luZCI6ICJsMl9zcXVhcmVkIiwgImZpbGwiOiAiI2E4ZDVmZiIsICJzdHJva2UiOiAiIzRhOTBkOSJ9XSwgImxpbmtzIjogW3sic291cmNlIjogImNvc3RfMCIsICJ0YXJnZXQiOiAidmFyXzAifSwgeyJzb3VyY2UiOiAiY29zdF8xIiwgInRhcmdldCI6ICJ2YXJfMCJ9LCB7InNvdXJjZSI6ICJjb3N0XzIiLCAidGFyZ2V0IjogInZhcl8wIn0sIHsic291cmNlIjogImNvc3RfMyIsICJ0YXJnZXQiOiAidmFyXzAifSwgeyJzb3VyY2UiOiAiY29zdF80IiwgInRhcmdldCI6ICJ2YXJfMCJ9LCB7InNvdXJjZSI6ICJjb3N0XzUiLCAidGFyZ2V0IjogInZhcl8wIn0sIHsic291cmNlIjogImNvc3RfNiIsICJ0YXJnZXQiOiAidmFyXzAifSwgeyJzb3VyY2UiOiAiY29zdF83IiwgInRhcmdldCI6ICJ2YXJfMCJ9LCB7InNvdXJjZSI6ICJjb3N0XzgiLCAidGFyZ2V0IjogInZhcl8wIn0sIHsic291cmNlIjogImNvc3RfOSIsICJ0YXJnZXQiOiAidmFyXzAifSwgeyJzb3VyY2UiOiAiY29zdF8xMCIsICJ0YXJnZXQiOiAidmFyXzAifSwgeyJzb3VyY2UiOiAiY29zdF8xMSIsICJ0YXJnZXQiOiAidmFyXzAifSwgeyJzb3VyY2UiOiAiY29zdF8xMiIsICJ0YXJnZXQiOiAidmFyXzAifSwgeyJzb3VyY2UiOiAiY29zdF8xMyIsICJ0YXJnZXQiOiAidmFyXzAifSwgeyJzb3VyY2UiOiAiY29zdF8xNCIsICJ0YXJnZXQiOiAidmFyXzAifSwgeyJzb3VyY2UiOiAiY29zdF8xNSIsICJ0YXJnZXQiOiAidmFyXzAifSwgeyJzb3VyY2UiOiAiY29zdF8xNiIsICJ0YXJnZXQiOiAidmFyXzAifSwgeyJzb3VyY2UiOiAiY29zdF8xNyIsICJ0YXJnZXQiOiAidmFyXzAifSwgeyJzb3VyY2UiOiAiY29zdF8xOCIsICJ0YXJnZXQiOiAidmFyXzAifSwgeyJzb3VyY2UiOiAiY29zdF8xOSIsICJ0YXJnZXQiOiAidmFyXzAifSwgeyJzb3VyY2UiOiAiY29zdF8yMCIsICJ0YXJnZXQiOiAidmFyXzAifSwgeyJzb3VyY2UiOiAiY29zdF8yMSIsICJ0YXJnZXQiOiAidmFyXzAifSwgeyJzb3VyY2UiOiAiY29zdF8yMiIsICJ0YXJnZXQiOiAidmFyXzAifSwgeyJzb3VyY2UiOiAiY29zdF8yMyIsICJ0YXJnZXQiOiAidmFyXzAifSwgeyJzb3VyY2UiOiAiY29zdF8yNCIsICJ0YXJnZXQiOiAidmFyXzAifSwgeyJzb3VyY2UiOiAiY29zdF8yNSIsICJ0YXJnZXQiOiAidmFyXzAifSwgeyJzb3VyY2UiOiAiY29zdF8yNiIsICJ0YXJnZXQiOiAidmFyXzAifSwgeyJzb3VyY2UiOiAiY29zdF8yNyIsICJ0YXJnZXQiOiAidmFyXzAifSwgeyJzb3VyY2UiOiAiY29zdF8yOCIsICJ0YXJnZXQiOiAidmFyXzAifSwgeyJzb3VyY2UiOiAiY29zdF8yOSIsICJ0YXJnZXQiOiAidmFyXzAifSwgeyJzb3VyY2UiOiAiY29zdF8zMCIsICJ0YXJnZXQiOiAidmFyXzAifSwgeyJzb3VyY2UiOiAiY29zdF8zMSIsICJ0YXJnZXQiOiAidmFyXzAifSwgeyJzb3VyY2UiOiAiY29zdF8zMiIsICJ0YXJnZXQiOiAidmFyXzAifSwgeyJzb3VyY2UiOiAiY29zdF8zMyIsICJ0YXJnZXQiOiAidmFyXzAifSwgeyJzb3VyY2UiOiAiY29zdF8zNCIsICJ0YXJnZXQiOiAidmFyXzAifSwgeyJzb3VyY2UiOiAiY29zdF8zNSIsICJ0YXJnZXQiOiAidmFyXzAifSwgeyJzb3VyY2UiOiAiY29zdF8zNiIsICJ0YXJnZXQiOiAidmFyXzAifSwgeyJzb3VyY2UiOiAiY29zdF8zNyIsICJ0YXJnZXQiOiAidmFyXzAifSwgeyJzb3VyY2UiOiAiY29zdF8zOCIsICJ0YXJnZXQiOiAidmFyXzAifSwgeyJzb3VyY2UiOiAiY29zdF8zOSIsICJ0YXJnZXQiOiAidmFyXzAifSwgeyJzb3VyY2UiOiAiY29zdF80MCIsICJ0YXJnZXQiOiAidmFyXzAifSwgeyJzb3VyY2UiOiAiY29zdF80MSIsICJ0YXJnZXQiOiAidmFyXzAifSwgeyJzb3VyY2UiOiAiY29zdF80MiIsICJ0YXJnZXQiOiAidmFyXzAifSwgeyJzb3VyY2UiOiAiY29zdF80MyIsICJ0YXJnZXQiOiAidmFyXzAifSwgeyJzb3VyY2UiOiAiY29zdF80NCIsICJ0YXJnZXQiOiAidmFyXzAifSwgeyJzb3VyY2UiOiAiY29zdF80NSIsICJ0YXJnZXQiOiAidmFyXzAifSwgeyJzb3VyY2UiOiAiY29zdF80NiIsICJ0YXJnZXQiOiAidmFyXzAifSwgeyJzb3VyY2UiOiAiY29zdF80NyIsICJ0YXJnZXQiOiAidmFyXzAifSwgeyJzb3VyY2UiOiAiY29zdF80OCIsICJ0YXJnZXQiOiAidmFyXzAifSwgeyJzb3VyY2UiOiAiY29zdF80OSIsICJ0YXJnZXQiOiAidmFyXzAifV0sICJ0cnVuY2F0ZWQiOiBmYWxzZX07CiAgICAgICAgY29uc3QgY29udGFpbmVyID0gZDMuc2VsZWN0KCIjY29udGFpbmVyIik7CiAgICAgICAgY29uc3QgY2FudmFzID0gY29udGFpbmVyLnNlbGVjdCgiY2FudmFzIikubm9kZSgpOwogICAgICAgIGNvbnN0IGN0eCA9IGNhbnZhcy5nZXRDb250ZXh0KCIyZCIpOwoKICAgIC8vIEdldCBhY3R1YWwgY29udGFpbmVyIGRpbWVuc2lvbnMuCiAgICBjb25zdCByZWN0ID0gY29udGFpbmVyLm5vZGUoKS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsKICAgIGNvbnN0IHdpZHRoID0gcmVjdC53aWR0aDsKICAgIGNvbnN0IGhlaWdodCA9IHJlY3QuaGVpZ2h0OwoKICAgIC8vIE5vZGUgc2l6aW5nLgogICAgY29uc3QgdmFyUnggPSA0NSwgdmFyUnkgPSAxNDsgIC8vIEVsbGlwc2UgcmFkaWkgZm9yIHZhcmlhYmxlcy4KICAgIGNvbnN0IGNvc3RXID0gOTAsIGNvc3RIID0gMjI7ICAgLy8gUmVjdCBzaXplIGZvciBjb3N0cy4KCiAgICAvLyBTZXQgdXAgaGlnaC1EUEkgY2FudmFzLgogICAgY29uc3QgZHByID0gd2luZG93LmRldmljZVBpeGVsUmF0aW8gfHwgMTsKICAgIGNhbnZhcy53aWR0aCA9IHdpZHRoICogZHByOwogICAgY2FudmFzLmhlaWdodCA9IGhlaWdodCAqIGRwcjsKICAgIGN0eC5zY2FsZShkcHIsIGRwcik7CgogICAgLy8gVHJhY2sgdHJhbnNmb3JtIGZvciB6b29tL3Bhbi4KICAgIGxldCB0cmFuc2Zvcm0gPSBkMy56b29tSWRlbnRpdHk7CgogICAgLy8gQ3JlYXRlIGZvcmNlIHNpbXVsYXRpb24uCiAgICBjb25zdCBzaW11bGF0aW9uID0gZDMuZm9yY2VTaW11bGF0aW9uKGRhdGEubm9kZXMpCiAgICAgICAgLmZvcmNlKCJsaW5rIiwgZDMuZm9yY2VMaW5rKGRhdGEubGlua3MpLmlkKGQgPT4gZC5pZCkuZGlzdGFuY2UoNjApKQogICAgICAgIC5mb3JjZSgiY2hhcmdlIiwgZDMuZm9yY2VNYW55Qm9keSgpLnN0cmVuZ3RoKC0xNTApLmRpc3RhbmNlTWF4KDI1MCkpCiAgICAgICAgLmZvcmNlKCJjZW50ZXIiLCBkMy5mb3JjZUNlbnRlcih3aWR0aCAvIDIsIGhlaWdodCAvIDIpKQogICAgICAgIC5mb3JjZSgiY29sbGlzaW9uIiwgZDMuZm9yY2VDb2xsaWRlKCkucmFkaXVzKDM1KSk7CgogICAgLy8gRHJhZyBzdGF0ZS4KICAgIGxldCBkcmFnTm9kZSA9IG51bGw7CgogICAgLy8gRmluZCBub2RlIGF0IHBvc2l0aW9uLgogICAgZnVuY3Rpb24gbm9kZUF0KHgsIHkpIHsKICAgICAgICBjb25zdCB0eCA9ICh4IC0gdHJhbnNmb3JtLngpIC8gdHJhbnNmb3JtLms7CiAgICAgICAgY29uc3QgdHkgPSAoeSAtIHRyYW5zZm9ybS55KSAvIHRyYW5zZm9ybS5rOwogICAgICAgIGZvciAobGV0IGkgPSBkYXRhLm5vZGVzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7CiAgICAgICAgICAgIGNvbnN0IGQgPSBkYXRhLm5vZGVzW2ldOwogICAgICAgICAgICBjb25zdCBkeCA9IHR4IC0gZC54OwogICAgICAgICAgICBjb25zdCBkeSA9IHR5IC0gZC55OwogICAgICAgICAgICBpZiAoZC50eXBlID09PSAidmFyaWFibGUiKSB7CiAgICAgICAgICAgICAgICBpZiAoKGR4KmR4KS8odmFyUngqdmFyUngpICsgKGR5KmR5KS8odmFyUnkqdmFyUnkpIDwgMSkgcmV0dXJuIGQ7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBpZiAoTWF0aC5hYnMoZHgpIDwgY29zdFcvMiAmJiBNYXRoLmFicyhkeSkgPCBjb3N0SC8yKSByZXR1cm4gZDsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZXR1cm4gbnVsbDsKICAgIH0KCiAgICBmdW5jdGlvbiBkcmF3KCkgewogICAgICAgIGN0eC5zYXZlKCk7CiAgICAgICAgY3R4LmNsZWFyUmVjdCgwLCAwLCB3aWR0aCwgaGVpZ2h0KTsKICAgICAgICBjdHgudHJhbnNsYXRlKHRyYW5zZm9ybS54LCB0cmFuc2Zvcm0ueSk7CiAgICAgICAgY3R4LnNjYWxlKHRyYW5zZm9ybS5rLCB0cmFuc2Zvcm0uayk7CgogICAgICAgIC8vIERyYXcgbGlua3MuCiAgICAgICAgY3R4LnN0cm9rZVN0eWxlID0gIiM5OTkiOwogICAgICAgIGN0eC5nbG9iYWxBbHBoYSA9IDAuNjsKICAgICAgICBjdHgubGluZVdpZHRoID0gMS41IC8gdHJhbnNmb3JtLms7CiAgICAgICAgY3R4LmJlZ2luUGF0aCgpOwogICAgICAgIGRhdGEubGlua3MuZm9yRWFjaChkID0+IHsKICAgICAgICAgICAgY3R4Lm1vdmVUbyhkLnNvdXJjZS54LCBkLnNvdXJjZS55KTsKICAgICAgICAgICAgY3R4LmxpbmVUbyhkLnRhcmdldC54LCBkLnRhcmdldC55KTsKICAgICAgICB9KTsKICAgICAgICBjdHguc3Ryb2tlKCk7CiAgICAgICAgY3R4Lmdsb2JhbEFscGhhID0gMS4wOwoKICAgICAgICAvLyBEcmF3IG5vZGVzLgogICAgICAgIGRhdGEubm9kZXMuZm9yRWFjaChkID0+IHsKICAgICAgICAgICAgY3R4LnNhdmUoKTsKICAgICAgICAgICAgY3R4LnRyYW5zbGF0ZShkLngsIGQueSk7CgogICAgICAgICAgICBpZiAoZC50eXBlID09PSAidmFyaWFibGUiKSB7CiAgICAgICAgICAgICAgICAvLyBFbGxpcHNlIGZvciB2YXJpYWJsZXMuCiAgICAgICAgICAgICAgICBjdHguYmVnaW5QYXRoKCk7CiAgICAgICAgICAgICAgICBjdHguZWxsaXBzZSgwLCAwLCB2YXJSeCwgdmFyUnksIDAsIDAsIDIgKiBNYXRoLlBJKTsKICAgICAgICAgICAgICAgIGN0eC5maWxsU3R5bGUgPSBkLmZpbGw7CiAgICAgICAgICAgICAgICBjdHguZmlsbCgpOwogICAgICAgICAgICAgICAgY3R4LnN0cm9rZVN0eWxlID0gZC5zdHJva2U7CiAgICAgICAgICAgICAgICBjdHgubGluZVdpZHRoID0gMS41IC8gdHJhbnNmb3JtLms7CiAgICAgICAgICAgICAgICBjdHguc3Ryb2tlKCk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAvLyBSb3VuZGVkIHJlY3QgZm9yIGNvc3RzLgogICAgICAgICAgICAgICAgY29uc3QgdyA9IGNvc3RXLCBoID0gY29zdEgsIHIgPSA0OwogICAgICAgICAgICAgICAgY3R4LmJlZ2luUGF0aCgpOwogICAgICAgICAgICAgICAgY3R4Lm1vdmVUbygtdy8yICsgciwgLWgvMik7CiAgICAgICAgICAgICAgICBjdHgubGluZVRvKHcvMiAtIHIsIC1oLzIpOwogICAgICAgICAgICAgICAgY3R4LnF1YWRyYXRpY0N1cnZlVG8ody8yLCAtaC8yLCB3LzIsIC1oLzIgKyByKTsKICAgICAgICAgICAgICAgIGN0eC5saW5lVG8ody8yLCBoLzIgLSByKTsKICAgICAgICAgICAgICAgIGN0eC5xdWFkcmF0aWNDdXJ2ZVRvKHcvMiwgaC8yLCB3LzIgLSByLCBoLzIpOwogICAgICAgICAgICAgICAgY3R4LmxpbmVUbygtdy8yICsgciwgaC8yKTsKICAgICAgICAgICAgICAgIGN0eC5xdWFkcmF0aWNDdXJ2ZVRvKC13LzIsIGgvMiwgLXcvMiwgaC8yIC0gcik7CiAgICAgICAgICAgICAgICBjdHgubGluZVRvKC13LzIsIC1oLzIgKyByKTsKICAgICAgICAgICAgICAgIGN0eC5xdWFkcmF0aWNDdXJ2ZVRvKC13LzIsIC1oLzIsIC13LzIgKyByLCAtaC8yKTsKICAgICAgICAgICAgICAgIGN0eC5jbG9zZVBhdGgoKTsKICAgICAgICAgICAgICAgIGN0eC5maWxsU3R5bGUgPSBkLmZpbGw7CiAgICAgICAgICAgICAgICBjdHguZmlsbCgpOwogICAgICAgICAgICAgICAgY3R4LnN0cm9rZVN0eWxlID0gZC5zdHJva2U7CiAgICAgICAgICAgICAgICBjdHgubGluZVdpZHRoID0gMS41IC8gdHJhbnNmb3JtLms7CiAgICAgICAgICAgICAgICBjdHguc3Ryb2tlKCk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vIERyYXcgbGFiZWwuCiAgICAgICAgICAgIGN0eC5maWxsU3R5bGUgPSAiIzAwMCI7CiAgICAgICAgICAgIGN0eC5mb250ID0gIjlweCBIZWx2ZXRpY2EsIEFyaWFsLCBzYW5zLXNlcmlmIjsKICAgICAgICAgICAgY3R4LnRleHRBbGlnbiA9ICJjZW50ZXIiOwogICAgICAgICAgICBjdHgudGV4dEJhc2VsaW5lID0gIm1pZGRsZSI7CiAgICAgICAgICAgIGN0eC5maWxsVGV4dChkLmxhYmVsLCAwLCAwKTsKCiAgICAgICAgICAgIGN0eC5yZXN0b3JlKCk7CiAgICAgICAgfSk7CgogICAgICAgIC8vIERyYXcgbGVnZW5kLgogICAgICAgIGN0eC5yZXN0b3JlKCk7CiAgICAgICAgZHJhd0xlZ2VuZCgpOwogICAgfQoKICAgIGZ1bmN0aW9uIGRyYXdMZWdlbmQoKSB7CiAgICAgICAgLy8gQnVpbGQgbGVnZW5kIGR5bmFtaWNhbGx5IGZyb20gYWN0dWFsIG5vZGVzLgogICAgICAgIGNvbnN0IGxlZ2VuZERhdGEgPSBbXTsKCiAgICAgICAgLy8gQ29sbGVjdCB1bmlxdWUgY29zdCBraW5kcy4KICAgICAgICBjb25zdCBjb3N0S2luZExhYmVscyA9IHsKICAgICAgICAgICAgImwyX3NxdWFyZWQiOiAiQ29zdCAoTDIpIiwKICAgICAgICAgICAgImNvbnN0cmFpbnRfZXFfemVybyI6ICJFcXVhbGl0eSIsCiAgICAgICAgICAgICJjb25zdHJhaW50X2xlcV96ZXJvIjogIkluZXF1YWxpdHkgKOKJpCkiLAogICAgICAgICAgICAiY29uc3RyYWludF9nZXFfemVybyI6ICJJbmVxdWFsaXR5ICjiiaUpIgogICAgICAgIH07CiAgICAgICAgY29uc3Qgc2VlbkNvc3RLaW5kcyA9IG5ldyBTZXQoKTsKICAgICAgICBkYXRhLm5vZGVzLmZpbHRlcihuID0+IG4udHlwZSA9PT0gImNvc3QiKS5mb3JFYWNoKG4gPT4gc2VlbkNvc3RLaW5kcy5hZGQobi5raW5kKSk7CiAgICAgICAgZm9yIChjb25zdCBraW5kIG9mIFsibDJfc3F1YXJlZCIsICJjb25zdHJhaW50X2VxX3plcm8iLCAiY29uc3RyYWludF9sZXFfemVybyIsICJjb25zdHJhaW50X2dlcV96ZXJvIl0pIHsKICAgICAgICAgICAgaWYgKHNlZW5Db3N0S2luZHMuaGFzKGtpbmQpKSB7CiAgICAgICAgICAgICAgICBjb25zdCBub2RlID0gZGF0YS5ub2Rlcy5maW5kKG4gPT4gbi50eXBlID09PSAiY29zdCIgJiYgbi5raW5kID09PSBraW5kKTsKICAgICAgICAgICAgICAgIGxlZ2VuZERhdGEucHVzaCh7CiAgICAgICAgICAgICAgICAgICAgbGFiZWw6IGNvc3RLaW5kTGFiZWxzW2tpbmRdLAogICAgICAgICAgICAgICAgICAgIGZpbGw6IG5vZGUuZmlsbCwKICAgICAgICAgICAgICAgICAgICBzdHJva2U6IG5vZGUuc3Ryb2tlLAogICAgICAgICAgICAgICAgICAgIHR5cGU6ICJjb3N0IgogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIC8vIENvbGxlY3QgdW5pcXVlIHZhcmlhYmxlIHR5cGVzLgogICAgICAgIGNvbnN0IHNlZW5WYXJUeXBlcyA9IG5ldyBNYXAoKTsgIC8vIHZhcl90eXBlIC0+IHtmaWxsLCBzdHJva2V9CiAgICAgICAgZGF0YS5ub2Rlcy5maWx0ZXIobiA9PiBuLnR5cGUgPT09ICJ2YXJpYWJsZSIpLmZvckVhY2gobiA9PiB7CiAgICAgICAgICAgIGlmICghc2VlblZhclR5cGVzLmhhcyhuLnZhcl90eXBlKSkgewogICAgICAgICAgICAgICAgc2VlblZhclR5cGVzLnNldChuLnZhcl90eXBlLCB7IGZpbGw6IG4uZmlsbCwgc3Ryb2tlOiBuLnN0cm9rZSB9KTsKICAgICAgICAgICAgfQogICAgICAgIH0pOwogICAgICAgIGZvciAoY29uc3QgW3ZhclR5cGUsIGNvbG9yc10gb2Ygc2VlblZhclR5cGVzKSB7CiAgICAgICAgICAgIGxlZ2VuZERhdGEucHVzaCh7CiAgICAgICAgICAgICAgICBsYWJlbDogdmFyVHlwZSwKICAgICAgICAgICAgICAgIGZpbGw6IGNvbG9ycy5maWxsLAogICAgICAgICAgICAgICAgc3Ryb2tlOiBjb2xvcnMuc3Ryb2tlLAogICAgICAgICAgICAgICAgdHlwZTogInZhcmlhYmxlIgogICAgICAgICAgICB9KTsKICAgICAgICB9CgogICAgICAgIGN0eC5zYXZlKCk7CiAgICAgICAgY3R4LnRyYW5zbGF0ZSgxMCwgMTApOwoKICAgICAgICBsZWdlbmREYXRhLmZvckVhY2goKGQsIGkpID0+IHsKICAgICAgICAgICAgY29uc3QgeSA9IGkgKiAxODsKICAgICAgICAgICAgaWYgKGQudHlwZSA9PT0gInZhcmlhYmxlIikgewogICAgICAgICAgICAgICAgY3R4LmJlZ2luUGF0aCgpOwogICAgICAgICAgICAgICAgY3R4LmVsbGlwc2UoMTIsIHkgKyA2LCAxMiwgNiwgMCwgMCwgMiAqIE1hdGguUEkpOwogICAgICAgICAgICAgICAgY3R4LmZpbGxTdHlsZSA9IGQuZmlsbDsKICAgICAgICAgICAgICAgIGN0eC5maWxsKCk7CiAgICAgICAgICAgICAgICBjdHguc3Ryb2tlU3R5bGUgPSBkLnN0cm9rZTsKICAgICAgICAgICAgICAgIGN0eC5saW5lV2lkdGggPSAxOwogICAgICAgICAgICAgICAgY3R4LnN0cm9rZSgpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgY3R4LmJlZ2luUGF0aCgpOwogICAgICAgICAgICAgICAgY3R4LnJvdW5kUmVjdCgwLCB5LCAyNCwgMTIsIDIpOwogICAgICAgICAgICAgICAgY3R4LmZpbGxTdHlsZSA9IGQuZmlsbDsKICAgICAgICAgICAgICAgIGN0eC5maWxsKCk7CiAgICAgICAgICAgICAgICBjdHguc3Ryb2tlU3R5bGUgPSBkLnN0cm9rZTsKICAgICAgICAgICAgICAgIGN0eC5saW5lV2lkdGggPSAxOwogICAgICAgICAgICAgICAgY3R4LnN0cm9rZSgpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGN0eC5maWxsU3R5bGUgPSAiIzAwMCI7CiAgICAgICAgICAgIGN0eC5mb250ID0gIjlweCBIZWx2ZXRpY2EsIEFyaWFsLCBzYW5zLXNlcmlmIjsKICAgICAgICAgICAgY3R4LnRleHRBbGlnbiA9ICJsZWZ0IjsKICAgICAgICAgICAgY3R4LnRleHRCYXNlbGluZSA9ICJtaWRkbGUiOwogICAgICAgICAgICBjdHguZmlsbFRleHQoZC5sYWJlbCwgMzAsIHkgKyA2KTsKICAgICAgICB9KTsKCiAgICAgICAgY3R4LnJlc3RvcmUoKTsKICAgIH0KCiAgICBzaW11bGF0aW9uLm9uKCJ0aWNrIiwgZHJhdyk7CgogICAgLy8gWm9vbSBiZWhhdmlvciB3aXRoIGZpbHRlciB0byBhbGxvdyBub2RlIGRyYWdnaW5nLgogICAgY29uc3Qgem9vbSA9IGQzLnpvb20oKQogICAgICAgIC5zY2FsZUV4dGVudChbMC4xLCA0XSkKICAgICAgICAuZmlsdGVyKChldmVudCkgPT4gewogICAgICAgICAgICAvLyBCbG9jayB6b29tIGlmIGNsaWNraW5nIG9uIGEgbm9kZSAoYWxsb3cgbm9kZSBkcmFnIGluc3RlYWQpLgogICAgICAgICAgICBpZiAoZXZlbnQudHlwZSA9PT0gIm1vdXNlZG93biIpIHsKICAgICAgICAgICAgICAgIGNvbnN0IFt4LCB5XSA9IGQzLnBvaW50ZXIoZXZlbnQpOwogICAgICAgICAgICAgICAgaWYgKG5vZGVBdCh4LCB5KSkgcmV0dXJuIGZhbHNlOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0pCiAgICAgICAgLm9uKCJ6b29tIiwgKGV2ZW50KSA9PiB7CiAgICAgICAgICAgIHRyYW5zZm9ybSA9IGV2ZW50LnRyYW5zZm9ybTsKICAgICAgICAgICAgZHJhdygpOwogICAgICAgIH0pOwoKICAgIGQzLnNlbGVjdChjYW52YXMpCiAgICAgICAgLmNhbGwoem9vbSkKICAgICAgICAub24oIm1vdXNlZG93bi5kcmFnIiwgKGV2ZW50KSA9PiB7CiAgICAgICAgICAgIGNvbnN0IFt4LCB5XSA9IGQzLnBvaW50ZXIoZXZlbnQpOwogICAgICAgICAgICBjb25zdCBub2RlID0gbm9kZUF0KHgsIHkpOwogICAgICAgICAgICBpZiAobm9kZSkgewogICAgICAgICAgICAgICAgZHJhZ05vZGUgPSBub2RlOwogICAgICAgICAgICAgICAgc2ltdWxhdGlvbi5hbHBoYVRhcmdldCgwLjMpLnJlc3RhcnQoKTsKICAgICAgICAgICAgICAgIGRyYWdOb2RlLmZ4ID0gZHJhZ05vZGUueDsKICAgICAgICAgICAgICAgIGRyYWdOb2RlLmZ5ID0gZHJhZ05vZGUueTsKICAgICAgICAgICAgfQogICAgICAgIH0pCiAgICAgICAgLm9uKCJtb3VzZW1vdmUuZHJhZyIsIChldmVudCkgPT4gewogICAgICAgICAgICBpZiAoZHJhZ05vZGUpIHsKICAgICAgICAgICAgICAgIGNvbnN0IFt4LCB5XSA9IGQzLnBvaW50ZXIoZXZlbnQpOwogICAgICAgICAgICAgICAgZHJhZ05vZGUuZnggPSB0cmFuc2Zvcm0uaW52ZXJ0WCh4KTsKICAgICAgICAgICAgICAgIGRyYWdOb2RlLmZ5ID0gdHJhbnNmb3JtLmludmVydFkoeSk7CiAgICAgICAgICAgICAgICBkcmF3KCk7CiAgICAgICAgICAgIH0KICAgICAgICB9KQogICAgICAgIC5vbigibW91c2V1cC5kcmFnIG1vdXNlbGVhdmUuZHJhZyIsICgpID0+IHsKICAgICAgICAgICAgaWYgKGRyYWdOb2RlKSB7CiAgICAgICAgICAgICAgICBzaW11bGF0aW9uLmFscGhhVGFyZ2V0KDApOwogICAgICAgICAgICAgICAgZHJhZ05vZGUuZnggPSBudWxsOwogICAgICAgICAgICAgICAgZHJhZ05vZGUuZnkgPSBudWxsOwogICAgICAgICAgICAgICAgZHJhZ05vZGUgPSBudWxsOwogICAgICAgICAgICB9CiAgICAgICAgfSk7CgogICAgICAgIC8vIEluaXRpYWwgZHJhdy4KICAgICAgICBkcmF3KCk7CiAgICB9KSgpOwogICAgPC9zY3JpcHQ+CjwvYm9keT4KPC9odG1sPg=="
            frameborder="0"
            allowfullscreen
            
        ></iframe>
        </div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Analyze and solve.</span>
<span class="n">problem_standard</span> <span class="o">=</span> <span class="n">problem_standard</span><span class="o">.</span><span class="n">analyze</span><span class="p">()</span>
<span class="n">solution_standard</span> <span class="o">=</span> <span class="n">problem_standard</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">initial_vals</span><span class="p">)</span>

<span class="n">params_standard</span> <span class="o">=</span> <span class="n">solution_standard</span><span class="p">[</span><span class="n">circle_var</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;Standard LS result: center=(</span><span class="si">{</span><span class="n">params_standard</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">params_standard</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">), radius=</span><span class="si">{</span><span class="n">params_standard</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;True parameters:    center=(</span><span class="si">{</span><span class="n">true_cx</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">true_cy</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">), radius=</span><span class="si">{</span><span class="n">true_r</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Bold">INFO    </span> | Building optimization problem with 50 terms and 1 variables: 50 costs, 0 eq_zero, 0 leq_zero, 0 geq_zero
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 50 costs, 1 variables each: circle_residual
<span class=" -Color -Color-Bold">INFO    </span> |  step #0: cost=62.2762 lambd=0.0005 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - circle_residual(50): 62.27618 (avg 0.62276)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=8.01e+00 cost_prev=62.2762 cost_new=60.3239
<span class=" -Color -Color-Bold">INFO    </span> |  step #1: cost=60.3239 lambd=0.0003 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - circle_residual(50): 60.32394 (avg 0.60324)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=1.71e+00 cost_prev=60.3239 cost_new=60.2327
<span class=" -Color -Color-Bold">INFO    </span> |  step #2: cost=60.2327 lambd=0.0001 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - circle_residual(50): 60.23269 (avg 0.60233)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=3.43e-01 cost_prev=60.2327 cost_new=60.2291
<span class=" -Color -Color-Bold">INFO    </span> |  step #3: cost=60.2291 lambd=0.0001 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - circle_residual(50): 60.22906 (avg 0.60229)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=6.96e-02 cost_prev=60.2291 cost_new=60.2289
<span class=" -Color -Color-Bold">INFO    </span> | Terminated @ iteration #4: cost=60.2289 criteria=[1 0 0], term_deltas=2.5e-06,6.0e-02,7.6e-04
Standard LS result: center=(0.639, 1.114), radius=2.445
True parameters:    center=(1.000, 1.000), radius=2.000
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">plotly.graph_objects</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">go</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">IPython.display</span><span class="w"> </span><span class="kn">import</span> <span class="n">HTML</span>


<span class="k">def</span><span class="w"> </span><span class="nf">make_circle_trace</span><span class="p">(</span>
    <span class="n">cx</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">cy</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">r</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">color</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">dash</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;solid&quot;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a circle trace for plotting.&quot;&quot;&quot;</span>
    <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">cx</span> <span class="o">+</span> <span class="n">r</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">cy</span> <span class="o">+</span> <span class="n">r</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span>
        <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span>
        <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;lines&quot;</span><span class="p">,</span>
        <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
        <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">dash</span><span class="o">=</span><span class="n">dash</span><span class="p">),</span>
    <span class="p">)</span>


<span class="n">fig_standard</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>

<span class="c1"># Inlier points.</span>
<span class="n">fig_standard</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
    <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="n">all_x</span><span class="p">[</span><span class="o">~</span><span class="n">is_outlier</span><span class="p">],</span>
        <span class="n">y</span><span class="o">=</span><span class="n">all_y</span><span class="p">[</span><span class="o">~</span><span class="n">is_outlier</span><span class="p">],</span>
        <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;markers&quot;</span><span class="p">,</span>
        <span class="n">marker</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#2196F3&quot;</span><span class="p">),</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Inliers&quot;</span><span class="p">,</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Outlier points.</span>
<span class="n">fig_standard</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
    <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="n">all_x</span><span class="p">[</span><span class="n">is_outlier</span><span class="p">],</span>
        <span class="n">y</span><span class="o">=</span><span class="n">all_y</span><span class="p">[</span><span class="n">is_outlier</span><span class="p">],</span>
        <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;markers&quot;</span><span class="p">,</span>
        <span class="n">marker</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#F44336&quot;</span><span class="p">,</span> <span class="n">symbol</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">),</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Outliers&quot;</span><span class="p">,</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="c1"># True circle.</span>
<span class="n">fig_standard</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
    <span class="n">make_circle_trace</span><span class="p">(</span><span class="n">true_cx</span><span class="p">,</span> <span class="n">true_cy</span><span class="p">,</span> <span class="n">true_r</span><span class="p">,</span> <span class="s2">&quot;True circle&quot;</span><span class="p">,</span> <span class="s2">&quot;#4CAF50&quot;</span><span class="p">,</span> <span class="s2">&quot;dash&quot;</span><span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Standard LS result.</span>
<span class="n">fig_standard</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
    <span class="n">make_circle_trace</span><span class="p">(</span>
        <span class="nb">float</span><span class="p">(</span><span class="n">params_standard</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
        <span class="nb">float</span><span class="p">(</span><span class="n">params_standard</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
        <span class="nb">float</span><span class="p">(</span><span class="n">params_standard</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span>
        <span class="s2">&quot;Standard LS&quot;</span><span class="p">,</span>
        <span class="s2">&quot;#FF9800&quot;</span><span class="p">,</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="n">fig_standard</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span><span class="n">title_text</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">scaleanchor</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">scaleratio</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">fig_standard</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="n">title_text</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">)</span>
<span class="n">fig_standard</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
    <span class="n">height</span><span class="o">=</span><span class="mi">450</span><span class="p">,</span>
    <span class="n">margin</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">t</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">l</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="mi">40</span><span class="p">),</span>
    <span class="n">legend</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">yanchor</span><span class="o">=</span><span class="s2">&quot;top&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.99</span><span class="p">,</span> <span class="n">xanchor</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mf">0.01</span><span class="p">),</span>
<span class="p">)</span>
<span class="n">HTML</span><span class="p">(</span><span class="n">fig_standard</span><span class="o">.</span><span class="n">to_html</span><span class="p">(</span><span class="n">full_html</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">include_plotlyjs</span><span class="o">=</span><span class="s2">&quot;cdn&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><div>                        <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-3.3.0.min.js" integrity="sha256-bO3dS6yCpk9aK4gUpNELtCiDeSYvGYnK7jFI58NQnHI=" crossorigin="anonymous"></script>                <div id="6fe73782-f7c0-4d64-924f-6a364f0497ce" class="plotly-graph-div" style="height:450px; width:100%;"></div>            <script type="text/javascript">                window.PLOTLYENV=window.PLOTLYENV || {};                                if (document.getElementById("6fe73782-f7c0-4d64-924f-6a364f0497ce")) {                    Plotly.newPlot(                        "6fe73782-f7c0-4d64-924f-6a364f0497ce",                        [{"marker":{"color":"#2196F3","size":8},"mode":"markers","name":"Inliers","x":{"dtype":"f8","bdata":"uJO90tUv2r8UqAuC2m4GQD\u002fo4xtFeug\u002fkPsdi5np4L+u2ShhYQABQG3QMUySCQBAwjQjTCX0BUCwVyLeP8YCQBSMMQsOauW\u002fUkRiJQ9i3j+3G15ZTcYHQDvZtCxyegdAd3A6BF+s\u002fj\u002fizeOuUDv3P7KlQM9j\u002fPw\u002fZQVHDZSw\u002fT+26Cds+HrUP\u002f7tahpYp+m\u002fSHqzZWou6786psLXrdffP4CwE+gJXd6\u002fNusL0hGNAkDg9azz58XcP\u002fyotDYvctm\u002fCFjYwlz+6r\u002f1y1cgGuj2P8xlQumfHfo\u002ffFjrZz5t8b\u002fInF6\u002ffTrkv3AiguFeLgdA7Fa9qRBZ3r8F2398PGj+PwTq2g9LRwdAwJCV+x82CECDOeR3d5IHQMLQSltJDvw\u002fFswdsLwn1D8GfO+DlKgEQAggHUFuV8c\u002fQiT5xpMN8L8="},"y":{"dtype":"f8","bdata":"OkkuurRWA0BQ4hoKNg7bPz7NVaBjGvG\u002fECUiMo9Jt78oCQNw620FQOLcwb+y\u002fANAtteBMJWp+j94Ewjqlyngvwj2d5uZh82\u002ffP87Ok1S7r86ev8Kdhr0PyYbbc4vJ+Q\u002fqMu\u002fsUZ+478CTYPriv4GQJpoPSMcOAZAIFOnlHJkB0CuOWw3vFYHQDLb\u002fn9\u002f9eY\u002f0wY3JjB8\u002fT8SY2EgGSsHQDCjF7WP3c+\u002fCpNk1firBECC0D\u002f8BD0IQCSxzG4ldwRAXKhBZ+Ba+D9a6n1bUHrtv5GHbXVndQdAlGSlAzoB6j+gJRzvASSyv7itiao1H\u002fk\u002fsN1RJN1Cx785J2VcwzQFQB0PX4QlPP0\u002f8uRQjrja1D\u002f8uPUQG1biP4Z+wZLKvO6\u002f\u002fP840vJWB0BUn+TdweoAQEBl9McYrOu\u002fnio5Cbqn\u002fD8="},"type":"scatter"},{"marker":{"color":"#F44336","size":10,"symbol":"x"},"mode":"markers","name":"Outliers","x":{"dtype":"f8","bdata":"UIvonyzsEUDSuONSdOj2PxB0ohdAAPw\u002f\u002fxLhhJN+5j8U1CqgW8MNwHD1xwNsgQbAnIclm\u002fY7DcB8pDrCDQEIQJtDN\u002fvAWOG\u002fhSVNOymC+T8="},"y":{"dtype":"f8","bdata":"vi3EKdTuF0Dg67Oq4x\u002f0vx7FwAttdOA\u002fA+mdLIc+EUBE2UEVRbv3v0iYae3LOQnAT\u002fFtxeoB6r9DmlDAAdABwCoXb0Yd6BhAkUAg\u002f6qOE0A="},"type":"scatter"},{"line":{"color":"#4CAF50","dash":"dash","width":2},"mode":"lines","name":"True circle","x":{"dtype":"f8","bdata":"AAAAAAAACEDKpZTgwPcHQDR9gwIM3wdAkvSb3fq1B0CSPwvHt3wHQPgkucV9MwdArlhvVZjaBkC\u002fGgoZY3IGQLBQAnxJ+wVAXXiyQ8Z1BUArmcgQY+IEQByoZ9G3QQRA2pyKJGqUA0BLqEqvLNsCQKCJuGS+FgJAgtUGwelHAUAuFtD4g28AQKvanzrYHP8\u002fW4njbBRL\u002fT\u002fFKUSnnGv7P66hsShfgPk\u002foxa4UlaL9z\u002fj3IKfho71P4Qdd438i\u002fM\u002fBwKLgsqF8T9TcA1TDfzuP73NxZaR7eo\u002fkV34TVDk5j\u002fYEKqScuTiP9r+eqIv5N0\u002fhr39EKMi1j8k0y1gfBjNP6izOQtNo7w\u002fAAAAAAAAwLzwbM4daZu7v3CmZYg8Ccu\u002fHGLd\u002fXnS079s+9Ta7cnZv3RJHVPTZN+\u002fTMC1o7FO4r+6OO76HbfkvxSzFkMz6ea\u002fguXfE67i6L+ynxBehaHqvzZapITsI+y\u002frqCaN1Vo7b+G5I0OcW3uvwh6auEyMu+\u002fvGji3c+1778ODoBYwPfvvw4OgFjA9++\u002fvGji3c+1778IemrhMjLvv4bkjQ5xbe6\u002frqCaN1Vo7b84WqSE7CPsv7KfEF6Foeq\u002fhOXfE67i6L8SsxZDM+nmv7w47vodt+S\u002fSsC1o7FO4r94SR1T02Tfv2j71Nrtydm\u002fIGLd\u002fXnS079gpmWIPAnLvxBtzh1pm7u\u002fAAAAAAAAzDzAszkLTaO8PyTTLWB8GM0\u002ffr39EKMi1j\u002fo\u002fnqiL+TdP9wQqpJy5OI\u002fkV34TVDk5j+4zcWWke3qP1twDVMN\u002fO4\u002fCQKLgsqF8T+CHXeN\u002fIvzP9\u002fcgp+GjvU\u002fpRa4UlaL9z+tobEoX4D5P8MpRKeca\u002fs\u002fXonjbBRL\u002fT+s2p862Bz\u002fPy4W0PiDbwBAgNUGwelHAUCiibhkvhYCQEyoSq8s2wJA2pyKJGqUA0AcqGfRt0EEQCyZyBBj4gRAXXiyQ8Z1BUCwUAJ8SfsFQL4aChljcgZArlhvVZjaBkD4JLnFfTMHQJI\u002fC8e3fAdAk\u002fSb3fq1B0A0fYMCDN8HQMqllODA9wdAAAAAAAAACEA="},"y":{"dtype":"f8","bdata":"AAAAAAAA8D\u002fAsJaZkQfyP\u002fygAJ4LDfQ\u002fJCsooFgO9j9NxOyAZwn4P+wPkZAt\u002fPk\u002f\u002fsmGqajk+z9BIG1C4cD9P4wmH3Xsjv8\u002fBqxd\u002fHamAECjQk0GjXwBQA4LHqnbSAJAAIwfSpAKA0DDjEk848ADQESgEI4YawRAy6Aiy4AIBUA8Z0OxeZgFQBlOj9duGgZAChZ3R9qNBkDgeNcGRfIGQP4RnpJHRwdAcC99SYqMB0AMjkDGxcEHQBrjZSnD5gdAQlatUVz7B0D4nGcDfP8HQDMzWf4d8wdAeCEcAk\u002fWB0Dgy\u002fvALKkHQAJWWMHlawdA4imxLbkeB0DKEYiT9sEGQKgDYJH9VQZAVSYsdD3bBUBIq5TENFIFQEvBh8RwuwRAUBSd3YwXBEDb8+EAMmcDQOlDs\u002fgVqwJAebxYrfrjAUAToyJdrRIBQLEJ2MgFOABAeVSfqsqp\u002fj\u002ftQDFGbNT8P\u002fwFRTrU8fo\u002f4Ea7\u002fvMD+T95CqmsyAz3PzqxjfFYDvU\u002ffOqo+LIK8z+7zZdM6gPxP4dk0GYr+O0\u002fBiuuDprq6T+KneQcTuPlPxLrraZu5uE\u002ffOQSBTDw2z8Y6OsWrzjUP4z4dc6dXMk\u002fkLgKVlVjtT\u002fA2ARs5AKcvyAxKtLVKsG\u002fmMeL1ao\u002fzr9EH5rFr1jVv9yeDweQOdu\u002fQFF0djNe4L8uBR8Sw+3ivyCtUhLTSOW\u002fWJmw0PVs57+kDoBF9lfpvyZHIE7aB+u\u002fiKfEtuR67L8IWGEFl6\u002ftv34v7wOzpO6\u002f3oVwCDxZ77\u002fKzGT5d8zvv95zng3w\u002fe+\u002fBlm1RnHt779ojJelDJvvvzA4AhkXB++\u002fvr30JSky7r\u002f6R3hKHh3tv4TjXRsUyeu\u002fJFjcHWk36r9iOD1eu2nov+6cDcXmYea\u002fLoOKLAMi5L8MgUI4YqzhvxRmTOIZB96\u002fAGD8UIJU2L98WPBI3UbSvyAq1GTQyMe\u002fsIC1i9\u002fOtL+gXDa44kScP+T9luz1+ME\u002fFtjkWV1t0D9OwLu9SQ\u002fYP8buTPxh2t8\u002fwKmvv07j4z8Mvv7D6OXnP3+e0szc8Os\u002f\u002fP\u002f\u002f\u002f\u002f\u002f\u002f7z8="},"type":"scatter"},{"line":{"color":"#FF9800","dash":"solid","width":2},"mode":"lines","name":"Standard LS","x":{"dtype":"f8","bdata":"AAAAqBCsCEBx8w0+\u002fKEIQIAYKmTJgwhAMmF1O5dRCEDCpiiCmQsIQIsrPl4YsgdAWVoSE3BFB0AwbUiiEMYGQEAFVVh9NAZAh7glRUyRBUBzGXGhJd0EQP6sTiHDGARAoo\u002fJNO9EA0DOHDM3hGICQN60DI5rcgFAtqdwuJx1AED0iuSfONr+P8Yk+Pf1s\u002fw\u002f7w2Csah6+j9WKsWlmzD4Pxqe8fEq2PU\u002f+vJoiMFz8z8oA7iy1gXxP9azsA3XIe0\u002faK6vpBAv6D+7mR\u002f8czjjP4fdcbQ9htw\u002fhmQqZ1uo0j\u002fIyJiZ2cLBP0C2FuJAj4i\u002fDOR1Gs5+xL9MCGaLlIXTv1woASdzjdy\u002fBAAA4Nmm4r+WObeEqN7mv95d9WrM6eq\u002fyAs4hxrE7r8aII0SzTTxvy9wr39E6\u002fK\u002f1k3vj6+D9L\u002fCUa1Bafz1v17XuT7tU\u002fe\u002fQkijbNmI+L\u002fQjLpZ75n5vyJdVYUVhvq\u002fPBL8gVhM+7+211fw6+v7vxKU3lErZPy\u002fWl1jspq0\u002fL+6r9wn59z8v7qv3Cfn3Py\u002fWl1jspq0\u002fL8SlN5RK2T8v7bXV\u002fDr6\u002fu\u002fPBL8gVhM+78kXVWFFYb6v9CMulnvmfm\u002fREijbNmI+L9e17k+7VP3v8RRrUFp\u002fPW\u002f1U3vj6+D9L8wcK9\u002fROvyvxggjRLNNPG\u002fygs4hxrE7r\u002fYXfVqzOnqv5o5t4So3ua\u002f+P\u002f\u002f39mm4r9UKAEnc43cv0wIZouUhdO\u002fIOR1Gs5+xL9AtBbiQI+Iv9jImJnZwsE\u002fhmQqZ1uo0j983XG0PYbcP8SZH\u002fxzOOM\u002fbK6vpBAv6D\u002fSs7AN1yHtPyMDuLLWBfE\u002f\u002fPJoiMFz8z8anvHxKtj1P1QqxaWbMPg\u002f8w2Csah6+j\u002fIJPj39bP8P\u002fSK5J842v4\u002ftKdwuJx1AEDgtAyOa3IBQM4cMzeEYgJAoY\u002fJNO9EA0D8rE4hwxgEQHQZcaEl3QRAh7glRUyRBUBABVVYfTQGQC9tSKIQxgZAWloSE3BFB0CLKz5eGLIHQMKmKIKZCwhAM2F1O5dRCECAGCpkyYMIQHHzDT78oQhAAAAAqBCsCEA="},"y":{"dtype":"f8","bdata":"AAAAAJ7S8T+TEWLprk30P61n9y4xxvY\u002fh2jEz5g5+T8WILgNX6X7P8pVWQgFB\u002f4\u002fVP2rJwsuAED2CC61FVEBQP4muyl2awJAdjHScAl8A0AavXWQtoEEQOgWz8pvewVAOHU8tDNoBkAbvKs8DkcHQJFMMKsZFwhAqIfQin\u002fXCECG65aHeYcJQAzpAjtSJgpA\u002f7MG52WzCkCfTNEeIy4LQLXEtlwLlgtAFDmchLPqC0B6DmFSxCsMQGih07P6WAxAda7UDShyDEA3LmJsMncMQL8eWJ0UaAxA6KbLNd5EDED0DfuBsw0MQEYW41\u002fNwgtAK02gBHlkC0DKvNisF\u002fMKQKEKgDgebwpAN1VdshTZCUDYAc\u002fDlTEJQPMIXRVOeQhA5xi+nPuwB0A7BgfZbNkGQA5jzv1\u002f8wVAlKkfDiIABUDJFSroTQAEQDgHp0IL9QJAAH0CnW3fAUBN5F0jk8AAQCXvIw9HM\u002f8\u002fuIe\u002foJ3X\u002fD84ERZAmHD6Px0AQuewAPg\u002frVhsuGqK9T8L+9dmTxDzP\u002fMEKJnslPA\u002fok4nj6I17D\u002fC\u002f3sxFknnP5fd039HaeI\u002fGOEBfXk22z92Q3DD08fRPyC7IcqtIME\u002fAP35BDqfeb+Qc3Aq1CbCv0CuUEF\u002fbdG\u002fqEz9cCBs2b84jDn3h4Pgv+4YHGQ7G+S\u002fmmP4cnZ557\u002fOI3RVwJrqv1wHPA\u002ffe+2\u002fcqq6ZO0M8L9EFQBxADnxv5R5sVnzQPK\u002fVJpACbYj87+OLMa\u002fXuDzv+gb9gMrdvS\u002f0E2Xa4Dk9L98PbA67Sr1v25cxNgoSfW\u002f6lypGxQ\u002f9b\u002fQQqdnuQz1v\u002fYcwqRMsvS\u002fKHI4CSsw9L9qiW252obzv0CZoj0Kt\u002fK\u002f\u002fGcNzo\u002fB8b8W0gV2aKfwvxiuWx5u0+6\u002foB5CK4YT7L9AMsGs7hHpv2rwrvLA0eW\u002f4NTx0FZW4r9Qt3hWjkbdv8jorYPEeNW\u002faBcjDbeWyr\u002fQ32Q3BRuzvwDhPloJMbA\u002f3CpAhS1Jyj\u002faqJre23jWP6B\u002fH8lz\u002f98\u002f\u002fC53YEbX5D+qMBGiFb7pP9ncOy0ar+4\u002f\u002ff\u002f\u002f\u002f53S8T8="},"type":"scatter"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermap":[{"type":"scattermap","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"title":{"text":"x"},"scaleanchor":"y","scaleratio":1},"yaxis":{"title":{"text":"y"}},"margin":{"t":40,"b":40,"l":60,"r":40},"legend":{"yanchor":"top","y":0.99,"xanchor":"left","x":0.01},"height":450},                        {"responsive": true}                    )                };            </script>        </div></div></div>
</div>
</section>
<section id="robust-cost-functions-m-estimators">
<h2>Robust cost functions (M-estimators)<a class="headerlink" href="#robust-cost-functions-m-estimators" title="Link to this heading">#</a></h2>
<p>M-estimators replace the squared loss <span class="math notranslate nohighlight">\(r^2\)</span> with a robust function <span class="math notranslate nohighlight">\(\rho(r)\)</span> that grows
more slowly for large residuals. Common choices:</p>
<p><strong>Huber loss</strong>: Quadratic for small residuals, linear for large:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\rho_\text{Huber}(r) = \begin{cases} \frac{1}{2}r^2 &amp; |r| \leq k \\ k(|r| - \frac{k}{2}) &amp; |r| &gt; k \end{cases}
\end{split}\]</div>
<p><strong>Cauchy/Lorentzian</strong>: Soft down-weighting of outliers:</p>
<div class="math notranslate nohighlight">
\[
\rho_\text{Cauchy}(r) = \frac{c^2}{2} \log\left(1 + \left(\frac{r}{c}\right)^2\right)
\]</div>
<p><strong>Geman-McClure</strong>: Even more aggressive outlier rejection:</p>
<div class="math notranslate nohighlight">
\[
\rho_\text{GM}(r) = \frac{r^2/2}{1 + r^2}
\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">huber_weight</span><span class="p">(</span><span class="n">residual</span><span class="p">:</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">,</span> <span class="n">k</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.345</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Huber weight: 1 for small residuals, k/|r| for large.</span>

<span class="sd">    The default k=1.345 gives 95% efficiency for Gaussian data.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">abs_r</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">residual</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1e-8</span>
    <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">abs_r</span> <span class="o">&lt;=</span> <span class="n">k</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">k</span> <span class="o">/</span> <span class="n">abs_r</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">cauchy_weight</span><span class="p">(</span><span class="n">residual</span><span class="p">:</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">,</span> <span class="n">c</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">2.385</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Cauchy/Lorentzian weight: 1 / (1 + (r/c)^2).</span>

<span class="sd">    Provides soft down-weighting that never fully rejects points.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="p">(</span><span class="n">residual</span> <span class="o">/</span> <span class="n">c</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">geman_mcclure_weight</span><span class="p">(</span><span class="n">residual</span><span class="p">:</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">,</span> <span class="n">sigma</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Geman-McClure weight: 1 / (1 + r^2)^2.</span>

<span class="sd">    Aggressive outlier rejection -- weight drops quickly for large residuals.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">r_scaled</span> <span class="o">=</span> <span class="n">residual</span> <span class="o">/</span> <span class="n">sigma</span>
    <span class="k">return</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">r_scaled</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">plotly.graph_objects</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">go</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">IPython.display</span><span class="w"> </span><span class="kn">import</span> <span class="n">HTML</span>

<span class="c1"># Visualize weight functions.</span>
<span class="n">r_vals</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>

<span class="n">fig_weights</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>
<span class="n">fig_weights</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
    <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="n">r_vals</span><span class="p">,</span>
        <span class="n">y</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">r_vals</span><span class="p">),</span>
        <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;lines&quot;</span><span class="p">,</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Standard LS (weight=1)&quot;</span><span class="p">,</span>
        <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">,</span> <span class="n">dash</span><span class="o">=</span><span class="s2">&quot;dash&quot;</span><span class="p">),</span>
    <span class="p">)</span>
<span class="p">)</span>
<span class="n">fig_weights</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
    <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="n">r_vals</span><span class="p">,</span>
        <span class="n">y</span><span class="o">=</span><span class="n">huber_weight</span><span class="p">(</span><span class="n">r_vals</span><span class="p">),</span>
        <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;lines&quot;</span><span class="p">,</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Huber (k=1.345)&quot;</span><span class="p">,</span>
        <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;#2196F3&quot;</span><span class="p">),</span>
    <span class="p">)</span>
<span class="p">)</span>
<span class="n">fig_weights</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
    <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="n">r_vals</span><span class="p">,</span>
        <span class="n">y</span><span class="o">=</span><span class="n">cauchy_weight</span><span class="p">(</span><span class="n">r_vals</span><span class="p">),</span>
        <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;lines&quot;</span><span class="p">,</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Cauchy (c=2.385)&quot;</span><span class="p">,</span>
        <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;#4CAF50&quot;</span><span class="p">),</span>
    <span class="p">)</span>
<span class="p">)</span>
<span class="n">fig_weights</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
    <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="n">r_vals</span><span class="p">,</span>
        <span class="n">y</span><span class="o">=</span><span class="n">geman_mcclure_weight</span><span class="p">(</span><span class="n">r_vals</span><span class="p">),</span>
        <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;lines&quot;</span><span class="p">,</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Geman-McClure&quot;</span><span class="p">,</span>
        <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;#FF9800&quot;</span><span class="p">),</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="n">fig_weights</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Robust Weight Functions&quot;</span><span class="p">,</span>
    <span class="n">xaxis_title</span><span class="o">=</span><span class="s2">&quot;Residual&quot;</span><span class="p">,</span>
    <span class="n">yaxis_title</span><span class="o">=</span><span class="s2">&quot;Weight&quot;</span><span class="p">,</span>
    <span class="n">height</span><span class="o">=</span><span class="mi">350</span><span class="p">,</span>
    <span class="n">margin</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">t</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">l</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="mi">40</span><span class="p">),</span>
    <span class="n">legend</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">yanchor</span><span class="o">=</span><span class="s2">&quot;top&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.99</span><span class="p">,</span> <span class="n">xanchor</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mf">0.99</span><span class="p">),</span>
<span class="p">)</span>
<span class="n">HTML</span><span class="p">(</span><span class="n">fig_weights</span><span class="o">.</span><span class="n">to_html</span><span class="p">(</span><span class="n">full_html</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">include_plotlyjs</span><span class="o">=</span><span class="s2">&quot;cdn&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><div>                        <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-3.3.0.min.js" integrity="sha256-bO3dS6yCpk9aK4gUpNELtCiDeSYvGYnK7jFI58NQnHI=" crossorigin="anonymous"></script>                <div id="ae99fb65-f663-41f9-b599-4cf33fcfbb66" class="plotly-graph-div" style="height:350px; width:100%;"></div>            <script type="text/javascript">                window.PLOTLYENV=window.PLOTLYENV || {};                                if (document.getElementById("ae99fb65-f663-41f9-b599-4cf33fcfbb66")) {                    Plotly.newPlot(                        "ae99fb65-f663-41f9-b599-4cf33fcfbb66",                        [{"line":{"color":"gray","dash":"dash"},"mode":"lines","name":"Standard LS (weight=1)","x":{"dtype":"f4","bdata":"AACgwFhknsCvyJzABi2bwF6RmcC29ZfADFqWwGS+lMC8IpPAE4eRwGvrj8DCT47AGrSMwHIYi8DIfInAIOGHwHhFhsDQqYTAJg6DwH5ygcCsrX\u002fAWXZ8wAg\u002fecC4B3bAZ9BywBeZb8DEYWzAdCppwCPzZcDRu2LAgIRfwDBNXMDfFVnAj95VwDynUsDsb0\u002fAmzhMwEkBScD4yUXAqJJCwFZbP8AGJDzAtOw4wGK1NcASfjLAwEYvwHAPLMAf2CjAzaAlwH1pIsAsMh\u002fA2\u002fobwIrDGMA4jBXA6FQSwJYdD8BF5gvA9K4IwKR3BcBTQALAAxL+v2Cj97+\u002fNPG\u002fHMbqv3lX5L\u002fY6N2\u002fNXrXv5YL0b\u002fxnMq\u002fUC7Ev6+\u002fvb8MUbe\u002fa+Kwv8hzqr8lBaS\u002fg5adv+Anl789uZC\u002fnkqKv\u002fnbg7+02nq\u002fbv1tvyggYb\u002fmQlS\u002foGVHv16IOr8Yqy2\u002f0s0gv5DwE79OEwe\u002fB2z0voux2r7\u002f9sC+ezynvu6Bjb7Ejme+vBk0vqSkAL5WX5q9F9TNvCzUzTw8X5o9pqQAPr8ZND7Hjmc+8IGNPnQ8pz4A98A+hLHaPhBs9D5OEwc\u002fkPATP9LNID8Zqy0\u002fX4g6P6FlRz\u002fjQlQ\u002fKSBhP2\u002f9bT+x2no\u002f+9uDP51Kij9AuZA\u002f4SeXP4OWnT8lBaQ\u002fyHOqP2risD8MUbc\u002frb+9P08uxD\u002fynMo\u002flAvRPzV61z\u002fX6N0\u002felfkPxzG6j++NPE\u002fYKP3PwQS\u002fj9SQAJAo3cFQPSuCEBG5gtAlh0PQOdUEkA4jBVAicMYQNv6G0AsMh9AfWkiQM6gJUAf2ChAcA8sQMFGL0ASfjJAY7U1QLTsOEAFJDxAVls\u002fQKeSQkD4yUVASQFJQJo4TEDrb09APKdSQI3eVUDeFVlAME1cQICEX0DSu2JAI\u002fNlQHQqaUDFYWxAFplvQGfQckC4B3ZACT95QFp2fECrrX9AfnKBQCcOg0DPqYRAeEWGQCDhh0DJfIlAcRiLQBq0jEDCT45Aa+uPQBOHkUC8IpNAZL6UQA1alkC19ZdAXpGZQAYtm0CvyJxAV2SeQAAAoEA="},"y":{"dtype":"f4","bdata":"AACAPwAAgD8AAIA\u002fAACAPwAAgD8AAIA\u002fAACAPwAAgD8AAIA\u002fAACAPwAAgD8AAIA\u002fAACAPwAAgD8AAIA\u002fAACAPwAAgD8AAIA\u002fAACAPwAAgD8AAIA\u002fAACAPwAAgD8AAIA\u002fAACAPwAAgD8AAIA\u002fAACAPwAAgD8AAIA\u002fAACAPwAAgD8AAIA\u002fAACAPwAAgD8AAIA\u002fAACAPwAAgD8AAIA\u002fAACAPwAAgD8AAIA\u002fAACAPwAAgD8AAIA\u002fAACAPwAAgD8AAIA\u002fAACAPwAAgD8AAIA\u002fAACAPwAAgD8AAIA\u002fAACAPwAAgD8AAIA\u002fAACAPwAAgD8AAIA\u002fAACAPwAAgD8AAIA\u002fAACAPwAAgD8AAIA\u002fAACAPwAAgD8AAIA\u002fAACAPwAAgD8AAIA\u002fAACAPwAAgD8AAIA\u002fAACAPwAAgD8AAIA\u002fAACAPwAAgD8AAIA\u002fAACAPwAAgD8AAIA\u002fAACAPwAAgD8AAIA\u002fAACAPwAAgD8AAIA\u002fAACAPwAAgD8AAIA\u002fAACAPwAAgD8AAIA\u002fAACAPwAAgD8AAIA\u002fAACAPwAAgD8AAIA\u002fAACAPwAAgD8AAIA\u002fAACAPwAAgD8AAIA\u002fAACAPwAAgD8AAIA\u002fAACAPwAAgD8AAIA\u002fAACAPwAAgD8AAIA\u002fAACAPwAAgD8AAIA\u002fAACAPwAAgD8AAIA\u002fAACAPwAAgD8AAIA\u002fAACAPwAAgD8AAIA\u002fAACAPwAAgD8AAIA\u002fAACAPwAAgD8AAIA\u002fAACAPwAAgD8AAIA\u002fAACAPwAAgD8AAIA\u002fAACAPwAAgD8AAIA\u002fAACAPwAAgD8AAIA\u002fAACAPwAAgD8AAIA\u002fAACAPwAAgD8AAIA\u002fAACAPwAAgD8AAIA\u002fAACAPwAAgD8AAIA\u002fAACAPwAAgD8AAIA\u002fAACAPwAAgD8AAIA\u002fAACAPwAAgD8AAIA\u002fAACAPwAAgD8AAIA\u002fAACAPwAAgD8AAIA\u002fAACAPwAAgD8AAIA\u002fAACAPwAAgD8AAIA\u002fAACAPwAAgD8AAIA\u002fAACAPwAAgD8AAIA\u002fAACAPwAAgD8AAIA\u002fAACAPwAAgD8AAIA\u002fAACAPwAAgD8AAIA\u002fAACAPwAAgD8AAIA\u002fAACAPwAAgD8="},"type":"scatter"},{"line":{"color":"#2196F3"},"mode":"lines","name":"Huber (k=1.345)","x":{"dtype":"f4","bdata":"AACgwFhknsCvyJzABi2bwF6RmcC29ZfADFqWwGS+lMC8IpPAE4eRwGvrj8DCT47AGrSMwHIYi8DIfInAIOGHwHhFhsDQqYTAJg6DwH5ygcCsrX\u002fAWXZ8wAg\u002fecC4B3bAZ9BywBeZb8DEYWzAdCppwCPzZcDRu2LAgIRfwDBNXMDfFVnAj95VwDynUsDsb0\u002fAmzhMwEkBScD4yUXAqJJCwFZbP8AGJDzAtOw4wGK1NcASfjLAwEYvwHAPLMAf2CjAzaAlwH1pIsAsMh\u002fA2\u002fobwIrDGMA4jBXA6FQSwJYdD8BF5gvA9K4IwKR3BcBTQALAAxL+v2Cj97+\u002fNPG\u002fHMbqv3lX5L\u002fY6N2\u002fNXrXv5YL0b\u002fxnMq\u002fUC7Ev6+\u002fvb8MUbe\u002fa+Kwv8hzqr8lBaS\u002fg5adv+Anl789uZC\u002fnkqKv\u002fnbg7+02nq\u002fbv1tvyggYb\u002fmQlS\u002foGVHv16IOr8Yqy2\u002f0s0gv5DwE79OEwe\u002fB2z0voux2r7\u002f9sC+ezynvu6Bjb7Ejme+vBk0vqSkAL5WX5q9F9TNvCzUzTw8X5o9pqQAPr8ZND7Hjmc+8IGNPnQ8pz4A98A+hLHaPhBs9D5OEwc\u002fkPATP9LNID8Zqy0\u002fX4g6P6FlRz\u002fjQlQ\u002fKSBhP2\u002f9bT+x2no\u002f+9uDP51Kij9AuZA\u002f4SeXP4OWnT8lBaQ\u002fyHOqP2risD8MUbc\u002frb+9P08uxD\u002fynMo\u002flAvRPzV61z\u002fX6N0\u002felfkPxzG6j++NPE\u002fYKP3PwQS\u002fj9SQAJAo3cFQPSuCEBG5gtAlh0PQOdUEkA4jBVAicMYQNv6G0AsMh9AfWkiQM6gJUAf2ChAcA8sQMFGL0ASfjJAY7U1QLTsOEAFJDxAVls\u002fQKeSQkD4yUVASQFJQJo4TEDrb09APKdSQI3eVUDeFVlAME1cQICEX0DSu2JAI\u002fNlQHQqaUDFYWxAFplvQGfQckC4B3ZACT95QFp2fECrrX9AfnKBQCcOg0DPqYRAeEWGQCDhh0DJfIlAcRiLQBq0jEDCT45Aa+uPQBOHkUC8IpNAZL6UQA1alkC19ZdAXpGZQAYtm0CvyJxAV2SeQAAAoEA="},"y":{"dtype":"f4","bdata":"XrqJPlIgiz6ejYw+fAKOPil\u002fjz7jA5E+8ZCSPpImlD4RxZU+umyXPtodmT7E2Jo+zZ2cPlBtnj6sR6A+QC2iPnYepD66G6Y+fyWoPjg8qj5lYKw+jJKuPjPTsD7tIrM+VIK1Pgjytz64cro+EgW9Ptepvz7QYcI+0C3FPrYOyD5yBcs+\u002fxLOPm040T7RdtQ+Xc\u002fXPlND2z4H1N4+54LiPnpR5j5cQeo+T1TuPi2M8j7z6vY+ynL7Pv0SAD+AgwI\u002fRQwFP7uuBz9xbAo\u002fF0cNP4BAED+qWhM\u002fu5cWPxH6GT86hB0\u002fCTkhP48bJT80Lyk\u002fsXctPyT5MT8auDY\u002fpLk7P2EDQT+Xm0Y\u002fUIlMP2vUUj\u002fXhVk\u002fmqdgPyRFaD+Aa3A\u002flil5PwAAgD8AAIA\u002fAACAPwAAgD8AAIA\u002fAACAPwAAgD8AAIA\u002fAACAPwAAgD8AAIA\u002fAACAPwAAgD8AAIA\u002fAACAPwAAgD8AAIA\u002fAACAPwAAgD8AAIA\u002fAACAPwAAgD8AAIA\u002fAACAPwAAgD8AAIA\u002fAACAPwAAgD8AAIA\u002fAACAPwAAgD8AAIA\u002fAACAPwAAgD8AAIA\u002fAACAPwAAgD8AAIA\u002fAACAPwAAgD8AAIA\u002fAACAPwAAgD8AAIA\u002fAACAPwAAgD8AAIA\u002fAACAPwAAgD8AAIA\u002fAACAPwAAgD8AAIA\u002fAACAP5cpeT+Aa3A\u002fJ0VoP5unYD\u002fWhVk\u002fbdRSP1CJTD+Ym0Y\u002fYANBP6S5Oz8buDY\u002fJPkxP7B3LT81Lyk\u002fkBslPwk5IT85hB0\u002fEfoZP7yXFj+qWhM\u002fgUAQPxdHDT9xbAo\u002fu64HP0UMBT+AgwI\u002f\u002fRIAP8hy+z7z6vY+LIzyPk9U7j5dQeo+elHmPuiC4j4H1N4+U0PbPl7P1z7SdtQ+bTjRPgETzj5zBcs+tg7IPtAtxT7PYcI+16m\u002fPhIFvT63cro+CfK3PlSCtT7tIrM+MtOwPouSrj5mYKw+ODyqPn4lqD67G6Y+dh6kPkAtoj6rR6A+UW2ePs2dnD7E2Jo+2h2ZPrpslz4RxZU+kiaUPvCQkj7kA5E+KX+PPnwCjj6ejYw+UyCLPl66iT4="},"type":"scatter"},{"line":{"color":"#4CAF50"},"mode":"lines","name":"Cauchy (c=2.385)","x":{"dtype":"f4","bdata":"AACgwFhknsCvyJzABi2bwF6RmcC29ZfADFqWwGS+lMC8IpPAE4eRwGvrj8DCT47AGrSMwHIYi8DIfInAIOGHwHhFhsDQqYTAJg6DwH5ygcCsrX\u002fAWXZ8wAg\u002fecC4B3bAZ9BywBeZb8DEYWzAdCppwCPzZcDRu2LAgIRfwDBNXMDfFVnAj95VwDynUsDsb0\u002fAmzhMwEkBScD4yUXAqJJCwFZbP8AGJDzAtOw4wGK1NcASfjLAwEYvwHAPLMAf2CjAzaAlwH1pIsAsMh\u002fA2\u002fobwIrDGMA4jBXA6FQSwJYdD8BF5gvA9K4IwKR3BcBTQALAAxL+v2Cj97+\u002fNPG\u002fHMbqv3lX5L\u002fY6N2\u002fNXrXv5YL0b\u002fxnMq\u002fUC7Ev6+\u002fvb8MUbe\u002fa+Kwv8hzqr8lBaS\u002fg5adv+Anl789uZC\u002fnkqKv\u002fnbg7+02nq\u002fbv1tvyggYb\u002fmQlS\u002foGVHv16IOr8Yqy2\u002f0s0gv5DwE79OEwe\u002fB2z0voux2r7\u002f9sC+ezynvu6Bjb7Ejme+vBk0vqSkAL5WX5q9F9TNvCzUzTw8X5o9pqQAPr8ZND7Hjmc+8IGNPnQ8pz4A98A+hLHaPhBs9D5OEwc\u002fkPATP9LNID8Zqy0\u002fX4g6P6FlRz\u002fjQlQ\u002fKSBhP2\u002f9bT+x2no\u002f+9uDP51Kij9AuZA\u002f4SeXP4OWnT8lBaQ\u002fyHOqP2risD8MUbc\u002frb+9P08uxD\u002fynMo\u002flAvRPzV61z\u002fX6N0\u002felfkPxzG6j++NPE\u002fYKP3PwQS\u002fj9SQAJAo3cFQPSuCEBG5gtAlh0PQOdUEkA4jBVAicMYQNv6G0AsMh9AfWkiQM6gJUAf2ChAcA8sQMFGL0ASfjJAY7U1QLTsOEAFJDxAVls\u002fQKeSQkD4yUVASQFJQJo4TEDrb09APKdSQI3eVUDeFVlAME1cQICEX0DSu2JAI\u002fNlQHQqaUDFYWxAFplvQGfQckC4B3ZACT95QFp2fECrrX9AfnKBQCcOg0DPqYRAeEWGQCDhh0DJfIlAcRiLQBq0jEDCT45Aa+uPQBOHkUC8IpNAZL6UQA1alkC19ZdAXpGZQAYtm0CvyJxAV2SeQAAAoEA="},"y":{"dtype":"f4","bdata":"yM09PojyQD7bKUQ+RHRHPkjSSj50RE4+XctRPpBnVT6qGVk+SeJcPg3CYD6cuWQ+o8loPsvybD7WNXE+bpN1PlwMej5ZoX4+namBPmARhD5hiIY+DQ+JPs2liz4UTY4+VgWRPgXPkz6dqpY+kZiZPmCZnD6IrZ8+hNWiPtcRpj4DY6k+ismsPvFFsD662LM+aYK3PoRDuz6LHL8+AQ7DPmgYxz43PMs+63nPPvzR0z7URNg+5dLcPop84T4iQuY+AiTrPmci8D6UPfU+snX6PtvK\u002fz6OngI\u002fNGYFP1E8CD\u002fJIAs\u002fcRMOPxIUET9nIhQ\u002fFT4XP69mGj+4mx0\u002fmNwgP6MoJD8Vfyc\u002fD98qP5RHLj+QtzE\u002fyi01P++oOD+KJzw\u002fBqg\u002fP60oQz+lp0Y\u002f9iJKP4WYTT8aBlE\u002fV2lUP9C\u002fVz\u002fsBls\u002fDjxeP3VcYT9aZWQ\u002f6lNnP0Ylaj+U1mw\u002fAGVvP77NcT8YDnQ\u002fcyN2P1ELeD9bw3k\u002fbUl7P5WbfD8cuH0\u002fh51+P6tKfz+bvn8\u002fuvh\u002fP7r4fz+bvn8\u002fq0p\u002fP4edfj8cuH0\u002flZt8P21Jez9bw3k\u002fUQt4P3Mjdj8YDnQ\u002fvs1xPwBlbz+U1mw\u002fRiVqP+hTZz9cZWQ\u002fdVxhPww8Xj\u002ftBls\u002fz79XP1hpVD8XBlE\u002fhZhNP\u002fYiSj+lp0Y\u002frShDPwaoPz+KJzw\u002f76g4P8stNT+QtzE\u002flUcuPw\u002ffKj8Wfyc\u002foygkP5jcID+4mx0\u002fr2YaPxQ+Fz9oIhQ\u002fFBQRP3ETDj\u002fHIAs\u002fUTwIPzVmBT+OngI\u002f3cr\u002fPrJ1+j6UPfU+ZyLwPgAk6z4iQuY+inzhPuXS3D7URNg+\u002fNHTPut5zz43PMs+aBjHPgQOwz6LHL8+hEO7PmuCtz682LM+8UWwPovJrD4EY6k+1xGmPoTVoj6HrZ8+YJmcPpGYmT6bqpY+Bs+TPlYFkT4UTY4+zKWLPgsPiT5hiIY+YBGEPp2pgT5doX4+XAx6Pm6TdT7WNXE+z\u002fJsPqPJaD6cuWQ+DcJgPkniXD6qGVk+kGdVPlvLUT52RE4+SNJKPkR0Rz7bKUQ+i\u002fJAPsjNPT4="},"type":"scatter"},{"line":{"color":"#FF9800"},"mode":"lines","name":"Geman-McClure","x":{"dtype":"f4","bdata":"AACgwFhknsCvyJzABi2bwF6RmcC29ZfADFqWwGS+lMC8IpPAE4eRwGvrj8DCT47AGrSMwHIYi8DIfInAIOGHwHhFhsDQqYTAJg6DwH5ygcCsrX\u002fAWXZ8wAg\u002fecC4B3bAZ9BywBeZb8DEYWzAdCppwCPzZcDRu2LAgIRfwDBNXMDfFVnAj95VwDynUsDsb0\u002fAmzhMwEkBScD4yUXAqJJCwFZbP8AGJDzAtOw4wGK1NcASfjLAwEYvwHAPLMAf2CjAzaAlwH1pIsAsMh\u002fA2\u002fobwIrDGMA4jBXA6FQSwJYdD8BF5gvA9K4IwKR3BcBTQALAAxL+v2Cj97+\u002fNPG\u002fHMbqv3lX5L\u002fY6N2\u002fNXrXv5YL0b\u002fxnMq\u002fUC7Ev6+\u002fvb8MUbe\u002fa+Kwv8hzqr8lBaS\u002fg5adv+Anl789uZC\u002fnkqKv\u002fnbg7+02nq\u002fbv1tvyggYb\u002fmQlS\u002foGVHv16IOr8Yqy2\u002f0s0gv5DwE79OEwe\u002fB2z0voux2r7\u002f9sC+ezynvu6Bjb7Ejme+vBk0vqSkAL5WX5q9F9TNvCzUzTw8X5o9pqQAPr8ZND7Hjmc+8IGNPnQ8pz4A98A+hLHaPhBs9D5OEwc\u002fkPATP9LNID8Zqy0\u002fX4g6P6FlRz\u002fjQlQ\u002fKSBhP2\u002f9bT+x2no\u002f+9uDP51Kij9AuZA\u002f4SeXP4OWnT8lBaQ\u002fyHOqP2risD8MUbc\u002frb+9P08uxD\u002fynMo\u002flAvRPzV61z\u002fX6N0\u002felfkPxzG6j++NPE\u002fYKP3PwQS\u002fj9SQAJAo3cFQPSuCEBG5gtAlh0PQOdUEkA4jBVAicMYQNv6G0AsMh9AfWkiQM6gJUAf2ChAcA8sQMFGL0ASfjJAY7U1QLTsOEAFJDxAVls\u002fQKeSQkD4yUVASQFJQJo4TEDrb09APKdSQI3eVUDeFVlAME1cQICEX0DSu2JAI\u002fNlQHQqaUDFYWxAFplvQGfQckC4B3ZACT95QFp2fECrrX9AfnKBQCcOg0DPqYRAeEWGQCDhh0DJfIlAcRiLQBq0jEDCT45Aa+uPQBOHkUC8IpNAZL6UQA1alkC19ZdAXpGZQAYtm0CvyJxAV2SeQAAAoEA="},"y":{"dtype":"f4","bdata":"vOTBOkuSyTpNodE6hhfaOib74jrXUuw6wSX2OrM9ADv\u002frQU7KWgLO99wETs0zRc7j4IeO8mWJTs1EC07i\u002fU0OxpOPTvHIUY7HXlPOzJdWTsC2GM7VfRuO8K9ejtwoIM7t0WKOx5WkTu82Zg7TtmgO2deqTtyc7I7vyO8O657xjvOiNE74FndOx\u002f\u002f6Ts1ivc7TwcDPNrQCjxvLRM88ykcPKPUJTwXPTA8oXQ7PFCORzwtn1Q8or5iPHgGcjy6SYE8tEKKPNz\u002fkzzrlJ480heqPA6htjz0S8Q8ADfTPG2E4zxmWvU843EEPUcoDz1a6xo9X9knPVUUNj1vwkU9qQ5XPVUpaj20SH897VSLPZ9ImD3ypaY95Je2PZ5OyD3W\u002f9s9JefxPVEjBT50sxI+ssshPhaXMj68Q0U+TQJaPnQFcT4KQIU+FVKTPuHPoj75zLM+XFfGPst02j7OH\u002fA+FaIDP5XdDz8NpBw\u002fksopP3wYNz+pR0Q\u002fNAVRP2T0XD\u002fHsmc\u002fId5wP1cbeD+UHX0\u002fVa1\u002fP1Wtfz+YHX0\u002fVxt4PyHecD\u002fHsmc\u002fYfRcPzcFUT+pR0Q\u002fghg3P4vKKT8NpBw\u002fld0PPxWiAz\u002fMH\u002fA+x3TaPlxXxj7+zLM+38+iPhRSkz4OQIU+bQVxPlACWj6xQ0U+EZcyPrLLIT50sxI+USMFPirn8T3W\u002f9s9pE7IPeiXtj3wpaY9okiYPe1Uiz20SH89TilqPakOVz1xwkU9VRQ2PV\u002fZJz1f6xo9SigPPeNxBD1hWvU8bYTjPAc30zz0S8Q8EaG2PNIXqjzrlJ483P+TPLJCijy6SYE8eAZyPJu+Yjwtn1Q8So5HPKF0OzwcPTA8o9QlPPcpHDxvLRM82tAKPFIHAzw7ivc7H\u002f\u002fpO+dZ3TvSiNE7rnvGO78jvDtvc7I7Z16pO07ZoDu62Zg7H1aRO7dFijtwoIM7ur16O1L0bjsF2GM7Ml1ZOxZ5TzvMIUY7Gk49O4v1NDsxEC07zZYlO4+CHjs0zRc733AROyloCzv\u002frQU7sz0AO7ol9jrcUuw6JvviOoYX2jpNodE6UZLJOrzkwTo="},"type":"scatter"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermap":[{"type":"scattermap","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"margin":{"t":40,"b":40,"l":60,"r":40},"legend":{"yanchor":"top","y":0.99,"xanchor":"right","x":0.99},"title":{"text":"Robust Weight Functions"},"xaxis":{"title":{"text":"Residual"}},"yaxis":{"title":{"text":"Weight"}},"height":350},                        {"responsive": true}                    )                };            </script>        </div></div></div>
</div>
</section>
<section id="irls-with-jaxls">
<h2>IRLS with jaxls<a class="headerlink" href="#irls-with-jaxls" title="Link to this heading">#</a></h2>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Iteratively_reweighted_least_squares">Iteratively reweighted least squares</a> (IRLS) is an algorithm for robust estimation. The key to implementing IRLS in jaxls is using <code class="docutils literal notranslate"><span class="pre">jax.lax.stop_gradient</span></code> on the weights. This tells JAX to treat the weights as constants when computing Jacobians, so the solver sees a weighted least squares problem at each iteration. As the solution changes across iterations, the weights automatically update, implementing IRLS without an explicit outer loop.</p>
<p>The cost function computes:</p>
<ol class="arabic simple">
<li><p>Residual <span class="math notranslate nohighlight">\(r_i = \|p - p_{\text{circle}}\|\)</span> for each point</p></li>
<li><p>Weight <span class="math notranslate nohighlight">\(w_i = \psi(r_i)\)</span> using the M-estimator, with <code class="docutils literal notranslate"><span class="pre">stop_gradient</span></code></p></li>
<li><p>Weighted residual <span class="math notranslate nohighlight">\(\sqrt{w_i} \cdot r_i\)</span></p></li>
</ol>
<p>Since jaxls squares residuals, the objective becomes <span class="math notranslate nohighlight">\(\sum_i w_i r_i^2\)</span>, exactly the IRLS formulation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">make_robust_circle_cost</span><span class="p">(</span><span class="n">weight_fn</span><span class="p">:</span> <span class="nb">callable</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a robust circle cost with IRLS weights via stop_gradient.</span>

<span class="sd">    Args:</span>
<span class="sd">        weight_fn: Function mapping residual magnitude to weight (e.g., cauchy_weight).</span>

<span class="sd">    Returns:</span>
<span class="sd">        A jaxls cost factory that applies robust weighting.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nd">@jaxls</span><span class="o">.</span><span class="n">Cost</span><span class="o">.</span><span class="n">factory</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">robust_circle_residual</span><span class="p">(</span>
        <span class="n">vals</span><span class="p">:</span> <span class="n">jaxls</span><span class="o">.</span><span class="n">VarValues</span><span class="p">,</span>
        <span class="n">circle</span><span class="p">:</span> <span class="n">CircleVar</span><span class="p">,</span>
        <span class="n">point</span><span class="p">:</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;2D residual with automatic IRLS weighting.&quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="n">vals</span><span class="p">[</span><span class="n">circle</span><span class="p">]</span>
        <span class="n">cx</span><span class="p">,</span> <span class="n">cy</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">params</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">params</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">diff</span> <span class="o">=</span> <span class="n">point</span> <span class="o">-</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">cx</span><span class="p">,</span> <span class="n">cy</span><span class="p">])</span>
        <span class="n">dist</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">diff</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1e-8</span><span class="p">)</span>
        <span class="n">direction</span> <span class="o">=</span> <span class="n">diff</span> <span class="o">/</span> <span class="n">dist</span>
        <span class="n">residual</span> <span class="o">=</span> <span class="n">dist</span> <span class="o">-</span> <span class="n">r</span>

        <span class="c1"># Compute weight from current residual, but stop gradients.</span>
        <span class="c1"># This makes the optimizer treat weights as constants, implementing IRLS.</span>
        <span class="n">weight</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">lax</span><span class="o">.</span><span class="n">stop_gradient</span><span class="p">(</span><span class="n">weight_fn</span><span class="p">(</span><span class="n">residual</span><span class="p">))</span>
        <span class="n">sqrt_weight</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">weight</span> <span class="o">+</span> <span class="mf">1e-8</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">sqrt_weight</span> <span class="o">*</span> <span class="n">residual</span> <span class="o">*</span> <span class="n">direction</span>

    <span class="k">return</span> <span class="n">robust_circle_residual</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">compute_weights</span><span class="p">(</span>
    <span class="n">params</span><span class="p">:</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">,</span> <span class="n">points</span><span class="p">:</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">,</span> <span class="n">weight_fn</span><span class="p">:</span> <span class="nb">callable</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute IRLS weights for visualization.&quot;&quot;&quot;</span>
    <span class="n">cx</span><span class="p">,</span> <span class="n">cy</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">params</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">params</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">dists</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">points</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">cx</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">points</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">cy</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="mf">1e-8</span><span class="p">)</span>
    <span class="n">residuals</span> <span class="o">=</span> <span class="n">dists</span> <span class="o">-</span> <span class="n">r</span>
    <span class="k">return</span> <span class="n">weight_fn</span><span class="p">(</span><span class="n">residuals</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="robust-fitting-with-cauchy-weights">
<h2>Robust fitting with Cauchy weights<a class="headerlink" href="#robust-fitting-with-cauchy-weights" title="Link to this heading">#</a></h2>
<p>With the <code class="docutils literal notranslate"><span class="pre">stop_gradient</span></code> approach, robust fitting is just a single <code class="docutils literal notranslate"><span class="pre">solve()</span></code> call:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create robust cost with Cauchy weights.</span>
<span class="n">cauchy_weight_fn</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">r</span><span class="p">:</span> <span class="n">cauchy_weight</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">robust_cost</span> <span class="o">=</span> <span class="n">make_robust_circle_cost</span><span class="p">(</span><span class="n">cauchy_weight_fn</span><span class="p">)</span>

<span class="c1"># Build and solve (just one call - IRLS happens automatically via solver iterations).</span>
<span class="n">costs_irls</span> <span class="o">=</span> <span class="p">[</span><span class="n">robust_cost</span><span class="p">(</span><span class="n">CircleVar</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_points</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">int32</span><span class="p">)),</span> <span class="n">points</span><span class="p">)]</span>

<span class="n">initial_vals</span> <span class="o">=</span> <span class="n">jaxls</span><span class="o">.</span><span class="n">VarValues</span><span class="o">.</span><span class="n">make</span><span class="p">([</span><span class="n">circle_var</span><span class="o">.</span><span class="n">with_value</span><span class="p">(</span><span class="n">initial_params</span><span class="p">)])</span>
<span class="n">problem_irls</span> <span class="o">=</span> <span class="n">jaxls</span><span class="o">.</span><span class="n">LeastSquaresProblem</span><span class="p">(</span><span class="n">costs_irls</span><span class="p">,</span> <span class="p">[</span><span class="n">circle_var</span><span class="p">])</span><span class="o">.</span><span class="n">analyze</span><span class="p">()</span>
<span class="n">solution_irls</span> <span class="o">=</span> <span class="n">problem_irls</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">initial_vals</span><span class="p">)</span>

<span class="n">params_irls</span> <span class="o">=</span> <span class="n">solution_irls</span><span class="p">[</span><span class="n">circle_var</span><span class="p">]</span>
<span class="n">weights_irls</span> <span class="o">=</span> <span class="n">compute_weights</span><span class="p">(</span><span class="n">params_irls</span><span class="p">,</span> <span class="n">points</span><span class="p">,</span> <span class="n">cauchy_weight_fn</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;IRLS result:     center=(</span><span class="si">{</span><span class="n">params_irls</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">params_irls</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">), radius=</span><span class="si">{</span><span class="n">params_irls</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;True parameters: center=(</span><span class="si">{</span><span class="n">true_cx</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">true_cy</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">), radius=</span><span class="si">{</span><span class="n">true_r</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Center error: </span><span class="si">{</span><span class="n">jnp</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">params_irls</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">true_cx</span><span class="p">)</span><span class="w"> </span><span class="o">**</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">params_irls</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">true_cy</span><span class="p">)</span><span class="w"> </span><span class="o">**</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Radius error: </span><span class="si">{</span><span class="n">jnp</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">params_irls</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">true_r</span><span class="p">)</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Bold">INFO    </span> | Building optimization problem with 50 terms and 1 variables: 50 costs, 0 eq_zero, 0 leq_zero, 0 geq_zero
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 50 costs, 1 variables each: robust_circle_residual
<span class=" -Color -Color-Bold">INFO    </span> |  step #0: cost=6.1968 lambd=0.0005 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - robust_circle_residual(50): 6.19684 (avg 0.06197)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=9.32e+00 cost_prev=6.1968 cost_new=2.7644
<span class=" -Color -Color-Bold">INFO    </span> |  step #1: cost=2.7644 lambd=0.0003 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - robust_circle_residual(50): 2.76435 (avg 0.02764)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=2.87e+00 cost_prev=2.7644 cost_new=2.4958
<span class=" -Color -Color-Bold">INFO    </span> |  step #2: cost=2.4958 lambd=0.0001 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - robust_circle_residual(50): 2.49581 (avg 0.02496)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=2.61e-01 cost_prev=2.4958 cost_new=2.4868
<span class=" -Color -Color-Bold">INFO    </span> |  step #3: cost=2.4868 lambd=0.0001 inexact_tol=7.5e-03
<span class=" -Color -Color-Bold">INFO    </span> |      - robust_circle_residual(50): 2.48685 (avg 0.02487)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=2.36e-02 cost_prev=2.4868 cost_new=2.4862
<span class=" -Color -Color-Bold">INFO    </span> |  step #4: cost=2.4862 lambd=0.0000 inexact_tol=7.3e-03
<span class=" -Color -Color-Bold">INFO    </span> |      - robust_circle_residual(50): 2.48620 (avg 0.02486)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=2.40e-03 cost_prev=2.4862 cost_new=2.4861
<span class=" -Color -Color-Bold">INFO    </span> |  step #5: cost=2.4861 lambd=0.0000 inexact_tol=7.3e-03
<span class=" -Color -Color-Bold">INFO    </span> |      - robust_circle_residual(50): 2.48614 (avg 0.02486)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=False ATb_norm=2.81e-04 cost_prev=2.4861 cost_new=2.4861
<span class=" -Color -Color-Bold">INFO    </span> | Terminated @ iteration #6: cost=2.4861 criteria=[1 0 0], term_deltas=1.9e-06,2.7e-04,4.9e-06
IRLS result:     center=(0.975, 1.009), radius=2.015
True parameters: center=(1.000, 1.000), radius=2.000

Center error: 0.0266
Radius error: 0.0150
</pre></div>
</div>
</div>
</div>
</section>
<section id="visualization">
<h2>Visualization<a class="headerlink" href="#visualization" title="Link to this heading">#</a></h2>
<p>Compare standard least squares (pulled by outliers) vs IRLS (robust to outliers):</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">plotly.subplots</span><span class="w"> </span><span class="kn">import</span> <span class="n">make_subplots</span>

<span class="n">fig_compare</span> <span class="o">=</span> <span class="n">make_subplots</span><span class="p">(</span>
    <span class="n">rows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">cols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">subplot_titles</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;Standard Least Squares&quot;</span><span class="p">,</span> <span class="s2">&quot;IRLS (Cauchy)&quot;</span><span class="p">),</span>
<span class="p">)</span>

<span class="c1"># Common elements for both plots.</span>
<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]:</span>
    <span class="c1"># Inlier points.</span>
    <span class="n">fig_compare</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
        <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
            <span class="n">x</span><span class="o">=</span><span class="n">all_x</span><span class="p">[</span><span class="o">~</span><span class="n">is_outlier</span><span class="p">],</span>
            <span class="n">y</span><span class="o">=</span><span class="n">all_y</span><span class="p">[</span><span class="o">~</span><span class="n">is_outlier</span><span class="p">],</span>
            <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;markers&quot;</span><span class="p">,</span>
            <span class="n">marker</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#2196F3&quot;</span><span class="p">),</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Inliers&quot;</span><span class="p">,</span>
            <span class="n">showlegend</span><span class="o">=</span><span class="p">(</span><span class="n">col</span> <span class="o">==</span> <span class="mi">1</span><span class="p">),</span>
        <span class="p">),</span>
        <span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">col</span><span class="o">=</span><span class="n">col</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># Outlier points.</span>
    <span class="n">fig_compare</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
        <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
            <span class="n">x</span><span class="o">=</span><span class="n">all_x</span><span class="p">[</span><span class="n">is_outlier</span><span class="p">],</span>
            <span class="n">y</span><span class="o">=</span><span class="n">all_y</span><span class="p">[</span><span class="n">is_outlier</span><span class="p">],</span>
            <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;markers&quot;</span><span class="p">,</span>
            <span class="n">marker</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#F44336&quot;</span><span class="p">,</span> <span class="n">symbol</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">),</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Outliers&quot;</span><span class="p">,</span>
            <span class="n">showlegend</span><span class="o">=</span><span class="p">(</span><span class="n">col</span> <span class="o">==</span> <span class="mi">1</span><span class="p">),</span>
        <span class="p">),</span>
        <span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">col</span><span class="o">=</span><span class="n">col</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># True circle.</span>
    <span class="n">true_circle</span> <span class="o">=</span> <span class="n">make_circle_trace</span><span class="p">(</span>
        <span class="n">true_cx</span><span class="p">,</span> <span class="n">true_cy</span><span class="p">,</span> <span class="n">true_r</span><span class="p">,</span> <span class="s2">&quot;True circle&quot;</span><span class="p">,</span> <span class="s2">&quot;#4CAF50&quot;</span><span class="p">,</span> <span class="s2">&quot;dash&quot;</span>
    <span class="p">)</span>
    <span class="n">true_circle</span><span class="o">.</span><span class="n">showlegend</span> <span class="o">=</span> <span class="n">col</span> <span class="o">==</span> <span class="mi">1</span>
    <span class="n">fig_compare</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">true_circle</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="n">col</span><span class="p">)</span>

<span class="c1"># Standard LS result.</span>
<span class="n">fig_compare</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
    <span class="n">make_circle_trace</span><span class="p">(</span>
        <span class="nb">float</span><span class="p">(</span><span class="n">params_standard</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
        <span class="nb">float</span><span class="p">(</span><span class="n">params_standard</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
        <span class="nb">float</span><span class="p">(</span><span class="n">params_standard</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span>
        <span class="s2">&quot;Standard LS&quot;</span><span class="p">,</span>
        <span class="s2">&quot;#FF9800&quot;</span><span class="p">,</span>
    <span class="p">),</span>
    <span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">col</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># IRLS result.</span>
<span class="n">fig_compare</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
    <span class="n">make_circle_trace</span><span class="p">(</span>
        <span class="nb">float</span><span class="p">(</span><span class="n">params_irls</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
        <span class="nb">float</span><span class="p">(</span><span class="n">params_irls</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
        <span class="nb">float</span><span class="p">(</span><span class="n">params_irls</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span>
        <span class="s2">&quot;IRLS&quot;</span><span class="p">,</span>
        <span class="s2">&quot;#9C27B0&quot;</span><span class="p">,</span>
    <span class="p">),</span>
    <span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">col</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">fig_compare</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span><span class="n">title_text</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">scaleanchor</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">scaleratio</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">fig_compare</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="n">title_text</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">)</span>
<span class="n">fig_compare</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
    <span class="n">height</span><span class="o">=</span><span class="mi">450</span><span class="p">,</span>
    <span class="n">margin</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">t</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">l</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="mi">40</span><span class="p">),</span>
    <span class="n">legend</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">orientation</span><span class="o">=</span><span class="s2">&quot;h&quot;</span><span class="p">,</span> <span class="n">yanchor</span><span class="o">=</span><span class="s2">&quot;bottom&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=-</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">xanchor</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mf">0.5</span><span class="p">),</span>
<span class="p">)</span>
<span class="n">HTML</span><span class="p">(</span><span class="n">fig_compare</span><span class="o">.</span><span class="n">to_html</span><span class="p">(</span><span class="n">full_html</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">include_plotlyjs</span><span class="o">=</span><span class="s2">&quot;cdn&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><div>                        <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-3.3.0.min.js" integrity="sha256-bO3dS6yCpk9aK4gUpNELtCiDeSYvGYnK7jFI58NQnHI=" crossorigin="anonymous"></script>                <div id="7d7f3bdd-475c-43e3-83bd-a1c05a7b5f38" class="plotly-graph-div" style="height:450px; width:100%;"></div>            <script type="text/javascript">                window.PLOTLYENV=window.PLOTLYENV || {};                                if (document.getElementById("7d7f3bdd-475c-43e3-83bd-a1c05a7b5f38")) {                    Plotly.newPlot(                        "7d7f3bdd-475c-43e3-83bd-a1c05a7b5f38",                        [{"marker":{"color":"#2196F3","size":8},"mode":"markers","name":"Inliers","showlegend":true,"x":{"dtype":"f8","bdata":"uJO90tUv2r8UqAuC2m4GQD\u002fo4xtFeug\u002fkPsdi5np4L+u2ShhYQABQG3QMUySCQBAwjQjTCX0BUCwVyLeP8YCQBSMMQsOauW\u002fUkRiJQ9i3j+3G15ZTcYHQDvZtCxyegdAd3A6BF+s\u002fj\u002fizeOuUDv3P7KlQM9j\u002fPw\u002fZQVHDZSw\u002fT+26Cds+HrUP\u002f7tahpYp+m\u002fSHqzZWou6786psLXrdffP4CwE+gJXd6\u002fNusL0hGNAkDg9azz58XcP\u002fyotDYvctm\u002fCFjYwlz+6r\u002f1y1cgGuj2P8xlQumfHfo\u002ffFjrZz5t8b\u002fInF6\u002ffTrkv3AiguFeLgdA7Fa9qRBZ3r8F2398PGj+PwTq2g9LRwdAwJCV+x82CECDOeR3d5IHQMLQSltJDvw\u002fFswdsLwn1D8GfO+DlKgEQAggHUFuV8c\u002fQiT5xpMN8L8="},"y":{"dtype":"f8","bdata":"OkkuurRWA0BQ4hoKNg7bPz7NVaBjGvG\u002fECUiMo9Jt78oCQNw620FQOLcwb+y\u002fANAtteBMJWp+j94Ewjqlyngvwj2d5uZh82\u002ffP87Ok1S7r86ev8Kdhr0PyYbbc4vJ+Q\u002fqMu\u002fsUZ+478CTYPriv4GQJpoPSMcOAZAIFOnlHJkB0CuOWw3vFYHQDLb\u002fn9\u002f9eY\u002f0wY3JjB8\u002fT8SY2EgGSsHQDCjF7WP3c+\u002fCpNk1firBECC0D\u002f8BD0IQCSxzG4ldwRAXKhBZ+Ba+D9a6n1bUHrtv5GHbXVndQdAlGSlAzoB6j+gJRzvASSyv7itiao1H\u002fk\u002fsN1RJN1Cx785J2VcwzQFQB0PX4QlPP0\u002f8uRQjrja1D\u002f8uPUQG1biP4Z+wZLKvO6\u002f\u002fP840vJWB0BUn+TdweoAQEBl9McYrOu\u002fnio5Cbqn\u002fD8="},"type":"scatter","xaxis":"x","yaxis":"y"},{"marker":{"color":"#F44336","size":10,"symbol":"x"},"mode":"markers","name":"Outliers","showlegend":true,"x":{"dtype":"f8","bdata":"UIvonyzsEUDSuONSdOj2PxB0ohdAAPw\u002f\u002fxLhhJN+5j8U1CqgW8MNwHD1xwNsgQbAnIclm\u002fY7DcB8pDrCDQEIQJtDN\u002fvAWOG\u002fhSVNOymC+T8="},"y":{"dtype":"f8","bdata":"vi3EKdTuF0Dg67Oq4x\u002f0vx7FwAttdOA\u002fA+mdLIc+EUBE2UEVRbv3v0iYae3LOQnAT\u002fFtxeoB6r9DmlDAAdABwCoXb0Yd6BhAkUAg\u002f6qOE0A="},"type":"scatter","xaxis":"x","yaxis":"y"},{"line":{"color":"#4CAF50","dash":"dash","width":2},"mode":"lines","name":"True circle","showlegend":true,"x":{"dtype":"f8","bdata":"AAAAAAAACEDKpZTgwPcHQDR9gwIM3wdAkvSb3fq1B0CSPwvHt3wHQPgkucV9MwdArlhvVZjaBkC\u002fGgoZY3IGQLBQAnxJ+wVAXXiyQ8Z1BUArmcgQY+IEQByoZ9G3QQRA2pyKJGqUA0BLqEqvLNsCQKCJuGS+FgJAgtUGwelHAUAuFtD4g28AQKvanzrYHP8\u002fW4njbBRL\u002fT\u002fFKUSnnGv7P66hsShfgPk\u002foxa4UlaL9z\u002fj3IKfho71P4Qdd438i\u002fM\u002fBwKLgsqF8T9TcA1TDfzuP73NxZaR7eo\u002fkV34TVDk5j\u002fYEKqScuTiP9r+eqIv5N0\u002fhr39EKMi1j8k0y1gfBjNP6izOQtNo7w\u002fAAAAAAAAwLzwbM4daZu7v3CmZYg8Ccu\u002fHGLd\u002fXnS079s+9Ta7cnZv3RJHVPTZN+\u002fTMC1o7FO4r+6OO76HbfkvxSzFkMz6ea\u002fguXfE67i6L+ynxBehaHqvzZapITsI+y\u002frqCaN1Vo7b+G5I0OcW3uvwh6auEyMu+\u002fvGji3c+1778ODoBYwPfvvw4OgFjA9++\u002fvGji3c+1778IemrhMjLvv4bkjQ5xbe6\u002frqCaN1Vo7b84WqSE7CPsv7KfEF6Foeq\u002fhOXfE67i6L8SsxZDM+nmv7w47vodt+S\u002fSsC1o7FO4r94SR1T02Tfv2j71Nrtydm\u002fIGLd\u002fXnS079gpmWIPAnLvxBtzh1pm7u\u002fAAAAAAAAzDzAszkLTaO8PyTTLWB8GM0\u002ffr39EKMi1j\u002fo\u002fnqiL+TdP9wQqpJy5OI\u002fkV34TVDk5j+4zcWWke3qP1twDVMN\u002fO4\u002fCQKLgsqF8T+CHXeN\u002fIvzP9\u002fcgp+GjvU\u002fpRa4UlaL9z+tobEoX4D5P8MpRKeca\u002fs\u002fXonjbBRL\u002fT+s2p862Bz\u002fPy4W0PiDbwBAgNUGwelHAUCiibhkvhYCQEyoSq8s2wJA2pyKJGqUA0AcqGfRt0EEQCyZyBBj4gRAXXiyQ8Z1BUCwUAJ8SfsFQL4aChljcgZArlhvVZjaBkD4JLnFfTMHQJI\u002fC8e3fAdAk\u002fSb3fq1B0A0fYMCDN8HQMqllODA9wdAAAAAAAAACEA="},"y":{"dtype":"f8","bdata":"AAAAAAAA8D\u002fAsJaZkQfyP\u002fygAJ4LDfQ\u002fJCsooFgO9j9NxOyAZwn4P+wPkZAt\u002fPk\u002f\u002fsmGqajk+z9BIG1C4cD9P4wmH3Xsjv8\u002fBqxd\u002fHamAECjQk0GjXwBQA4LHqnbSAJAAIwfSpAKA0DDjEk848ADQESgEI4YawRAy6Aiy4AIBUA8Z0OxeZgFQBlOj9duGgZAChZ3R9qNBkDgeNcGRfIGQP4RnpJHRwdAcC99SYqMB0AMjkDGxcEHQBrjZSnD5gdAQlatUVz7B0D4nGcDfP8HQDMzWf4d8wdAeCEcAk\u002fWB0Dgy\u002fvALKkHQAJWWMHlawdA4imxLbkeB0DKEYiT9sEGQKgDYJH9VQZAVSYsdD3bBUBIq5TENFIFQEvBh8RwuwRAUBSd3YwXBEDb8+EAMmcDQOlDs\u002fgVqwJAebxYrfrjAUAToyJdrRIBQLEJ2MgFOABAeVSfqsqp\u002fj\u002ftQDFGbNT8P\u002fwFRTrU8fo\u002f4Ea7\u002fvMD+T95CqmsyAz3PzqxjfFYDvU\u002ffOqo+LIK8z+7zZdM6gPxP4dk0GYr+O0\u002fBiuuDprq6T+KneQcTuPlPxLrraZu5uE\u002ffOQSBTDw2z8Y6OsWrzjUP4z4dc6dXMk\u002fkLgKVlVjtT\u002fA2ARs5AKcvyAxKtLVKsG\u002fmMeL1ao\u002fzr9EH5rFr1jVv9yeDweQOdu\u002fQFF0djNe4L8uBR8Sw+3ivyCtUhLTSOW\u002fWJmw0PVs57+kDoBF9lfpvyZHIE7aB+u\u002fiKfEtuR67L8IWGEFl6\u002ftv34v7wOzpO6\u002f3oVwCDxZ77\u002fKzGT5d8zvv95zng3w\u002fe+\u002fBlm1RnHt779ojJelDJvvvzA4AhkXB++\u002fvr30JSky7r\u002f6R3hKHh3tv4TjXRsUyeu\u002fJFjcHWk36r9iOD1eu2nov+6cDcXmYea\u002fLoOKLAMi5L8MgUI4YqzhvxRmTOIZB96\u002fAGD8UIJU2L98WPBI3UbSvyAq1GTQyMe\u002fsIC1i9\u002fOtL+gXDa44kScP+T9luz1+ME\u002fFtjkWV1t0D9OwLu9SQ\u002fYP8buTPxh2t8\u002fwKmvv07j4z8Mvv7D6OXnP3+e0szc8Os\u002f\u002fP\u002f\u002f\u002f\u002f\u002f\u002f7z8="},"type":"scatter","xaxis":"x","yaxis":"y"},{"marker":{"color":"#2196F3","size":8},"mode":"markers","name":"Inliers","showlegend":false,"x":{"dtype":"f8","bdata":"uJO90tUv2r8UqAuC2m4GQD\u002fo4xtFeug\u002fkPsdi5np4L+u2ShhYQABQG3QMUySCQBAwjQjTCX0BUCwVyLeP8YCQBSMMQsOauW\u002fUkRiJQ9i3j+3G15ZTcYHQDvZtCxyegdAd3A6BF+s\u002fj\u002fizeOuUDv3P7KlQM9j\u002fPw\u002fZQVHDZSw\u002fT+26Cds+HrUP\u002f7tahpYp+m\u002fSHqzZWou6786psLXrdffP4CwE+gJXd6\u002fNusL0hGNAkDg9azz58XcP\u002fyotDYvctm\u002fCFjYwlz+6r\u002f1y1cgGuj2P8xlQumfHfo\u002ffFjrZz5t8b\u002fInF6\u002ffTrkv3AiguFeLgdA7Fa9qRBZ3r8F2398PGj+PwTq2g9LRwdAwJCV+x82CECDOeR3d5IHQMLQSltJDvw\u002fFswdsLwn1D8GfO+DlKgEQAggHUFuV8c\u002fQiT5xpMN8L8="},"y":{"dtype":"f8","bdata":"OkkuurRWA0BQ4hoKNg7bPz7NVaBjGvG\u002fECUiMo9Jt78oCQNw620FQOLcwb+y\u002fANAtteBMJWp+j94Ewjqlyngvwj2d5uZh82\u002ffP87Ok1S7r86ev8Kdhr0PyYbbc4vJ+Q\u002fqMu\u002fsUZ+478CTYPriv4GQJpoPSMcOAZAIFOnlHJkB0CuOWw3vFYHQDLb\u002fn9\u002f9eY\u002f0wY3JjB8\u002fT8SY2EgGSsHQDCjF7WP3c+\u002fCpNk1firBECC0D\u002f8BD0IQCSxzG4ldwRAXKhBZ+Ba+D9a6n1bUHrtv5GHbXVndQdAlGSlAzoB6j+gJRzvASSyv7itiao1H\u002fk\u002fsN1RJN1Cx785J2VcwzQFQB0PX4QlPP0\u002f8uRQjrja1D\u002f8uPUQG1biP4Z+wZLKvO6\u002f\u002fP840vJWB0BUn+TdweoAQEBl9McYrOu\u002fnio5Cbqn\u002fD8="},"type":"scatter","xaxis":"x2","yaxis":"y2"},{"marker":{"color":"#F44336","size":10,"symbol":"x"},"mode":"markers","name":"Outliers","showlegend":false,"x":{"dtype":"f8","bdata":"UIvonyzsEUDSuONSdOj2PxB0ohdAAPw\u002f\u002fxLhhJN+5j8U1CqgW8MNwHD1xwNsgQbAnIclm\u002fY7DcB8pDrCDQEIQJtDN\u002fvAWOG\u002fhSVNOymC+T8="},"y":{"dtype":"f8","bdata":"vi3EKdTuF0Dg67Oq4x\u002f0vx7FwAttdOA\u002fA+mdLIc+EUBE2UEVRbv3v0iYae3LOQnAT\u002fFtxeoB6r9DmlDAAdABwCoXb0Yd6BhAkUAg\u002f6qOE0A="},"type":"scatter","xaxis":"x2","yaxis":"y2"},{"line":{"color":"#4CAF50","dash":"dash","width":2},"mode":"lines","name":"True circle","showlegend":false,"x":{"dtype":"f8","bdata":"AAAAAAAACEDKpZTgwPcHQDR9gwIM3wdAkvSb3fq1B0CSPwvHt3wHQPgkucV9MwdArlhvVZjaBkC\u002fGgoZY3IGQLBQAnxJ+wVAXXiyQ8Z1BUArmcgQY+IEQByoZ9G3QQRA2pyKJGqUA0BLqEqvLNsCQKCJuGS+FgJAgtUGwelHAUAuFtD4g28AQKvanzrYHP8\u002fW4njbBRL\u002fT\u002fFKUSnnGv7P66hsShfgPk\u002foxa4UlaL9z\u002fj3IKfho71P4Qdd438i\u002fM\u002fBwKLgsqF8T9TcA1TDfzuP73NxZaR7eo\u002fkV34TVDk5j\u002fYEKqScuTiP9r+eqIv5N0\u002fhr39EKMi1j8k0y1gfBjNP6izOQtNo7w\u002fAAAAAAAAwLzwbM4daZu7v3CmZYg8Ccu\u002fHGLd\u002fXnS079s+9Ta7cnZv3RJHVPTZN+\u002fTMC1o7FO4r+6OO76HbfkvxSzFkMz6ea\u002fguXfE67i6L+ynxBehaHqvzZapITsI+y\u002frqCaN1Vo7b+G5I0OcW3uvwh6auEyMu+\u002fvGji3c+1778ODoBYwPfvvw4OgFjA9++\u002fvGji3c+1778IemrhMjLvv4bkjQ5xbe6\u002frqCaN1Vo7b84WqSE7CPsv7KfEF6Foeq\u002fhOXfE67i6L8SsxZDM+nmv7w47vodt+S\u002fSsC1o7FO4r94SR1T02Tfv2j71Nrtydm\u002fIGLd\u002fXnS079gpmWIPAnLvxBtzh1pm7u\u002fAAAAAAAAzDzAszkLTaO8PyTTLWB8GM0\u002ffr39EKMi1j\u002fo\u002fnqiL+TdP9wQqpJy5OI\u002fkV34TVDk5j+4zcWWke3qP1twDVMN\u002fO4\u002fCQKLgsqF8T+CHXeN\u002fIvzP9\u002fcgp+GjvU\u002fpRa4UlaL9z+tobEoX4D5P8MpRKeca\u002fs\u002fXonjbBRL\u002fT+s2p862Bz\u002fPy4W0PiDbwBAgNUGwelHAUCiibhkvhYCQEyoSq8s2wJA2pyKJGqUA0AcqGfRt0EEQCyZyBBj4gRAXXiyQ8Z1BUCwUAJ8SfsFQL4aChljcgZArlhvVZjaBkD4JLnFfTMHQJI\u002fC8e3fAdAk\u002fSb3fq1B0A0fYMCDN8HQMqllODA9wdAAAAAAAAACEA="},"y":{"dtype":"f8","bdata":"AAAAAAAA8D\u002fAsJaZkQfyP\u002fygAJ4LDfQ\u002fJCsooFgO9j9NxOyAZwn4P+wPkZAt\u002fPk\u002f\u002fsmGqajk+z9BIG1C4cD9P4wmH3Xsjv8\u002fBqxd\u002fHamAECjQk0GjXwBQA4LHqnbSAJAAIwfSpAKA0DDjEk848ADQESgEI4YawRAy6Aiy4AIBUA8Z0OxeZgFQBlOj9duGgZAChZ3R9qNBkDgeNcGRfIGQP4RnpJHRwdAcC99SYqMB0AMjkDGxcEHQBrjZSnD5gdAQlatUVz7B0D4nGcDfP8HQDMzWf4d8wdAeCEcAk\u002fWB0Dgy\u002fvALKkHQAJWWMHlawdA4imxLbkeB0DKEYiT9sEGQKgDYJH9VQZAVSYsdD3bBUBIq5TENFIFQEvBh8RwuwRAUBSd3YwXBEDb8+EAMmcDQOlDs\u002fgVqwJAebxYrfrjAUAToyJdrRIBQLEJ2MgFOABAeVSfqsqp\u002fj\u002ftQDFGbNT8P\u002fwFRTrU8fo\u002f4Ea7\u002fvMD+T95CqmsyAz3PzqxjfFYDvU\u002ffOqo+LIK8z+7zZdM6gPxP4dk0GYr+O0\u002fBiuuDprq6T+KneQcTuPlPxLrraZu5uE\u002ffOQSBTDw2z8Y6OsWrzjUP4z4dc6dXMk\u002fkLgKVlVjtT\u002fA2ARs5AKcvyAxKtLVKsG\u002fmMeL1ao\u002fzr9EH5rFr1jVv9yeDweQOdu\u002fQFF0djNe4L8uBR8Sw+3ivyCtUhLTSOW\u002fWJmw0PVs57+kDoBF9lfpvyZHIE7aB+u\u002fiKfEtuR67L8IWGEFl6\u002ftv34v7wOzpO6\u002f3oVwCDxZ77\u002fKzGT5d8zvv95zng3w\u002fe+\u002fBlm1RnHt779ojJelDJvvvzA4AhkXB++\u002fvr30JSky7r\u002f6R3hKHh3tv4TjXRsUyeu\u002fJFjcHWk36r9iOD1eu2nov+6cDcXmYea\u002fLoOKLAMi5L8MgUI4YqzhvxRmTOIZB96\u002fAGD8UIJU2L98WPBI3UbSvyAq1GTQyMe\u002fsIC1i9\u002fOtL+gXDa44kScP+T9luz1+ME\u002fFtjkWV1t0D9OwLu9SQ\u002fYP8buTPxh2t8\u002fwKmvv07j4z8Mvv7D6OXnP3+e0szc8Os\u002f\u002fP\u002f\u002f\u002f\u002f\u002f\u002f7z8="},"type":"scatter","xaxis":"x2","yaxis":"y2"},{"line":{"color":"#FF9800","dash":"solid","width":2},"mode":"lines","name":"Standard LS","x":{"dtype":"f8","bdata":"AAAAqBCsCEBx8w0+\u002fKEIQIAYKmTJgwhAMmF1O5dRCEDCpiiCmQsIQIsrPl4YsgdAWVoSE3BFB0AwbUiiEMYGQEAFVVh9NAZAh7glRUyRBUBzGXGhJd0EQP6sTiHDGARAoo\u002fJNO9EA0DOHDM3hGICQN60DI5rcgFAtqdwuJx1AED0iuSfONr+P8Yk+Pf1s\u002fw\u002f7w2Csah6+j9WKsWlmzD4Pxqe8fEq2PU\u002f+vJoiMFz8z8oA7iy1gXxP9azsA3XIe0\u002faK6vpBAv6D+7mR\u002f8czjjP4fdcbQ9htw\u002fhmQqZ1uo0j\u002fIyJiZ2cLBP0C2FuJAj4i\u002fDOR1Gs5+xL9MCGaLlIXTv1woASdzjdy\u002fBAAA4Nmm4r+WObeEqN7mv95d9WrM6eq\u002fyAs4hxrE7r8aII0SzTTxvy9wr39E6\u002fK\u002f1k3vj6+D9L\u002fCUa1Bafz1v17XuT7tU\u002fe\u002fQkijbNmI+L\u002fQjLpZ75n5vyJdVYUVhvq\u002fPBL8gVhM+7+211fw6+v7vxKU3lErZPy\u002fWl1jspq0\u002fL+6r9wn59z8v7qv3Cfn3Py\u002fWl1jspq0\u002fL8SlN5RK2T8v7bXV\u002fDr6\u002fu\u002fPBL8gVhM+78kXVWFFYb6v9CMulnvmfm\u002fREijbNmI+L9e17k+7VP3v8RRrUFp\u002fPW\u002f1U3vj6+D9L8wcK9\u002fROvyvxggjRLNNPG\u002fygs4hxrE7r\u002fYXfVqzOnqv5o5t4So3ua\u002f+P\u002f\u002f39mm4r9UKAEnc43cv0wIZouUhdO\u002fIOR1Gs5+xL9AtBbiQI+Iv9jImJnZwsE\u002fhmQqZ1uo0j983XG0PYbcP8SZH\u002fxzOOM\u002fbK6vpBAv6D\u002fSs7AN1yHtPyMDuLLWBfE\u002f\u002fPJoiMFz8z8anvHxKtj1P1QqxaWbMPg\u002f8w2Csah6+j\u002fIJPj39bP8P\u002fSK5J842v4\u002ftKdwuJx1AEDgtAyOa3IBQM4cMzeEYgJAoY\u002fJNO9EA0D8rE4hwxgEQHQZcaEl3QRAh7glRUyRBUBABVVYfTQGQC9tSKIQxgZAWloSE3BFB0CLKz5eGLIHQMKmKIKZCwhAM2F1O5dRCECAGCpkyYMIQHHzDT78oQhAAAAAqBCsCEA="},"y":{"dtype":"f8","bdata":"AAAAAJ7S8T+TEWLprk30P61n9y4xxvY\u002fh2jEz5g5+T8WILgNX6X7P8pVWQgFB\u002f4\u002fVP2rJwsuAED2CC61FVEBQP4muyl2awJAdjHScAl8A0AavXWQtoEEQOgWz8pvewVAOHU8tDNoBkAbvKs8DkcHQJFMMKsZFwhAqIfQin\u002fXCECG65aHeYcJQAzpAjtSJgpA\u002f7MG52WzCkCfTNEeIy4LQLXEtlwLlgtAFDmchLPqC0B6DmFSxCsMQGih07P6WAxAda7UDShyDEA3LmJsMncMQL8eWJ0UaAxA6KbLNd5EDED0DfuBsw0MQEYW41\u002fNwgtAK02gBHlkC0DKvNisF\u002fMKQKEKgDgebwpAN1VdshTZCUDYAc\u002fDlTEJQPMIXRVOeQhA5xi+nPuwB0A7BgfZbNkGQA5jzv1\u002f8wVAlKkfDiIABUDJFSroTQAEQDgHp0IL9QJAAH0CnW3fAUBN5F0jk8AAQCXvIw9HM\u002f8\u002fuIe\u002foJ3X\u002fD84ERZAmHD6Px0AQuewAPg\u002frVhsuGqK9T8L+9dmTxDzP\u002fMEKJnslPA\u002fok4nj6I17D\u002fC\u002f3sxFknnP5fd039HaeI\u002fGOEBfXk22z92Q3DD08fRPyC7IcqtIME\u002fAP35BDqfeb+Qc3Aq1CbCv0CuUEF\u002fbdG\u002fqEz9cCBs2b84jDn3h4Pgv+4YHGQ7G+S\u002fmmP4cnZ557\u002fOI3RVwJrqv1wHPA\u002ffe+2\u002fcqq6ZO0M8L9EFQBxADnxv5R5sVnzQPK\u002fVJpACbYj87+OLMa\u002fXuDzv+gb9gMrdvS\u002f0E2Xa4Dk9L98PbA67Sr1v25cxNgoSfW\u002f6lypGxQ\u002f9b\u002fQQqdnuQz1v\u002fYcwqRMsvS\u002fKHI4CSsw9L9qiW252obzv0CZoj0Kt\u002fK\u002f\u002fGcNzo\u002fB8b8W0gV2aKfwvxiuWx5u0+6\u002foB5CK4YT7L9AMsGs7hHpv2rwrvLA0eW\u002f4NTx0FZW4r9Qt3hWjkbdv8jorYPEeNW\u002faBcjDbeWyr\u002fQ32Q3BRuzvwDhPloJMbA\u002f3CpAhS1Jyj\u002faqJre23jWP6B\u002fH8lz\u002f98\u002f\u002fC53YEbX5D+qMBGiFb7pP9ncOy0ar+4\u002f\u002ff\u002f\u002f\u002f53S8T8="},"type":"scatter","xaxis":"x","yaxis":"y"},{"line":{"color":"#9C27B0","dash":"solid","width":2},"mode":"lines","name":"IRLS","x":{"dtype":"f8","bdata":"AAAA4HPrB0CqrBroJOMHQKgZ8ZBAygdAymFCg+CgB0D4HpNlL2cHQLZeNrBoHQdA\u002fxEAcNjDBkCgKeD32loGQIout4Hc4gVAfHDGvlhcBUD9yi5Y2scEQA9wAWD6JQRAig92s193A0D5AelOvrwCQA7GUpTW9gFACRH4hHQmAUDU3h7vbkwAQO+PQiFN0\u002f4\u002fmLuEXgr+\u002fD\u002fIt2dP+Rr7P+4siugLLPk\u002fCEx4WEAz9z8wwMP5njL1PxNYnzo4LPM\u002f7VMnfCIi8T+4sw\u002fX7yzuP5TIcq6oFuo\u002f+g4eBaYF5j\u002fMTKjzGP7hP7xs2qRRCNw\u002fdNXd4t031D9wCbp6ySXJP2hztfodhbQ\u002fQAAAAGyqoL9QhAV\u002f1RLCv\u002fCjy4nKZ8+\u002fzOPw\u002fN0N1r+EZHPRyBDcv6bHgbQ52+C\u002f+lYexYV8478Sb\u002fONkunlv+Rt7N3fH+i\u002fymlo8yUd6r8Y3PnVV9\u002frv5pAjXOlZO2\u002fNtbIfn2r7r++YbgMj7Lvv+NDDXhlPPC\u002fqt10aLJ+8L+WTYD\u002f6Z\u002fwv5ZNgP\u002fpn\u002fC\u002fqt10aLJ+8L\u002fjQw14ZTzwv75huAyPsu+\u002fNtbIfn2r7r+cQI1zpWTtvxjc+dVX3+u\u002fzGlo8yUd6r\u002fibezd3x\u002fovxRv842S6eW\u002f+FYexYV847+ox4G0Odvgv4Bkc9HIENy\u002f0OPw\u002fN0N1r\u002fgo8uJymfPv2CEBX\u002fVEsK\u002fgP\u002f\u002f\u002f2uqoL+Ac7X6HYW0P3AJunrJJck\u002fbNXd4t031D\u002fKbNqkUQjcP89MqPMY\u002fuE\u002f+g4eBaYF5j+QyHKuqBbqP7+zD9fvLO4\u002f71MnfCIi8T8RWJ86OCzzPyzAw\u002fmeMvU\u002fCkx4WEAz9z\u002fuLIroCyz5P8a3Z0\u002f5Gvs\u002fnLuEXgr+\u002fD\u002fwj0IhTdP+P9TeHu9uTABACBH4hHQmAUAQxlKU1vYBQPoB6U6+vAJAig92s193A0AOcAFg+iUEQP7KLljaxwRAfHDGvlhcBUCKLreB3OIFQJ8p4PfaWgZAABIAcNjDBkC2XjawaB0HQPgek2UvZwdAy2FCg+CgB0CoGfGQQMoHQKqsGugk4wdAAAAA4HPrB0A="},"y":{"dtype":"f8","bdata":"AAAA4M0k8D\u002fDFKXQRTDyPyUcASeiOfQ\u002fE\u002fgGdck+9j8+COSipj34PwhGhhQrNPo\u002f0ndzyFAg\u002fD886cFtHAD+P4Y6DG+f0f8\u002fapoi+HzJAEB7DK9eLqEBQJ7B4JMFbwJAGllbaC4yA0D+VWqv3+kDQMopYQ5clQRAtvLLv\u002fIzBUDFuKdJAMUFQJ5T5iXvRwZApkOQXDi8BkBLnOUOZCEHQOWU7vIJdwdAkGD8vtG8B0D6e6uEc\u002fIHQLagCfu3FwhAGO+St3gsCEDBj8tVoDAIQMz6TI0qJAhAUSkwNiQHCEAyJNA7q9kHQCSW8n3umwdAuyt2oC1OB0BQkLjJuPAGQGyn90\u002fwgwZAYi0DVkQIBkAKHaVXNH4FQDwCOKZO5gRAsq\u002fy1S9BBEAEkoAcgo8DQC4BjaH80QJAaG32wWIJAkAvBmxGgzYBQH5yRY43WgBAW6ngXsXq\u002fj91KLUY4RH9P7h0lcGpK\u002fs\u002f7A5CjRQ6+T\u002fQfQhnIj\u002f3PwLlCOHdPPU\u002f3aGIGVk18z+zNX2YqyrxP5eUBU\u002fgPe4\u002fQrzuTIUo6j\u002f5Ne69exnmP2QE77HyFOI\u002fSMT3yhw+3D8mLar5x3fUP0y8VjrVvck\u002fcGr1EWbttT8AP7ki17Sav+BiwGZWG8G\u002fiNZmH05Jzr9oCWgMdmnVvyiQBOShVdu\u002fxL7K14dx4L\u002f0COAYAwbjvyh0lN6ZZeW\u002fjLUM2NmN57+ynd6\u002fiXzpv0BB4qarL+u\u002f6q7YAX+l7L+SWMp3gtztv8aQQG910+6\u002fRKXAWFmJ778w6zO1cv3vv4Ifl+ukF\u002fC\u002fMN4lr1UP8L\u002fYgiZsqMvvv+rvrZKWNu+\u002fQILxew9g7r+UU7pL8Ejtvy5xlrtY8uu\u002flg5B8qld6r94TpkXhYzovxTjnqbJgOa\u002f3Movf5M85L8mp4S5OMLhv+yvUnuOKN6\u002f0MjaQgRr2L\u002f8DAafvVHSv6DH8OoHxse\u002fUE1TBOOVtL9gXvE8FP+dPwy28JH6S8I\u002fxCAy3iul0D\u002fe5+atwlXYP4HvNzrqF+A\u002f4g\u002fylaQV5D+6x\u002f0x8x\u002foP3rWtd6rMuw\u002f\u002fv\u002f\u002f380k8D8="},"type":"scatter","xaxis":"x2","yaxis":"y2"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermap":[{"type":"scattermap","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"anchor":"y","domain":[0.0,0.45],"title":{"text":"x"},"scaleanchor":"y","scaleratio":1},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"y"}},"xaxis2":{"anchor":"y2","domain":[0.55,1.0],"title":{"text":"x"},"scaleanchor":"y","scaleratio":1},"yaxis2":{"anchor":"x2","domain":[0.0,1.0],"title":{"text":"y"}},"annotations":[{"font":{"size":16},"showarrow":false,"text":"Standard Least Squares","x":0.225,"xanchor":"center","xref":"paper","y":1.0,"yanchor":"bottom","yref":"paper"},{"font":{"size":16},"showarrow":false,"text":"IRLS (Cauchy)","x":0.775,"xanchor":"center","xref":"paper","y":1.0,"yanchor":"bottom","yref":"paper"}],"margin":{"t":40,"b":40,"l":60,"r":40},"legend":{"orientation":"h","yanchor":"bottom","y":-0.2,"xanchor":"center","x":0.5},"height":450},                        {"responsive": true}                    )                };            </script>        </div></div></div>
</div>
</section>
<section id="weight-visualization">
<h2>Weight visualization<a class="headerlink" href="#weight-visualization" title="Link to this heading">#</a></h2>
<p>IRLS identifies outliers by assigning them low weights. Let’s visualize the final weights:</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig_weights_viz</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>

<span class="c1"># Color points by weight (blue=high weight/inlier, red=low weight/outlier).</span>
<span class="n">fig_weights_viz</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
    <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="n">all_x</span><span class="p">,</span>
        <span class="n">y</span><span class="o">=</span><span class="n">all_y</span><span class="p">,</span>
        <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;markers&quot;</span><span class="p">,</span>
        <span class="n">marker</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
            <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="n">weights_irls</span><span class="p">,</span>
            <span class="n">colorscale</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;#F44336&quot;</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;#2196F3&quot;</span><span class="p">]],</span>
            <span class="n">colorbar</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Weight&quot;</span><span class="p">,</span> <span class="n">thickness</span><span class="o">=</span><span class="mi">15</span><span class="p">),</span>
            <span class="n">cmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
            <span class="n">cmax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">text</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;Weight: </span><span class="si">{</span><span class="n">w</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">weights_irls</span><span class="p">],</span>
        <span class="n">hovertemplate</span><span class="o">=</span><span class="s2">&quot;(%</span><span class="si">{x:.2f}</span><span class="s2">, %</span><span class="si">{y:.2f}</span><span class="s2">)&lt;br&gt;%</span><span class="si">{text}</span><span class="s2">&lt;extra&gt;&lt;/extra&gt;&quot;</span><span class="p">,</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Points&quot;</span><span class="p">,</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Fitted circle.</span>
<span class="n">fig_weights_viz</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
    <span class="n">make_circle_trace</span><span class="p">(</span>
        <span class="nb">float</span><span class="p">(</span><span class="n">params_irls</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
        <span class="nb">float</span><span class="p">(</span><span class="n">params_irls</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
        <span class="nb">float</span><span class="p">(</span><span class="n">params_irls</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span>
        <span class="s2">&quot;IRLS fit&quot;</span><span class="p">,</span>
        <span class="s2">&quot;#9C27B0&quot;</span><span class="p">,</span>
    <span class="p">),</span>
<span class="p">)</span>

<span class="c1"># True circle.</span>
<span class="n">fig_weights_viz</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
    <span class="n">make_circle_trace</span><span class="p">(</span><span class="n">true_cx</span><span class="p">,</span> <span class="n">true_cy</span><span class="p">,</span> <span class="n">true_r</span><span class="p">,</span> <span class="s2">&quot;True circle&quot;</span><span class="p">,</span> <span class="s2">&quot;#4CAF50&quot;</span><span class="p">,</span> <span class="s2">&quot;dash&quot;</span><span class="p">),</span>
<span class="p">)</span>

<span class="n">fig_weights_viz</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span><span class="n">title_text</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">scaleanchor</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">scaleratio</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">fig_weights_viz</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="n">title_text</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">)</span>
<span class="n">fig_weights_viz</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Points Colored by IRLS Weight&quot;</span><span class="p">,</span>
    <span class="n">height</span><span class="o">=</span><span class="mi">450</span><span class="p">,</span>
    <span class="n">margin</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">t</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">l</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="mi">40</span><span class="p">),</span>
    <span class="n">legend</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">yanchor</span><span class="o">=</span><span class="s2">&quot;top&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.99</span><span class="p">,</span> <span class="n">xanchor</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mf">0.01</span><span class="p">),</span>
<span class="p">)</span>
<span class="n">HTML</span><span class="p">(</span><span class="n">fig_weights_viz</span><span class="o">.</span><span class="n">to_html</span><span class="p">(</span><span class="n">full_html</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">include_plotlyjs</span><span class="o">=</span><span class="s2">&quot;cdn&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><div>                        <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-3.3.0.min.js" integrity="sha256-bO3dS6yCpk9aK4gUpNELtCiDeSYvGYnK7jFI58NQnHI=" crossorigin="anonymous"></script>                <div id="8ed42c5c-8ea5-434d-b9bd-5928b26651c3" class="plotly-graph-div" style="height:450px; width:100%;"></div>            <script type="text/javascript">                window.PLOTLYENV=window.PLOTLYENV || {};                                if (document.getElementById("8ed42c5c-8ea5-434d-b9bd-5928b26651c3")) {                    Plotly.newPlot(                        "8ed42c5c-8ea5-434d-b9bd-5928b26651c3",                        [{"hovertemplate":"(%{x:.2f}, %{y:.2f})\u003cbr\u003e%{text}\u003cextra\u003e\u003c\u002fextra\u003e","marker":{"cmax":1,"cmin":0,"color":{"dtype":"f4","bdata":"zFd+P\u002fs5dz+ilXo\u002f905qP\u002fHWfz8RX1s\u002fBltwP4Mxfz96BX4\u002fzvp\u002fP9r9fz8uo38\u002f2L9sP34FeD8Fhnw\u002fGXh3PzT+fz\u002fGK1g\u002fOOp\u002fP7RIez8s7HY\u002fbeR8Pxipej+w93w\u002fK9VwPx\u002f8fj97r38\u002fC418P8nKeT+M2X8\u002fgIdtP7K1bz9csHg\u002fHJRrP2z7fz+XnXU\u002fAPt\u002fPz\u002fcez+\u002fnH8\u002fPbpzPx+KczyOHz0\u002fwIwwPtdEBD6Rwrc85PGZPPVL4zxwXJI9UI6rPMDGgj0="},"colorbar":{"thickness":15,"title":{"text":"Weight"}},"colorscale":[[0,"#F44336"],[1,"#2196F3"]],"size":12},"mode":"markers","name":"Points","text":["Weight: 0.994","Weight: 0.966","Weight: 0.979","Weight: 0.915","Weight: 0.999","Weight: 0.857","Weight: 0.939","Weight: 0.997","Weight: 0.992","Weight: 1.000","Weight: 1.000","Weight: 0.999","Weight: 0.925","Weight: 0.969","Weight: 0.986","Weight: 0.967","Weight: 1.000","Weight: 0.844","Weight: 1.000","Weight: 0.982","Weight: 0.965","Weight: 0.988","Weight: 0.979","Weight: 0.988","Weight: 0.941","Weight: 0.996","Weight: 0.999","Weight: 0.987","Weight: 0.976","Weight: 0.999","Weight: 0.928","Weight: 0.936","Weight: 0.971","Weight: 0.920","Weight: 1.000","Weight: 0.959","Weight: 1.000","Weight: 0.984","Weight: 0.998","Weight: 0.952","Weight: 0.015","Weight: 0.739","Weight: 0.172","Weight: 0.129","Weight: 0.022","Weight: 0.019","Weight: 0.028","Weight: 0.071","Weight: 0.021","Weight: 0.064"],"x":{"dtype":"f8","bdata":"uJO90tUv2r8UqAuC2m4GQD\u002fo4xtFeug\u002fkPsdi5np4L+u2ShhYQABQG3QMUySCQBAwjQjTCX0BUCwVyLeP8YCQBSMMQsOauW\u002fUkRiJQ9i3j+3G15ZTcYHQDvZtCxyegdAd3A6BF+s\u002fj\u002fizeOuUDv3P7KlQM9j\u002fPw\u002fZQVHDZSw\u002fT+26Cds+HrUP\u002f7tahpYp+m\u002fSHqzZWou6786psLXrdffP4CwE+gJXd6\u002fNusL0hGNAkDg9azz58XcP\u002fyotDYvctm\u002fCFjYwlz+6r\u002f1y1cgGuj2P8xlQumfHfo\u002ffFjrZz5t8b\u002fInF6\u002ffTrkv3AiguFeLgdA7Fa9qRBZ3r8F2398PGj+PwTq2g9LRwdAwJCV+x82CECDOeR3d5IHQMLQSltJDvw\u002fFswdsLwn1D8GfO+DlKgEQAggHUFuV8c\u002fQiT5xpMN8L9Qi+ifLOwRQNK441J06PY\u002fEHSiF0AA\u002fD\u002f\u002fEuGEk37mPxTUKqBbww3AcPXHA2yBBsCchyWb9jsNwHykOsINAQhAm0M3+8BY4b+FJU07KYL5Pw=="},"y":{"dtype":"f8","bdata":"OkkuurRWA0BQ4hoKNg7bPz7NVaBjGvG\u002fECUiMo9Jt78oCQNw620FQOLcwb+y\u002fANAtteBMJWp+j94Ewjqlyngvwj2d5uZh82\u002ffP87Ok1S7r86ev8Kdhr0PyYbbc4vJ+Q\u002fqMu\u002fsUZ+478CTYPriv4GQJpoPSMcOAZAIFOnlHJkB0CuOWw3vFYHQDLb\u002fn9\u002f9eY\u002f0wY3JjB8\u002fT8SY2EgGSsHQDCjF7WP3c+\u002fCpNk1firBECC0D\u002f8BD0IQCSxzG4ldwRAXKhBZ+Ba+D9a6n1bUHrtv5GHbXVndQdAlGSlAzoB6j+gJRzvASSyv7itiao1H\u002fk\u002fsN1RJN1Cx785J2VcwzQFQB0PX4QlPP0\u002f8uRQjrja1D\u002f8uPUQG1biP4Z+wZLKvO6\u002f\u002fP840vJWB0BUn+TdweoAQEBl9McYrOu\u002fnio5Cbqn\u002fD++LcQp1O4XQODrs6rjH\u002fS\u002fHsXAC2104D8D6Z0shz4RQETZQRVFu\u002fe\u002fSJhp7cs5CcBP8W3F6gHqv0OaUMAB0AHAKhdvRh3oGECRQCD\u002fqo4TQA=="},"type":"scatter"},{"line":{"color":"#9C27B0","dash":"solid","width":2},"mode":"lines","name":"IRLS fit","x":{"dtype":"f8","bdata":"AAAA4HPrB0CqrBroJOMHQKgZ8ZBAygdAymFCg+CgB0D4HpNlL2cHQLZeNrBoHQdA\u002fxEAcNjDBkCgKeD32loGQIout4Hc4gVAfHDGvlhcBUD9yi5Y2scEQA9wAWD6JQRAig92s193A0D5AelOvrwCQA7GUpTW9gFACRH4hHQmAUDU3h7vbkwAQO+PQiFN0\u002f4\u002fmLuEXgr+\u002fD\u002fIt2dP+Rr7P+4siugLLPk\u002fCEx4WEAz9z8wwMP5njL1PxNYnzo4LPM\u002f7VMnfCIi8T+4sw\u002fX7yzuP5TIcq6oFuo\u002f+g4eBaYF5j\u002fMTKjzGP7hP7xs2qRRCNw\u002fdNXd4t031D9wCbp6ySXJP2hztfodhbQ\u002fQAAAAGyqoL9QhAV\u002f1RLCv\u002fCjy4nKZ8+\u002fzOPw\u002fN0N1r+EZHPRyBDcv6bHgbQ52+C\u002f+lYexYV8478Sb\u002fONkunlv+Rt7N3fH+i\u002fymlo8yUd6r8Y3PnVV9\u002frv5pAjXOlZO2\u002fNtbIfn2r7r++YbgMj7Lvv+NDDXhlPPC\u002fqt10aLJ+8L+WTYD\u002f6Z\u002fwv5ZNgP\u002fpn\u002fC\u002fqt10aLJ+8L\u002fjQw14ZTzwv75huAyPsu+\u002fNtbIfn2r7r+cQI1zpWTtvxjc+dVX3+u\u002fzGlo8yUd6r\u002fibezd3x\u002fovxRv842S6eW\u002f+FYexYV847+ox4G0Odvgv4Bkc9HIENy\u002f0OPw\u002fN0N1r\u002fgo8uJymfPv2CEBX\u002fVEsK\u002fgP\u002f\u002f\u002f2uqoL+Ac7X6HYW0P3AJunrJJck\u002fbNXd4t031D\u002fKbNqkUQjcP89MqPMY\u002fuE\u002f+g4eBaYF5j+QyHKuqBbqP7+zD9fvLO4\u002f71MnfCIi8T8RWJ86OCzzPyzAw\u002fmeMvU\u002fCkx4WEAz9z\u002fuLIroCyz5P8a3Z0\u002f5Gvs\u002fnLuEXgr+\u002fD\u002fwj0IhTdP+P9TeHu9uTABACBH4hHQmAUAQxlKU1vYBQPoB6U6+vAJAig92s193A0AOcAFg+iUEQP7KLljaxwRAfHDGvlhcBUCKLreB3OIFQJ8p4PfaWgZAABIAcNjDBkC2XjawaB0HQPgek2UvZwdAy2FCg+CgB0CoGfGQQMoHQKqsGugk4wdAAAAA4HPrB0A="},"y":{"dtype":"f8","bdata":"AAAA4M0k8D\u002fDFKXQRTDyPyUcASeiOfQ\u002fE\u002fgGdck+9j8+COSipj34PwhGhhQrNPo\u002f0ndzyFAg\u002fD886cFtHAD+P4Y6DG+f0f8\u002fapoi+HzJAEB7DK9eLqEBQJ7B4JMFbwJAGllbaC4yA0D+VWqv3+kDQMopYQ5clQRAtvLLv\u002fIzBUDFuKdJAMUFQJ5T5iXvRwZApkOQXDi8BkBLnOUOZCEHQOWU7vIJdwdAkGD8vtG8B0D6e6uEc\u002fIHQLagCfu3FwhAGO+St3gsCEDBj8tVoDAIQMz6TI0qJAhAUSkwNiQHCEAyJNA7q9kHQCSW8n3umwdAuyt2oC1OB0BQkLjJuPAGQGyn90\u002fwgwZAYi0DVkQIBkAKHaVXNH4FQDwCOKZO5gRAsq\u002fy1S9BBEAEkoAcgo8DQC4BjaH80QJAaG32wWIJAkAvBmxGgzYBQH5yRY43WgBAW6ngXsXq\u002fj91KLUY4RH9P7h0lcGpK\u002fs\u002f7A5CjRQ6+T\u002fQfQhnIj\u002f3PwLlCOHdPPU\u002f3aGIGVk18z+zNX2YqyrxP5eUBU\u002fgPe4\u002fQrzuTIUo6j\u002f5Ne69exnmP2QE77HyFOI\u002fSMT3yhw+3D8mLar5x3fUP0y8VjrVvck\u002fcGr1EWbttT8AP7ki17Sav+BiwGZWG8G\u002fiNZmH05Jzr9oCWgMdmnVvyiQBOShVdu\u002fxL7K14dx4L\u002f0COAYAwbjvyh0lN6ZZeW\u002fjLUM2NmN57+ynd6\u002fiXzpv0BB4qarL+u\u002f6q7YAX+l7L+SWMp3gtztv8aQQG910+6\u002fRKXAWFmJ778w6zO1cv3vv4Ifl+ukF\u002fC\u002fMN4lr1UP8L\u002fYgiZsqMvvv+rvrZKWNu+\u002fQILxew9g7r+UU7pL8Ejtvy5xlrtY8uu\u002flg5B8qld6r94TpkXhYzovxTjnqbJgOa\u002f3Movf5M85L8mp4S5OMLhv+yvUnuOKN6\u002f0MjaQgRr2L\u002f8DAafvVHSv6DH8OoHxse\u002fUE1TBOOVtL9gXvE8FP+dPwy28JH6S8I\u002fxCAy3iul0D\u002fe5+atwlXYP4HvNzrqF+A\u002f4g\u002fylaQV5D+6x\u002f0x8x\u002foP3rWtd6rMuw\u002f\u002fv\u002f\u002f380k8D8="},"type":"scatter"},{"line":{"color":"#4CAF50","dash":"dash","width":2},"mode":"lines","name":"True circle","x":{"dtype":"f8","bdata":"AAAAAAAACEDKpZTgwPcHQDR9gwIM3wdAkvSb3fq1B0CSPwvHt3wHQPgkucV9MwdArlhvVZjaBkC\u002fGgoZY3IGQLBQAnxJ+wVAXXiyQ8Z1BUArmcgQY+IEQByoZ9G3QQRA2pyKJGqUA0BLqEqvLNsCQKCJuGS+FgJAgtUGwelHAUAuFtD4g28AQKvanzrYHP8\u002fW4njbBRL\u002fT\u002fFKUSnnGv7P66hsShfgPk\u002foxa4UlaL9z\u002fj3IKfho71P4Qdd438i\u002fM\u002fBwKLgsqF8T9TcA1TDfzuP73NxZaR7eo\u002fkV34TVDk5j\u002fYEKqScuTiP9r+eqIv5N0\u002fhr39EKMi1j8k0y1gfBjNP6izOQtNo7w\u002fAAAAAAAAwLzwbM4daZu7v3CmZYg8Ccu\u002fHGLd\u002fXnS079s+9Ta7cnZv3RJHVPTZN+\u002fTMC1o7FO4r+6OO76HbfkvxSzFkMz6ea\u002fguXfE67i6L+ynxBehaHqvzZapITsI+y\u002frqCaN1Vo7b+G5I0OcW3uvwh6auEyMu+\u002fvGji3c+1778ODoBYwPfvvw4OgFjA9++\u002fvGji3c+1778IemrhMjLvv4bkjQ5xbe6\u002frqCaN1Vo7b84WqSE7CPsv7KfEF6Foeq\u002fhOXfE67i6L8SsxZDM+nmv7w47vodt+S\u002fSsC1o7FO4r94SR1T02Tfv2j71Nrtydm\u002fIGLd\u002fXnS079gpmWIPAnLvxBtzh1pm7u\u002fAAAAAAAAzDzAszkLTaO8PyTTLWB8GM0\u002ffr39EKMi1j\u002fo\u002fnqiL+TdP9wQqpJy5OI\u002fkV34TVDk5j+4zcWWke3qP1twDVMN\u002fO4\u002fCQKLgsqF8T+CHXeN\u002fIvzP9\u002fcgp+GjvU\u002fpRa4UlaL9z+tobEoX4D5P8MpRKeca\u002fs\u002fXonjbBRL\u002fT+s2p862Bz\u002fPy4W0PiDbwBAgNUGwelHAUCiibhkvhYCQEyoSq8s2wJA2pyKJGqUA0AcqGfRt0EEQCyZyBBj4gRAXXiyQ8Z1BUCwUAJ8SfsFQL4aChljcgZArlhvVZjaBkD4JLnFfTMHQJI\u002fC8e3fAdAk\u002fSb3fq1B0A0fYMCDN8HQMqllODA9wdAAAAAAAAACEA="},"y":{"dtype":"f8","bdata":"AAAAAAAA8D\u002fAsJaZkQfyP\u002fygAJ4LDfQ\u002fJCsooFgO9j9NxOyAZwn4P+wPkZAt\u002fPk\u002f\u002fsmGqajk+z9BIG1C4cD9P4wmH3Xsjv8\u002fBqxd\u002fHamAECjQk0GjXwBQA4LHqnbSAJAAIwfSpAKA0DDjEk848ADQESgEI4YawRAy6Aiy4AIBUA8Z0OxeZgFQBlOj9duGgZAChZ3R9qNBkDgeNcGRfIGQP4RnpJHRwdAcC99SYqMB0AMjkDGxcEHQBrjZSnD5gdAQlatUVz7B0D4nGcDfP8HQDMzWf4d8wdAeCEcAk\u002fWB0Dgy\u002fvALKkHQAJWWMHlawdA4imxLbkeB0DKEYiT9sEGQKgDYJH9VQZAVSYsdD3bBUBIq5TENFIFQEvBh8RwuwRAUBSd3YwXBEDb8+EAMmcDQOlDs\u002fgVqwJAebxYrfrjAUAToyJdrRIBQLEJ2MgFOABAeVSfqsqp\u002fj\u002ftQDFGbNT8P\u002fwFRTrU8fo\u002f4Ea7\u002fvMD+T95CqmsyAz3PzqxjfFYDvU\u002ffOqo+LIK8z+7zZdM6gPxP4dk0GYr+O0\u002fBiuuDprq6T+KneQcTuPlPxLrraZu5uE\u002ffOQSBTDw2z8Y6OsWrzjUP4z4dc6dXMk\u002fkLgKVlVjtT\u002fA2ARs5AKcvyAxKtLVKsG\u002fmMeL1ao\u002fzr9EH5rFr1jVv9yeDweQOdu\u002fQFF0djNe4L8uBR8Sw+3ivyCtUhLTSOW\u002fWJmw0PVs57+kDoBF9lfpvyZHIE7aB+u\u002fiKfEtuR67L8IWGEFl6\u002ftv34v7wOzpO6\u002f3oVwCDxZ77\u002fKzGT5d8zvv95zng3w\u002fe+\u002fBlm1RnHt779ojJelDJvvvzA4AhkXB++\u002fvr30JSky7r\u002f6R3hKHh3tv4TjXRsUyeu\u002fJFjcHWk36r9iOD1eu2nov+6cDcXmYea\u002fLoOKLAMi5L8MgUI4YqzhvxRmTOIZB96\u002fAGD8UIJU2L98WPBI3UbSvyAq1GTQyMe\u002fsIC1i9\u002fOtL+gXDa44kScP+T9luz1+ME\u002fFtjkWV1t0D9OwLu9SQ\u002fYP8buTPxh2t8\u002fwKmvv07j4z8Mvv7D6OXnP3+e0szc8Os\u002f\u002fP\u002f\u002f\u002f\u002f\u002f\u002f7z8="},"type":"scatter"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermap":[{"type":"scattermap","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"title":{"text":"x"},"scaleanchor":"y","scaleratio":1},"yaxis":{"title":{"text":"y"}},"margin":{"t":60,"b":40,"l":60,"r":40},"legend":{"yanchor":"top","y":0.99,"xanchor":"left","x":0.01},"title":{"text":"Points Colored by IRLS Weight"},"height":450},                        {"responsive": true}                    )                };            </script>        </div></div></div>
</div>
</section>
<section id="comparing-m-estimators">
<h2>Comparing M-estimators<a class="headerlink" href="#comparing-m-estimators" title="Link to this heading">#</a></h2>
<p>Different weight functions give different levels of robustness:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Fit with different M-estimators.</span>
<span class="n">results</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Standard LS&quot;</span><span class="p">:</span> <span class="n">params_standard</span><span class="p">}</span>

<span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">weight_fn</span> <span class="ow">in</span> <span class="p">[</span>
    <span class="p">(</span><span class="s2">&quot;Huber&quot;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">r</span><span class="p">:</span> <span class="n">huber_weight</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)),</span>
    <span class="p">(</span><span class="s2">&quot;Cauchy&quot;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">r</span><span class="p">:</span> <span class="n">cauchy_weight</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)),</span>
    <span class="p">(</span><span class="s2">&quot;Geman-McClure&quot;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">r</span><span class="p">:</span> <span class="n">geman_mcclure_weight</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)),</span>
<span class="p">]:</span>
    <span class="n">robust_cost</span> <span class="o">=</span> <span class="n">make_robust_circle_cost</span><span class="p">(</span><span class="n">weight_fn</span><span class="p">)</span>
    <span class="n">costs</span> <span class="o">=</span> <span class="p">[</span><span class="n">robust_cost</span><span class="p">(</span><span class="n">CircleVar</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_points</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">int32</span><span class="p">)),</span> <span class="n">points</span><span class="p">)]</span>
    <span class="n">problem</span> <span class="o">=</span> <span class="n">jaxls</span><span class="o">.</span><span class="n">LeastSquaresProblem</span><span class="p">(</span><span class="n">costs</span><span class="p">,</span> <span class="p">[</span><span class="n">circle_var</span><span class="p">])</span><span class="o">.</span><span class="n">analyze</span><span class="p">()</span>
    <span class="n">solution</span> <span class="o">=</span> <span class="n">problem</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">initial_vals</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">results</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">solution</span><span class="p">[</span><span class="n">circle_var</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;Method&#39;</span><span class="si">:</span><span class="s2">&lt;15</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="s1">&#39;cx&#39;</span><span class="si">:</span><span class="s2">&gt;8</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="s1">&#39;cy&#39;</span><span class="si">:</span><span class="s2">&gt;8</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="s1">&#39;r&#39;</span><span class="si">:</span><span class="s2">&gt;8</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="s1">&#39;Center err&#39;</span><span class="si">:</span><span class="s2">&gt;12</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="s1">&#39;Radius err&#39;</span><span class="si">:</span><span class="s2">&gt;12</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">70</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;True&#39;</span><span class="si">:</span><span class="s2">&lt;15</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">true_cx</span><span class="si">:</span><span class="s2">&gt;8.3f</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">true_cy</span><span class="si">:</span><span class="s2">&gt;8.3f</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">true_r</span><span class="si">:</span><span class="s2">&gt;8.3f</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="s1">&#39;-&#39;</span><span class="si">:</span><span class="s2">&gt;12</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="s1">&#39;-&#39;</span><span class="si">:</span><span class="s2">&gt;12</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="p">)</span>
<span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">params</span> <span class="ow">in</span> <span class="n">results</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">center_err</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span>
        <span class="n">jnp</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">true_cx</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">true_cy</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="n">radius_err</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">true_r</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name</span><span class="si">:</span><span class="s2">&lt;15</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="nb">float</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="si">:</span><span class="s2">&gt;8.3f</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="nb">float</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="si">:</span><span class="s2">&gt;8.3f</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="nb">float</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="si">:</span><span class="s2">&gt;8.3f</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">center_err</span><span class="si">:</span><span class="s2">&gt;12.4f</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">radius_err</span><span class="si">:</span><span class="s2">&gt;12.4f</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Bold">INFO    </span> | Building optimization problem with 50 terms and 1 variables: 50 costs, 0 eq_zero, 0 leq_zero, 0 geq_zero
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 50 costs, 1 variables each: robust_circle_residual
<span class=" -Color -Color-Bold">INFO    </span> | Building optimization problem with 50 terms and 1 variables: 50 costs, 0 eq_zero, 0 leq_zero, 0 geq_zero
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 50 costs, 1 variables each: robust_circle_residual
<span class=" -Color -Color-Bold">INFO    </span> | Building optimization problem with 50 terms and 1 variables: 50 costs, 0 eq_zero, 0 leq_zero, 0 geq_zero
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 50 costs, 1 variables each: robust_circle_residual
Method                cx       cy        r   Center err   Radius err
----------------------------------------------------------------------
True               1.000    1.000    2.000            -            -
Standard LS        0.639    1.114    2.445       0.3781       0.4446
Huber              0.918    1.032    2.087       0.0880       0.0871
Cauchy             0.975    1.009    2.015       0.0266       0.0150
Geman-McClure      0.990    1.000    1.999       0.0104       0.0010
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Visualize all methods.</span>
<span class="n">colors</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;Standard LS&quot;</span><span class="p">:</span> <span class="s2">&quot;#FF9800&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Huber&quot;</span><span class="p">:</span> <span class="s2">&quot;#2196F3&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Cauchy&quot;</span><span class="p">:</span> <span class="s2">&quot;#9C27B0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Geman-McClure&quot;</span><span class="p">:</span> <span class="s2">&quot;#00BCD4&quot;</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">fig_all</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>

<span class="c1"># Points.</span>
<span class="n">fig_all</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
    <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="n">all_x</span><span class="p">[</span><span class="o">~</span><span class="n">is_outlier</span><span class="p">],</span>
        <span class="n">y</span><span class="o">=</span><span class="n">all_y</span><span class="p">[</span><span class="o">~</span><span class="n">is_outlier</span><span class="p">],</span>
        <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;markers&quot;</span><span class="p">,</span>
        <span class="n">marker</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#607D8B&quot;</span><span class="p">),</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Inliers&quot;</span><span class="p">,</span>
    <span class="p">)</span>
<span class="p">)</span>
<span class="n">fig_all</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
    <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="n">all_x</span><span class="p">[</span><span class="n">is_outlier</span><span class="p">],</span>
        <span class="n">y</span><span class="o">=</span><span class="n">all_y</span><span class="p">[</span><span class="n">is_outlier</span><span class="p">],</span>
        <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;markers&quot;</span><span class="p">,</span>
        <span class="n">marker</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#F44336&quot;</span><span class="p">,</span> <span class="n">symbol</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">),</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Outliers&quot;</span><span class="p">,</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="c1"># True circle.</span>
<span class="n">fig_all</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
    <span class="n">make_circle_trace</span><span class="p">(</span><span class="n">true_cx</span><span class="p">,</span> <span class="n">true_cy</span><span class="p">,</span> <span class="n">true_r</span><span class="p">,</span> <span class="s2">&quot;True&quot;</span><span class="p">,</span> <span class="s2">&quot;#4CAF50&quot;</span><span class="p">,</span> <span class="s2">&quot;dash&quot;</span><span class="p">),</span>
<span class="p">)</span>

<span class="c1"># Fitted circles.</span>
<span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">params</span> <span class="ow">in</span> <span class="n">results</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">fig_all</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span>
        <span class="n">make_circle_trace</span><span class="p">(</span>
            <span class="nb">float</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span> <span class="n">name</span><span class="p">,</span> <span class="n">colors</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
        <span class="p">),</span>
    <span class="p">)</span>

<span class="n">fig_all</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span><span class="n">title_text</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">scaleanchor</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">scaleratio</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">fig_all</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="n">title_text</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">)</span>
<span class="n">fig_all</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Comparison of M-Estimators for Circle Fitting&quot;</span><span class="p">,</span>
    <span class="n">height</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span>
    <span class="n">margin</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">t</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">l</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="mi">40</span><span class="p">),</span>
    <span class="n">legend</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">yanchor</span><span class="o">=</span><span class="s2">&quot;top&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.99</span><span class="p">,</span> <span class="n">xanchor</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mf">0.01</span><span class="p">),</span>
<span class="p">)</span>
<span class="n">HTML</span><span class="p">(</span><span class="n">fig_all</span><span class="o">.</span><span class="n">to_html</span><span class="p">(</span><span class="n">full_html</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">include_plotlyjs</span><span class="o">=</span><span class="s2">&quot;cdn&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><div>                        <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-3.3.0.min.js" integrity="sha256-bO3dS6yCpk9aK4gUpNELtCiDeSYvGYnK7jFI58NQnHI=" crossorigin="anonymous"></script>                <div id="1c734150-d27a-4d50-a338-78606b872f5d" class="plotly-graph-div" style="height:500px; width:100%;"></div>            <script type="text/javascript">                window.PLOTLYENV=window.PLOTLYENV || {};                                if (document.getElementById("1c734150-d27a-4d50-a338-78606b872f5d")) {                    Plotly.newPlot(                        "1c734150-d27a-4d50-a338-78606b872f5d",                        [{"marker":{"color":"#607D8B","size":8},"mode":"markers","name":"Inliers","x":{"dtype":"f8","bdata":"uJO90tUv2r8UqAuC2m4GQD\u002fo4xtFeug\u002fkPsdi5np4L+u2ShhYQABQG3QMUySCQBAwjQjTCX0BUCwVyLeP8YCQBSMMQsOauW\u002fUkRiJQ9i3j+3G15ZTcYHQDvZtCxyegdAd3A6BF+s\u002fj\u002fizeOuUDv3P7KlQM9j\u002fPw\u002fZQVHDZSw\u002fT+26Cds+HrUP\u002f7tahpYp+m\u002fSHqzZWou6786psLXrdffP4CwE+gJXd6\u002fNusL0hGNAkDg9azz58XcP\u002fyotDYvctm\u002fCFjYwlz+6r\u002f1y1cgGuj2P8xlQumfHfo\u002ffFjrZz5t8b\u002fInF6\u002ffTrkv3AiguFeLgdA7Fa9qRBZ3r8F2398PGj+PwTq2g9LRwdAwJCV+x82CECDOeR3d5IHQMLQSltJDvw\u002fFswdsLwn1D8GfO+DlKgEQAggHUFuV8c\u002fQiT5xpMN8L8="},"y":{"dtype":"f8","bdata":"OkkuurRWA0BQ4hoKNg7bPz7NVaBjGvG\u002fECUiMo9Jt78oCQNw620FQOLcwb+y\u002fANAtteBMJWp+j94Ewjqlyngvwj2d5uZh82\u002ffP87Ok1S7r86ev8Kdhr0PyYbbc4vJ+Q\u002fqMu\u002fsUZ+478CTYPriv4GQJpoPSMcOAZAIFOnlHJkB0CuOWw3vFYHQDLb\u002fn9\u002f9eY\u002f0wY3JjB8\u002fT8SY2EgGSsHQDCjF7WP3c+\u002fCpNk1firBECC0D\u002f8BD0IQCSxzG4ldwRAXKhBZ+Ba+D9a6n1bUHrtv5GHbXVndQdAlGSlAzoB6j+gJRzvASSyv7itiao1H\u002fk\u002fsN1RJN1Cx785J2VcwzQFQB0PX4QlPP0\u002f8uRQjrja1D\u002f8uPUQG1biP4Z+wZLKvO6\u002f\u002fP840vJWB0BUn+TdweoAQEBl9McYrOu\u002fnio5Cbqn\u002fD8="},"type":"scatter"},{"marker":{"color":"#F44336","size":10,"symbol":"x"},"mode":"markers","name":"Outliers","x":{"dtype":"f8","bdata":"UIvonyzsEUDSuONSdOj2PxB0ohdAAPw\u002f\u002fxLhhJN+5j8U1CqgW8MNwHD1xwNsgQbAnIclm\u002fY7DcB8pDrCDQEIQJtDN\u002fvAWOG\u002fhSVNOymC+T8="},"y":{"dtype":"f8","bdata":"vi3EKdTuF0Dg67Oq4x\u002f0vx7FwAttdOA\u002fA+mdLIc+EUBE2UEVRbv3v0iYae3LOQnAT\u002fFtxeoB6r9DmlDAAdABwCoXb0Yd6BhAkUAg\u002f6qOE0A="},"type":"scatter"},{"line":{"color":"#4CAF50","dash":"dash","width":2},"mode":"lines","name":"True","x":{"dtype":"f8","bdata":"AAAAAAAACEDKpZTgwPcHQDR9gwIM3wdAkvSb3fq1B0CSPwvHt3wHQPgkucV9MwdArlhvVZjaBkC\u002fGgoZY3IGQLBQAnxJ+wVAXXiyQ8Z1BUArmcgQY+IEQByoZ9G3QQRA2pyKJGqUA0BLqEqvLNsCQKCJuGS+FgJAgtUGwelHAUAuFtD4g28AQKvanzrYHP8\u002fW4njbBRL\u002fT\u002fFKUSnnGv7P66hsShfgPk\u002foxa4UlaL9z\u002fj3IKfho71P4Qdd438i\u002fM\u002fBwKLgsqF8T9TcA1TDfzuP73NxZaR7eo\u002fkV34TVDk5j\u002fYEKqScuTiP9r+eqIv5N0\u002fhr39EKMi1j8k0y1gfBjNP6izOQtNo7w\u002fAAAAAAAAwLzwbM4daZu7v3CmZYg8Ccu\u002fHGLd\u002fXnS079s+9Ta7cnZv3RJHVPTZN+\u002fTMC1o7FO4r+6OO76HbfkvxSzFkMz6ea\u002fguXfE67i6L+ynxBehaHqvzZapITsI+y\u002frqCaN1Vo7b+G5I0OcW3uvwh6auEyMu+\u002fvGji3c+1778ODoBYwPfvvw4OgFjA9++\u002fvGji3c+1778IemrhMjLvv4bkjQ5xbe6\u002frqCaN1Vo7b84WqSE7CPsv7KfEF6Foeq\u002fhOXfE67i6L8SsxZDM+nmv7w47vodt+S\u002fSsC1o7FO4r94SR1T02Tfv2j71Nrtydm\u002fIGLd\u002fXnS079gpmWIPAnLvxBtzh1pm7u\u002fAAAAAAAAzDzAszkLTaO8PyTTLWB8GM0\u002ffr39EKMi1j\u002fo\u002fnqiL+TdP9wQqpJy5OI\u002fkV34TVDk5j+4zcWWke3qP1twDVMN\u002fO4\u002fCQKLgsqF8T+CHXeN\u002fIvzP9\u002fcgp+GjvU\u002fpRa4UlaL9z+tobEoX4D5P8MpRKeca\u002fs\u002fXonjbBRL\u002fT+s2p862Bz\u002fPy4W0PiDbwBAgNUGwelHAUCiibhkvhYCQEyoSq8s2wJA2pyKJGqUA0AcqGfRt0EEQCyZyBBj4gRAXXiyQ8Z1BUCwUAJ8SfsFQL4aChljcgZArlhvVZjaBkD4JLnFfTMHQJI\u002fC8e3fAdAk\u002fSb3fq1B0A0fYMCDN8HQMqllODA9wdAAAAAAAAACEA="},"y":{"dtype":"f8","bdata":"AAAAAAAA8D\u002fAsJaZkQfyP\u002fygAJ4LDfQ\u002fJCsooFgO9j9NxOyAZwn4P+wPkZAt\u002fPk\u002f\u002fsmGqajk+z9BIG1C4cD9P4wmH3Xsjv8\u002fBqxd\u002fHamAECjQk0GjXwBQA4LHqnbSAJAAIwfSpAKA0DDjEk848ADQESgEI4YawRAy6Aiy4AIBUA8Z0OxeZgFQBlOj9duGgZAChZ3R9qNBkDgeNcGRfIGQP4RnpJHRwdAcC99SYqMB0AMjkDGxcEHQBrjZSnD5gdAQlatUVz7B0D4nGcDfP8HQDMzWf4d8wdAeCEcAk\u002fWB0Dgy\u002fvALKkHQAJWWMHlawdA4imxLbkeB0DKEYiT9sEGQKgDYJH9VQZAVSYsdD3bBUBIq5TENFIFQEvBh8RwuwRAUBSd3YwXBEDb8+EAMmcDQOlDs\u002fgVqwJAebxYrfrjAUAToyJdrRIBQLEJ2MgFOABAeVSfqsqp\u002fj\u002ftQDFGbNT8P\u002fwFRTrU8fo\u002f4Ea7\u002fvMD+T95CqmsyAz3PzqxjfFYDvU\u002ffOqo+LIK8z+7zZdM6gPxP4dk0GYr+O0\u002fBiuuDprq6T+KneQcTuPlPxLrraZu5uE\u002ffOQSBTDw2z8Y6OsWrzjUP4z4dc6dXMk\u002fkLgKVlVjtT\u002fA2ARs5AKcvyAxKtLVKsG\u002fmMeL1ao\u002fzr9EH5rFr1jVv9yeDweQOdu\u002fQFF0djNe4L8uBR8Sw+3ivyCtUhLTSOW\u002fWJmw0PVs57+kDoBF9lfpvyZHIE7aB+u\u002fiKfEtuR67L8IWGEFl6\u002ftv34v7wOzpO6\u002f3oVwCDxZ77\u002fKzGT5d8zvv95zng3w\u002fe+\u002fBlm1RnHt779ojJelDJvvvzA4AhkXB++\u002fvr30JSky7r\u002f6R3hKHh3tv4TjXRsUyeu\u002fJFjcHWk36r9iOD1eu2nov+6cDcXmYea\u002fLoOKLAMi5L8MgUI4YqzhvxRmTOIZB96\u002fAGD8UIJU2L98WPBI3UbSvyAq1GTQyMe\u002fsIC1i9\u002fOtL+gXDa44kScP+T9luz1+ME\u002fFtjkWV1t0D9OwLu9SQ\u002fYP8buTPxh2t8\u002fwKmvv07j4z8Mvv7D6OXnP3+e0szc8Os\u002f\u002fP\u002f\u002f\u002f\u002f\u002f\u002f7z8="},"type":"scatter"},{"line":{"color":"#FF9800","dash":"solid","width":2},"mode":"lines","name":"Standard LS","x":{"dtype":"f8","bdata":"AAAAqBCsCEBx8w0+\u002fKEIQIAYKmTJgwhAMmF1O5dRCEDCpiiCmQsIQIsrPl4YsgdAWVoSE3BFB0AwbUiiEMYGQEAFVVh9NAZAh7glRUyRBUBzGXGhJd0EQP6sTiHDGARAoo\u002fJNO9EA0DOHDM3hGICQN60DI5rcgFAtqdwuJx1AED0iuSfONr+P8Yk+Pf1s\u002fw\u002f7w2Csah6+j9WKsWlmzD4Pxqe8fEq2PU\u002f+vJoiMFz8z8oA7iy1gXxP9azsA3XIe0\u002faK6vpBAv6D+7mR\u002f8czjjP4fdcbQ9htw\u002fhmQqZ1uo0j\u002fIyJiZ2cLBP0C2FuJAj4i\u002fDOR1Gs5+xL9MCGaLlIXTv1woASdzjdy\u002fBAAA4Nmm4r+WObeEqN7mv95d9WrM6eq\u002fyAs4hxrE7r8aII0SzTTxvy9wr39E6\u002fK\u002f1k3vj6+D9L\u002fCUa1Bafz1v17XuT7tU\u002fe\u002fQkijbNmI+L\u002fQjLpZ75n5vyJdVYUVhvq\u002fPBL8gVhM+7+211fw6+v7vxKU3lErZPy\u002fWl1jspq0\u002fL+6r9wn59z8v7qv3Cfn3Py\u002fWl1jspq0\u002fL8SlN5RK2T8v7bXV\u002fDr6\u002fu\u002fPBL8gVhM+78kXVWFFYb6v9CMulnvmfm\u002fREijbNmI+L9e17k+7VP3v8RRrUFp\u002fPW\u002f1U3vj6+D9L8wcK9\u002fROvyvxggjRLNNPG\u002fygs4hxrE7r\u002fYXfVqzOnqv5o5t4So3ua\u002f+P\u002f\u002f39mm4r9UKAEnc43cv0wIZouUhdO\u002fIOR1Gs5+xL9AtBbiQI+Iv9jImJnZwsE\u002fhmQqZ1uo0j983XG0PYbcP8SZH\u002fxzOOM\u002fbK6vpBAv6D\u002fSs7AN1yHtPyMDuLLWBfE\u002f\u002fPJoiMFz8z8anvHxKtj1P1QqxaWbMPg\u002f8w2Csah6+j\u002fIJPj39bP8P\u002fSK5J842v4\u002ftKdwuJx1AEDgtAyOa3IBQM4cMzeEYgJAoY\u002fJNO9EA0D8rE4hwxgEQHQZcaEl3QRAh7glRUyRBUBABVVYfTQGQC9tSKIQxgZAWloSE3BFB0CLKz5eGLIHQMKmKIKZCwhAM2F1O5dRCECAGCpkyYMIQHHzDT78oQhAAAAAqBCsCEA="},"y":{"dtype":"f8","bdata":"AAAAAJ7S8T+TEWLprk30P61n9y4xxvY\u002fh2jEz5g5+T8WILgNX6X7P8pVWQgFB\u002f4\u002fVP2rJwsuAED2CC61FVEBQP4muyl2awJAdjHScAl8A0AavXWQtoEEQOgWz8pvewVAOHU8tDNoBkAbvKs8DkcHQJFMMKsZFwhAqIfQin\u002fXCECG65aHeYcJQAzpAjtSJgpA\u002f7MG52WzCkCfTNEeIy4LQLXEtlwLlgtAFDmchLPqC0B6DmFSxCsMQGih07P6WAxAda7UDShyDEA3LmJsMncMQL8eWJ0UaAxA6KbLNd5EDED0DfuBsw0MQEYW41\u002fNwgtAK02gBHlkC0DKvNisF\u002fMKQKEKgDgebwpAN1VdshTZCUDYAc\u002fDlTEJQPMIXRVOeQhA5xi+nPuwB0A7BgfZbNkGQA5jzv1\u002f8wVAlKkfDiIABUDJFSroTQAEQDgHp0IL9QJAAH0CnW3fAUBN5F0jk8AAQCXvIw9HM\u002f8\u002fuIe\u002foJ3X\u002fD84ERZAmHD6Px0AQuewAPg\u002frVhsuGqK9T8L+9dmTxDzP\u002fMEKJnslPA\u002fok4nj6I17D\u002fC\u002f3sxFknnP5fd039HaeI\u002fGOEBfXk22z92Q3DD08fRPyC7IcqtIME\u002fAP35BDqfeb+Qc3Aq1CbCv0CuUEF\u002fbdG\u002fqEz9cCBs2b84jDn3h4Pgv+4YHGQ7G+S\u002fmmP4cnZ557\u002fOI3RVwJrqv1wHPA\u002ffe+2\u002fcqq6ZO0M8L9EFQBxADnxv5R5sVnzQPK\u002fVJpACbYj87+OLMa\u002fXuDzv+gb9gMrdvS\u002f0E2Xa4Dk9L98PbA67Sr1v25cxNgoSfW\u002f6lypGxQ\u002f9b\u002fQQqdnuQz1v\u002fYcwqRMsvS\u002fKHI4CSsw9L9qiW252obzv0CZoj0Kt\u002fK\u002f\u002fGcNzo\u002fB8b8W0gV2aKfwvxiuWx5u0+6\u002foB5CK4YT7L9AMsGs7hHpv2rwrvLA0eW\u002f4NTx0FZW4r9Qt3hWjkbdv8jorYPEeNW\u002faBcjDbeWyr\u002fQ32Q3BRuzvwDhPloJMbA\u002f3CpAhS1Jyj\u002faqJre23jWP6B\u002fH8lz\u002f98\u002f\u002fC53YEbX5D+qMBGiFb7pP9ncOy0ar+4\u002f\u002ff\u002f\u002f\u002f53S8T8="},"type":"scatter"},{"line":{"color":"#2196F3","dash":"solid","width":2},"mode":"lines","name":"Huber","x":{"dtype":"f8","bdata":"AAAAYMIKCEDRHy5TJwIIQGUirAtf6AdA5\u002f4vHYS9B0D9lsy0woEHQG4TaGtYNQdA\u002fvc8BpTYBkBaYqcl1WsGQJ4nkuKL7wVA\u002fGzpWjhkBUDO2IktasoEQNR+NOa\u002fIgRA5CMgWuZtA0BOUdD1l6wCQJre6fyb3wFAaAnLvMUHAUAK2Lqy8yUAQE6cIE0ddv4\u002faLt7dRGQ\u002fD+k3HDluJv6P4yKdmEXm\u002fg\u002frP\u002flVz2Q9j\u002fxTEPARX30P64zqe9TZPI\u002fCWeVZJFH8D\u002fKmLUYV1LsP4m8CwmjFug\u002fhgYHtWPg4z8h13Ev4WffP1wAWyUuK9c\u002fHJte+lcmzj\u002fwLcZXyqC8P8CRRq6TsoG\u002fEAAAAG4MwL\u002fwk\u002f33AXTOv6ieUvOFIda\u002fyESv5qe13L8m3N9lz3fhv0o5WcV\u002fZOS\u002ffub6TeEd57\u002f0RakfJaHpv0Y3\u002fiK06+u\u002fBILQtDH77b+SynkVfs3vv5dKrExcsPC\u002fckcmzKBZ8b8oLRcN3uHxv9iZRJ+HSPK\u002fOM4RrzON8r9kTJZym6\u002fyv2RMlnKbr\u002fK\u002fOM4RrzON8r\u002fYmUSfh0jyvygtFw3e4fG\u002fckcmzKBZ8b+YSqxMXLDwv5LKeRV+ze+\u002fBoLQtDH77b9EN\u002f4itOvrv\u002fZFqR8loem\u002ffOb6TeEd579MOVnFf2TkvyTc32XPd+G\u002fzESv5qe13L+gnlLzhSHWvwCU\u002ffcBdM6\u002f4P\u002f\u002f\u002f20MwL8AkUauk7KBv\u002fAtxlfKoLw\u002fDJte+lcmzj9sAFslLivXPyjXcS\u002fhZ98\u002fhgYHtWPg4z+EvAsJoxboP9KYtRhXUuw\u002fC2eVZJFH8D+sM6nvU2TyP+xMQ8BFffQ\u002frv\u002flVz2Q9j+MinZhF5v4P6LccOW4m\u002fo\u002fbLt7dRGQ\u002fD9QnCBNHXb+PwrYurLzJQBAZwnLvMUHAUCc3un8m98BQE5R0PWXrAJA5CMgWuZtA0DSfjTmvyIEQM\u002fYiS1qygRA\u002fGzpWjhkBUCeJ5Lii+8FQFpipyXVawZA\u002fvc8BpTYBkBuE2hrWDUHQP2WzLTCgQdA6P4vHYS9B0BlIqwLX+gHQNEfLlMnAghAAAAAYMIKCEA="},"y":{"dtype":"f8","bdata":"AAAAgBuE8D+EA6zoTKLyP47X2GlPvvQ\u002f6r0oXPbV9j+f9y6WGef4P3vwnaWX7\u002fo\u002fAE+JAVjt\u002fD8oUngzTd7+P3Ivh3o7YABAV7ENIPJIAUAy2nmnWigCQG2of8WO\u002fQJA2lLBs7LHA0DGv1sT9oUEQKqFscOUNwVAtguXrNfbBUDSYg97FXIGQBpJ10+z+QZAkGsKXyVyB0AiVT6A79oHQP5+fq6lMwhAY5Sld+x7CED5IaFaebMIQFeFPhQT2ghAuPEx2pHvCEAisRqE3\u002fMIQBtaWqL35ghAfW6ngufICEC8rFYizpkIQG82aQ7cWQhAInqAMVMJCEBCd+uPhqgHQC5nE\u002fLZNwdA3AGgfcG3BkBsZb09wSgGQHoL\u002f5psiwVALRtsw2XgBECgulEDXSgEQH60hw8QZANA\u002fcbiQUmUAkAIMZ7I3rkBQLCBk8mx1QBAxIBI9FrR\u002fz9JVolZjOf9PxrzQqrw7\u002fs\u002fE4PIB4\u002fs+T90fkW2et\u002f3P\u002fCeGfnQyvU\u002fsr\u002fm5Law8z+QzI8pV5PxP91m4Ky\u002f6e4\u002fmIAyNgCv6j8ewswNzHrmPxwDdZN4UeI\u002frvPd4J9u3D+kM\u002fRWGWHUP6xNtTNVBck\u002f4PN3u8Btsz9AbOBkkmWkv2AQ44k0XMO\u002f7DcWD26B0L\u002fooz18pP\u002fWvwTVjRoMIt2\u002fsmywDSlx4b\u002fqLfxrRB3kv66V9faWkua\u002fdAeA9pfO6L+8nE3I+c7qvwbdrT+skey\u002fhOgBxt4U7r\u002fA2aQ5Alfvv3hZrURlK\u002fC\u002f+txOBZiJ8L80tLREuMXwv0RiNQiI3\u002fC\u002fcONjtOzW8L+uCn0o76vwv\u002fJDQrW7XvC\u002fjFGW3kPf77\u002f6+\u002fm5KL7uv4hU+QBQW+2\u002fPK4pfCe4679kJF0\u002fX9bpv0aLPeznt+e\u002f2i5csvBe5b+kFsYO5c3ivxT\u002fbk1qB+C\u002f0JYKnrkc2r90Q\u002f0rmsvTvxCjnXfyQ8q\u002f4Cq2AdSauL\u002fARmi8AvCRP6xuPWROT8E\u002fDsTa+Xtr0D8UPohpfWLYP78QotM6QuA\u002fNYSuR4Fk5D\u002fnUE4sz5PoP\u002ff4py7Uy+w\u002f\u002fv\u002f\u002ffxuE8D8="},"type":"scatter"},{"line":{"color":"#9C27B0","dash":"solid","width":2},"mode":"lines","name":"Cauchy","x":{"dtype":"f8","bdata":"AAAA4HPrB0CqrBroJOMHQKgZ8ZBAygdAymFCg+CgB0D4HpNlL2cHQLZeNrBoHQdA\u002fxEAcNjDBkCgKeD32loGQIout4Hc4gVAfHDGvlhcBUD9yi5Y2scEQA9wAWD6JQRAig92s193A0D5AelOvrwCQA7GUpTW9gFACRH4hHQmAUDU3h7vbkwAQO+PQiFN0\u002f4\u002fmLuEXgr+\u002fD\u002fIt2dP+Rr7P+4siugLLPk\u002fCEx4WEAz9z8wwMP5njL1PxNYnzo4LPM\u002f7VMnfCIi8T+4sw\u002fX7yzuP5TIcq6oFuo\u002f+g4eBaYF5j\u002fMTKjzGP7hP7xs2qRRCNw\u002fdNXd4t031D9wCbp6ySXJP2hztfodhbQ\u002fQAAAAGyqoL9QhAV\u002f1RLCv\u002fCjy4nKZ8+\u002fzOPw\u002fN0N1r+EZHPRyBDcv6bHgbQ52+C\u002f+lYexYV8478Sb\u002fONkunlv+Rt7N3fH+i\u002fymlo8yUd6r8Y3PnVV9\u002frv5pAjXOlZO2\u002fNtbIfn2r7r++YbgMj7Lvv+NDDXhlPPC\u002fqt10aLJ+8L+WTYD\u002f6Z\u002fwv5ZNgP\u002fpn\u002fC\u002fqt10aLJ+8L\u002fjQw14ZTzwv75huAyPsu+\u002fNtbIfn2r7r+cQI1zpWTtvxjc+dVX3+u\u002fzGlo8yUd6r\u002fibezd3x\u002fovxRv842S6eW\u002f+FYexYV847+ox4G0Odvgv4Bkc9HIENy\u002f0OPw\u002fN0N1r\u002fgo8uJymfPv2CEBX\u002fVEsK\u002fgP\u002f\u002f\u002f2uqoL+Ac7X6HYW0P3AJunrJJck\u002fbNXd4t031D\u002fKbNqkUQjcP89MqPMY\u002fuE\u002f+g4eBaYF5j+QyHKuqBbqP7+zD9fvLO4\u002f71MnfCIi8T8RWJ86OCzzPyzAw\u002fmeMvU\u002fCkx4WEAz9z\u002fuLIroCyz5P8a3Z0\u002f5Gvs\u002fnLuEXgr+\u002fD\u002fwj0IhTdP+P9TeHu9uTABACBH4hHQmAUAQxlKU1vYBQPoB6U6+vAJAig92s193A0AOcAFg+iUEQP7KLljaxwRAfHDGvlhcBUCKLreB3OIFQJ8p4PfaWgZAABIAcNjDBkC2XjawaB0HQPgek2UvZwdAy2FCg+CgB0CoGfGQQMoHQKqsGugk4wdAAAAA4HPrB0A="},"y":{"dtype":"f8","bdata":"AAAA4M0k8D\u002fDFKXQRTDyPyUcASeiOfQ\u002fE\u002fgGdck+9j8+COSipj34PwhGhhQrNPo\u002f0ndzyFAg\u002fD886cFtHAD+P4Y6DG+f0f8\u002fapoi+HzJAEB7DK9eLqEBQJ7B4JMFbwJAGllbaC4yA0D+VWqv3+kDQMopYQ5clQRAtvLLv\u002fIzBUDFuKdJAMUFQJ5T5iXvRwZApkOQXDi8BkBLnOUOZCEHQOWU7vIJdwdAkGD8vtG8B0D6e6uEc\u002fIHQLagCfu3FwhAGO+St3gsCEDBj8tVoDAIQMz6TI0qJAhAUSkwNiQHCEAyJNA7q9kHQCSW8n3umwdAuyt2oC1OB0BQkLjJuPAGQGyn90\u002fwgwZAYi0DVkQIBkAKHaVXNH4FQDwCOKZO5gRAsq\u002fy1S9BBEAEkoAcgo8DQC4BjaH80QJAaG32wWIJAkAvBmxGgzYBQH5yRY43WgBAW6ngXsXq\u002fj91KLUY4RH9P7h0lcGpK\u002fs\u002f7A5CjRQ6+T\u002fQfQhnIj\u002f3PwLlCOHdPPU\u002f3aGIGVk18z+zNX2YqyrxP5eUBU\u002fgPe4\u002fQrzuTIUo6j\u002f5Ne69exnmP2QE77HyFOI\u002fSMT3yhw+3D8mLar5x3fUP0y8VjrVvck\u002fcGr1EWbttT8AP7ki17Sav+BiwGZWG8G\u002fiNZmH05Jzr9oCWgMdmnVvyiQBOShVdu\u002fxL7K14dx4L\u002f0COAYAwbjvyh0lN6ZZeW\u002fjLUM2NmN57+ynd6\u002fiXzpv0BB4qarL+u\u002f6q7YAX+l7L+SWMp3gtztv8aQQG910+6\u002fRKXAWFmJ778w6zO1cv3vv4Ifl+ukF\u002fC\u002fMN4lr1UP8L\u002fYgiZsqMvvv+rvrZKWNu+\u002fQILxew9g7r+UU7pL8Ejtvy5xlrtY8uu\u002flg5B8qld6r94TpkXhYzovxTjnqbJgOa\u002f3Movf5M85L8mp4S5OMLhv+yvUnuOKN6\u002f0MjaQgRr2L\u002f8DAafvVHSv6DH8OoHxse\u002fUE1TBOOVtL9gXvE8FP+dPwy28JH6S8I\u002fxCAy3iul0D\u002fe5+atwlXYP4HvNzrqF+A\u002f4g\u002fylaQV5D+6x\u002f0x8x\u002foP3rWtd6rMuw\u002f\u002fv\u002f\u002f380k8D8="},"type":"scatter"},{"line":{"color":"#00BCD4","dash":"solid","width":2},"mode":"lines","name":"Geman-McClure","x":{"dtype":"f8","bdata":"AAAAAMHoB0AAI+TnguAHQPIEsh7RxwdAqeQLGcWeB0AoStcmiWUHQLtFn0dYHAdAxGDD7X3DBkA+8bGwVVsGQB77fe5K5AVA0PIxXdheBUBGd1GMh8sEQOFnDFfwKgRAGIK1R7h9A0BJ4x3tkcQCQKRVhSI8AAJAOiTdSoExAUCqQyiANlkAQM+6n2918P4\u002fklyduese\u002fT8CRUDBrz\u002f7P1Y804evVPk\u002fcdG5L+Vf9z++Y7TyVGP1P5MwvQ0LYfM\u002f1e2ipBlb8T98\u002fhs\u002fLafuP50xRwkzmeo\u002fAUT8n3KQ5j\u002fmyWeYFJHiP+YIkrZvPt0\u002fABULy9p91T8sjFpc0NDLPzi3E6WkF7o\u002fAAEAALBAhL9AF5ihDSC+v1DbekfoScy\u002fSDpqkwZy1L8wWkztu2jav9Lg5DZ3AeC\u002fFscJ12ud4r+Y9g5MiwXlv\u002fbqE3laN+e\u002f7KYNPpYw6b88PsDMNe\u002fqv\u002f5mmsFscey\u002fQqtJ\u002fqy17b\u002fQBR5EqLruv5LglYxRf++\u002fBKVXD28B8L8jQvAvYyLwvyNC8C9jIvC\u002fBKVXD28B8L+S4JWMUX\u002fvv9AFHkSouu6\u002fQqtJ\u002fqy17b8AZ5rBbHHsvzw+wMw17+q\u002f7qYNPpYw6b\u002f06hN5Wjfnv5r2DkyLBeW\u002fFMcJ12ud4r\u002fU4OQ2dwHgvyxaTO27aNq\u002fTDpqkwZy1L9A23pH6EnMv2AXmKENIL6\u002fQP7\u002f\u002f69AhL9QtxOlpBe6PyyMWlzQ0Ms\u002f+BQLy9p91T\u002f0CJK2bz7dP+rJZ5gUkeI\u002fAUT8n3KQ5j+ZMUcJM5nqP4T+Gz8tp+4\u002f1u2ipBlb8T+RML0NC2HzP7pjtPJUY\u002fU\u002fc9G5L+Vf9z9WPNOHr1T5PwBFQMGvP\u002fs\u002fllyduese\u002fT\u002fQup9vdfD+P6pDKIA2WQBAOCTdSoExAUCmVYUiPAACQErjHe2RxAJAGIK1R7h9A0DgZwxX8CoEQEd3UYyHywRA0PIxXdheBUAe+33uSuQFQD7xsbBVWwZAxWDD7X3DBkC7RZ9HWBwHQChK1yaJZQdAquQLGcWeB0DyBLIe0ccHQAAj5OeC4AdAAAAAAMHoB0A="},"y":{"dtype":"f8","bdata":"AAAAQLYB8D+3uusLBwnyPwSyd4VADvQ\u002fYmEWgk0P9j\u002fF7aUkHQr4P\u002fQxmv6k\u002fPk\u002fEHWFKuPk+z9IqdRd4MD9P+Qine+xjv8\u002fDn4y6T2mAEBsY24\u002fOXwBQDBZyGZuSAJARG3U3goKA0DO\u002fXETR8ADQC2YhipnagRAwEqixbsHBUBGzcW2opcFQFgnkKeHGQZALYAnsuSMBkBseD\u002frQvEGQIzGrtw6RgdA9LgV8HSLB0DqrSfJqcAHQEdvOo+i5QdAVZ7PJTn6B0BB6N1TWP4HQO+Dsdn78QdAGmxNdTDVB0D40UjVE6gHQI9SNnrUagdA9Hi0hrEdB0An91h++sAGQOGrufMOVQZA\u002fPLnJV7aBUCGzsONZlEFQCQenVu1ugRAQ0ip5eUWBECsW+MHoWYDQP24+3WcqgJAkrEKAJrjAUBLL8fKZhIBQM9WD3zaNwBAjkA6uayp\u002fj+0F5jfiNT8P3SpvgQt8vo\u002fYJeCYooE+T98kXnSnQ33P3\u002fAccFtD\u002fU\u002f2moKGQgM8z8ktJQhgAXxP7WX1rzY++0\u002fSCrrzcju6T\u002f+fhx9\u002feflPw3dDFud6+E\u002feqL1dYj72z84WgXt\u002fUTUP1BCPwMdd8k\u002fSPdbbPybtT\u002fAZ6sHHhKbv6D0cqwIC8G\u002fIBmrADwezr\u002fkx92vMUfVv2jdGj9WJ9u\u002fCiGllr5U4L+UeHRu\u002fOPivxQ6DzfBPuW\u002f8sufl59i57+Gr+bOYk3pv5zcY\u002fkQ\u002feq\u002fzOPRGu1v7L8+StnoeKTtv95HI1V2me6\u002fZrA11ehN77+6D8ZmFsHvvwShd0+I8u+\u002fVHk+lwvi778cvek8sY\u002fvv6y3niTO++6\u002f0uNWwPom7r8uGrtyEhLtv7Th\u002fawyvuu\u002fsgCeyLks6r9cnUCeRV\u002fovxY1F9uxV+a\u002fACuJFhYY5L+wYBqqw6Lhv3Duj5uG9N2\u002fJGqj9qRC2L+QyUI2wTXSv7A25vYvqMe\u002f0MFPJvWQtL\u002fARrcYpC6dP6i1WhFhFMI\u002fzivqVSV60D8uOJcFHhvYP+ZIaG095d8\u002fRT3T+z3o4z\u002f8mxD1V+rnP5KKKOjK9Os\u002f\u002fv\u002f\u002fP7YB8D8="},"type":"scatter"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermap":[{"type":"scattermap","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"title":{"text":"x"},"scaleanchor":"y","scaleratio":1},"yaxis":{"title":{"text":"y"}},"margin":{"t":60,"b":40,"l":60,"r":40},"legend":{"yanchor":"top","y":0.99,"xanchor":"left","x":0.01},"title":{"text":"Comparison of M-Estimators for Circle Fitting"},"height":500},                        {"responsive": true}                    )                };            </script>        </div></div></div>
</div>
</section>
<section id="summary">
<h2>Summary<a class="headerlink" href="#summary" title="Link to this heading">#</a></h2>
<p>Robust estimation in jaxls using <code class="docutils literal notranslate"><span class="pre">jax.lax.stop_gradient</span></code>:</p>
<ol class="arabic simple">
<li><p>Standard least squares gives outliers disproportionate influence due to the squared loss.</p></li>
<li><p>M-estimators (Huber, Cauchy, Geman-McClure) define weight functions that down-weight large residuals.</p></li>
<li><p>Using <code class="docutils literal notranslate"><span class="pre">stop_gradient</span></code> on weights implements IRLS automatically within the solver’s iterations – no explicit outer loop needed.</p></li>
<li><p>Huber provides convex robustness; Cauchy gives smooth down-weighting; Geman-McClure aggressively rejects outliers.</p></li>
</ol>
<p>Implementation pattern:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">weight</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">lax</span><span class="o">.</span><span class="n">stop_gradient</span><span class="p">(</span><span class="n">weight_fn</span><span class="p">(</span><span class="n">residual</span><span class="p">))</span>
<span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">weight</span><span class="p">)</span> <span class="o">*</span> <span class="n">residual</span>
</pre></div>
</div>
<p>This makes the optimizer treat weights as constants while still updating them as the solution evolves. The solver’s iterations naturally perform IRLS.</p>
<p>For more details, see <a class="reference internal" href="../../../api/core/#jaxls.Var" title="jaxls.Var"><code class="xref py py-class docutils literal notranslate"><span class="pre">jaxls.Var</span></code></a>, <a class="reference internal" href="../../../api/core/#jaxls.Cost" title="jaxls.Cost"><code class="xref py py-class docutils literal notranslate"><span class="pre">jaxls.Cost</span></code></a>, and <a class="reference internal" href="../../../api/core/#jaxls.LeastSquaresProblem" title="jaxls.LeastSquaresProblem"><code class="xref py py-class docutils literal notranslate"><span class="pre">jaxls.LeastSquaresProblem</span></code></a>.</p>
</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../constraints/"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Constraints</p>
      </div>
    </a>
    <a class="right-next"
       href="../covariance/"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Covariance estimation</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-outlier-problem">The outlier problem</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#standard-least-squares">Standard least squares</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#robust-cost-functions-m-estimators">Robust cost functions (M-estimators)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#irls-with-jaxls">IRLS with jaxls</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#robust-fitting-with-cauchy-weights">Robust fitting with Cauchy weights</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#visualization">Visualization</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#weight-visualization">Weight visualization</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#comparing-m-estimators">Comparing M-estimators</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summary">Summary</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By brentyi
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2026.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>