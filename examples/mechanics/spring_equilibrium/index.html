
<!DOCTYPE html>


<html lang="en" data-content_root="../../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Spring equilibrium &#8212; jaxls</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=b86133f3" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css?v=6644e6bb" />
    <link rel="stylesheet" type="text/css" href="../../../_static/css/custom.css?v=2a1f1aab" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../../_static/documentation_options.js?v=55b5f74b"></script>
    <script src="../../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../../_static/copybutton.js?v=fd10adb8"></script>
    <script src="../../../_static/js/custom.js?v=58150dd0"></script>
    <script src="../../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'examples/mechanics/spring_equilibrium';</script>
    <link rel="index" title="Index" href="../../../genindex/" />
    <link rel="search" title="Search" href="../../../search/" />
    <link rel="next" title="Cloth draping" href="../cloth_draping/" />
    <link rel="prev" title="Mechanics" href="../" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../../search/"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../../">
  
  
  
  
  
  
    <p class="title logo__title">jaxls</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Guide</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../guide/basics/">Basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../guide/tips_and_gotchas/">Tips and gotchas</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../guide/advanced/">Advanced</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../guide/advanced/non_euclidean/">Non-Euclidean variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../guide/advanced/custom_jacobians/">Custom Jacobians</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../guide/advanced/constraints/">Constraints</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../guide/advanced/robust_costs/">Robust costs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../guide/advanced/covariance/">Covariance estimation</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Examples</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../">Mechanics</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Spring equilibrium</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cloth_draping/">Cloth draping</a></li>
<li class="toctree-l2"><a class="reference internal" href="../truss_analysis/">Truss analysis</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../vision/">Vision</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../vision/camera_calibration/">Camera calibration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../vision/pose_graph_2d/">SE(2) pose graph</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../vision/pose_graph_3d/">SE(3) pose graph</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../vision/bundle_adjustment/">Bundle adjustment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../vision/smplh_shape_fitting/">SMPL-H shape fitting</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../robotics/">Robotics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../robotics/inverse_kinematics/">Inverse kinematics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../robotics/obstacle_avoidance/">Obstacle avoidance</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../robotics/cart_pole_collocation/">Cart-pole (collocation)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../robotics/cart_pole_shooting/">Cart-pole (shooting)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../robotics/cam_design/">Cam profile optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../robotics/imu_sensor_fusion/">IMU fusion + calibration</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../portfolio/">Portfolio optimization</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../portfolio/mean_variance/">Mean-variance allocation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../portfolio/manifold_allocation/">Manifold allocation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../portfolio/reparameterized_allocation/">Reparameterized allocation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../portfolio/cvar_optimization/">CVaR allocation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../portfolio/black_litterman/">Black-Litterman allocation</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../api/core/">Core API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/lie_group_variables/">Lie group variables</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/solver_config/">Solver configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/covariance/">Covariance Estimation</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Design Notes</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../design/typed_api/">Typed API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../design/sparse_matrices/">Sparse matrices</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../design/traced_vs_static/">What’s traced?</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/brentyi/jaxls" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/brentyi/jaxls/issues/new?title=Issue%20on%20page%20%2Fexamples/mechanics/spring_equilibrium.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../../_sources/examples/mechanics/spring_equilibrium.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Spring equilibrium</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#variables-and-costs">Variables and costs</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#problem-setup">Problem setup</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#approach-1-naive-construction">Approach 1: naive construction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#approach-2-batched-construction">Approach 2: batched construction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#solving">Solving</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#visualization">Visualization</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#relaxation-animation">Relaxation animation</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="spring-equilibrium">
<h1>Spring equilibrium<a class="headerlink" href="#spring-equilibrium" title="Link to this heading">#</a></h1>
<p>In this notebook, we solve a spring network equilibrium problem: finding the resting
shape of a mesh of masses connected by springs under gravity.</p>
<p>Features used:</p>
<ul class="simple">
<li><p><a class="reference internal" href="../../../api/core/#jaxls.Var" title="jaxls.Var"><code class="xref py py-class docutils literal notranslate"><span class="pre">Var</span></code></a> subclassing for custom variable types</p></li>
<li><p><a class="reference internal" href="../../../api/core/#jaxls.Cost.factory" title="jaxls.Cost.factory"><code class="xref py py-func docutils literal notranslate"><span class="pre">&#64;jaxls.Cost.factory</span></code></a> for defining costs</p></li>
<li><p>Equality constraints (<code class="docutils literal notranslate"><span class="pre">constraint_eq_zero</span></code>) for anchoring points</p></li>
<li><p>Augmented Lagrangian solver for constrained optimization</p></li>
</ul>
<p>We show two approaches:</p>
<ol class="arabic simple">
<li><p>Naive construction: Build variables and costs one-by-one (simple but slower)</p></li>
<li><p>Batched construction: Use array operations for efficiency (recommended for large problems)</p></li>
</ol>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">loguru</span><span class="w"> </span><span class="kn">import</span> <span class="n">logger</span>

<span class="n">logger</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
<span class="n">logger</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;&lt;level&gt;</span><span class="si">{level: &lt;8}</span><span class="s2">&lt;/level&gt; | </span><span class="si">{message}</span><span class="s2">&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">jax</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">jax.numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">jnp</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">jaxls</span>
</pre></div>
</div>
</div>
</div>
<section id="variables-and-costs">
<h2>Variables and costs<a class="headerlink" href="#variables-and-costs" title="Link to this heading">#</a></h2>
<p>Variables represent the unknowns we want to solve for. We define a custom 2D point variable by subclassing <code class="docutils literal notranslate"><span class="pre">jaxls.Var</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">Point2Var</span><span class="p">(</span><span class="n">jaxls</span><span class="o">.</span><span class="n">Var</span><span class="p">[</span><span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">],</span> <span class="n">default_factory</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">2</span><span class="p">)):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A 2D point variable.&quot;&quot;&quot;</span>
</pre></div>
</div>
</div>
</div>
<p>Cost functions define what we’re optimizing. Use <a class="reference internal" href="../../../api/core/#jaxls.Cost.factory" title="jaxls.Cost.factory"><code class="xref py py-func docutils literal notranslate"><span class="pre">&#64;jaxls.Cost.factory</span></code></a> to create cost factories.</p>
<p>A cost function takes a <a class="reference internal" href="../../../api/core/#jaxls.VarValues" title="jaxls.VarValues"><code class="xref py py-class docutils literal notranslate"><span class="pre">VarValues</span></code></a> object (for looking up variable values) plus any arguments, and returns a residual vector to minimize or constrain.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@jaxls</span><span class="o">.</span><span class="n">Cost</span><span class="o">.</span><span class="n">factory</span>
<span class="k">def</span><span class="w"> </span><span class="nf">spring_cost</span><span class="p">(</span>
    <span class="n">vals</span><span class="p">:</span> <span class="n">jaxls</span><span class="o">.</span><span class="n">VarValues</span><span class="p">,</span>
    <span class="n">var_a</span><span class="p">:</span> <span class="n">Point2Var</span><span class="p">,</span>
    <span class="n">var_b</span><span class="p">:</span> <span class="n">Point2Var</span><span class="p">,</span>
    <span class="n">rest_length</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Penalize deviation from rest length.</span>

<span class="sd">    Returns a 2D residual for better Jacobian conditioning.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">diff</span> <span class="o">=</span> <span class="n">vals</span><span class="p">[</span><span class="n">var_a</span><span class="p">]</span> <span class="o">-</span> <span class="n">vals</span><span class="p">[</span><span class="n">var_b</span><span class="p">]</span>
    <span class="n">length</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">diff</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1e-6</span><span class="p">)</span>
    <span class="n">direction</span> <span class="o">=</span> <span class="n">diff</span> <span class="o">/</span> <span class="n">length</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">length</span> <span class="o">-</span> <span class="n">rest_length</span><span class="p">)</span> <span class="o">*</span> <span class="n">direction</span>


<span class="nd">@jaxls</span><span class="o">.</span><span class="n">Cost</span><span class="o">.</span><span class="n">factory</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s2">&quot;constraint_eq_zero&quot;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">anchor_constraint</span><span class="p">(</span>
    <span class="n">vals</span><span class="p">:</span> <span class="n">jaxls</span><span class="o">.</span><span class="n">VarValues</span><span class="p">,</span>
    <span class="n">var</span><span class="p">:</span> <span class="n">Point2Var</span><span class="p">,</span>
    <span class="n">target</span><span class="p">:</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Pin a point to a target position (hard constraint).&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">vals</span><span class="p">[</span><span class="n">var</span><span class="p">]</span> <span class="o">-</span> <span class="n">target</span>


<span class="nd">@jaxls</span><span class="o">.</span><span class="n">Cost</span><span class="o">.</span><span class="n">factory</span>
<span class="k">def</span><span class="w"> </span><span class="nf">gravity_cost</span><span class="p">(</span>
    <span class="n">vals</span><span class="p">:</span> <span class="n">jaxls</span><span class="o">.</span><span class="n">VarValues</span><span class="p">,</span>
    <span class="n">var</span><span class="p">:</span> <span class="n">Point2Var</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Pull points downward.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">vals</span><span class="p">[</span><span class="n">var</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mf">10.0</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.15</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="problem-setup">
<h2>Problem setup<a class="headerlink" href="#problem-setup" title="Link to this heading">#</a></h2>
<p>We’ll create a 5x4 grid of points. The left and right columns will be anchored, and springs connect adjacent points:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Grid dimensions.</span>
<span class="n">cols</span><span class="p">,</span> <span class="n">rows</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">4</span>
<span class="n">num_points</span> <span class="o">=</span> <span class="n">cols</span> <span class="o">*</span> <span class="n">rows</span>
<span class="n">spacing</span> <span class="o">=</span> <span class="mf">1.0</span>


<span class="k">def</span><span class="w"> </span><span class="nf">idx</span><span class="p">(</span><span class="n">row</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">col</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert (row, col) to flat index.</span>

<span class="sd">    Args:</span>
<span class="sd">        row: Row index</span>
<span class="sd">        col: Column index</span>

<span class="sd">    Returns:</span>
<span class="sd">        Flat index into the points array</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">row</span> <span class="o">*</span> <span class="n">cols</span> <span class="o">+</span> <span class="n">col</span>


<span class="c1"># Initial positions (regular grid)</span>
<span class="n">initial_positions</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
    <span class="p">[[</span><span class="n">c</span> <span class="o">*</span> <span class="n">spacing</span><span class="p">,</span> <span class="o">-</span><span class="n">r</span> <span class="o">*</span> <span class="n">spacing</span><span class="p">]</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">rows</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">cols</span><span class="p">)]</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Grid: </span><span class="si">{</span><span class="n">cols</span><span class="si">}</span><span class="s2">x</span><span class="si">{</span><span class="n">rows</span><span class="si">}</span><span class="s2"> = </span><span class="si">{</span><span class="n">num_points</span><span class="si">}</span><span class="s2"> points&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Grid: 5x4 = 20 points
</pre></div>
</div>
</div>
</div>
</section>
<section id="approach-1-naive-construction">
<h2>Approach 1: naive construction<a class="headerlink" href="#approach-1-naive-construction" title="Link to this heading">#</a></h2>
<p>The straightforward approach: create variables and costs one-by-one using Python loops.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create variables for each grid point.</span>
<span class="n">point_vars_naive</span> <span class="o">=</span> <span class="p">{</span>
    <span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span> <span class="n">Point2Var</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">idx</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">))</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">rows</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">costs_naive</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">jaxls</span><span class="o">.</span><span class="n">Cost</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># Anchor the left and right columns.</span>
<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">rows</span><span class="p">):</span>
    <span class="n">costs_naive</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
        <span class="n">anchor_constraint</span><span class="p">(</span><span class="n">point_vars_naive</span><span class="p">[(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">)],</span> <span class="n">initial_positions</span><span class="p">[</span><span class="n">idx</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">)])</span>
    <span class="p">)</span>
    <span class="n">costs_naive</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
        <span class="n">anchor_constraint</span><span class="p">(</span>
            <span class="n">point_vars_naive</span><span class="p">[(</span><span class="n">row</span><span class="p">,</span> <span class="n">cols</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)],</span> <span class="n">initial_positions</span><span class="p">[</span><span class="n">idx</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">cols</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)]</span>
        <span class="p">)</span>
    <span class="p">)</span>

<span class="c1"># Horizontal springs.</span>
<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">rows</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">cols</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">costs_naive</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">spring_cost</span><span class="p">(</span>
                <span class="n">point_vars_naive</span><span class="p">[(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">)],</span> <span class="n">point_vars_naive</span><span class="p">[(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)],</span> <span class="n">spacing</span>
            <span class="p">)</span>
        <span class="p">)</span>

<span class="c1"># Vertical springs.</span>
<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">rows</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">cols</span><span class="p">):</span>
        <span class="n">costs_naive</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">spring_cost</span><span class="p">(</span>
                <span class="n">point_vars_naive</span><span class="p">[(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">)],</span> <span class="n">point_vars_naive</span><span class="p">[(</span><span class="n">row</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">col</span><span class="p">)],</span> <span class="n">spacing</span>
            <span class="p">)</span>
        <span class="p">)</span>

<span class="c1"># Gravity on non-anchor points.</span>
<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">rows</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">cols</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">costs_naive</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">gravity_cost</span><span class="p">(</span><span class="n">point_vars_naive</span><span class="p">[(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">)]))</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Naive: Created </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">costs_naive</span><span class="p">)</span><span class="si">}</span><span class="s2"> cost objects&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Naive: Created 51 cost objects
</pre></div>
</div>
</div>
</div>
</section>
<section id="approach-2-batched-construction">
<h2>Approach 2: batched construction<a class="headerlink" href="#approach-2-batched-construction" title="Link to this heading">#</a></h2>
<p>When variable IDs have a leading batch axis, a batch of costs is created in one call. This reduces Python overhead and speeds up problem analysis.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create ALL point variables at once with batched IDs.</span>
<span class="n">all_point_vars</span> <span class="o">=</span> <span class="n">Point2Var</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">num_points</span><span class="p">))</span>

<span class="c1"># Precompute index arrays.</span>
<span class="n">anchor_indices</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">idx</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">rows</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">cols</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]])</span>
<span class="n">anchor_positions</span> <span class="o">=</span> <span class="n">initial_positions</span><span class="p">[</span><span class="n">anchor_indices</span><span class="p">]</span>

<span class="n">h_spring_a</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">idx</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">rows</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">cols</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)])</span>
<span class="n">h_spring_b</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">idx</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">c</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">rows</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">cols</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)])</span>

<span class="n">v_spring_a</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">idx</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">rows</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">cols</span><span class="p">)])</span>
<span class="n">v_spring_b</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">idx</span><span class="p">(</span><span class="n">r</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">rows</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">cols</span><span class="p">)])</span>

<span class="n">interior_indices</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
    <span class="p">[</span><span class="n">idx</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">rows</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">cols</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)]</span>
<span class="p">)</span>

<span class="c1"># Create all costs using batched construction (4 calls instead of 51!)</span>
<span class="n">costs_batched</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">jaxls</span><span class="o">.</span><span class="n">Cost</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">anchor_constraint</span><span class="p">(</span><span class="n">Point2Var</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">anchor_indices</span><span class="p">),</span> <span class="n">anchor_positions</span><span class="p">),</span>
    <span class="n">spring_cost</span><span class="p">(</span><span class="n">Point2Var</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">h_spring_a</span><span class="p">),</span> <span class="n">Point2Var</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">h_spring_b</span><span class="p">),</span> <span class="n">spacing</span><span class="p">),</span>
    <span class="n">spring_cost</span><span class="p">(</span><span class="n">Point2Var</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">v_spring_a</span><span class="p">),</span> <span class="n">Point2Var</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">v_spring_b</span><span class="p">),</span> <span class="n">spacing</span><span class="p">),</span>
    <span class="n">gravity_cost</span><span class="p">(</span><span class="n">Point2Var</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">interior_indices</span><span class="p">)),</span>
<span class="p">]</span>

<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;Batched: Created </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">costs_batched</span><span class="p">)</span><span class="si">}</span><span class="s2"> cost objects (representing 51 individual costs)&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Batched: Created 4 cost objects (representing 51 individual costs)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Visualize the full batched problem structure.</span>
<span class="c1"># The interactive D3.js visualization supports zoom, pan, and dragging nodes.</span>
<span class="n">jaxls</span><span class="o">.</span><span class="n">LeastSquaresProblem</span><span class="p">(</span><span class="n">costs_batched</span><span class="p">,</span> <span class="p">[</span><span class="n">all_point_vars</span><span class="p">])</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
        <iframe
            width="100%"
            height="500"
            src="data:text/html;base64,PCFET0NUWVBFIGh0bWw+CjxodG1sPgo8aGVhZD4KICAgIDxtZXRhIGNoYXJzZXQ9InV0Zi04Ij4KICAgIDxzdHlsZT4KICAgICAgICBib2R5IHsgbWFyZ2luOiAwOyBvdmVyZmxvdzogaGlkZGVuOyB9CiAgICAgICAgI2NvbnRhaW5lciB7IHdpZHRoOiAxMDAlOyBoZWlnaHQ6IDEwMHZoOyBwb3NpdGlvbjogcmVsYXRpdmU7IH0KICAgICAgICBjYW52YXMgeyBkaXNwbGF5OiBibG9jazsgd2lkdGg6IDEwMCU7IGhlaWdodDogMTAwJTsgfQogICAgICAgIC5zdGF0dXMgeyBwb3NpdGlvbjogYWJzb2x1dGU7IGJvdHRvbTogNXB4OyByaWdodDogMTBweDsgZm9udC1zaXplOiAxMHB4OyBjb2xvcjogIzY2NjsgZm9udC1mYW1pbHk6IEhlbHZldGljYSwgQXJpYWwsIHNhbnMtc2VyaWY7IGJhY2tncm91bmQ6IHJnYmEoMjU1LDI1NSwyNTUsMC44KTsgcGFkZGluZzogMnB4IDVweDsgYm9yZGVyLXJhZGl1czogM3B4OyB9CiAgICA8L3N0eWxlPgo8L2hlYWQ+Cjxib2R5PgogICAgPGRpdiBpZD0iY29udGFpbmVyIj4KICAgICAgICA8Y2FudmFzPjwvY2FudmFzPgogICAgICAgIDxkaXYgY2xhc3M9InN0YXR1cyI+NTEgY29zdHMsIDIwIHZhcmlhYmxlczwvZGl2PgogICAgPC9kaXY+CiAgICA8c2NyaXB0IHNyYz0iaHR0cHM6Ly9kM2pzLm9yZy9kMy52Ny5taW4uanMiPjwvc2NyaXB0PgogICAgPHNjcmlwdD4KICAgIChmdW5jdGlvbigpIHsKICAgICAgICBjb25zdCBkYXRhID0geyJub2RlcyI6IFt7ImlkIjogInZhcl8wIiwgImxhYmVsIjogIlBvaW50MlZhcigwKSIsICJ0eXBlIjogInZhcmlhYmxlIiwgInZhcl90eXBlIjogIlBvaW50MlZhciIsICJmaWxsIjogIiNmZmNjY2MiLCAic3Ryb2tlIjogIiNjYzY2NjYifSwgeyJpZCI6ICJ2YXJfMSIsICJsYWJlbCI6ICJQb2ludDJWYXIoNCkiLCAidHlwZSI6ICJ2YXJpYWJsZSIsICJ2YXJfdHlwZSI6ICJQb2ludDJWYXIiLCAiZmlsbCI6ICIjZmZjY2NjIiwgInN0cm9rZSI6ICIjY2M2NjY2In0sIHsiaWQiOiAidmFyXzIiLCAibGFiZWwiOiAiUG9pbnQyVmFyKDUpIiwgInR5cGUiOiAidmFyaWFibGUiLCAidmFyX3R5cGUiOiAiUG9pbnQyVmFyIiwgImZpbGwiOiAiI2ZmY2NjYyIsICJzdHJva2UiOiAiI2NjNjY2NiJ9LCB7ImlkIjogInZhcl8zIiwgImxhYmVsIjogIlBvaW50MlZhcig5KSIsICJ0eXBlIjogInZhcmlhYmxlIiwgInZhcl90eXBlIjogIlBvaW50MlZhciIsICJmaWxsIjogIiNmZmNjY2MiLCAic3Ryb2tlIjogIiNjYzY2NjYifSwgeyJpZCI6ICJ2YXJfNCIsICJsYWJlbCI6ICJQb2ludDJWYXIoMTApIiwgInR5cGUiOiAidmFyaWFibGUiLCAidmFyX3R5cGUiOiAiUG9pbnQyVmFyIiwgImZpbGwiOiAiI2ZmY2NjYyIsICJzdHJva2UiOiAiI2NjNjY2NiJ9LCB7ImlkIjogInZhcl81IiwgImxhYmVsIjogIlBvaW50MlZhcigxNCkiLCAidHlwZSI6ICJ2YXJpYWJsZSIsICJ2YXJfdHlwZSI6ICJQb2ludDJWYXIiLCAiZmlsbCI6ICIjZmZjY2NjIiwgInN0cm9rZSI6ICIjY2M2NjY2In0sIHsiaWQiOiAidmFyXzYiLCAibGFiZWwiOiAiUG9pbnQyVmFyKDE1KSIsICJ0eXBlIjogInZhcmlhYmxlIiwgInZhcl90eXBlIjogIlBvaW50MlZhciIsICJmaWxsIjogIiNmZmNjY2MiLCAic3Ryb2tlIjogIiNjYzY2NjYifSwgeyJpZCI6ICJ2YXJfNyIsICJsYWJlbCI6ICJQb2ludDJWYXIoMTkpIiwgInR5cGUiOiAidmFyaWFibGUiLCAidmFyX3R5cGUiOiAiUG9pbnQyVmFyIiwgImZpbGwiOiAiI2ZmY2NjYyIsICJzdHJva2UiOiAiI2NjNjY2NiJ9LCB7ImlkIjogInZhcl84IiwgImxhYmVsIjogIlBvaW50MlZhcigxKSIsICJ0eXBlIjogInZhcmlhYmxlIiwgInZhcl90eXBlIjogIlBvaW50MlZhciIsICJmaWxsIjogIiNmZmNjY2MiLCAic3Ryb2tlIjogIiNjYzY2NjYifSwgeyJpZCI6ICJ2YXJfOSIsICJsYWJlbCI6ICJQb2ludDJWYXIoMikiLCAidHlwZSI6ICJ2YXJpYWJsZSIsICJ2YXJfdHlwZSI6ICJQb2ludDJWYXIiLCAiZmlsbCI6ICIjZmZjY2NjIiwgInN0cm9rZSI6ICIjY2M2NjY2In0sIHsiaWQiOiAidmFyXzEwIiwgImxhYmVsIjogIlBvaW50MlZhcigzKSIsICJ0eXBlIjogInZhcmlhYmxlIiwgInZhcl90eXBlIjogIlBvaW50MlZhciIsICJmaWxsIjogIiNmZmNjY2MiLCAic3Ryb2tlIjogIiNjYzY2NjYifSwgeyJpZCI6ICJ2YXJfMTEiLCAibGFiZWwiOiAiUG9pbnQyVmFyKDYpIiwgInR5cGUiOiAidmFyaWFibGUiLCAidmFyX3R5cGUiOiAiUG9pbnQyVmFyIiwgImZpbGwiOiAiI2ZmY2NjYyIsICJzdHJva2UiOiAiI2NjNjY2NiJ9LCB7ImlkIjogInZhcl8xMiIsICJsYWJlbCI6ICJQb2ludDJWYXIoNykiLCAidHlwZSI6ICJ2YXJpYWJsZSIsICJ2YXJfdHlwZSI6ICJQb2ludDJWYXIiLCAiZmlsbCI6ICIjZmZjY2NjIiwgInN0cm9rZSI6ICIjY2M2NjY2In0sIHsiaWQiOiAidmFyXzEzIiwgImxhYmVsIjogIlBvaW50MlZhcig4KSIsICJ0eXBlIjogInZhcmlhYmxlIiwgInZhcl90eXBlIjogIlBvaW50MlZhciIsICJmaWxsIjogIiNmZmNjY2MiLCAic3Ryb2tlIjogIiNjYzY2NjYifSwgeyJpZCI6ICJ2YXJfMTQiLCAibGFiZWwiOiAiUG9pbnQyVmFyKDExKSIsICJ0eXBlIjogInZhcmlhYmxlIiwgInZhcl90eXBlIjogIlBvaW50MlZhciIsICJmaWxsIjogIiNmZmNjY2MiLCAic3Ryb2tlIjogIiNjYzY2NjYifSwgeyJpZCI6ICJ2YXJfMTUiLCAibGFiZWwiOiAiUG9pbnQyVmFyKDEyKSIsICJ0eXBlIjogInZhcmlhYmxlIiwgInZhcl90eXBlIjogIlBvaW50MlZhciIsICJmaWxsIjogIiNmZmNjY2MiLCAic3Ryb2tlIjogIiNjYzY2NjYifSwgeyJpZCI6ICJ2YXJfMTYiLCAibGFiZWwiOiAiUG9pbnQyVmFyKDEzKSIsICJ0eXBlIjogInZhcmlhYmxlIiwgInZhcl90eXBlIjogIlBvaW50MlZhciIsICJmaWxsIjogIiNmZmNjY2MiLCAic3Ryb2tlIjogIiNjYzY2NjYifSwgeyJpZCI6ICJ2YXJfMTciLCAibGFiZWwiOiAiUG9pbnQyVmFyKDE2KSIsICJ0eXBlIjogInZhcmlhYmxlIiwgInZhcl90eXBlIjogIlBvaW50MlZhciIsICJmaWxsIjogIiNmZmNjY2MiLCAic3Ryb2tlIjogIiNjYzY2NjYifSwgeyJpZCI6ICJ2YXJfMTgiLCAibGFiZWwiOiAiUG9pbnQyVmFyKDE3KSIsICJ0eXBlIjogInZhcmlhYmxlIiwgInZhcl90eXBlIjogIlBvaW50MlZhciIsICJmaWxsIjogIiNmZmNjY2MiLCAic3Ryb2tlIjogIiNjYzY2NjYifSwgeyJpZCI6ICJ2YXJfMTkiLCAibGFiZWwiOiAiUG9pbnQyVmFyKDE4KSIsICJ0eXBlIjogInZhcmlhYmxlIiwgInZhcl90eXBlIjogIlBvaW50MlZhciIsICJmaWxsIjogIiNmZmNjY2MiLCAic3Ryb2tlIjogIiNjYzY2NjYifSwgeyJpZCI6ICJjb3N0XzAiLCAibGFiZWwiOiAiYW5jaG9yX2NvbnN0cmFpbnQiLCAidHlwZSI6ICJjb3N0IiwgImtpbmQiOiAiY29uc3RyYWludF9lcV96ZXJvIiwgImZpbGwiOiAiI2E4ZmZhOCIsICJzdHJva2UiOiAiIzRhZDk0YSJ9LCB7ImlkIjogImNvc3RfMSIsICJsYWJlbCI6ICJhbmNob3JfY29uc3RyYWludCIsICJ0eXBlIjogImNvc3QiLCAia2luZCI6ICJjb25zdHJhaW50X2VxX3plcm8iLCAiZmlsbCI6ICIjYThmZmE4IiwgInN0cm9rZSI6ICIjNGFkOTRhIn0sIHsiaWQiOiAiY29zdF8yIiwgImxhYmVsIjogImFuY2hvcl9jb25zdHJhaW50IiwgInR5cGUiOiAiY29zdCIsICJraW5kIjogImNvbnN0cmFpbnRfZXFfemVybyIsICJmaWxsIjogIiNhOGZmYTgiLCAic3Ryb2tlIjogIiM0YWQ5NGEifSwgeyJpZCI6ICJjb3N0XzMiLCAibGFiZWwiOiAiYW5jaG9yX2NvbnN0cmFpbnQiLCAidHlwZSI6ICJjb3N0IiwgImtpbmQiOiAiY29uc3RyYWludF9lcV96ZXJvIiwgImZpbGwiOiAiI2E4ZmZhOCIsICJzdHJva2UiOiAiIzRhZDk0YSJ9LCB7ImlkIjogImNvc3RfNCIsICJsYWJlbCI6ICJhbmNob3JfY29uc3RyYWludCIsICJ0eXBlIjogImNvc3QiLCAia2luZCI6ICJjb25zdHJhaW50X2VxX3plcm8iLCAiZmlsbCI6ICIjYThmZmE4IiwgInN0cm9rZSI6ICIjNGFkOTRhIn0sIHsiaWQiOiAiY29zdF81IiwgImxhYmVsIjogImFuY2hvcl9jb25zdHJhaW50IiwgInR5cGUiOiAiY29zdCIsICJraW5kIjogImNvbnN0cmFpbnRfZXFfemVybyIsICJmaWxsIjogIiNhOGZmYTgiLCAic3Ryb2tlIjogIiM0YWQ5NGEifSwgeyJpZCI6ICJjb3N0XzYiLCAibGFiZWwiOiAiYW5jaG9yX2NvbnN0cmFpbnQiLCAidHlwZSI6ICJjb3N0IiwgImtpbmQiOiAiY29uc3RyYWludF9lcV96ZXJvIiwgImZpbGwiOiAiI2E4ZmZhOCIsICJzdHJva2UiOiAiIzRhZDk0YSJ9LCB7ImlkIjogImNvc3RfNyIsICJsYWJlbCI6ICJhbmNob3JfY29uc3RyYWludCIsICJ0eXBlIjogImNvc3QiLCAia2luZCI6ICJjb25zdHJhaW50X2VxX3plcm8iLCAiZmlsbCI6ICIjYThmZmE4IiwgInN0cm9rZSI6ICIjNGFkOTRhIn0sIHsiaWQiOiAiY29zdF84IiwgImxhYmVsIjogInNwcmluZ19jb3N0IiwgInR5cGUiOiAiY29zdCIsICJraW5kIjogImwyX3NxdWFyZWQiLCAiZmlsbCI6ICIjYThkNWZmIiwgInN0cm9rZSI6ICIjNGE5MGQ5In0sIHsiaWQiOiAiY29zdF85IiwgImxhYmVsIjogInNwcmluZ19jb3N0IiwgInR5cGUiOiAiY29zdCIsICJraW5kIjogImwyX3NxdWFyZWQiLCAiZmlsbCI6ICIjYThkNWZmIiwgInN0cm9rZSI6ICIjNGE5MGQ5In0sIHsiaWQiOiAiY29zdF8xMCIsICJsYWJlbCI6ICJzcHJpbmdfY29zdCIsICJ0eXBlIjogImNvc3QiLCAia2luZCI6ICJsMl9zcXVhcmVkIiwgImZpbGwiOiAiI2E4ZDVmZiIsICJzdHJva2UiOiAiIzRhOTBkOSJ9LCB7ImlkIjogImNvc3RfMTEiLCAibGFiZWwiOiAic3ByaW5nX2Nvc3QiLCAidHlwZSI6ICJjb3N0IiwgImtpbmQiOiAibDJfc3F1YXJlZCIsICJmaWxsIjogIiNhOGQ1ZmYiLCAic3Ryb2tlIjogIiM0YTkwZDkifSwgeyJpZCI6ICJjb3N0XzEyIiwgImxhYmVsIjogInNwcmluZ19jb3N0IiwgInR5cGUiOiAiY29zdCIsICJraW5kIjogImwyX3NxdWFyZWQiLCAiZmlsbCI6ICIjYThkNWZmIiwgInN0cm9rZSI6ICIjNGE5MGQ5In0sIHsiaWQiOiAiY29zdF8xMyIsICJsYWJlbCI6ICJzcHJpbmdfY29zdCIsICJ0eXBlIjogImNvc3QiLCAia2luZCI6ICJsMl9zcXVhcmVkIiwgImZpbGwiOiAiI2E4ZDVmZiIsICJzdHJva2UiOiAiIzRhOTBkOSJ9LCB7ImlkIjogImNvc3RfMTQiLCAibGFiZWwiOiAic3ByaW5nX2Nvc3QiLCAidHlwZSI6ICJjb3N0IiwgImtpbmQiOiAibDJfc3F1YXJlZCIsICJmaWxsIjogIiNhOGQ1ZmYiLCAic3Ryb2tlIjogIiM0YTkwZDkifSwgeyJpZCI6ICJjb3N0XzE1IiwgImxhYmVsIjogInNwcmluZ19jb3N0IiwgInR5cGUiOiAiY29zdCIsICJraW5kIjogImwyX3NxdWFyZWQiLCAiZmlsbCI6ICIjYThkNWZmIiwgInN0cm9rZSI6ICIjNGE5MGQ5In0sIHsiaWQiOiAiY29zdF8xNiIsICJsYWJlbCI6ICJzcHJpbmdfY29zdCIsICJ0eXBlIjogImNvc3QiLCAia2luZCI6ICJsMl9zcXVhcmVkIiwgImZpbGwiOiAiI2E4ZDVmZiIsICJzdHJva2UiOiAiIzRhOTBkOSJ9LCB7ImlkIjogImNvc3RfMTciLCAibGFiZWwiOiAic3ByaW5nX2Nvc3QiLCAidHlwZSI6ICJjb3N0IiwgImtpbmQiOiAibDJfc3F1YXJlZCIsICJmaWxsIjogIiNhOGQ1ZmYiLCAic3Ryb2tlIjogIiM0YTkwZDkifSwgeyJpZCI6ICJjb3N0XzE4IiwgImxhYmVsIjogInNwcmluZ19jb3N0IiwgInR5cGUiOiAiY29zdCIsICJraW5kIjogImwyX3NxdWFyZWQiLCAiZmlsbCI6ICIjYThkNWZmIiwgInN0cm9rZSI6ICIjNGE5MGQ5In0sIHsiaWQiOiAiY29zdF8xOSIsICJsYWJlbCI6ICJzcHJpbmdfY29zdCIsICJ0eXBlIjogImNvc3QiLCAia2luZCI6ICJsMl9zcXVhcmVkIiwgImZpbGwiOiAiI2E4ZDVmZiIsICJzdHJva2UiOiAiIzRhOTBkOSJ9LCB7ImlkIjogImNvc3RfMjAiLCAibGFiZWwiOiAic3ByaW5nX2Nvc3QiLCAidHlwZSI6ICJjb3N0IiwgImtpbmQiOiAibDJfc3F1YXJlZCIsICJmaWxsIjogIiNhOGQ1ZmYiLCAic3Ryb2tlIjogIiM0YTkwZDkifSwgeyJpZCI6ICJjb3N0XzIxIiwgImxhYmVsIjogInNwcmluZ19jb3N0IiwgInR5cGUiOiAiY29zdCIsICJraW5kIjogImwyX3NxdWFyZWQiLCAiZmlsbCI6ICIjYThkNWZmIiwgInN0cm9rZSI6ICIjNGE5MGQ5In0sIHsiaWQiOiAiY29zdF8yMiIsICJsYWJlbCI6ICJzcHJpbmdfY29zdCIsICJ0eXBlIjogImNvc3QiLCAia2luZCI6ICJsMl9zcXVhcmVkIiwgImZpbGwiOiAiI2E4ZDVmZiIsICJzdHJva2UiOiAiIzRhOTBkOSJ9LCB7ImlkIjogImNvc3RfMjMiLCAibGFiZWwiOiAic3ByaW5nX2Nvc3QiLCAidHlwZSI6ICJjb3N0IiwgImtpbmQiOiAibDJfc3F1YXJlZCIsICJmaWxsIjogIiNhOGQ1ZmYiLCAic3Ryb2tlIjogIiM0YTkwZDkifSwgeyJpZCI6ICJjb3N0XzI0IiwgImxhYmVsIjogInNwcmluZ19jb3N0IiwgInR5cGUiOiAiY29zdCIsICJraW5kIjogImwyX3NxdWFyZWQiLCAiZmlsbCI6ICIjYThkNWZmIiwgInN0cm9rZSI6ICIjNGE5MGQ5In0sIHsiaWQiOiAiY29zdF8yNSIsICJsYWJlbCI6ICJzcHJpbmdfY29zdCIsICJ0eXBlIjogImNvc3QiLCAia2luZCI6ICJsMl9zcXVhcmVkIiwgImZpbGwiOiAiI2E4ZDVmZiIsICJzdHJva2UiOiAiIzRhOTBkOSJ9LCB7ImlkIjogImNvc3RfMjYiLCAibGFiZWwiOiAic3ByaW5nX2Nvc3QiLCAidHlwZSI6ICJjb3N0IiwgImtpbmQiOiAibDJfc3F1YXJlZCIsICJmaWxsIjogIiNhOGQ1ZmYiLCAic3Ryb2tlIjogIiM0YTkwZDkifSwgeyJpZCI6ICJjb3N0XzI3IiwgImxhYmVsIjogInNwcmluZ19jb3N0IiwgInR5cGUiOiAiY29zdCIsICJraW5kIjogImwyX3NxdWFyZWQiLCAiZmlsbCI6ICIjYThkNWZmIiwgInN0cm9rZSI6ICIjNGE5MGQ5In0sIHsiaWQiOiAiY29zdF8yOCIsICJsYWJlbCI6ICJzcHJpbmdfY29zdCIsICJ0eXBlIjogImNvc3QiLCAia2luZCI6ICJsMl9zcXVhcmVkIiwgImZpbGwiOiAiI2E4ZDVmZiIsICJzdHJva2UiOiAiIzRhOTBkOSJ9LCB7ImlkIjogImNvc3RfMjkiLCAibGFiZWwiOiAic3ByaW5nX2Nvc3QiLCAidHlwZSI6ICJjb3N0IiwgImtpbmQiOiAibDJfc3F1YXJlZCIsICJmaWxsIjogIiNhOGQ1ZmYiLCAic3Ryb2tlIjogIiM0YTkwZDkifSwgeyJpZCI6ICJjb3N0XzMwIiwgImxhYmVsIjogInNwcmluZ19jb3N0IiwgInR5cGUiOiAiY29zdCIsICJraW5kIjogImwyX3NxdWFyZWQiLCAiZmlsbCI6ICIjYThkNWZmIiwgInN0cm9rZSI6ICIjNGE5MGQ5In0sIHsiaWQiOiAiY29zdF8zMSIsICJsYWJlbCI6ICJzcHJpbmdfY29zdCIsICJ0eXBlIjogImNvc3QiLCAia2luZCI6ICJsMl9zcXVhcmVkIiwgImZpbGwiOiAiI2E4ZDVmZiIsICJzdHJva2UiOiAiIzRhOTBkOSJ9LCB7ImlkIjogImNvc3RfMzIiLCAibGFiZWwiOiAic3ByaW5nX2Nvc3QiLCAidHlwZSI6ICJjb3N0IiwgImtpbmQiOiAibDJfc3F1YXJlZCIsICJmaWxsIjogIiNhOGQ1ZmYiLCAic3Ryb2tlIjogIiM0YTkwZDkifSwgeyJpZCI6ICJjb3N0XzMzIiwgImxhYmVsIjogInNwcmluZ19jb3N0IiwgInR5cGUiOiAiY29zdCIsICJraW5kIjogImwyX3NxdWFyZWQiLCAiZmlsbCI6ICIjYThkNWZmIiwgInN0cm9rZSI6ICIjNGE5MGQ5In0sIHsiaWQiOiAiY29zdF8zNCIsICJsYWJlbCI6ICJzcHJpbmdfY29zdCIsICJ0eXBlIjogImNvc3QiLCAia2luZCI6ICJsMl9zcXVhcmVkIiwgImZpbGwiOiAiI2E4ZDVmZiIsICJzdHJva2UiOiAiIzRhOTBkOSJ9LCB7ImlkIjogImNvc3RfMzUiLCAibGFiZWwiOiAic3ByaW5nX2Nvc3QiLCAidHlwZSI6ICJjb3N0IiwgImtpbmQiOiAibDJfc3F1YXJlZCIsICJmaWxsIjogIiNhOGQ1ZmYiLCAic3Ryb2tlIjogIiM0YTkwZDkifSwgeyJpZCI6ICJjb3N0XzM2IiwgImxhYmVsIjogInNwcmluZ19jb3N0IiwgInR5cGUiOiAiY29zdCIsICJraW5kIjogImwyX3NxdWFyZWQiLCAiZmlsbCI6ICIjYThkNWZmIiwgInN0cm9rZSI6ICIjNGE5MGQ5In0sIHsiaWQiOiAiY29zdF8zNyIsICJsYWJlbCI6ICJzcHJpbmdfY29zdCIsICJ0eXBlIjogImNvc3QiLCAia2luZCI6ICJsMl9zcXVhcmVkIiwgImZpbGwiOiAiI2E4ZDVmZiIsICJzdHJva2UiOiAiIzRhOTBkOSJ9LCB7ImlkIjogImNvc3RfMzgiLCAibGFiZWwiOiAic3ByaW5nX2Nvc3QiLCAidHlwZSI6ICJjb3N0IiwgImtpbmQiOiAibDJfc3F1YXJlZCIsICJmaWxsIjogIiNhOGQ1ZmYiLCAic3Ryb2tlIjogIiM0YTkwZDkifSwgeyJpZCI6ICJjb3N0XzM5IiwgImxhYmVsIjogImdyYXZpdHlfY29zdCIsICJ0eXBlIjogImNvc3QiLCAia2luZCI6ICJsMl9zcXVhcmVkIiwgImZpbGwiOiAiI2E4ZDVmZiIsICJzdHJva2UiOiAiIzRhOTBkOSJ9LCB7ImlkIjogImNvc3RfNDAiLCAibGFiZWwiOiAiZ3Jhdml0eV9jb3N0IiwgInR5cGUiOiAiY29zdCIsICJraW5kIjogImwyX3NxdWFyZWQiLCAiZmlsbCI6ICIjYThkNWZmIiwgInN0cm9rZSI6ICIjNGE5MGQ5In0sIHsiaWQiOiAiY29zdF80MSIsICJsYWJlbCI6ICJncmF2aXR5X2Nvc3QiLCAidHlwZSI6ICJjb3N0IiwgImtpbmQiOiAibDJfc3F1YXJlZCIsICJmaWxsIjogIiNhOGQ1ZmYiLCAic3Ryb2tlIjogIiM0YTkwZDkifSwgeyJpZCI6ICJjb3N0XzQyIiwgImxhYmVsIjogImdyYXZpdHlfY29zdCIsICJ0eXBlIjogImNvc3QiLCAia2luZCI6ICJsMl9zcXVhcmVkIiwgImZpbGwiOiAiI2E4ZDVmZiIsICJzdHJva2UiOiAiIzRhOTBkOSJ9LCB7ImlkIjogImNvc3RfNDMiLCAibGFiZWwiOiAiZ3Jhdml0eV9jb3N0IiwgInR5cGUiOiAiY29zdCIsICJraW5kIjogImwyX3NxdWFyZWQiLCAiZmlsbCI6ICIjYThkNWZmIiwgInN0cm9rZSI6ICIjNGE5MGQ5In0sIHsiaWQiOiAiY29zdF80NCIsICJsYWJlbCI6ICJncmF2aXR5X2Nvc3QiLCAidHlwZSI6ICJjb3N0IiwgImtpbmQiOiAibDJfc3F1YXJlZCIsICJmaWxsIjogIiNhOGQ1ZmYiLCAic3Ryb2tlIjogIiM0YTkwZDkifSwgeyJpZCI6ICJjb3N0XzQ1IiwgImxhYmVsIjogImdyYXZpdHlfY29zdCIsICJ0eXBlIjogImNvc3QiLCAia2luZCI6ICJsMl9zcXVhcmVkIiwgImZpbGwiOiAiI2E4ZDVmZiIsICJzdHJva2UiOiAiIzRhOTBkOSJ9LCB7ImlkIjogImNvc3RfNDYiLCAibGFiZWwiOiAiZ3Jhdml0eV9jb3N0IiwgInR5cGUiOiAiY29zdCIsICJraW5kIjogImwyX3NxdWFyZWQiLCAiZmlsbCI6ICIjYThkNWZmIiwgInN0cm9rZSI6ICIjNGE5MGQ5In0sIHsiaWQiOiAiY29zdF80NyIsICJsYWJlbCI6ICJncmF2aXR5X2Nvc3QiLCAidHlwZSI6ICJjb3N0IiwgImtpbmQiOiAibDJfc3F1YXJlZCIsICJmaWxsIjogIiNhOGQ1ZmYiLCAic3Ryb2tlIjogIiM0YTkwZDkifSwgeyJpZCI6ICJjb3N0XzQ4IiwgImxhYmVsIjogImdyYXZpdHlfY29zdCIsICJ0eXBlIjogImNvc3QiLCAia2luZCI6ICJsMl9zcXVhcmVkIiwgImZpbGwiOiAiI2E4ZDVmZiIsICJzdHJva2UiOiAiIzRhOTBkOSJ9LCB7ImlkIjogImNvc3RfNDkiLCAibGFiZWwiOiAiZ3Jhdml0eV9jb3N0IiwgInR5cGUiOiAiY29zdCIsICJraW5kIjogImwyX3NxdWFyZWQiLCAiZmlsbCI6ICIjYThkNWZmIiwgInN0cm9rZSI6ICIjNGE5MGQ5In0sIHsiaWQiOiAiY29zdF81MCIsICJsYWJlbCI6ICJncmF2aXR5X2Nvc3QiLCAidHlwZSI6ICJjb3N0IiwgImtpbmQiOiAibDJfc3F1YXJlZCIsICJmaWxsIjogIiNhOGQ1ZmYiLCAic3Ryb2tlIjogIiM0YTkwZDkifV0sICJsaW5rcyI6IFt7InNvdXJjZSI6ICJjb3N0XzAiLCAidGFyZ2V0IjogInZhcl8wIn0sIHsic291cmNlIjogImNvc3RfMSIsICJ0YXJnZXQiOiAidmFyXzEifSwgeyJzb3VyY2UiOiAiY29zdF8yIiwgInRhcmdldCI6ICJ2YXJfMiJ9LCB7InNvdXJjZSI6ICJjb3N0XzMiLCAidGFyZ2V0IjogInZhcl8zIn0sIHsic291cmNlIjogImNvc3RfNCIsICJ0YXJnZXQiOiAidmFyXzQifSwgeyJzb3VyY2UiOiAiY29zdF81IiwgInRhcmdldCI6ICJ2YXJfNSJ9LCB7InNvdXJjZSI6ICJjb3N0XzYiLCAidGFyZ2V0IjogInZhcl82In0sIHsic291cmNlIjogImNvc3RfNyIsICJ0YXJnZXQiOiAidmFyXzcifSwgeyJzb3VyY2UiOiAiY29zdF84IiwgInRhcmdldCI6ICJ2YXJfMCJ9LCB7InNvdXJjZSI6ICJjb3N0XzgiLCAidGFyZ2V0IjogInZhcl84In0sIHsic291cmNlIjogImNvc3RfOSIsICJ0YXJnZXQiOiAidmFyXzgifSwgeyJzb3VyY2UiOiAiY29zdF85IiwgInRhcmdldCI6ICJ2YXJfOSJ9LCB7InNvdXJjZSI6ICJjb3N0XzEwIiwgInRhcmdldCI6ICJ2YXJfOSJ9LCB7InNvdXJjZSI6ICJjb3N0XzEwIiwgInRhcmdldCI6ICJ2YXJfMTAifSwgeyJzb3VyY2UiOiAiY29zdF8xMSIsICJ0YXJnZXQiOiAidmFyXzEwIn0sIHsic291cmNlIjogImNvc3RfMTEiLCAidGFyZ2V0IjogInZhcl8xIn0sIHsic291cmNlIjogImNvc3RfMTIiLCAidGFyZ2V0IjogInZhcl8yIn0sIHsic291cmNlIjogImNvc3RfMTIiLCAidGFyZ2V0IjogInZhcl8xMSJ9LCB7InNvdXJjZSI6ICJjb3N0XzEzIiwgInRhcmdldCI6ICJ2YXJfMTEifSwgeyJzb3VyY2UiOiAiY29zdF8xMyIsICJ0YXJnZXQiOiAidmFyXzEyIn0sIHsic291cmNlIjogImNvc3RfMTQiLCAidGFyZ2V0IjogInZhcl8xMiJ9LCB7InNvdXJjZSI6ICJjb3N0XzE0IiwgInRhcmdldCI6ICJ2YXJfMTMifSwgeyJzb3VyY2UiOiAiY29zdF8xNSIsICJ0YXJnZXQiOiAidmFyXzEzIn0sIHsic291cmNlIjogImNvc3RfMTUiLCAidGFyZ2V0IjogInZhcl8zIn0sIHsic291cmNlIjogImNvc3RfMTYiLCAidGFyZ2V0IjogInZhcl80In0sIHsic291cmNlIjogImNvc3RfMTYiLCAidGFyZ2V0IjogInZhcl8xNCJ9LCB7InNvdXJjZSI6ICJjb3N0XzE3IiwgInRhcmdldCI6ICJ2YXJfMTQifSwgeyJzb3VyY2UiOiAiY29zdF8xNyIsICJ0YXJnZXQiOiAidmFyXzE1In0sIHsic291cmNlIjogImNvc3RfMTgiLCAidGFyZ2V0IjogInZhcl8xNSJ9LCB7InNvdXJjZSI6ICJjb3N0XzE4IiwgInRhcmdldCI6ICJ2YXJfMTYifSwgeyJzb3VyY2UiOiAiY29zdF8xOSIsICJ0YXJnZXQiOiAidmFyXzE2In0sIHsic291cmNlIjogImNvc3RfMTkiLCAidGFyZ2V0IjogInZhcl81In0sIHsic291cmNlIjogImNvc3RfMjAiLCAidGFyZ2V0IjogInZhcl82In0sIHsic291cmNlIjogImNvc3RfMjAiLCAidGFyZ2V0IjogInZhcl8xNyJ9LCB7InNvdXJjZSI6ICJjb3N0XzIxIiwgInRhcmdldCI6ICJ2YXJfMTcifSwgeyJzb3VyY2UiOiAiY29zdF8yMSIsICJ0YXJnZXQiOiAidmFyXzE4In0sIHsic291cmNlIjogImNvc3RfMjIiLCAidGFyZ2V0IjogInZhcl8xOCJ9LCB7InNvdXJjZSI6ICJjb3N0XzIyIiwgInRhcmdldCI6ICJ2YXJfMTkifSwgeyJzb3VyY2UiOiAiY29zdF8yMyIsICJ0YXJnZXQiOiAidmFyXzE5In0sIHsic291cmNlIjogImNvc3RfMjMiLCAidGFyZ2V0IjogInZhcl83In0sIHsic291cmNlIjogImNvc3RfMjQiLCAidGFyZ2V0IjogInZhcl8wIn0sIHsic291cmNlIjogImNvc3RfMjQiLCAidGFyZ2V0IjogInZhcl8yIn0sIHsic291cmNlIjogImNvc3RfMjUiLCAidGFyZ2V0IjogInZhcl84In0sIHsic291cmNlIjogImNvc3RfMjUiLCAidGFyZ2V0IjogInZhcl8xMSJ9LCB7InNvdXJjZSI6ICJjb3N0XzI2IiwgInRhcmdldCI6ICJ2YXJfOSJ9LCB7InNvdXJjZSI6ICJjb3N0XzI2IiwgInRhcmdldCI6ICJ2YXJfMTIifSwgeyJzb3VyY2UiOiAiY29zdF8yNyIsICJ0YXJnZXQiOiAidmFyXzEwIn0sIHsic291cmNlIjogImNvc3RfMjciLCAidGFyZ2V0IjogInZhcl8xMyJ9LCB7InNvdXJjZSI6ICJjb3N0XzI4IiwgInRhcmdldCI6ICJ2YXJfMSJ9LCB7InNvdXJjZSI6ICJjb3N0XzI4IiwgInRhcmdldCI6ICJ2YXJfMyJ9LCB7InNvdXJjZSI6ICJjb3N0XzI5IiwgInRhcmdldCI6ICJ2YXJfMiJ9LCB7InNvdXJjZSI6ICJjb3N0XzI5IiwgInRhcmdldCI6ICJ2YXJfNCJ9LCB7InNvdXJjZSI6ICJjb3N0XzMwIiwgInRhcmdldCI6ICJ2YXJfMTEifSwgeyJzb3VyY2UiOiAiY29zdF8zMCIsICJ0YXJnZXQiOiAidmFyXzE0In0sIHsic291cmNlIjogImNvc3RfMzEiLCAidGFyZ2V0IjogInZhcl8xMiJ9LCB7InNvdXJjZSI6ICJjb3N0XzMxIiwgInRhcmdldCI6ICJ2YXJfMTUifSwgeyJzb3VyY2UiOiAiY29zdF8zMiIsICJ0YXJnZXQiOiAidmFyXzEzIn0sIHsic291cmNlIjogImNvc3RfMzIiLCAidGFyZ2V0IjogInZhcl8xNiJ9LCB7InNvdXJjZSI6ICJjb3N0XzMzIiwgInRhcmdldCI6ICJ2YXJfMyJ9LCB7InNvdXJjZSI6ICJjb3N0XzMzIiwgInRhcmdldCI6ICJ2YXJfNSJ9LCB7InNvdXJjZSI6ICJjb3N0XzM0IiwgInRhcmdldCI6ICJ2YXJfNCJ9LCB7InNvdXJjZSI6ICJjb3N0XzM0IiwgInRhcmdldCI6ICJ2YXJfNiJ9LCB7InNvdXJjZSI6ICJjb3N0XzM1IiwgInRhcmdldCI6ICJ2YXJfMTQifSwgeyJzb3VyY2UiOiAiY29zdF8zNSIsICJ0YXJnZXQiOiAidmFyXzE3In0sIHsic291cmNlIjogImNvc3RfMzYiLCAidGFyZ2V0IjogInZhcl8xNSJ9LCB7InNvdXJjZSI6ICJjb3N0XzM2IiwgInRhcmdldCI6ICJ2YXJfMTgifSwgeyJzb3VyY2UiOiAiY29zdF8zNyIsICJ0YXJnZXQiOiAidmFyXzE2In0sIHsic291cmNlIjogImNvc3RfMzciLCAidGFyZ2V0IjogInZhcl8xOSJ9LCB7InNvdXJjZSI6ICJjb3N0XzM4IiwgInRhcmdldCI6ICJ2YXJfNSJ9LCB7InNvdXJjZSI6ICJjb3N0XzM4IiwgInRhcmdldCI6ICJ2YXJfNyJ9LCB7InNvdXJjZSI6ICJjb3N0XzM5IiwgInRhcmdldCI6ICJ2YXJfOCJ9LCB7InNvdXJjZSI6ICJjb3N0XzQwIiwgInRhcmdldCI6ICJ2YXJfOSJ9LCB7InNvdXJjZSI6ICJjb3N0XzQxIiwgInRhcmdldCI6ICJ2YXJfMTAifSwgeyJzb3VyY2UiOiAiY29zdF80MiIsICJ0YXJnZXQiOiAidmFyXzExIn0sIHsic291cmNlIjogImNvc3RfNDMiLCAidGFyZ2V0IjogInZhcl8xMiJ9LCB7InNvdXJjZSI6ICJjb3N0XzQ0IiwgInRhcmdldCI6ICJ2YXJfMTMifSwgeyJzb3VyY2UiOiAiY29zdF80NSIsICJ0YXJnZXQiOiAidmFyXzE0In0sIHsic291cmNlIjogImNvc3RfNDYiLCAidGFyZ2V0IjogInZhcl8xNSJ9LCB7InNvdXJjZSI6ICJjb3N0XzQ3IiwgInRhcmdldCI6ICJ2YXJfMTYifSwgeyJzb3VyY2UiOiAiY29zdF80OCIsICJ0YXJnZXQiOiAidmFyXzE3In0sIHsic291cmNlIjogImNvc3RfNDkiLCAidGFyZ2V0IjogInZhcl8xOCJ9LCB7InNvdXJjZSI6ICJjb3N0XzUwIiwgInRhcmdldCI6ICJ2YXJfMTkifV0sICJ0cnVuY2F0ZWQiOiBmYWxzZX07CiAgICAgICAgY29uc3QgY29udGFpbmVyID0gZDMuc2VsZWN0KCIjY29udGFpbmVyIik7CiAgICAgICAgY29uc3QgY2FudmFzID0gY29udGFpbmVyLnNlbGVjdCgiY2FudmFzIikubm9kZSgpOwogICAgICAgIGNvbnN0IGN0eCA9IGNhbnZhcy5nZXRDb250ZXh0KCIyZCIpOwoKICAgIC8vIEdldCBhY3R1YWwgY29udGFpbmVyIGRpbWVuc2lvbnMuCiAgICBjb25zdCByZWN0ID0gY29udGFpbmVyLm5vZGUoKS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsKICAgIGNvbnN0IHdpZHRoID0gcmVjdC53aWR0aDsKICAgIGNvbnN0IGhlaWdodCA9IHJlY3QuaGVpZ2h0OwoKICAgIC8vIE5vZGUgc2l6aW5nLgogICAgY29uc3QgdmFyUnggPSA0NSwgdmFyUnkgPSAxNDsgIC8vIEVsbGlwc2UgcmFkaWkgZm9yIHZhcmlhYmxlcy4KICAgIGNvbnN0IGNvc3RXID0gOTAsIGNvc3RIID0gMjI7ICAgLy8gUmVjdCBzaXplIGZvciBjb3N0cy4KCiAgICAvLyBTZXQgdXAgaGlnaC1EUEkgY2FudmFzLgogICAgY29uc3QgZHByID0gd2luZG93LmRldmljZVBpeGVsUmF0aW8gfHwgMTsKICAgIGNhbnZhcy53aWR0aCA9IHdpZHRoICogZHByOwogICAgY2FudmFzLmhlaWdodCA9IGhlaWdodCAqIGRwcjsKICAgIGN0eC5zY2FsZShkcHIsIGRwcik7CgogICAgLy8gVHJhY2sgdHJhbnNmb3JtIGZvciB6b29tL3Bhbi4KICAgIGxldCB0cmFuc2Zvcm0gPSBkMy56b29tSWRlbnRpdHk7CgogICAgLy8gQ3JlYXRlIGZvcmNlIHNpbXVsYXRpb24uCiAgICBjb25zdCBzaW11bGF0aW9uID0gZDMuZm9yY2VTaW11bGF0aW9uKGRhdGEubm9kZXMpCiAgICAgICAgLmZvcmNlKCJsaW5rIiwgZDMuZm9yY2VMaW5rKGRhdGEubGlua3MpLmlkKGQgPT4gZC5pZCkuZGlzdGFuY2UoNjApKQogICAgICAgIC5mb3JjZSgiY2hhcmdlIiwgZDMuZm9yY2VNYW55Qm9keSgpLnN0cmVuZ3RoKC0xNTApLmRpc3RhbmNlTWF4KDI1MCkpCiAgICAgICAgLmZvcmNlKCJjZW50ZXIiLCBkMy5mb3JjZUNlbnRlcih3aWR0aCAvIDIsIGhlaWdodCAvIDIpKQogICAgICAgIC5mb3JjZSgiY29sbGlzaW9uIiwgZDMuZm9yY2VDb2xsaWRlKCkucmFkaXVzKDM1KSk7CgogICAgLy8gRHJhZyBzdGF0ZS4KICAgIGxldCBkcmFnTm9kZSA9IG51bGw7CgogICAgLy8gRmluZCBub2RlIGF0IHBvc2l0aW9uLgogICAgZnVuY3Rpb24gbm9kZUF0KHgsIHkpIHsKICAgICAgICBjb25zdCB0eCA9ICh4IC0gdHJhbnNmb3JtLngpIC8gdHJhbnNmb3JtLms7CiAgICAgICAgY29uc3QgdHkgPSAoeSAtIHRyYW5zZm9ybS55KSAvIHRyYW5zZm9ybS5rOwogICAgICAgIGZvciAobGV0IGkgPSBkYXRhLm5vZGVzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7CiAgICAgICAgICAgIGNvbnN0IGQgPSBkYXRhLm5vZGVzW2ldOwogICAgICAgICAgICBjb25zdCBkeCA9IHR4IC0gZC54OwogICAgICAgICAgICBjb25zdCBkeSA9IHR5IC0gZC55OwogICAgICAgICAgICBpZiAoZC50eXBlID09PSAidmFyaWFibGUiKSB7CiAgICAgICAgICAgICAgICBpZiAoKGR4KmR4KS8odmFyUngqdmFyUngpICsgKGR5KmR5KS8odmFyUnkqdmFyUnkpIDwgMSkgcmV0dXJuIGQ7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBpZiAoTWF0aC5hYnMoZHgpIDwgY29zdFcvMiAmJiBNYXRoLmFicyhkeSkgPCBjb3N0SC8yKSByZXR1cm4gZDsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZXR1cm4gbnVsbDsKICAgIH0KCiAgICBmdW5jdGlvbiBkcmF3KCkgewogICAgICAgIGN0eC5zYXZlKCk7CiAgICAgICAgY3R4LmNsZWFyUmVjdCgwLCAwLCB3aWR0aCwgaGVpZ2h0KTsKICAgICAgICBjdHgudHJhbnNsYXRlKHRyYW5zZm9ybS54LCB0cmFuc2Zvcm0ueSk7CiAgICAgICAgY3R4LnNjYWxlKHRyYW5zZm9ybS5rLCB0cmFuc2Zvcm0uayk7CgogICAgICAgIC8vIERyYXcgbGlua3MuCiAgICAgICAgY3R4LnN0cm9rZVN0eWxlID0gIiM5OTkiOwogICAgICAgIGN0eC5nbG9iYWxBbHBoYSA9IDAuNjsKICAgICAgICBjdHgubGluZVdpZHRoID0gMS41IC8gdHJhbnNmb3JtLms7CiAgICAgICAgY3R4LmJlZ2luUGF0aCgpOwogICAgICAgIGRhdGEubGlua3MuZm9yRWFjaChkID0+IHsKICAgICAgICAgICAgY3R4Lm1vdmVUbyhkLnNvdXJjZS54LCBkLnNvdXJjZS55KTsKICAgICAgICAgICAgY3R4LmxpbmVUbyhkLnRhcmdldC54LCBkLnRhcmdldC55KTsKICAgICAgICB9KTsKICAgICAgICBjdHguc3Ryb2tlKCk7CiAgICAgICAgY3R4Lmdsb2JhbEFscGhhID0gMS4wOwoKICAgICAgICAvLyBEcmF3IG5vZGVzLgogICAgICAgIGRhdGEubm9kZXMuZm9yRWFjaChkID0+IHsKICAgICAgICAgICAgY3R4LnNhdmUoKTsKICAgICAgICAgICAgY3R4LnRyYW5zbGF0ZShkLngsIGQueSk7CgogICAgICAgICAgICBpZiAoZC50eXBlID09PSAidmFyaWFibGUiKSB7CiAgICAgICAgICAgICAgICAvLyBFbGxpcHNlIGZvciB2YXJpYWJsZXMuCiAgICAgICAgICAgICAgICBjdHguYmVnaW5QYXRoKCk7CiAgICAgICAgICAgICAgICBjdHguZWxsaXBzZSgwLCAwLCB2YXJSeCwgdmFyUnksIDAsIDAsIDIgKiBNYXRoLlBJKTsKICAgICAgICAgICAgICAgIGN0eC5maWxsU3R5bGUgPSBkLmZpbGw7CiAgICAgICAgICAgICAgICBjdHguZmlsbCgpOwogICAgICAgICAgICAgICAgY3R4LnN0cm9rZVN0eWxlID0gZC5zdHJva2U7CiAgICAgICAgICAgICAgICBjdHgubGluZVdpZHRoID0gMS41IC8gdHJhbnNmb3JtLms7CiAgICAgICAgICAgICAgICBjdHguc3Ryb2tlKCk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAvLyBSb3VuZGVkIHJlY3QgZm9yIGNvc3RzLgogICAgICAgICAgICAgICAgY29uc3QgdyA9IGNvc3RXLCBoID0gY29zdEgsIHIgPSA0OwogICAgICAgICAgICAgICAgY3R4LmJlZ2luUGF0aCgpOwogICAgICAgICAgICAgICAgY3R4Lm1vdmVUbygtdy8yICsgciwgLWgvMik7CiAgICAgICAgICAgICAgICBjdHgubGluZVRvKHcvMiAtIHIsIC1oLzIpOwogICAgICAgICAgICAgICAgY3R4LnF1YWRyYXRpY0N1cnZlVG8ody8yLCAtaC8yLCB3LzIsIC1oLzIgKyByKTsKICAgICAgICAgICAgICAgIGN0eC5saW5lVG8ody8yLCBoLzIgLSByKTsKICAgICAgICAgICAgICAgIGN0eC5xdWFkcmF0aWNDdXJ2ZVRvKHcvMiwgaC8yLCB3LzIgLSByLCBoLzIpOwogICAgICAgICAgICAgICAgY3R4LmxpbmVUbygtdy8yICsgciwgaC8yKTsKICAgICAgICAgICAgICAgIGN0eC5xdWFkcmF0aWNDdXJ2ZVRvKC13LzIsIGgvMiwgLXcvMiwgaC8yIC0gcik7CiAgICAgICAgICAgICAgICBjdHgubGluZVRvKC13LzIsIC1oLzIgKyByKTsKICAgICAgICAgICAgICAgIGN0eC5xdWFkcmF0aWNDdXJ2ZVRvKC13LzIsIC1oLzIsIC13LzIgKyByLCAtaC8yKTsKICAgICAgICAgICAgICAgIGN0eC5jbG9zZVBhdGgoKTsKICAgICAgICAgICAgICAgIGN0eC5maWxsU3R5bGUgPSBkLmZpbGw7CiAgICAgICAgICAgICAgICBjdHguZmlsbCgpOwogICAgICAgICAgICAgICAgY3R4LnN0cm9rZVN0eWxlID0gZC5zdHJva2U7CiAgICAgICAgICAgICAgICBjdHgubGluZVdpZHRoID0gMS41IC8gdHJhbnNmb3JtLms7CiAgICAgICAgICAgICAgICBjdHguc3Ryb2tlKCk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vIERyYXcgbGFiZWwuCiAgICAgICAgICAgIGN0eC5maWxsU3R5bGUgPSAiIzAwMCI7CiAgICAgICAgICAgIGN0eC5mb250ID0gIjlweCBIZWx2ZXRpY2EsIEFyaWFsLCBzYW5zLXNlcmlmIjsKICAgICAgICAgICAgY3R4LnRleHRBbGlnbiA9ICJjZW50ZXIiOwogICAgICAgICAgICBjdHgudGV4dEJhc2VsaW5lID0gIm1pZGRsZSI7CiAgICAgICAgICAgIGN0eC5maWxsVGV4dChkLmxhYmVsLCAwLCAwKTsKCiAgICAgICAgICAgIGN0eC5yZXN0b3JlKCk7CiAgICAgICAgfSk7CgogICAgICAgIC8vIERyYXcgbGVnZW5kLgogICAgICAgIGN0eC5yZXN0b3JlKCk7CiAgICAgICAgZHJhd0xlZ2VuZCgpOwogICAgfQoKICAgIGZ1bmN0aW9uIGRyYXdMZWdlbmQoKSB7CiAgICAgICAgLy8gQnVpbGQgbGVnZW5kIGR5bmFtaWNhbGx5IGZyb20gYWN0dWFsIG5vZGVzLgogICAgICAgIGNvbnN0IGxlZ2VuZERhdGEgPSBbXTsKCiAgICAgICAgLy8gQ29sbGVjdCB1bmlxdWUgY29zdCBraW5kcy4KICAgICAgICBjb25zdCBjb3N0S2luZExhYmVscyA9IHsKICAgICAgICAgICAgImwyX3NxdWFyZWQiOiAiQ29zdCAoTDIpIiwKICAgICAgICAgICAgImNvbnN0cmFpbnRfZXFfemVybyI6ICJFcXVhbGl0eSIsCiAgICAgICAgICAgICJjb25zdHJhaW50X2xlcV96ZXJvIjogIkluZXF1YWxpdHkgKOKJpCkiLAogICAgICAgICAgICAiY29uc3RyYWludF9nZXFfemVybyI6ICJJbmVxdWFsaXR5ICjiiaUpIgogICAgICAgIH07CiAgICAgICAgY29uc3Qgc2VlbkNvc3RLaW5kcyA9IG5ldyBTZXQoKTsKICAgICAgICBkYXRhLm5vZGVzLmZpbHRlcihuID0+IG4udHlwZSA9PT0gImNvc3QiKS5mb3JFYWNoKG4gPT4gc2VlbkNvc3RLaW5kcy5hZGQobi5raW5kKSk7CiAgICAgICAgZm9yIChjb25zdCBraW5kIG9mIFsibDJfc3F1YXJlZCIsICJjb25zdHJhaW50X2VxX3plcm8iLCAiY29uc3RyYWludF9sZXFfemVybyIsICJjb25zdHJhaW50X2dlcV96ZXJvIl0pIHsKICAgICAgICAgICAgaWYgKHNlZW5Db3N0S2luZHMuaGFzKGtpbmQpKSB7CiAgICAgICAgICAgICAgICBjb25zdCBub2RlID0gZGF0YS5ub2Rlcy5maW5kKG4gPT4gbi50eXBlID09PSAiY29zdCIgJiYgbi5raW5kID09PSBraW5kKTsKICAgICAgICAgICAgICAgIGxlZ2VuZERhdGEucHVzaCh7CiAgICAgICAgICAgICAgICAgICAgbGFiZWw6IGNvc3RLaW5kTGFiZWxzW2tpbmRdLAogICAgICAgICAgICAgICAgICAgIGZpbGw6IG5vZGUuZmlsbCwKICAgICAgICAgICAgICAgICAgICBzdHJva2U6IG5vZGUuc3Ryb2tlLAogICAgICAgICAgICAgICAgICAgIHR5cGU6ICJjb3N0IgogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIC8vIENvbGxlY3QgdW5pcXVlIHZhcmlhYmxlIHR5cGVzLgogICAgICAgIGNvbnN0IHNlZW5WYXJUeXBlcyA9IG5ldyBNYXAoKTsgIC8vIHZhcl90eXBlIC0+IHtmaWxsLCBzdHJva2V9CiAgICAgICAgZGF0YS5ub2Rlcy5maWx0ZXIobiA9PiBuLnR5cGUgPT09ICJ2YXJpYWJsZSIpLmZvckVhY2gobiA9PiB7CiAgICAgICAgICAgIGlmICghc2VlblZhclR5cGVzLmhhcyhuLnZhcl90eXBlKSkgewogICAgICAgICAgICAgICAgc2VlblZhclR5cGVzLnNldChuLnZhcl90eXBlLCB7IGZpbGw6IG4uZmlsbCwgc3Ryb2tlOiBuLnN0cm9rZSB9KTsKICAgICAgICAgICAgfQogICAgICAgIH0pOwogICAgICAgIGZvciAoY29uc3QgW3ZhclR5cGUsIGNvbG9yc10gb2Ygc2VlblZhclR5cGVzKSB7CiAgICAgICAgICAgIGxlZ2VuZERhdGEucHVzaCh7CiAgICAgICAgICAgICAgICBsYWJlbDogdmFyVHlwZSwKICAgICAgICAgICAgICAgIGZpbGw6IGNvbG9ycy5maWxsLAogICAgICAgICAgICAgICAgc3Ryb2tlOiBjb2xvcnMuc3Ryb2tlLAogICAgICAgICAgICAgICAgdHlwZTogInZhcmlhYmxlIgogICAgICAgICAgICB9KTsKICAgICAgICB9CgogICAgICAgIGN0eC5zYXZlKCk7CiAgICAgICAgY3R4LnRyYW5zbGF0ZSgxMCwgMTApOwoKICAgICAgICBsZWdlbmREYXRhLmZvckVhY2goKGQsIGkpID0+IHsKICAgICAgICAgICAgY29uc3QgeSA9IGkgKiAxODsKICAgICAgICAgICAgaWYgKGQudHlwZSA9PT0gInZhcmlhYmxlIikgewogICAgICAgICAgICAgICAgY3R4LmJlZ2luUGF0aCgpOwogICAgICAgICAgICAgICAgY3R4LmVsbGlwc2UoMTIsIHkgKyA2LCAxMiwgNiwgMCwgMCwgMiAqIE1hdGguUEkpOwogICAgICAgICAgICAgICAgY3R4LmZpbGxTdHlsZSA9IGQuZmlsbDsKICAgICAgICAgICAgICAgIGN0eC5maWxsKCk7CiAgICAgICAgICAgICAgICBjdHguc3Ryb2tlU3R5bGUgPSBkLnN0cm9rZTsKICAgICAgICAgICAgICAgIGN0eC5saW5lV2lkdGggPSAxOwogICAgICAgICAgICAgICAgY3R4LnN0cm9rZSgpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgY3R4LmJlZ2luUGF0aCgpOwogICAgICAgICAgICAgICAgY3R4LnJvdW5kUmVjdCgwLCB5LCAyNCwgMTIsIDIpOwogICAgICAgICAgICAgICAgY3R4LmZpbGxTdHlsZSA9IGQuZmlsbDsKICAgICAgICAgICAgICAgIGN0eC5maWxsKCk7CiAgICAgICAgICAgICAgICBjdHguc3Ryb2tlU3R5bGUgPSBkLnN0cm9rZTsKICAgICAgICAgICAgICAgIGN0eC5saW5lV2lkdGggPSAxOwogICAgICAgICAgICAgICAgY3R4LnN0cm9rZSgpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGN0eC5maWxsU3R5bGUgPSAiIzAwMCI7CiAgICAgICAgICAgIGN0eC5mb250ID0gIjlweCBIZWx2ZXRpY2EsIEFyaWFsLCBzYW5zLXNlcmlmIjsKICAgICAgICAgICAgY3R4LnRleHRBbGlnbiA9ICJsZWZ0IjsKICAgICAgICAgICAgY3R4LnRleHRCYXNlbGluZSA9ICJtaWRkbGUiOwogICAgICAgICAgICBjdHguZmlsbFRleHQoZC5sYWJlbCwgMzAsIHkgKyA2KTsKICAgICAgICB9KTsKCiAgICAgICAgY3R4LnJlc3RvcmUoKTsKICAgIH0KCiAgICBzaW11bGF0aW9uLm9uKCJ0aWNrIiwgZHJhdyk7CgogICAgLy8gWm9vbSBiZWhhdmlvciB3aXRoIGZpbHRlciB0byBhbGxvdyBub2RlIGRyYWdnaW5nLgogICAgY29uc3Qgem9vbSA9IGQzLnpvb20oKQogICAgICAgIC5zY2FsZUV4dGVudChbMC4xLCA0XSkKICAgICAgICAuZmlsdGVyKChldmVudCkgPT4gewogICAgICAgICAgICAvLyBCbG9jayB6b29tIGlmIGNsaWNraW5nIG9uIGEgbm9kZSAoYWxsb3cgbm9kZSBkcmFnIGluc3RlYWQpLgogICAgICAgICAgICBpZiAoZXZlbnQudHlwZSA9PT0gIm1vdXNlZG93biIpIHsKICAgICAgICAgICAgICAgIGNvbnN0IFt4LCB5XSA9IGQzLnBvaW50ZXIoZXZlbnQpOwogICAgICAgICAgICAgICAgaWYgKG5vZGVBdCh4LCB5KSkgcmV0dXJuIGZhbHNlOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0pCiAgICAgICAgLm9uKCJ6b29tIiwgKGV2ZW50KSA9PiB7CiAgICAgICAgICAgIHRyYW5zZm9ybSA9IGV2ZW50LnRyYW5zZm9ybTsKICAgICAgICAgICAgZHJhdygpOwogICAgICAgIH0pOwoKICAgIGQzLnNlbGVjdChjYW52YXMpCiAgICAgICAgLmNhbGwoem9vbSkKICAgICAgICAub24oIm1vdXNlZG93bi5kcmFnIiwgKGV2ZW50KSA9PiB7CiAgICAgICAgICAgIGNvbnN0IFt4LCB5XSA9IGQzLnBvaW50ZXIoZXZlbnQpOwogICAgICAgICAgICBjb25zdCBub2RlID0gbm9kZUF0KHgsIHkpOwogICAgICAgICAgICBpZiAobm9kZSkgewogICAgICAgICAgICAgICAgZHJhZ05vZGUgPSBub2RlOwogICAgICAgICAgICAgICAgc2ltdWxhdGlvbi5hbHBoYVRhcmdldCgwLjMpLnJlc3RhcnQoKTsKICAgICAgICAgICAgICAgIGRyYWdOb2RlLmZ4ID0gZHJhZ05vZGUueDsKICAgICAgICAgICAgICAgIGRyYWdOb2RlLmZ5ID0gZHJhZ05vZGUueTsKICAgICAgICAgICAgfQogICAgICAgIH0pCiAgICAgICAgLm9uKCJtb3VzZW1vdmUuZHJhZyIsIChldmVudCkgPT4gewogICAgICAgICAgICBpZiAoZHJhZ05vZGUpIHsKICAgICAgICAgICAgICAgIGNvbnN0IFt4LCB5XSA9IGQzLnBvaW50ZXIoZXZlbnQpOwogICAgICAgICAgICAgICAgZHJhZ05vZGUuZnggPSB0cmFuc2Zvcm0uaW52ZXJ0WCh4KTsKICAgICAgICAgICAgICAgIGRyYWdOb2RlLmZ5ID0gdHJhbnNmb3JtLmludmVydFkoeSk7CiAgICAgICAgICAgICAgICBkcmF3KCk7CiAgICAgICAgICAgIH0KICAgICAgICB9KQogICAgICAgIC5vbigibW91c2V1cC5kcmFnIG1vdXNlbGVhdmUuZHJhZyIsICgpID0+IHsKICAgICAgICAgICAgaWYgKGRyYWdOb2RlKSB7CiAgICAgICAgICAgICAgICBzaW11bGF0aW9uLmFscGhhVGFyZ2V0KDApOwogICAgICAgICAgICAgICAgZHJhZ05vZGUuZnggPSBudWxsOwogICAgICAgICAgICAgICAgZHJhZ05vZGUuZnkgPSBudWxsOwogICAgICAgICAgICAgICAgZHJhZ05vZGUgPSBudWxsOwogICAgICAgICAgICB9CiAgICAgICAgfSk7CgogICAgICAgIC8vIEluaXRpYWwgZHJhdy4KICAgICAgICBkcmF3KCk7CiAgICB9KSgpOwogICAgPC9zY3JpcHQ+CjwvYm9keT4KPC9odG1sPg=="
            frameborder="0"
            allowfullscreen
            
        ></iframe>
        </div></div>
</div>
</section>
<section id="solving">
<h2>Solving<a class="headerlink" href="#solving" title="Link to this heading">#</a></h2>
<p>Both approaches produce identical results. We’ll use the batched version:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create initial values.</span>
<span class="n">initial_vals</span> <span class="o">=</span> <span class="n">jaxls</span><span class="o">.</span><span class="n">VarValues</span><span class="o">.</span><span class="n">make</span><span class="p">([</span><span class="n">all_point_vars</span><span class="o">.</span><span class="n">with_value</span><span class="p">(</span><span class="n">initial_positions</span><span class="p">)])</span>

<span class="c1"># Build and solve.</span>
<span class="n">problem</span> <span class="o">=</span> <span class="n">jaxls</span><span class="o">.</span><span class="n">LeastSquaresProblem</span><span class="p">(</span><span class="n">costs_batched</span><span class="p">,</span> <span class="p">[</span><span class="n">all_point_vars</span><span class="p">])</span><span class="o">.</span><span class="n">analyze</span><span class="p">()</span>
<span class="n">solution</span> <span class="o">=</span> <span class="n">problem</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">initial_vals</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Bold">INFO    </span> | Building optimization problem with 51 terms and 20 variables: 43 costs, 8 eq_zero, 0 leq_zero, 0 geq_zero
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing constraint group with 8 constraints (constraint_eq_zero), 1 variables each: augmented_anchor_constraint
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 31 costs, 2 variables each: spring_cost
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 12 costs, 1 variables each: gravity_cost
<span class=" -Color -Color-Bold">INFO    </span> | Augmented Lagrangian: initial snorm=0.0000e+00, csupn=0.0000e+00, max_rho=1.9845e+02, constraint_dim=16
<span class=" -Color -Color-Bold">INFO    </span> |  step #0: cost=19.8450 lambd=0.0005 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_anchor_constraint(8): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - spring_cost(31): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - gravity_cost(12): 19.84501 (avg 1.65375)
<span class=" -Color -Color-Bold">INFO    </span> |  step #1: cost=19.8450 lambd=0.0010 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_anchor_constraint(8): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - spring_cost(31): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - gravity_cost(12): 19.84501 (avg 1.65375)
<span class=" -Color -Color-Bold">INFO    </span> |  step #2: cost=19.8450 lambd=0.0020 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_anchor_constraint(8): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - spring_cost(31): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - gravity_cost(12): 19.84501 (avg 1.65375)
<span class=" -Color -Color-Bold">INFO    </span> |  step #3: cost=19.8450 lambd=0.0040 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_anchor_constraint(8): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - spring_cost(31): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - gravity_cost(12): 19.84501 (avg 1.65375)
<span class=" -Color -Color-Bold">INFO    </span> |  step #4: cost=19.8450 lambd=0.0080 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_anchor_constraint(8): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - spring_cost(31): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - gravity_cost(12): 19.84501 (avg 1.65375)
<span class=" -Color -Color-Bold">INFO    </span> |  step #5: cost=19.8450 lambd=0.0160 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_anchor_constraint(8): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - spring_cost(31): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - gravity_cost(12): 19.84501 (avg 1.65375)
<span class=" -Color -Color-Bold">INFO    </span> |  step #6: cost=19.8450 lambd=0.0320 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_anchor_constraint(8): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - spring_cost(31): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - gravity_cost(12): 19.84501 (avg 1.65375)
<span class=" -Color -Color-Bold">INFO    </span> |  step #7: cost=19.8450 lambd=0.0640 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_anchor_constraint(8): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - spring_cost(31): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - gravity_cost(12): 19.84501 (avg 1.65375)
<span class=" -Color -Color-Bold">INFO    </span> |  step #8: cost=19.8450 lambd=0.1280 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_anchor_constraint(8): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - spring_cost(31): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - gravity_cost(12): 19.84501 (avg 1.65375)
<span class=" -Color -Color-Bold">INFO    </span> |  step #9: cost=19.8450 lambd=0.2560 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_anchor_constraint(8): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - spring_cost(31): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - gravity_cost(12): 19.84501 (avg 1.65375)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=9.73e-01 cost_prev=19.8450 cost_new=17.7450
<span class=" -Color -Color-Bold">INFO    </span> |  step #10: cost=17.7450 lambd=0.1280 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_anchor_constraint(8): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - spring_cost(31): 3.55096 (avg 0.05727)
<span class=" -Color -Color-Bold">INFO    </span> |      - gravity_cost(12): 14.19406 (avg 1.18284)
<span class=" -Color -Color-Bold">INFO    </span> |  step #11: cost=17.7450 lambd=0.2560 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_anchor_constraint(8): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - spring_cost(31): 3.55096 (avg 0.05727)
<span class=" -Color -Color-Bold">INFO    </span> |      - gravity_cost(12): 14.19406 (avg 1.18284)
<span class=" -Color -Color-Bold">INFO    </span> |  step #12: cost=17.7450 lambd=0.5120 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_anchor_constraint(8): 0.00000 (avg 0.00000)
<span class=" -Color -Color-Bold">INFO    </span> |      - spring_cost(31): 3.55096 (avg 0.05727)
<span class=" -Color -Color-Bold">INFO    </span> |      - gravity_cost(12): 14.19406 (avg 1.18284)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=3.02e+00 cost_prev=17.7450 cost_new=16.9602
<span class=" -Color -Color-Bold">INFO    </span> |  step #13: cost=16.9561 lambd=0.2560 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_anchor_constraint(8): 0.00403 (avg 0.00025)
<span class=" -Color -Color-Bold">INFO    </span> |      - spring_cost(31): 2.67261 (avg 0.04311)
<span class=" -Color -Color-Bold">INFO    </span> |      - gravity_cost(12): 14.28351 (avg 1.19029)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=1.77e+00 cost_prev=16.9602 cost_new=16.2103
<span class=" -Color -Color-Bold">INFO    </span> |  step #14: cost=16.2057 lambd=0.1280 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_anchor_constraint(8): 0.00456 (avg 0.00029)
<span class=" -Color -Color-Bold">INFO    </span> |      - spring_cost(31): 1.61689 (avg 0.02608)
<span class=" -Color -Color-Bold">INFO    </span> |      - gravity_cost(12): 14.58886 (avg 1.21574)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=3.49e-01 cost_prev=16.2103 cost_new=16.1663
<span class=" -Color -Color-Bold">INFO    </span> |  step #15: cost=16.1621 lambd=0.0640 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_anchor_constraint(8): 0.00414 (avg 0.00026)
<span class=" -Color -Color-Bold">INFO    </span> |      - spring_cost(31): 1.27630 (avg 0.02059)
<span class=" -Color -Color-Bold">INFO    </span> |      - gravity_cost(12): 14.88583 (avg 1.24049)
<span class=" -Color -Color-Bold">INFO    </span> |  step #16: cost=16.1621 lambd=0.1280 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_anchor_constraint(8): 0.00414 (avg 0.00026)
<span class=" -Color -Color-Bold">INFO    </span> |      - spring_cost(31): 1.27630 (avg 0.02059)
<span class=" -Color -Color-Bold">INFO    </span> |      - gravity_cost(12): 14.88583 (avg 1.24049)
<span class=" -Color -Color-Bold">INFO    </span> |  step #17: cost=16.1621 lambd=0.2560 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_anchor_constraint(8): 0.00414 (avg 0.00026)
<span class=" -Color -Color-Bold">INFO    </span> |      - spring_cost(31): 1.27630 (avg 0.02059)
<span class=" -Color -Color-Bold">INFO    </span> |      - gravity_cost(12): 14.88583 (avg 1.24049)
<span class=" -Color -Color-Bold">INFO    </span> |  step #18: cost=16.1621 lambd=0.5120 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_anchor_constraint(8): 0.00414 (avg 0.00026)
<span class=" -Color -Color-Bold">INFO    </span> |      - spring_cost(31): 1.27630 (avg 0.02059)
<span class=" -Color -Color-Bold">INFO    </span> |      - gravity_cost(12): 14.88583 (avg 1.24049)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=1.89e-01 cost_prev=16.1663 cost_new=16.1507
<span class=" -Color -Color-Bold">INFO    </span> |  step #19: cost=16.1464 lambd=0.2560 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_anchor_constraint(8): 0.00431 (avg 0.00027)
<span class=" -Color -Color-Bold">INFO    </span> |      - spring_cost(31): 1.29705 (avg 0.02092)
<span class=" -Color -Color-Bold">INFO    </span> |      - gravity_cost(12): 14.84931 (avg 1.23744)
<span class=" -Color -Color-Bold">INFO    </span> |  step #20: cost=16.1464 lambd=0.5120 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_anchor_constraint(8): 0.00431 (avg 0.00027)
<span class=" -Color -Color-Bold">INFO    </span> |      - spring_cost(31): 1.29705 (avg 0.02092)
<span class=" -Color -Color-Bold">INFO    </span> |      - gravity_cost(12): 14.84931 (avg 1.23744)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=1.08e-01 cost_prev=16.1507 cost_new=16.1459
<span class=" -Color -Color-Bold">INFO    </span> |  step #21: cost=16.1416 lambd=0.2560 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_anchor_constraint(8): 0.00422 (avg 0.00026)
<span class=" -Color -Color-Bold">INFO    </span> |      - spring_cost(31): 1.26018 (avg 0.02033)
<span class=" -Color -Color-Bold">INFO    </span> |      - gravity_cost(12): 14.88145 (avg 1.24012)
<span class=" -Color -Color-Bold">INFO    </span> |  step #22: cost=16.1416 lambd=0.5120 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_anchor_constraint(8): 0.00422 (avg 0.00026)
<span class=" -Color -Color-Bold">INFO    </span> |      - spring_cost(31): 1.26018 (avg 0.02033)
<span class=" -Color -Color-Bold">INFO    </span> |      - gravity_cost(12): 14.88145 (avg 1.24012)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=6.47e-02 cost_prev=16.1459 cost_new=16.1444
<span class=" -Color -Color-Bold">INFO    </span> |  step #23: cost=16.1401 lambd=0.2560 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_anchor_constraint(8): 0.00429 (avg 0.00027)
<span class=" -Color -Color-Bold">INFO    </span> |      - spring_cost(31): 1.26015 (avg 0.02033)
<span class=" -Color -Color-Bold">INFO    </span> |      - gravity_cost(12): 14.87994 (avg 1.24000)
<span class=" -Color -Color-Bold">INFO    </span> |  step #24: cost=16.1401 lambd=0.5120 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_anchor_constraint(8): 0.00429 (avg 0.00027)
<span class=" -Color -Color-Bold">INFO    </span> |      - spring_cost(31): 1.26015 (avg 0.02033)
<span class=" -Color -Color-Bold">INFO    </span> |      - gravity_cost(12): 14.87994 (avg 1.24000)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=3.27e-02 cost_prev=16.1444 cost_new=16.1439
<span class=" -Color -Color-Bold">INFO    </span> |  step #25: cost=16.1397 lambd=0.2560 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_anchor_constraint(8): 0.00424 (avg 0.00027)
<span class=" -Color -Color-Bold">INFO    </span> |      - spring_cost(31): 1.25002 (avg 0.02016)
<span class=" -Color -Color-Bold">INFO    </span> |      - gravity_cost(12): 14.88967 (avg 1.24081)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=False ATb_norm=1.98e-02 cost_prev=16.1439 cost_new=16.1441
<span class=" -Color -Color-Bold">INFO    </span> |  AL update: snorm=1.3472e-03, csupn=1.3472e-03, max_rho=7.9380e+02
<span class=" -Color -Color-Bold">INFO    </span> |  step #26: cost=16.1397 lambd=0.2560 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_anchor_constraint(8): 0.02651 (avg 0.00166)
<span class=" -Color -Color-Bold">INFO    </span> |      - spring_cost(31): 1.25002 (avg 0.02016)
<span class=" -Color -Color-Bold">INFO    </span> |      - gravity_cost(12): 14.88967 (avg 1.24081)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=True ATb_norm=3.91e+00 cost_prev=16.1662 cost_new=16.1491
<span class=" -Color -Color-Bold">INFO    </span> |  step #27: cost=16.1481 lambd=0.1280 inexact_tol=1.0e-02
<span class=" -Color -Color-Bold">INFO    </span> |      - augmented_anchor_constraint(8): 0.00105 (avg 0.00007)
<span class=" -Color -Color-Bold">INFO    </span> |      - spring_cost(31): 1.26088 (avg 0.02034)
<span class=" -Color -Color-Bold">INFO    </span> |      - gravity_cost(12): 14.88720 (avg 1.24060)
<span class=" -Color -Color-Bold">INFO    </span> |      accepted=False ATb_norm=1.88e-02 cost_prev=16.1491 cost_new=16.1492
<span class=" -Color -Color-Bold">INFO    </span> |  AL update: snorm=4.4343e-06, csupn=4.4343e-06, max_rho=7.9380e+02
<span class=" -Color -Color-Bold">INFO    </span> | Terminated @ iteration #28: cost=16.1481 criteria=[1 0 0], term_deltas=6.3e-06,6.7e-03,6.0e-04
</pre></div>
</div>
</div>
</div>
</section>
<section id="visualization">
<h2>Visualization<a class="headerlink" href="#visualization" title="Link to this heading">#</a></h2>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">plotly.graph_objects</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">go</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">plotly.subplots</span><span class="w"> </span><span class="kn">import</span> <span class="n">make_subplots</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">IPython.display</span><span class="w"> </span><span class="kn">import</span> <span class="n">HTML</span>


<span class="k">def</span><span class="w"> </span><span class="nf">get_traces</span><span class="p">(</span><span class="n">vals</span><span class="p">:</span> <span class="n">jaxls</span><span class="o">.</span><span class="n">VarValues</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get all Plotly traces for visualization.</span>

<span class="sd">    Args:</span>
<span class="sd">        vals: Variable values containing point positions</span>

<span class="sd">    Returns:</span>
<span class="sd">        List of Plotly Scatter traces for springs and points</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">positions</span> <span class="o">=</span> <span class="n">vals</span><span class="p">[</span><span class="n">all_point_vars</span><span class="p">]</span>
    <span class="n">traces</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># Spring lines.</span>
    <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="p">[(</span><span class="n">h_spring_a</span><span class="p">,</span> <span class="n">h_spring_b</span><span class="p">),</span> <span class="p">(</span><span class="n">v_spring_a</span><span class="p">,</span> <span class="n">v_spring_b</span><span class="p">)]:</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
            <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span> <span class="o">=</span> <span class="n">positions</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">positions</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
            <span class="n">traces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
                    <span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="n">p1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">p2</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
                    <span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="n">p1</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">p2</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span>
                    <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;lines&quot;</span><span class="p">,</span>
                    <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                    <span class="n">opacity</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
                    <span class="n">hoverinfo</span><span class="o">=</span><span class="s2">&quot;skip&quot;</span><span class="p">,</span>
                    <span class="n">showlegend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="p">)</span>

    <span class="c1"># Anchor points.</span>
    <span class="n">anchor_pos</span> <span class="o">=</span> <span class="n">positions</span><span class="p">[</span><span class="n">anchor_indices</span><span class="p">]</span>
    <span class="n">traces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
        <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
            <span class="n">x</span><span class="o">=</span><span class="n">anchor_pos</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="n">y</span><span class="o">=</span><span class="n">anchor_pos</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span>
            <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;markers&quot;</span><span class="p">,</span>
            <span class="n">marker</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;crimson&quot;</span><span class="p">),</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Anchors&quot;</span><span class="p">,</span>
            <span class="n">hovertemplate</span><span class="o">=</span><span class="s2">&quot;(%</span><span class="si">{x:.2f}</span><span class="s2">, %</span><span class="si">{y:.2f}</span><span class="s2">)&quot;</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="p">)</span>

    <span class="c1"># Free points.</span>
    <span class="n">free_pos</span> <span class="o">=</span> <span class="n">positions</span><span class="p">[</span><span class="n">interior_indices</span><span class="p">]</span>
    <span class="n">traces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
        <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
            <span class="n">x</span><span class="o">=</span><span class="n">free_pos</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="n">y</span><span class="o">=</span><span class="n">free_pos</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span>
            <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;markers&quot;</span><span class="p">,</span>
            <span class="n">marker</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;steelblue&quot;</span><span class="p">),</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Free points&quot;</span><span class="p">,</span>
            <span class="n">hovertemplate</span><span class="o">=</span><span class="s2">&quot;(%</span><span class="si">{x:.2f}</span><span class="s2">, %</span><span class="si">{y:.2f}</span><span class="s2">)&quot;</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">traces</span>


<span class="n">fig</span> <span class="o">=</span> <span class="n">make_subplots</span><span class="p">(</span><span class="n">rows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">subplot_titles</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;Initial&quot;</span><span class="p">,</span> <span class="s2">&quot;Optimized&quot;</span><span class="p">))</span>
<span class="k">for</span> <span class="n">trace</span> <span class="ow">in</span> <span class="n">get_traces</span><span class="p">(</span><span class="n">initial_vals</span><span class="p">):</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">trace</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="k">for</span> <span class="n">trace</span> <span class="ow">in</span> <span class="n">get_traces</span><span class="p">(</span><span class="n">solution</span><span class="p">):</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">trace</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_xaxes</span><span class="p">(</span><span class="n">title_text</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">4.5</span><span class="p">],</span> <span class="n">scaleanchor</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">scaleratio</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="n">title_text</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">])</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">height</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span> <span class="n">showlegend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">margin</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">t</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">l</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="mi">40</span><span class="p">))</span>
<span class="n">HTML</span><span class="p">(</span><span class="n">fig</span><span class="o">.</span><span class="n">to_html</span><span class="p">(</span><span class="n">full_html</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">include_plotlyjs</span><span class="o">=</span><span class="s2">&quot;cdn&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><div>                        <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-3.3.0.min.js" integrity="sha256-bO3dS6yCpk9aK4gUpNELtCiDeSYvGYnK7jFI58NQnHI=" crossorigin="anonymous"></script>                <div id="8cadbecb-43db-43fd-8cb7-30f8885d134e" class="plotly-graph-div" style="height:400px; width:100%;"></div>            <script type="text/javascript">                window.PLOTLYENV=window.PLOTLYENV || {};                                if (document.getElementById("8cadbecb-43db-43fd-8cb7-30f8885d134e")) {                    Plotly.newPlot(                        "8cadbecb-43db-43fd-8cb7-30f8885d134e",                        [{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[0.0,1.0],"y":[0.0,0.0],"type":"scatter","xaxis":"x","yaxis":"y"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[1.0,2.0],"y":[0.0,0.0],"type":"scatter","xaxis":"x","yaxis":"y"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[2.0,3.0],"y":[0.0,0.0],"type":"scatter","xaxis":"x","yaxis":"y"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[3.0,4.0],"y":[0.0,0.0],"type":"scatter","xaxis":"x","yaxis":"y"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[0.0,1.0],"y":[-1.0,-1.0],"type":"scatter","xaxis":"x","yaxis":"y"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[1.0,2.0],"y":[-1.0,-1.0],"type":"scatter","xaxis":"x","yaxis":"y"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[2.0,3.0],"y":[-1.0,-1.0],"type":"scatter","xaxis":"x","yaxis":"y"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[3.0,4.0],"y":[-1.0,-1.0],"type":"scatter","xaxis":"x","yaxis":"y"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[0.0,1.0],"y":[-2.0,-2.0],"type":"scatter","xaxis":"x","yaxis":"y"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[1.0,2.0],"y":[-2.0,-2.0],"type":"scatter","xaxis":"x","yaxis":"y"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[2.0,3.0],"y":[-2.0,-2.0],"type":"scatter","xaxis":"x","yaxis":"y"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[3.0,4.0],"y":[-2.0,-2.0],"type":"scatter","xaxis":"x","yaxis":"y"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[0.0,1.0],"y":[-3.0,-3.0],"type":"scatter","xaxis":"x","yaxis":"y"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[1.0,2.0],"y":[-3.0,-3.0],"type":"scatter","xaxis":"x","yaxis":"y"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[2.0,3.0],"y":[-3.0,-3.0],"type":"scatter","xaxis":"x","yaxis":"y"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[3.0,4.0],"y":[-3.0,-3.0],"type":"scatter","xaxis":"x","yaxis":"y"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[0.0,0.0],"y":[0.0,-1.0],"type":"scatter","xaxis":"x","yaxis":"y"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[1.0,1.0],"y":[0.0,-1.0],"type":"scatter","xaxis":"x","yaxis":"y"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[2.0,2.0],"y":[0.0,-1.0],"type":"scatter","xaxis":"x","yaxis":"y"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[3.0,3.0],"y":[0.0,-1.0],"type":"scatter","xaxis":"x","yaxis":"y"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[4.0,4.0],"y":[0.0,-1.0],"type":"scatter","xaxis":"x","yaxis":"y"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[0.0,0.0],"y":[-1.0,-2.0],"type":"scatter","xaxis":"x","yaxis":"y"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[1.0,1.0],"y":[-1.0,-2.0],"type":"scatter","xaxis":"x","yaxis":"y"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[2.0,2.0],"y":[-1.0,-2.0],"type":"scatter","xaxis":"x","yaxis":"y"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[3.0,3.0],"y":[-1.0,-2.0],"type":"scatter","xaxis":"x","yaxis":"y"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[4.0,4.0],"y":[-1.0,-2.0],"type":"scatter","xaxis":"x","yaxis":"y"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[0.0,0.0],"y":[-2.0,-3.0],"type":"scatter","xaxis":"x","yaxis":"y"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[1.0,1.0],"y":[-2.0,-3.0],"type":"scatter","xaxis":"x","yaxis":"y"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[2.0,2.0],"y":[-2.0,-3.0],"type":"scatter","xaxis":"x","yaxis":"y"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[3.0,3.0],"y":[-2.0,-3.0],"type":"scatter","xaxis":"x","yaxis":"y"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[4.0,4.0],"y":[-2.0,-3.0],"type":"scatter","xaxis":"x","yaxis":"y"},{"hovertemplate":"(%{x:.2f}, %{y:.2f})","marker":{"color":"crimson","size":12},"mode":"markers","name":"Anchors","x":{"dtype":"f4","bdata":"AAAAAAAAgEAAAAAAAACAQAAAAAAAAIBAAAAAAAAAgEA="},"y":{"dtype":"f4","bdata":"AAAAAAAAAAAAAIC\u002fAACAvwAAAMAAAADAAABAwAAAQMA="},"type":"scatter","xaxis":"x","yaxis":"y"},{"hovertemplate":"(%{x:.2f}, %{y:.2f})","marker":{"color":"steelblue","size":10},"mode":"markers","name":"Free points","x":{"dtype":"f4","bdata":"AACAPwAAAEAAAEBAAACAPwAAAEAAAEBAAACAPwAAAEAAAEBAAACAPwAAAEAAAEBA"},"y":{"dtype":"f4","bdata":"AAAAAAAAAAAAAAAAAACAvwAAgL8AAIC\u002fAAAAwAAAAMAAAADAAABAwAAAQMAAAEDA"},"type":"scatter","xaxis":"x","yaxis":"y"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[-2.464591943862615e-07,0.8506224751472473],"y":[4.434182301338296e-06,-1.0431700944900513],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[0.8506224751472473,2.0],"y":[-1.0431700944900513,-1.4903693199157715],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[2.0,3.1493775844573975],"y":[-1.4903693199157715,-1.0431700944900513],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[3.1493775844573975,4.0],"y":[-1.0431700944900513,4.4343137233227026e-06],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[-4.241647388880665e-07,0.8550522923469543],"y":[-0.9999973773956299,-2.0232315063476562],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[0.8550522923469543,1.9999998807907104],"y":[-2.0232315063476562,-2.4677467346191406],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[1.9999998807907104,3.1449477672576904],"y":[-2.4677467346191406,-2.0232315063476562],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[3.1449477672576904,4.000000476837158],"y":[-2.0232315063476562,-0.9999973773956299],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[-4.6640388973173685e-07,0.8598397970199585],"y":[-1.9999974966049194,-2.999134063720703],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[0.8598397970199585,2.0],"y":[-2.999134063720703,-3.4360833168029785],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[2.0,3.140160083770752],"y":[-3.4360833168029785,-2.999134063720703],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[3.140160083770752,4.000000476837158],"y":[-2.999134063720703,-1.9999974966049194],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[-3.6986870100008673e-07,0.8630207180976868],"y":[-2.9999959468841553,-3.981503963470459],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[0.8630207180976868,2.0],"y":[-3.981503963470459,-4.410401821136475],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[2.0,3.136979341506958],"y":[-4.410401821136475,-3.981503963470459],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[3.136979341506958,4.000000476837158],"y":[-3.981503963470459,-2.9999959468841553],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[-2.464591943862615e-07,-4.241647388880665e-07],"y":[4.434182301338296e-06,-0.9999973773956299],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[0.8506224751472473,0.8550522923469543],"y":[-1.0431700944900513,-2.0232315063476562],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[2.0,1.9999998807907104],"y":[-1.4903693199157715,-2.4677467346191406],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[3.1493775844573975,3.1449477672576904],"y":[-1.0431700944900513,-2.0232315063476562],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[4.0,4.000000476837158],"y":[4.4343137233227026e-06,-0.9999973773956299],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[-4.241647388880665e-07,-4.6640388973173685e-07],"y":[-0.9999973773956299,-1.9999974966049194],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[0.8550522923469543,0.8598397970199585],"y":[-2.0232315063476562,-2.999134063720703],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[1.9999998807907104,2.0],"y":[-2.4677467346191406,-3.4360833168029785],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[3.1449477672576904,3.140160083770752],"y":[-2.0232315063476562,-2.999134063720703],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[4.000000476837158,4.000000476837158],"y":[-0.9999973773956299,-1.9999974966049194],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[-4.6640388973173685e-07,-3.6986870100008673e-07],"y":[-1.9999974966049194,-2.9999959468841553],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[0.8598397970199585,0.8630207180976868],"y":[-2.999134063720703,-3.981503963470459],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[2.0,2.0],"y":[-3.4360833168029785,-4.410401821136475],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[3.140160083770752,3.136979341506958],"y":[-2.999134063720703,-3.981503963470459],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"hoverinfo":"skip","line":{"color":"gray","width":1},"mode":"lines","opacity":0.5,"showlegend":false,"x":[4.000000476837158,4.000000476837158],"y":[-1.9999974966049194,-2.9999959468841553],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"hovertemplate":"(%{x:.2f}, %{y:.2f})","marker":{"color":"crimson","size":12},"mode":"markers","name":"Anchors","x":{"dtype":"f4","bdata":"GFGEtAAAgEDCuOO0AQCAQBBm+rQBAIBAXpLGtAEAgEA="},"y":{"dtype":"f4","bdata":"VsmUNnfKlDbU\u002f3+\u002f1P9\u002fv+v\u002f\u002f7\u002fr\u002f\u002f+\u002f7\u002f8\u002fwO\u002f\u002fP8A="},"type":"scatter","xaxis":"x2","yaxis":"y2"},{"hovertemplate":"(%{x:.2f}, %{y:.2f})","marker":{"color":"steelblue","size":10},"mode":"markers","name":"Free points","x":{"dtype":"f4","bdata":"ZcJZPwAAAEBnj0lAteRaP\u002f\u002f\u002f\u002fz\u002fTRklAdh5cPwAAAEBi+EhA7e5cPwAAAEBFxEhA"},"y":{"dtype":"f4","bdata":"mYaFv2zEvr+ZhoW\u002foHwBwJDvHcCgfAHA0PE\u002fwMroW8DQ8T\u002fA9tB+wAMijcD20H7A"},"type":"scatter","xaxis":"x2","yaxis":"y2"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermap":[{"type":"scattermap","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"anchor":"y","domain":[0.0,0.45],"title":{"text":"x"},"range":[-0.5,4.5],"scaleanchor":"y","scaleratio":1},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"y"},"range":[-5,0.5]},"xaxis2":{"anchor":"y2","domain":[0.55,1.0],"title":{"text":"x"},"range":[-0.5,4.5],"scaleanchor":"y","scaleratio":1},"yaxis2":{"anchor":"x2","domain":[0.0,1.0],"title":{"text":"y"},"range":[-5,0.5]},"annotations":[{"font":{"size":16},"showarrow":false,"text":"Initial","x":0.225,"xanchor":"center","xref":"paper","y":1.0,"yanchor":"bottom","yref":"paper"},{"font":{"size":16},"showarrow":false,"text":"Optimized","x":0.775,"xanchor":"center","xref":"paper","y":1.0,"yanchor":"bottom","yref":"paper"}],"margin":{"t":40,"b":40,"l":40,"r":40},"height":400,"showlegend":false},                        {"responsive": true}                    )                };            </script>        </div></div></div>
</div>
</section>
<section id="relaxation-animation">
<h2>Relaxation animation<a class="headerlink" href="#relaxation-animation" title="Link to this heading">#</a></h2>
<p>We can visualize the relaxation process by solving a sequence of problems with progressively increasing gravity. This simulates how the network would settle from its initial configuration to the final equilibrium:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@jaxls</span><span class="o">.</span><span class="n">Cost</span><span class="o">.</span><span class="n">factory</span>
<span class="k">def</span><span class="w"> </span><span class="nf">gravity_cost_scaled</span><span class="p">(</span>
    <span class="n">vals</span><span class="p">:</span> <span class="n">jaxls</span><span class="o">.</span><span class="n">VarValues</span><span class="p">,</span>
    <span class="n">var</span><span class="p">:</span> <span class="n">Point2Var</span><span class="p">,</span>
    <span class="n">scale</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Pull points downward with adjustable strength.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">vals</span><span class="p">[</span><span class="n">var</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mf">10.0</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.15</span> <span class="o">*</span> <span class="n">scale</span>


<span class="c1"># Solve for a sequence of gravity strengths.</span>
<span class="n">n_frames</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">gravity_scales</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">n_frames</span><span class="p">)</span>
<span class="n">frame_solutions</span> <span class="o">=</span> <span class="p">[</span><span class="n">initial_vals</span><span class="p">]</span>

<span class="n">current_vals</span> <span class="o">=</span> <span class="n">initial_vals</span>
<span class="k">for</span> <span class="n">scale</span> <span class="ow">in</span> <span class="n">gravity_scales</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
    <span class="n">costs_scaled</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">jaxls</span><span class="o">.</span><span class="n">Cost</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">anchor_constraint</span><span class="p">(</span><span class="n">Point2Var</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">anchor_indices</span><span class="p">),</span> <span class="n">anchor_positions</span><span class="p">),</span>
        <span class="n">spring_cost</span><span class="p">(</span><span class="n">Point2Var</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">h_spring_a</span><span class="p">),</span> <span class="n">Point2Var</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">h_spring_b</span><span class="p">),</span> <span class="n">spacing</span><span class="p">),</span>
        <span class="n">spring_cost</span><span class="p">(</span><span class="n">Point2Var</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">v_spring_a</span><span class="p">),</span> <span class="n">Point2Var</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">v_spring_b</span><span class="p">),</span> <span class="n">spacing</span><span class="p">),</span>
        <span class="n">gravity_cost_scaled</span><span class="p">(</span><span class="n">Point2Var</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">interior_indices</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="n">scale</span><span class="p">)),</span>
    <span class="p">]</span>
    <span class="n">problem_scaled</span> <span class="o">=</span> <span class="n">jaxls</span><span class="o">.</span><span class="n">LeastSquaresProblem</span><span class="p">(</span><span class="n">costs_scaled</span><span class="p">,</span> <span class="p">[</span><span class="n">all_point_vars</span><span class="p">])</span><span class="o">.</span><span class="n">analyze</span><span class="p">()</span>
    <span class="n">current_vals</span> <span class="o">=</span> <span class="n">problem_scaled</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">current_vals</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">frame_solutions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">current_vals</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Generated </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">frame_solutions</span><span class="p">)</span><span class="si">}</span><span class="s2"> frames&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Bold">INFO    </span> | Building optimization problem with 51 terms and 20 variables: 43 costs, 8 eq_zero, 0 leq_zero, 0 geq_zero
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing constraint group with 8 constraints (constraint_eq_zero), 1 variables each: augmented_anchor_constraint
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 31 costs, 2 variables each: spring_cost
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 12 costs, 1 variables each: gravity_cost_scaled
<span class=" -Color -Color-Bold">INFO    </span> | Building optimization problem with 51 terms and 20 variables: 43 costs, 8 eq_zero, 0 leq_zero, 0 geq_zero
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 31 costs, 2 variables each: spring_cost
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 12 costs, 1 variables each: gravity_cost_scaled
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing constraint group with 8 constraints (constraint_eq_zero), 1 variables each: augmented_anchor_constraint
<span class=" -Color -Color-Bold">INFO    </span> | Building optimization problem with 51 terms and 20 variables: 43 costs, 8 eq_zero, 0 leq_zero, 0 geq_zero
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 31 costs, 2 variables each: spring_cost
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing constraint group with 8 constraints (constraint_eq_zero), 1 variables each: augmented_anchor_constraint
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 12 costs, 1 variables each: gravity_cost_scaled
<span class=" -Color -Color-Bold">INFO    </span> | Building optimization problem with 51 terms and 20 variables: 43 costs, 8 eq_zero, 0 leq_zero, 0 geq_zero
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing constraint group with 8 constraints (constraint_eq_zero), 1 variables each: augmented_anchor_constraint
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 31 costs, 2 variables each: spring_cost
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 12 costs, 1 variables each: gravity_cost_scaled
<span class=" -Color -Color-Bold">INFO    </span> | Building optimization problem with 51 terms and 20 variables: 43 costs, 8 eq_zero, 0 leq_zero, 0 geq_zero
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing constraint group with 8 constraints (constraint_eq_zero), 1 variables each: augmented_anchor_constraint
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 31 costs, 2 variables each: spring_cost
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 12 costs, 1 variables each: gravity_cost_scaled
<span class=" -Color -Color-Bold">INFO    </span> | Building optimization problem with 51 terms and 20 variables: 43 costs, 8 eq_zero, 0 leq_zero, 0 geq_zero
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 31 costs, 2 variables each: spring_cost
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing constraint group with 8 constraints (constraint_eq_zero), 1 variables each: augmented_anchor_constraint
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 12 costs, 1 variables each: gravity_cost_scaled
<span class=" -Color -Color-Bold">INFO    </span> | Building optimization problem with 51 terms and 20 variables: 43 costs, 8 eq_zero, 0 leq_zero, 0 geq_zero
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 12 costs, 1 variables each: gravity_cost_scaled
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 31 costs, 2 variables each: spring_cost
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing constraint group with 8 constraints (constraint_eq_zero), 1 variables each: augmented_anchor_constraint
<span class=" -Color -Color-Bold">INFO    </span> | Building optimization problem with 51 terms and 20 variables: 43 costs, 8 eq_zero, 0 leq_zero, 0 geq_zero
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing constraint group with 8 constraints (constraint_eq_zero), 1 variables each: augmented_anchor_constraint
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 31 costs, 2 variables each: spring_cost
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 12 costs, 1 variables each: gravity_cost_scaled
<span class=" -Color -Color-Bold">INFO    </span> | Building optimization problem with 51 terms and 20 variables: 43 costs, 8 eq_zero, 0 leq_zero, 0 geq_zero
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 12 costs, 1 variables each: gravity_cost_scaled
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 31 costs, 2 variables each: spring_cost
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing constraint group with 8 constraints (constraint_eq_zero), 1 variables each: augmented_anchor_constraint
<span class=" -Color -Color-Bold">INFO    </span> | Building optimization problem with 51 terms and 20 variables: 43 costs, 8 eq_zero, 0 leq_zero, 0 geq_zero
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing constraint group with 8 constraints (constraint_eq_zero), 1 variables each: augmented_anchor_constraint
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 31 costs, 2 variables each: spring_cost
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 12 costs, 1 variables each: gravity_cost_scaled
<span class=" -Color -Color-Bold">INFO    </span> | Building optimization problem with 51 terms and 20 variables: 43 costs, 8 eq_zero, 0 leq_zero, 0 geq_zero
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing constraint group with 8 constraints (constraint_eq_zero), 1 variables each: augmented_anchor_constraint
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 31 costs, 2 variables each: spring_cost
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 12 costs, 1 variables each: gravity_cost_scaled
<span class=" -Color -Color-Bold">INFO    </span> | Building optimization problem with 51 terms and 20 variables: 43 costs, 8 eq_zero, 0 leq_zero, 0 geq_zero
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 12 costs, 1 variables each: gravity_cost_scaled
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing constraint group with 8 constraints (constraint_eq_zero), 1 variables each: augmented_anchor_constraint
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 31 costs, 2 variables each: spring_cost
<span class=" -Color -Color-Bold">INFO    </span> | Building optimization problem with 51 terms and 20 variables: 43 costs, 8 eq_zero, 0 leq_zero, 0 geq_zero
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 12 costs, 1 variables each: gravity_cost_scaled
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing constraint group with 8 constraints (constraint_eq_zero), 1 variables each: augmented_anchor_constraint
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 31 costs, 2 variables each: spring_cost
<span class=" -Color -Color-Bold">INFO    </span> | Building optimization problem with 51 terms and 20 variables: 43 costs, 8 eq_zero, 0 leq_zero, 0 geq_zero
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 12 costs, 1 variables each: gravity_cost_scaled
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 31 costs, 2 variables each: spring_cost
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing constraint group with 8 constraints (constraint_eq_zero), 1 variables each: augmented_anchor_constraint
<span class=" -Color -Color-Bold">INFO    </span> | Building optimization problem with 51 terms and 20 variables: 43 costs, 8 eq_zero, 0 leq_zero, 0 geq_zero
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 12 costs, 1 variables each: gravity_cost_scaled
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing constraint group with 8 constraints (constraint_eq_zero), 1 variables each: augmented_anchor_constraint
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 31 costs, 2 variables each: spring_cost
<span class=" -Color -Color-Bold">INFO    </span> | Building optimization problem with 51 terms and 20 variables: 43 costs, 8 eq_zero, 0 leq_zero, 0 geq_zero
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 31 costs, 2 variables each: spring_cost
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 12 costs, 1 variables each: gravity_cost_scaled
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing constraint group with 8 constraints (constraint_eq_zero), 1 variables each: augmented_anchor_constraint
<span class=" -Color -Color-Bold">INFO    </span> | Building optimization problem with 51 terms and 20 variables: 43 costs, 8 eq_zero, 0 leq_zero, 0 geq_zero
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 31 costs, 2 variables each: spring_cost
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing constraint group with 8 constraints (constraint_eq_zero), 1 variables each: augmented_anchor_constraint
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 12 costs, 1 variables each: gravity_cost_scaled
<span class=" -Color -Color-Bold">INFO    </span> | Building optimization problem with 51 terms and 20 variables: 43 costs, 8 eq_zero, 0 leq_zero, 0 geq_zero
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing constraint group with 8 constraints (constraint_eq_zero), 1 variables each: augmented_anchor_constraint
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 12 costs, 1 variables each: gravity_cost_scaled
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 31 costs, 2 variables each: spring_cost
<span class=" -Color -Color-Bold">INFO    </span> | Building optimization problem with 51 terms and 20 variables: 43 costs, 8 eq_zero, 0 leq_zero, 0 geq_zero
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing constraint group with 8 constraints (constraint_eq_zero), 1 variables each: augmented_anchor_constraint
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 31 costs, 2 variables each: spring_cost
<span class=" -Color -Color-Bold">INFO    </span> | Vectorizing group with 12 costs, 1 variables each: gravity_cost_scaled
Generated 20 frames
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">get_frame_data</span><span class="p">(</span><span class="n">vals</span><span class="p">:</span> <span class="n">jaxls</span><span class="o">.</span><span class="n">VarValues</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Extract position data for animation frame.&quot;&quot;&quot;</span>
    <span class="n">positions</span> <span class="o">=</span> <span class="n">vals</span><span class="p">[</span><span class="n">all_point_vars</span><span class="p">]</span>

    <span class="c1"># Build spring line coordinates.</span>
    <span class="n">spring_x</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">spring_y</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="p">[(</span><span class="n">h_spring_a</span><span class="p">,</span> <span class="n">h_spring_b</span><span class="p">),</span> <span class="p">(</span><span class="n">v_spring_a</span><span class="p">,</span> <span class="n">v_spring_b</span><span class="p">)]:</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
            <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span> <span class="o">=</span> <span class="n">positions</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">positions</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
            <span class="n">spring_x</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">p1</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">p2</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="kc">None</span><span class="p">])</span>
            <span class="n">spring_y</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">p1</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">p2</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="kc">None</span><span class="p">])</span>

    <span class="n">anchor_pos</span> <span class="o">=</span> <span class="n">positions</span><span class="p">[</span><span class="n">anchor_indices</span><span class="p">]</span>
    <span class="n">free_pos</span> <span class="o">=</span> <span class="n">positions</span><span class="p">[</span><span class="n">interior_indices</span><span class="p">]</span>

    <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span>
        <span class="n">spring_x</span><span class="o">=</span><span class="n">spring_x</span><span class="p">,</span>
        <span class="n">spring_y</span><span class="o">=</span><span class="n">spring_y</span><span class="p">,</span>
        <span class="n">anchor_x</span><span class="o">=</span><span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">anchor_pos</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]],</span>
        <span class="n">anchor_y</span><span class="o">=</span><span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">anchor_pos</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]],</span>
        <span class="n">free_x</span><span class="o">=</span><span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">free_pos</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]],</span>
        <span class="n">free_y</span><span class="o">=</span><span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">free_pos</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]],</span>
    <span class="p">)</span>


<span class="c1"># Build animation frames.</span>
<span class="n">frames</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">vals</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">frame_solutions</span><span class="p">):</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">get_frame_data</span><span class="p">(</span><span class="n">vals</span><span class="p">)</span>
    <span class="n">frames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
        <span class="n">go</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span>
            <span class="n">data</span><span class="o">=</span><span class="p">[</span>
                <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
                    <span class="n">x</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;spring_x&quot;</span><span class="p">],</span>
                    <span class="n">y</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;spring_y&quot;</span><span class="p">],</span>
                    <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;lines&quot;</span><span class="p">,</span>
                    <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span>
                    <span class="n">hoverinfo</span><span class="o">=</span><span class="s2">&quot;skip&quot;</span><span class="p">,</span>
                <span class="p">),</span>
                <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
                    <span class="n">x</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;anchor_x&quot;</span><span class="p">],</span>
                    <span class="n">y</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;anchor_y&quot;</span><span class="p">],</span>
                    <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;markers&quot;</span><span class="p">,</span>
                    <span class="n">marker</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;crimson&quot;</span><span class="p">),</span>
                <span class="p">),</span>
                <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
                    <span class="n">x</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;free_x&quot;</span><span class="p">],</span>
                    <span class="n">y</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;free_y&quot;</span><span class="p">],</span>
                    <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;markers&quot;</span><span class="p">,</span>
                    <span class="n">marker</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;steelblue&quot;</span><span class="p">),</span>
                <span class="p">),</span>
            <span class="p">],</span>
            <span class="n">name</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">),</span>
        <span class="p">)</span>
    <span class="p">)</span>

<span class="c1"># Initial frame data.</span>
<span class="n">init_data</span> <span class="o">=</span> <span class="n">get_frame_data</span><span class="p">(</span><span class="n">initial_vals</span><span class="p">)</span>

<span class="n">fig_anim</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="p">[</span>
        <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
            <span class="n">x</span><span class="o">=</span><span class="n">init_data</span><span class="p">[</span><span class="s2">&quot;spring_x&quot;</span><span class="p">],</span>
            <span class="n">y</span><span class="o">=</span><span class="n">init_data</span><span class="p">[</span><span class="s2">&quot;spring_y&quot;</span><span class="p">],</span>
            <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;lines&quot;</span><span class="p">,</span>
            <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span>
            <span class="n">hoverinfo</span><span class="o">=</span><span class="s2">&quot;skip&quot;</span><span class="p">,</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Springs&quot;</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
            <span class="n">x</span><span class="o">=</span><span class="n">init_data</span><span class="p">[</span><span class="s2">&quot;anchor_x&quot;</span><span class="p">],</span>
            <span class="n">y</span><span class="o">=</span><span class="n">init_data</span><span class="p">[</span><span class="s2">&quot;anchor_y&quot;</span><span class="p">],</span>
            <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;markers&quot;</span><span class="p">,</span>
            <span class="n">marker</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;crimson&quot;</span><span class="p">),</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Anchors&quot;</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span>
            <span class="n">x</span><span class="o">=</span><span class="n">init_data</span><span class="p">[</span><span class="s2">&quot;free_x&quot;</span><span class="p">],</span>
            <span class="n">y</span><span class="o">=</span><span class="n">init_data</span><span class="p">[</span><span class="s2">&quot;free_y&quot;</span><span class="p">],</span>
            <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;markers&quot;</span><span class="p">,</span>
            <span class="n">marker</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;steelblue&quot;</span><span class="p">),</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Free points&quot;</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">],</span>
    <span class="n">frames</span><span class="o">=</span><span class="n">frames</span><span class="p">,</span>
    <span class="n">layout</span><span class="o">=</span><span class="n">go</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span>
        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Spring network relaxation&quot;</span><span class="p">,</span>
        <span class="n">xaxis</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="nb">range</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">4.5</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">scaleanchor</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">scaleratio</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
        <span class="n">yaxis</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="nb">range</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">),</span>
        <span class="n">updatemenus</span><span class="o">=</span><span class="p">[</span>
            <span class="nb">dict</span><span class="p">(</span>
                <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;buttons&quot;</span><span class="p">,</span>
                <span class="n">showactive</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">y</span><span class="o">=</span><span class="mf">1.15</span><span class="p">,</span>
                <span class="n">x</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
                <span class="n">xanchor</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
                <span class="n">buttons</span><span class="o">=</span><span class="p">[</span>
                    <span class="nb">dict</span><span class="p">(</span>
                        <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Play&quot;</span><span class="p">,</span>
                        <span class="n">method</span><span class="o">=</span><span class="s2">&quot;animate&quot;</span><span class="p">,</span>
                        <span class="n">args</span><span class="o">=</span><span class="p">[</span>
                            <span class="kc">None</span><span class="p">,</span>
                            <span class="nb">dict</span><span class="p">(</span>
                                <span class="n">frame</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">redraw</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
                                <span class="n">fromcurrent</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                <span class="n">transition</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="mi">50</span><span class="p">),</span>
                            <span class="p">),</span>
                        <span class="p">],</span>
                    <span class="p">),</span>
                    <span class="nb">dict</span><span class="p">(</span>
                        <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Pause&quot;</span><span class="p">,</span>
                        <span class="n">method</span><span class="o">=</span><span class="s2">&quot;animate&quot;</span><span class="p">,</span>
                        <span class="n">args</span><span class="o">=</span><span class="p">[</span>
                            <span class="p">[</span><span class="kc">None</span><span class="p">],</span>
                            <span class="nb">dict</span><span class="p">(</span>
                                <span class="n">frame</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">redraw</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;immediate&quot;</span>
                            <span class="p">),</span>
                        <span class="p">],</span>
                    <span class="p">),</span>
                <span class="p">],</span>
            <span class="p">)</span>
        <span class="p">],</span>
        <span class="n">sliders</span><span class="o">=</span><span class="p">[</span>
            <span class="nb">dict</span><span class="p">(</span>
                <span class="n">active</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                <span class="n">yanchor</span><span class="o">=</span><span class="s2">&quot;top&quot;</span><span class="p">,</span>
                <span class="n">xanchor</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">,</span>
                <span class="n">currentvalue</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
                    <span class="n">prefix</span><span class="o">=</span><span class="s2">&quot;Gravity: &quot;</span><span class="p">,</span> <span class="n">suffix</span><span class="o">=</span><span class="s2">&quot;%&quot;</span><span class="p">,</span> <span class="n">visible</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">xanchor</span><span class="o">=</span><span class="s2">&quot;center&quot;</span>
                <span class="p">),</span>
                <span class="n">pad</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">b</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="mi">50</span><span class="p">),</span>
                <span class="n">steps</span><span class="o">=</span><span class="p">[</span>
                    <span class="nb">dict</span><span class="p">(</span>
                        <span class="n">args</span><span class="o">=</span><span class="p">[</span>
                            <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)],</span>
                            <span class="nb">dict</span><span class="p">(</span>
                                <span class="n">frame</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">redraw</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
                                <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;immediate&quot;</span><span class="p">,</span>
                                <span class="n">transition</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
                            <span class="p">),</span>
                        <span class="p">],</span>
                        <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">gravity_scales</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">100</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                        <span class="n">method</span><span class="o">=</span><span class="s2">&quot;animate&quot;</span><span class="p">,</span>
                    <span class="p">)</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_frames</span><span class="p">)</span>
                <span class="p">],</span>
                <span class="n">x</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
                <span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                <span class="nb">len</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">],</span>
        <span class="n">height</span><span class="o">=</span><span class="mi">450</span><span class="p">,</span>
        <span class="n">showlegend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">margin</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">t</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">80</span><span class="p">),</span>
    <span class="p">),</span>
<span class="p">)</span>
<span class="n">HTML</span><span class="p">(</span><span class="n">fig_anim</span><span class="o">.</span><span class="n">to_html</span><span class="p">(</span><span class="n">full_html</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">include_plotlyjs</span><span class="o">=</span><span class="s2">&quot;cdn&quot;</span><span class="p">,</span> <span class="n">auto_play</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><div>                        <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-3.3.0.min.js" integrity="sha256-bO3dS6yCpk9aK4gUpNELtCiDeSYvGYnK7jFI58NQnHI=" crossorigin="anonymous"></script>                <div id="a5f8c857-662d-4224-a148-96ecfb7b4846" class="plotly-graph-div" style="height:450px; width:100%;"></div>            <script type="text/javascript">                window.PLOTLYENV=window.PLOTLYENV || {};                                if (document.getElementById("a5f8c857-662d-4224-a148-96ecfb7b4846")) {                    Plotly.newPlot(                        "a5f8c857-662d-4224-a148-96ecfb7b4846",                        [{"hoverinfo":"skip","line":{"color":"gray","width":2},"mode":"lines","name":"Springs","x":[0.0,1.0,null,1.0,2.0,null,2.0,3.0,null,3.0,4.0,null,0.0,1.0,null,1.0,2.0,null,2.0,3.0,null,3.0,4.0,null,0.0,1.0,null,1.0,2.0,null,2.0,3.0,null,3.0,4.0,null,0.0,1.0,null,1.0,2.0,null,2.0,3.0,null,3.0,4.0,null,0.0,0.0,null,1.0,1.0,null,2.0,2.0,null,3.0,3.0,null,4.0,4.0,null,0.0,0.0,null,1.0,1.0,null,2.0,2.0,null,3.0,3.0,null,4.0,4.0,null,0.0,0.0,null,1.0,1.0,null,2.0,2.0,null,3.0,3.0,null,4.0,4.0,null],"y":[0.0,0.0,null,0.0,0.0,null,0.0,0.0,null,0.0,0.0,null,-1.0,-1.0,null,-1.0,-1.0,null,-1.0,-1.0,null,-1.0,-1.0,null,-2.0,-2.0,null,-2.0,-2.0,null,-2.0,-2.0,null,-2.0,-2.0,null,-3.0,-3.0,null,-3.0,-3.0,null,-3.0,-3.0,null,-3.0,-3.0,null,0.0,-1.0,null,0.0,-1.0,null,0.0,-1.0,null,0.0,-1.0,null,0.0,-1.0,null,-1.0,-2.0,null,-1.0,-2.0,null,-1.0,-2.0,null,-1.0,-2.0,null,-1.0,-2.0,null,-2.0,-3.0,null,-2.0,-3.0,null,-2.0,-3.0,null,-2.0,-3.0,null,-2.0,-3.0,null],"type":"scatter"},{"marker":{"color":"crimson","size":12},"mode":"markers","name":"Anchors","x":[0.0,4.0,0.0,4.0,0.0,4.0,0.0,4.0],"y":[0.0,0.0,-1.0,-1.0,-2.0,-2.0,-3.0,-3.0],"type":"scatter"},{"marker":{"color":"steelblue","size":10},"mode":"markers","name":"Free points","x":[1.0,2.0,3.0,1.0,2.0,3.0,1.0,2.0,3.0,1.0,2.0,3.0],"y":[0.0,0.0,0.0,-1.0,-1.0,-1.0,-2.0,-2.0,-2.0,-3.0,-3.0,-3.0],"type":"scatter"}],                        {"height":450,"margin":{"b":80,"t":80},"showlegend":false,"sliders":[{"active":0,"currentvalue":{"prefix":"Gravity: ","suffix":"%","visible":true,"xanchor":"center"},"len":0.8,"pad":{"b":10,"t":50},"steps":[{"args":[["0"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"0","method":"animate"},{"args":[["1"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"5","method":"animate"},{"args":[["2"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"10","method":"animate"},{"args":[["3"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"15","method":"animate"},{"args":[["4"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"21","method":"animate"},{"args":[["5"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"26","method":"animate"},{"args":[["6"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"31","method":"animate"},{"args":[["7"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"36","method":"animate"},{"args":[["8"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"42","method":"animate"},{"args":[["9"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"47","method":"animate"},{"args":[["10"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"52","method":"animate"},{"args":[["11"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"57","method":"animate"},{"args":[["12"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"63","method":"animate"},{"args":[["13"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"68","method":"animate"},{"args":[["14"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"73","method":"animate"},{"args":[["15"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"78","method":"animate"},{"args":[["16"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"84","method":"animate"},{"args":[["17"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"89","method":"animate"},{"args":[["18"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"94","method":"animate"},{"args":[["19"],{"frame":{"duration":0,"redraw":true},"mode":"immediate","transition":{"duration":0}}],"label":"100","method":"animate"}],"x":0.1,"xanchor":"left","y":0,"yanchor":"top"}],"title":{"text":"Spring network relaxation"},"updatemenus":[{"buttons":[{"args":[null,{"frame":{"duration":100,"redraw":true},"fromcurrent":true,"transition":{"duration":50}}],"label":"Play","method":"animate"},{"args":[[null],{"frame":{"duration":0,"redraw":false},"mode":"immediate"}],"label":"Pause","method":"animate"}],"showactive":false,"type":"buttons","x":0.5,"xanchor":"center","y":1.15}],"xaxis":{"range":[-0.5,4.5],"scaleanchor":"y","scaleratio":1,"title":{"text":"x"}},"yaxis":{"range":[-5,0.5],"title":{"text":"y"}},"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermap":[{"type":"scattermap","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}}},                        {"responsive": true}                    ).then(function(){
                            Plotly.addFrames('a5f8c857-662d-4224-a148-96ecfb7b4846', [{"data":[{"hoverinfo":"skip","line":{"color":"gray","width":2},"mode":"lines","x":[0.0,1.0,null,1.0,2.0,null,2.0,3.0,null,3.0,4.0,null,0.0,1.0,null,1.0,2.0,null,2.0,3.0,null,3.0,4.0,null,0.0,1.0,null,1.0,2.0,null,2.0,3.0,null,3.0,4.0,null,0.0,1.0,null,1.0,2.0,null,2.0,3.0,null,3.0,4.0,null,0.0,0.0,null,1.0,1.0,null,2.0,2.0,null,3.0,3.0,null,4.0,4.0,null,0.0,0.0,null,1.0,1.0,null,2.0,2.0,null,3.0,3.0,null,4.0,4.0,null,0.0,0.0,null,1.0,1.0,null,2.0,2.0,null,3.0,3.0,null,4.0,4.0,null],"y":[0.0,0.0,null,0.0,0.0,null,0.0,0.0,null,0.0,0.0,null,-1.0,-1.0,null,-1.0,-1.0,null,-1.0,-1.0,null,-1.0,-1.0,null,-2.0,-2.0,null,-2.0,-2.0,null,-2.0,-2.0,null,-2.0,-2.0,null,-3.0,-3.0,null,-3.0,-3.0,null,-3.0,-3.0,null,-3.0,-3.0,null,0.0,-1.0,null,0.0,-1.0,null,0.0,-1.0,null,0.0,-1.0,null,0.0,-1.0,null,-1.0,-2.0,null,-1.0,-2.0,null,-1.0,-2.0,null,-1.0,-2.0,null,-1.0,-2.0,null,-2.0,-3.0,null,-2.0,-3.0,null,-2.0,-3.0,null,-2.0,-3.0,null,-2.0,-3.0,null],"type":"scatter"},{"marker":{"color":"crimson","size":12},"mode":"markers","x":[0.0,4.0,0.0,4.0,0.0,4.0,0.0,4.0],"y":[0.0,0.0,-1.0,-1.0,-2.0,-2.0,-3.0,-3.0],"type":"scatter"},{"marker":{"color":"steelblue","size":10},"mode":"markers","x":[1.0,2.0,3.0,1.0,2.0,3.0,1.0,2.0,3.0,1.0,2.0,3.0],"y":[0.0,0.0,0.0,-1.0,-1.0,-1.0,-2.0,-2.0,-2.0,-3.0,-3.0,-3.0],"type":"scatter"}],"name":"0"},{"data":[{"hoverinfo":"skip","line":{"color":"gray","width":2},"mode":"lines","x":[9.75328362073924e-07,0.995123565196991,null,0.995123565196991,2.0,null,2.0,3.0048763751983643,null,3.0048763751983643,3.9999990463256836,null,9.755584642334725e-07,0.9951305389404297,null,0.9951305389404297,2.0,null,2.0,3.004869222640991,null,3.004869222640991,3.9999992847442627,null,9.856670430963277e-07,0.9951394200325012,null,0.9951394200325012,2.000000238418579,null,2.000000238418579,3.0048606395721436,null,3.0048606395721436,3.9999992847442627,null,9.887531859931187e-07,0.995144784450531,null,0.995144784450531,1.9999985694885254,null,1.9999985694885254,3.004852294921875,null,3.004852294921875,3.9999961853027344,null,9.75328362073924e-07,9.755584642334725e-07,null,0.995123565196991,0.9951305389404297,null,2.0,2.0,null,3.0048763751983643,3.004869222640991,null,3.9999990463256836,3.9999992847442627,null,9.755584642334725e-07,9.856670430963277e-07,null,0.9951305389404297,0.9951394200325012,null,2.0,2.000000238418579,null,3.004869222640991,3.0048606395721436,null,3.9999992847442627,3.9999992847442627,null,9.856670430963277e-07,9.887531859931187e-07,null,0.9951394200325012,0.995144784450531,null,2.000000238418579,1.9999985694885254,null,3.0048606395721436,3.004852294921875,null,3.9999992847442627,3.9999961853027344,null],"y":[3.161147787977825e-07,-0.14515362679958344,null,-0.14515362679958344,-0.1855153888463974,null,-0.1855153888463974,-0.14515098929405212,null,-0.14515098929405212,3.127714762740652e-07,null,-0.9999997019767761,-1.1450600624084473,null,-1.1450600624084473,-1.185427188873291,null,-1.185427188873291,-1.1450575590133667,null,-1.1450575590133667,-0.9999997019767761,null,-1.999999761581421,-2.14493727684021,null,-2.14493727684021,-2.1853036880493164,null,-2.1853036880493164,-2.144935369491577,null,-2.144935369491577,-1.9999996423721313,null,-2.999999523162842,-3.1448466777801514,null,-3.1448466777801514,-3.185206174850464,null,-3.185206174850464,-3.1448447704315186,null,-3.1448447704315186,-2.9999988079071045,null,3.161147787977825e-07,-0.9999997019767761,null,-0.14515362679958344,-1.1450600624084473,null,-0.1855153888463974,-1.185427188873291,null,-0.14515098929405212,-1.1450575590133667,null,3.127714762740652e-07,-0.9999997019767761,null,-0.9999997019767761,-1.999999761581421,null,-1.1450600624084473,-2.14493727684021,null,-1.185427188873291,-2.1853036880493164,null,-1.1450575590133667,-2.144935369491577,null,-0.9999997019767761,-1.9999996423721313,null,-1.999999761581421,-2.999999523162842,null,-2.14493727684021,-3.1448466777801514,null,-2.1853036880493164,-3.185206174850464,null,-2.144935369491577,-3.1448447704315186,null,-1.9999996423721313,-2.9999988079071045,null],"type":"scatter"},{"marker":{"color":"crimson","size":12},"mode":"markers","x":[9.75328362073924e-07,3.9999990463256836,9.755584642334725e-07,3.9999992847442627,9.856670430963277e-07,3.9999992847442627,9.887531859931187e-07,3.9999961853027344],"y":[3.161147787977825e-07,3.127714762740652e-07,-0.9999997019767761,-0.9999997019767761,-1.999999761581421,-1.9999996423721313,-2.999999523162842,-2.9999988079071045],"type":"scatter"},{"marker":{"color":"steelblue","size":10},"mode":"markers","x":[0.995123565196991,2.0,3.0048763751983643,0.9951305389404297,2.0,3.004869222640991,0.9951394200325012,2.000000238418579,3.0048606395721436,0.995144784450531,1.9999985694885254,3.004852294921875],"y":[-0.14515362679958344,-0.1855153888463974,-0.14515098929405212,-1.1450600624084473,-1.185427188873291,-1.1450575590133667,-2.14493727684021,-2.1853036880493164,-2.144935369491577,-3.1448466777801514,-3.185206174850464,-3.1448447704315186],"type":"scatter"}],"name":"1"},{"data":[{"hoverinfo":"skip","line":{"color":"gray","width":2},"mode":"lines","x":[-4.400988018460339e-07,0.9891790747642517,null,0.9891790747642517,2.000000238418579,null,2.000000238418579,3.01082181930542,null,3.01082181930542,4.000000476837158,null,-4.3717673747778463e-07,0.9892170429229736,null,0.9892170429229736,2.000000238418579,null,2.000000238418579,3.0107836723327637,null,3.0107836723327637,4.000000476837158,null,-4.343913531101862e-07,0.9892680644989014,null,0.9892680644989014,2.000000238418579,null,2.000000238418579,3.010732889175415,null,3.010732889175415,4.000000476837158,null,-4.3172201458219206e-07,0.9893069863319397,null,0.9893069863319397,2.0000009536743164,null,2.0000009536743164,3.010695219039917,null,3.010695219039917,4.000001907348633,null,-4.400988018460339e-07,-4.3717673747778463e-07,null,0.9891790747642517,0.9892170429229736,null,2.000000238418579,2.000000238418579,null,3.01082181930542,3.0107836723327637,null,4.000000476837158,4.000000476837158,null,-4.3717673747778463e-07,-4.343913531101862e-07,null,0.9892170429229736,0.9892680644989014,null,2.000000238418579,2.000000238418579,null,3.0107836723327637,3.010732889175415,null,4.000000476837158,4.000000476837158,null,-4.343913531101862e-07,-4.3172201458219206e-07,null,0.9892680644989014,0.9893069863319397,null,2.000000238418579,2.0000009536743164,null,3.010732889175415,3.010695219039917,null,4.000000476837158,4.000001907348633,null],"y":[-2.315528320195881e-07,-0.22342276573181152,null,-0.22342276573181152,-0.30098745226860046,null,-0.30098745226860046,-0.22342710196971893,null,-0.22342710196971893,-2.338868512197223e-07,null,-1.000000238418579,-1.2230687141418457,null,-1.2230687141418457,-1.3006211519241333,null,-1.3006211519241333,-1.2230730056762695,null,-1.2230730056762695,-1.000000238418579,null,-2.000000238418579,-2.22259521484375,null,-2.22259521484375,-2.300135850906372,null,-2.300135850906372,-2.222599506378174,null,-2.222599506378174,-2.000000238418579,null,-3.000000238418579,-3.2222371101379395,null,-3.2222371101379395,-3.2997729778289795,null,-3.2997729778289795,-3.2222414016723633,null,-3.2222414016723633,-3.0000007152557373,null,-2.315528320195881e-07,-1.000000238418579,null,-0.22342276573181152,-1.2230687141418457,null,-0.30098745226860046,-1.3006211519241333,null,-0.22342710196971893,-1.2230730056762695,null,-2.338868512197223e-07,-1.000000238418579,null,-1.000000238418579,-2.000000238418579,null,-1.2230687141418457,-2.22259521484375,null,-1.3006211519241333,-2.300135850906372,null,-1.2230730056762695,-2.222599506378174,null,-1.000000238418579,-2.000000238418579,null,-2.000000238418579,-3.000000238418579,null,-2.22259521484375,-3.2222371101379395,null,-2.300135850906372,-3.2997729778289795,null,-2.222599506378174,-3.2222414016723633,null,-2.000000238418579,-3.0000007152557373,null],"type":"scatter"},{"marker":{"color":"crimson","size":12},"mode":"markers","x":[-4.400988018460339e-07,4.000000476837158,-4.3717673747778463e-07,4.000000476837158,-4.343913531101862e-07,4.000000476837158,-4.3172201458219206e-07,4.000001907348633],"y":[-2.315528320195881e-07,-2.338868512197223e-07,-1.000000238418579,-1.000000238418579,-2.000000238418579,-2.000000238418579,-3.000000238418579,-3.0000007152557373],"type":"scatter"},{"marker":{"color":"steelblue","size":10},"mode":"markers","x":[0.9891790747642517,2.000000238418579,3.01082181930542,0.9892170429229736,2.000000238418579,3.0107836723327637,0.9892680644989014,2.000000238418579,3.010732889175415,0.9893069863319397,2.0000009536743164,3.010695219039917],"y":[-0.22342276573181152,-0.30098745226860046,-0.22342710196971893,-1.2230687141418457,-1.3006211519241333,-1.2230730056762695,-2.22259521484375,-2.300135850906372,-2.222599506378174,-3.2222371101379395,-3.2997729778289795,-3.2222414016723633],"type":"scatter"}],"name":"2"},{"data":[{"hoverinfo":"skip","line":{"color":"gray","width":2},"mode":"lines","x":[-2.4456244318571407e-06,0.9827088117599487,null,0.9827088117599487,1.9999998807907104,null,1.9999998807907104,3.0172908306121826,null,3.0172908306121826,4.000002384185791,null,-2.6217164759145817e-06,0.9828128218650818,null,0.9828128218650818,1.9999998807907104,null,1.9999998807907104,3.0171868801116943,null,3.0171868801116943,4.000002384185791,null,-2.595816795292194e-06,0.9829515814781189,null,0.9829515814781189,1.9999998807907104,null,1.9999998807907104,3.0170481204986572,null,3.0170481204986572,4.000002384185791,null,-2.195792148995679e-06,0.9830570816993713,null,0.9830570816993713,2.0,null,2.0,3.0169429779052734,null,3.0169429779052734,4.000002861022949,null,-2.4456244318571407e-06,-2.6217164759145817e-06,null,0.9827088117599487,0.9828128218650818,null,1.9999998807907104,1.9999998807907104,null,3.0172908306121826,3.0171868801116943,null,4.000002384185791,4.000002384185791,null,-2.6217164759145817e-06,-2.595816795292194e-06,null,0.9828128218650818,0.9829515814781189,null,1.9999998807907104,1.9999998807907104,null,3.0171868801116943,3.0170481204986572,null,4.000002384185791,4.000002384185791,null,-2.595816795292194e-06,-2.195792148995679e-06,null,0.9829515814781189,0.9830570816993713,null,1.9999998807907104,2.0,null,3.0170481204986572,3.0169429779052734,null,4.000002384185791,4.000002861022949,null],"y":[-3.187581114616478e-06,-0.2893422544002533,null,-0.2893422544002533,-0.4018297791481018,null,-0.4018297791481018,-0.28934165835380554,null,-0.28934165835380554,-3.241119884478394e-06,null,-1.0000033378601074,-1.2885771989822388,null,-1.2885771989822388,-1.4010298252105713,null,-1.4010298252105713,-1.2885767221450806,null,-1.2885767221450806,-1.0000033378601074,null,-2.0000033378601074,-2.287550449371338,null,-2.287550449371338,-2.3999598026275635,null,-2.3999598026275635,-2.2875499725341797,null,-2.2875499725341797,-2.0000030994415283,null,-3.000002861022949,-3.2867681980133057,null,-3.2867681980133057,-3.399150848388672,null,-3.399150848388672,-3.2867677211761475,null,-3.2867677211761475,-3.000002861022949,null,-3.187581114616478e-06,-1.0000033378601074,null,-0.2893422544002533,-1.2885771989822388,null,-0.4018297791481018,-1.4010298252105713,null,-0.28934165835380554,-1.2885767221450806,null,-3.241119884478394e-06,-1.0000033378601074,null,-1.0000033378601074,-2.0000033378601074,null,-1.2885771989822388,-2.287550449371338,null,-1.4010298252105713,-2.3999598026275635,null,-1.2885767221450806,-2.2875499725341797,null,-1.0000033378601074,-2.0000030994415283,null,-2.0000033378601074,-3.000002861022949,null,-2.287550449371338,-3.2867681980133057,null,-2.3999598026275635,-3.399150848388672,null,-2.2875499725341797,-3.2867677211761475,null,-2.0000030994415283,-3.000002861022949,null],"type":"scatter"},{"marker":{"color":"crimson","size":12},"mode":"markers","x":[-2.4456244318571407e-06,4.000002384185791,-2.6217164759145817e-06,4.000002384185791,-2.595816795292194e-06,4.000002384185791,-2.195792148995679e-06,4.000002861022949],"y":[-3.187581114616478e-06,-3.241119884478394e-06,-1.0000033378601074,-1.0000033378601074,-2.0000033378601074,-2.0000030994415283,-3.000002861022949,-3.000002861022949],"type":"scatter"},{"marker":{"color":"steelblue","size":10},"mode":"markers","x":[0.9827088117599487,1.9999998807907104,3.0172908306121826,0.9828128218650818,1.9999998807907104,3.0171868801116943,0.9829515814781189,1.9999998807907104,3.0170481204986572,0.9830570816993713,2.0,3.0169429779052734],"y":[-0.2893422544002533,-0.4018297791481018,-0.28934165835380554,-1.2885771989822388,-1.4010298252105713,-1.2885767221450806,-2.287550449371338,-2.3999598026275635,-2.2875499725341797,-3.2867681980133057,-3.399150848388672,-3.2867677211761475],"type":"scatter"}],"name":"3"},{"data":[{"hoverinfo":"skip","line":{"color":"gray","width":2},"mode":"lines","x":[-1.0475553153810324e-06,0.9736741781234741,null,0.9736741781234741,2.0,null,2.0,3.0263259410858154,null,3.0263259410858154,4.000000953674316,null,-1.023437334879418e-06,0.9738845825195312,null,0.9738845825195312,2.0,null,2.0,3.026115655899048,null,3.026115655899048,4.000000953674316,null,-1.0032009640781325e-06,0.9741666316986084,null,0.9741666316986084,2.0,null,2.0,3.0258333683013916,null,3.0258333683013916,4.000000953674316,null,-9.955955420082319e-07,0.9743823409080505,null,0.9743823409080505,1.9999998807907104,null,1.9999998807907104,3.0256175994873047,null,3.0256175994873047,4.000000953674316,null,-1.0475553153810324e-06,-1.023437334879418e-06,null,0.9736741781234741,0.9738845825195312,null,2.0,2.0,null,3.0263259410858154,3.026115655899048,null,4.000000953674316,4.000000953674316,null,-1.023437334879418e-06,-1.0032009640781325e-06,null,0.9738845825195312,0.9741666316986084,null,2.0,2.0,null,3.026115655899048,3.0258333683013916,null,4.000000953674316,4.000000953674316,null,-1.0032009640781325e-06,-9.955955420082319e-07,null,0.9741666316986084,0.9743823409080505,null,2.0,1.9999998807907104,null,3.0258333683013916,3.0256175994873047,null,4.000000953674316,4.000000953674316,null],"y":[-7.22898391813942e-07,-0.35379135608673096,null,-0.35379135608673096,-0.4801875948905945,null,-0.4801875948905945,-0.35379132628440857,null,-0.35379132628440857,-7.227442324619915e-07,null,-1.0000007152557373,-1.3524774312973022,null,-1.3524774312973022,-1.4787652492523193,null,-1.4787652492523193,-1.3524774312973022,null,-1.3524774312973022,-1.0000007152557373,null,-2.0000007152557373,-2.3507208824157715,null,-2.3507208824157715,-2.4768989086151123,null,-2.4768989086151123,-2.3507208824157715,null,-2.3507208824157715,-2.0000007152557373,null,-3.0000007152557373,-3.3493833541870117,null,-3.3493833541870117,-3.4755120277404785,null,-3.4755120277404785,-3.3493833541870117,null,-3.3493833541870117,-3.0000007152557373,null,-7.22898391813942e-07,-1.0000007152557373,null,-0.35379135608673096,-1.3524774312973022,null,-0.4801875948905945,-1.4787652492523193,null,-0.35379132628440857,-1.3524774312973022,null,-7.227442324619915e-07,-1.0000007152557373,null,-1.0000007152557373,-2.0000007152557373,null,-1.3524774312973022,-2.3507208824157715,null,-1.4787652492523193,-2.4768989086151123,null,-1.3524774312973022,-2.3507208824157715,null,-1.0000007152557373,-2.0000007152557373,null,-2.0000007152557373,-3.0000007152557373,null,-2.3507208824157715,-3.3493833541870117,null,-2.4768989086151123,-3.4755120277404785,null,-2.3507208824157715,-3.3493833541870117,null,-2.0000007152557373,-3.0000007152557373,null],"type":"scatter"},{"marker":{"color":"crimson","size":12},"mode":"markers","x":[-1.0475553153810324e-06,4.000000953674316,-1.023437334879418e-06,4.000000953674316,-1.0032009640781325e-06,4.000000953674316,-9.955955420082319e-07,4.000000953674316],"y":[-7.22898391813942e-07,-7.227442324619915e-07,-1.0000007152557373,-1.0000007152557373,-2.0000007152557373,-2.0000007152557373,-3.0000007152557373,-3.0000007152557373],"type":"scatter"},{"marker":{"color":"steelblue","size":10},"mode":"markers","x":[0.9736741781234741,2.0,3.0263259410858154,0.9738845825195312,2.0,3.026115655899048,0.9741666316986084,2.0,3.0258333683013916,0.9743823409080505,1.9999998807907104,3.0256175994873047],"y":[-0.35379135608673096,-0.4801875948905945,-0.35379132628440857,-1.3524774312973022,-1.4787652492523193,-1.3524774312973022,-2.3507208824157715,-2.4768989086151123,-2.3507208824157715,-3.3493833541870117,-3.4755120277404785,-3.3493833541870117],"type":"scatter"}],"name":"4"},{"data":[{"hoverinfo":"skip","line":{"color":"gray","width":2},"mode":"lines","x":[-2.276233090015012e-06,0.9632015824317932,null,0.9632015824317932,2.0,null,2.0,3.0367984771728516,null,3.0367984771728516,4.000002384185791,null,-2.1647867924912134e-06,0.9635787010192871,null,0.9635787010192871,2.0,null,2.0,3.036421298980713,null,3.036421298980713,4.000002384185791,null,-2.1770133571408223e-06,0.9640655517578125,null,0.9640655517578125,2.0,null,2.0,3.0359344482421875,null,3.0359344482421875,4.000001907348633,null,-2.2922065454622498e-06,0.9644250869750977,null,0.9644250869750977,2.0,null,2.0,3.0355749130249023,null,3.0355749130249023,4.000002384185791,null,-2.276233090015012e-06,-2.1647867924912134e-06,null,0.9632015824317932,0.9635787010192871,null,2.0,2.0,null,3.0367984771728516,3.036421298980713,null,4.000002384185791,4.000002384185791,null,-2.1647867924912134e-06,-2.1770133571408223e-06,null,0.9635787010192871,0.9640655517578125,null,2.0,2.0,null,3.036421298980713,3.0359344482421875,null,4.000002384185791,4.000001907348633,null,-2.1770133571408223e-06,-2.2922065454622498e-06,null,0.9640655517578125,0.9644250869750977,null,2.0,2.0,null,3.0359344482421875,3.0355749130249023,null,4.000001907348633,4.000002384185791,null],"y":[4.045652531203814e-06,-0.4160628318786621,null,-0.4160628318786621,-0.5526419281959534,null,-0.5526419281959534,-0.4160628616809845,null,-0.4160628616809845,4.044316483486909e-06,null,-0.9999958872795105,-1.4140475988388062,null,-1.4140475988388062,-1.550548791885376,null,-1.550548791885376,-1.4140477180480957,null,-1.4140477180480957,-0.9999958872795105,null,-1.9999959468841553,-2.4114015102386475,null,-2.4114015102386475,-2.5477163791656494,null,-2.5477163791656494,-2.4114015102386475,null,-2.4114015102386475,-1.9999959468841553,null,-2.9999961853027344,-3.409414768218994,null,-3.409414768218994,-3.5455405712127686,null,-3.5455405712127686,-3.409414768218994,null,-3.409414768218994,-2.9999961853027344,null,4.045652531203814e-06,-0.9999958872795105,null,-0.4160628318786621,-1.4140475988388062,null,-0.5526419281959534,-1.550548791885376,null,-0.4160628616809845,-1.4140477180480957,null,4.044316483486909e-06,-0.9999958872795105,null,-0.9999958872795105,-1.9999959468841553,null,-1.4140475988388062,-2.4114015102386475,null,-1.550548791885376,-2.5477163791656494,null,-1.4140477180480957,-2.4114015102386475,null,-0.9999958872795105,-1.9999959468841553,null,-1.9999959468841553,-2.9999961853027344,null,-2.4114015102386475,-3.409414768218994,null,-2.5477163791656494,-3.5455405712127686,null,-2.4114015102386475,-3.409414768218994,null,-1.9999959468841553,-2.9999961853027344,null],"type":"scatter"},{"marker":{"color":"crimson","size":12},"mode":"markers","x":[-2.276233090015012e-06,4.000002384185791,-2.1647867924912134e-06,4.000002384185791,-2.1770133571408223e-06,4.000001907348633,-2.2922065454622498e-06,4.000002384185791],"y":[4.045652531203814e-06,4.044316483486909e-06,-0.9999958872795105,-0.9999958872795105,-1.9999959468841553,-1.9999959468841553,-2.9999961853027344,-2.9999961853027344],"type":"scatter"},{"marker":{"color":"steelblue","size":10},"mode":"markers","x":[0.9632015824317932,2.0,3.0367984771728516,0.9635787010192871,2.0,3.036421298980713,0.9640655517578125,2.0,3.0359344482421875,0.9644250869750977,2.0,3.0355749130249023],"y":[-0.4160628318786621,-0.5526419281959534,-0.4160628616809845,-1.4140475988388062,-1.550548791885376,-1.4140477180480957,-2.4114015102386475,-2.5477163791656494,-2.4114015102386475,-3.409414768218994,-3.5455405712127686,-3.409414768218994],"type":"scatter"}],"name":"5"},{"data":[{"hoverinfo":"skip","line":{"color":"gray","width":2},"mode":"lines","x":[6.790503448428353e-06,0.9543743133544922,null,0.9543743133544922,2.0,null,2.0,3.045625686645508,null,3.045625686645508,3.999993324279785,null,6.480556294263806e-06,0.9549357891082764,null,0.9549357891082764,2.0,null,2.0,3.0450642108917236,null,3.0450642108917236,3.9999935626983643,null,6.133290753496112e-06,0.9556616544723511,null,0.9556616544723511,2.0,null,2.0,3.0443382263183594,null,3.0443382263183594,3.9999938011169434,null,5.9207995946053416e-06,0.9562021493911743,null,0.9562021493911743,2.0,null,2.0,3.043797731399536,null,3.043797731399536,3.9999940395355225,null,6.790503448428353e-06,6.480556294263806e-06,null,0.9543743133544922,0.9549357891082764,null,2.0,2.0,null,3.045625686645508,3.0450642108917236,null,3.999993324279785,3.9999935626983643,null,6.480556294263806e-06,6.133290753496112e-06,null,0.9549357891082764,0.9556616544723511,null,2.0,2.0,null,3.0450642108917236,3.0443382263183594,null,3.9999935626983643,3.9999938011169434,null,6.133290753496112e-06,5.9207995946053416e-06,null,0.9556616544723511,0.9562021493911743,null,2.0,2.0,null,3.0443382263183594,3.043797731399536,null,3.9999938011169434,3.9999940395355225,null],"y":[2.2443571197072743e-06,-0.46855002641677856,null,-0.46855002641677856,-0.6265224814414978,null,-0.6265224814414978,-0.4685499370098114,null,-0.4685499370098114,2.2443905436375644e-06,null,-0.9999975562095642,-1.4657796621322632,null,-1.4657796621322632,-1.6235414743423462,null,-1.6235414743423462,-1.4657796621322632,null,-1.4657796621322632,-0.9999975562095642,null,-1.9999972581863403,-2.4621262550354004,null,-2.4621262550354004,-2.6195425987243652,null,-2.6195425987243652,-2.4621262550354004,null,-2.4621262550354004,-1.9999972581863403,null,-2.9999969005584717,-3.4593582153320312,null,-3.4593582153320312,-3.6164910793304443,null,-3.6164910793304443,-3.4593582153320312,null,-3.4593582153320312,-2.9999969005584717,null,2.2443571197072743e-06,-0.9999975562095642,null,-0.46855002641677856,-1.4657796621322632,null,-0.6265224814414978,-1.6235414743423462,null,-0.4685499370098114,-1.4657796621322632,null,2.2443905436375644e-06,-0.9999975562095642,null,-0.9999975562095642,-1.9999972581863403,null,-1.4657796621322632,-2.4621262550354004,null,-1.6235414743423462,-2.6195425987243652,null,-1.4657796621322632,-2.4621262550354004,null,-0.9999975562095642,-1.9999972581863403,null,-1.9999972581863403,-2.9999969005584717,null,-2.4621262550354004,-3.4593582153320312,null,-2.6195425987243652,-3.6164910793304443,null,-2.4621262550354004,-3.4593582153320312,null,-1.9999972581863403,-2.9999969005584717,null],"type":"scatter"},{"marker":{"color":"crimson","size":12},"mode":"markers","x":[6.790503448428353e-06,3.999993324279785,6.480556294263806e-06,3.9999935626983643,6.133290753496112e-06,3.9999938011169434,5.9207995946053416e-06,3.9999940395355225],"y":[2.2443571197072743e-06,2.2443905436375644e-06,-0.9999975562095642,-0.9999975562095642,-1.9999972581863403,-1.9999972581863403,-2.9999969005584717,-2.9999969005584717],"type":"scatter"},{"marker":{"color":"steelblue","size":10},"mode":"markers","x":[0.9543743133544922,2.0,3.045625686645508,0.9549357891082764,2.0,3.0450642108917236,0.9556616544723511,2.0,3.0443382263183594,0.9562021493911743,2.0,3.043797731399536],"y":[-0.46855002641677856,-0.6265224814414978,-0.4685499370098114,-1.4657796621322632,-1.6235414743423462,-1.4657796621322632,-2.4621262550354004,-2.6195425987243652,-2.4621262550354004,-3.4593582153320312,-3.6164910793304443,-3.4593582153320312],"type":"scatter"}],"name":"6"},{"data":[{"hoverinfo":"skip","line":{"color":"gray","width":2},"mode":"lines","x":[7.858942808525171e-06,0.9454231858253479,null,0.9454231858253479,2.0,null,2.0,3.054576873779297,null,3.054576873779297,3.9999921321868896,null,7.756022569083143e-06,0.9462024569511414,null,0.9462024569511414,2.0,null,2.0,3.053797483444214,null,3.053797483444214,3.9999921321868896,null,7.438134161930066e-06,0.9472119212150574,null,0.9472119212150574,2.0,null,2.0,3.052788019180298,null,3.052788019180298,3.999992609024048,null,7.0781643444206566e-06,0.9479691982269287,null,0.9479691982269287,2.0,null,2.0,3.0520308017730713,null,3.0520308017730713,3.999992847442627,null,7.858942808525171e-06,7.756022569083143e-06,null,0.9454231858253479,0.9462024569511414,null,2.0,2.0,null,3.054576873779297,3.053797483444214,null,3.9999921321868896,3.9999921321868896,null,7.756022569083143e-06,7.438134161930066e-06,null,0.9462024569511414,0.9472119212150574,null,2.0,2.0,null,3.053797483444214,3.052788019180298,null,3.9999921321868896,3.999992609024048,null,7.438134161930066e-06,7.0781643444206566e-06,null,0.9472119212150574,0.9479691982269287,null,2.0,2.0,null,3.052788019180298,3.0520308017730713,null,3.999992609024048,3.999992847442627,null],"y":[6.104161798248242e-07,-0.519413948059082,null,-0.519413948059082,-0.7010848522186279,null,-0.7010848522186279,-0.519413948059082,null,-0.519413948059082,6.102396810092614e-07,null,-0.9999991655349731,-1.5157880783081055,null,-1.5157880783081055,-1.6971118450164795,null,-1.6971118450164795,-1.5157880783081055,null,-1.5157880783081055,-0.9999991655349731,null,-1.9999988079071045,-2.5110092163085938,null,-2.5110092163085938,-2.6917874813079834,null,-2.6917874813079834,-2.5110092163085938,null,-2.5110092163085938,-1.9999988079071045,null,-2.9999985694885254,-3.5073752403259277,null,-3.5073752403259277,-3.6877198219299316,null,-3.6877198219299316,-3.5073752403259277,null,-3.5073752403259277,-2.9999985694885254,null,6.104161798248242e-07,-0.9999991655349731,null,-0.519413948059082,-1.5157880783081055,null,-0.7010848522186279,-1.6971118450164795,null,-0.519413948059082,-1.5157880783081055,null,6.102396810092614e-07,-0.9999991655349731,null,-0.9999991655349731,-1.9999988079071045,null,-1.5157880783081055,-2.5110092163085938,null,-1.6971118450164795,-2.6917874813079834,null,-1.5157880783081055,-2.5110092163085938,null,-0.9999991655349731,-1.9999988079071045,null,-1.9999988079071045,-2.9999985694885254,null,-2.5110092163085938,-3.5073752403259277,null,-2.6917874813079834,-3.6877198219299316,null,-2.5110092163085938,-3.5073752403259277,null,-1.9999988079071045,-2.9999985694885254,null],"type":"scatter"},{"marker":{"color":"crimson","size":12},"mode":"markers","x":[7.858942808525171e-06,3.9999921321868896,7.756022569083143e-06,3.9999921321868896,7.438134161930066e-06,3.999992609024048,7.0781643444206566e-06,3.999992847442627],"y":[6.104161798248242e-07,6.102396810092614e-07,-0.9999991655349731,-0.9999991655349731,-1.9999988079071045,-1.9999988079071045,-2.9999985694885254,-2.9999985694885254],"type":"scatter"},{"marker":{"color":"steelblue","size":10},"mode":"markers","x":[0.9454231858253479,2.0,3.054576873779297,0.9462024569511414,2.0,3.053797483444214,0.9472119212150574,2.0,3.052788019180298,0.9479691982269287,2.0,3.0520308017730713],"y":[-0.519413948059082,-0.7010848522186279,-0.519413948059082,-1.5157880783081055,-1.6971118450164795,-1.5157880783081055,-2.5110092163085938,-2.6917874813079834,-2.5110092163085938,-3.5073752403259277,-3.6877198219299316,-3.5073752403259277],"type":"scatter"}],"name":"7"},{"data":[{"hoverinfo":"skip","line":{"color":"gray","width":2},"mode":"lines","x":[-4.801091108674882e-06,0.9365828037261963,null,0.9365828037261963,2.0,null,2.0,3.063417434692383,null,3.063417434692383,4.000004768371582,null,-4.109154815523652e-06,0.9376077651977539,null,0.9376077651977539,2.0,null,2.0,3.062392234802246,null,3.062392234802246,4.000004291534424,null,-4.107073891645996e-06,0.9389340877532959,null,0.9389340877532959,2.0,null,2.0,3.061065912246704,null,3.061065912246704,4.000004291534424,null,-4.729704869532725e-06,0.9399316310882568,null,0.9399316310882568,2.0,null,2.0,3.060068368911743,null,3.060068368911743,4.000004768371582,null,-4.801091108674882e-06,-4.109154815523652e-06,null,0.9365828037261963,0.9376077651977539,null,2.0,2.0,null,3.063417434692383,3.062392234802246,null,4.000004768371582,4.000004291534424,null,-4.109154815523652e-06,-4.107073891645996e-06,null,0.9376077651977539,0.9389340877532959,null,2.0,2.0,null,3.062392234802246,3.061065912246704,null,4.000004291534424,4.000004291534424,null,-4.107073891645996e-06,-4.729704869532725e-06,null,0.9389340877532959,0.9399316310882568,null,2.0,2.0,null,3.061065912246704,3.060068368911743,null,4.000004291534424,4.000004768371582,null],"y":[-4.825299271260519e-08,-0.5677614212036133,null,-0.5677614212036133,-0.7729564309120178,null,-0.7729564309120178,-0.5677613615989685,null,-0.5677613615989685,-4.854035040580129e-08,null,-1.0000020265579224,-1.5631998777389526,null,-1.5631998777389526,-1.7678732872009277,null,-1.7678732872009277,-1.5631998777389526,null,-1.5631998777389526,-1.0000020265579224,null,-2.000001907348633,-2.5571951866149902,null,-2.5571951866149902,-2.761068105697632,null,-2.761068105697632,-2.5571951866149902,null,-2.5571951866149902,-2.000001907348633,null,-3.0,-3.552616596221924,null,-3.552616596221924,-3.7558624744415283,null,-3.7558624744415283,-3.552616596221924,null,-3.552616596221924,-3.0,null,-4.825299271260519e-08,-1.0000020265579224,null,-0.5677614212036133,-1.5631998777389526,null,-0.7729564309120178,-1.7678732872009277,null,-0.5677613615989685,-1.5631998777389526,null,-4.854035040580129e-08,-1.0000020265579224,null,-1.0000020265579224,-2.000001907348633,null,-1.5631998777389526,-2.5571951866149902,null,-1.7678732872009277,-2.761068105697632,null,-1.5631998777389526,-2.5571951866149902,null,-1.0000020265579224,-2.000001907348633,null,-2.000001907348633,-3.0,null,-2.5571951866149902,-3.552616596221924,null,-2.761068105697632,-3.7558624744415283,null,-2.5571951866149902,-3.552616596221924,null,-2.000001907348633,-3.0,null],"type":"scatter"},{"marker":{"color":"crimson","size":12},"mode":"markers","x":[-4.801091108674882e-06,4.000004768371582,-4.109154815523652e-06,4.000004291534424,-4.107073891645996e-06,4.000004291534424,-4.729704869532725e-06,4.000004768371582],"y":[-4.825299271260519e-08,-4.854035040580129e-08,-1.0000020265579224,-1.0000020265579224,-2.000001907348633,-2.000001907348633,-3.0,-3.0],"type":"scatter"},{"marker":{"color":"steelblue","size":10},"mode":"markers","x":[0.9365828037261963,2.0,3.063417434692383,0.9376077651977539,2.0,3.062392234802246,0.9389340877532959,2.0,3.061065912246704,0.9399316310882568,2.0,3.060068368911743],"y":[-0.5677614212036133,-0.7729564309120178,-0.5677613615989685,-1.5631998777389526,-1.7678732872009277,-1.5631998777389526,-2.5571951866149902,-2.761068105697632,-2.5571951866149902,-3.552616596221924,-3.7558624744415283,-3.552616596221924],"type":"scatter"}],"name":"8"},{"data":[{"hoverinfo":"skip","line":{"color":"gray","width":2},"mode":"lines","x":[3.9191577343444806e-06,0.9302676916122437,null,0.9302676916122437,2.0,null,2.0,3.069732189178467,null,3.069732189178467,3.9999961853027344,null,3.926449608115945e-06,0.9314902424812317,null,0.9314902424812317,2.0,null,2.0,3.068509817123413,null,3.068509817123413,3.9999961853027344,null,3.7138056541152764e-06,0.9331192374229431,null,0.9331192374229431,2.0,null,2.0,3.066880702972412,null,3.066880702972412,3.9999961853027344,null,3.4092095120286103e-06,0.934385359287262,null,0.934385359287262,2.0,null,2.0,3.065614700317383,null,3.065614700317383,3.9999966621398926,null,3.9191577343444806e-06,3.926449608115945e-06,null,0.9302676916122437,0.9314902424812317,null,2.0,2.0,null,3.069732189178467,3.068509817123413,null,3.9999961853027344,3.9999961853027344,null,3.926449608115945e-06,3.7138056541152764e-06,null,0.9314902424812317,0.9331192374229431,null,2.0,2.0,null,3.068509817123413,3.066880702972412,null,3.9999961853027344,3.9999961853027344,null,3.7138056541152764e-06,3.4092095120286103e-06,null,0.9331192374229431,0.934385359287262,null,2.0,2.0,null,3.066880702972412,3.065614700317383,null,3.9999961853027344,3.9999966621398926,null],"y":[7.994685233825294e-07,-0.6090376973152161,null,-0.6090376973152161,-0.846816897392273,null,-0.846816897392273,-0.6090376973152161,null,-0.6090376973152161,7.991310440047528e-07,null,-0.9999989867210388,-1.603531837463379,null,-1.603531837463379,-1.8403044939041138,null,-1.8403044939041138,-1.6035319566726685,null,-1.6035319566726685,-0.9999989867210388,null,-1.999998688697815,-2.5962371826171875,null,-2.5962371826171875,-2.8318071365356445,null,-2.8318071365356445,-2.5962371826171875,null,-2.5962371826171875,-1.999998688697815,null,-2.9999985694885254,-3.5906152725219727,null,-3.5906152725219727,-3.82545804977417,null,-3.82545804977417,-3.5906152725219727,null,-3.5906152725219727,-2.9999985694885254,null,7.994685233825294e-07,-0.9999989867210388,null,-0.6090376973152161,-1.603531837463379,null,-0.846816897392273,-1.8403044939041138,null,-0.6090376973152161,-1.6035319566726685,null,7.991310440047528e-07,-0.9999989867210388,null,-0.9999989867210388,-1.999998688697815,null,-1.603531837463379,-2.5962371826171875,null,-1.8403044939041138,-2.8318071365356445,null,-1.6035319566726685,-2.5962371826171875,null,-0.9999989867210388,-1.999998688697815,null,-1.999998688697815,-2.9999985694885254,null,-2.5962371826171875,-3.5906152725219727,null,-2.8318071365356445,-3.82545804977417,null,-2.5962371826171875,-3.5906152725219727,null,-1.999998688697815,-2.9999985694885254,null],"type":"scatter"},{"marker":{"color":"crimson","size":12},"mode":"markers","x":[3.9191577343444806e-06,3.9999961853027344,3.926449608115945e-06,3.9999961853027344,3.7138056541152764e-06,3.9999961853027344,3.4092095120286103e-06,3.9999966621398926],"y":[7.994685233825294e-07,7.991310440047528e-07,-0.9999989867210388,-0.9999989867210388,-1.999998688697815,-1.999998688697815,-2.9999985694885254,-2.9999985694885254],"type":"scatter"},{"marker":{"color":"steelblue","size":10},"mode":"markers","x":[0.9302676916122437,2.0,3.069732189178467,0.9314902424812317,2.0,3.068509817123413,0.9331192374229431,2.0,3.066880702972412,0.934385359287262,2.0,3.065614700317383],"y":[-0.6090376973152161,-0.846816897392273,-0.6090376973152161,-1.603531837463379,-1.8403044939041138,-1.6035319566726685,-2.5962371826171875,-2.8318071365356445,-2.5962371826171875,-3.5906152725219727,-3.82545804977417,-3.5906152725219727],"type":"scatter"}],"name":"9"},{"data":[{"hoverinfo":"skip","line":{"color":"gray","width":2},"mode":"lines","x":[3.268338105044677e-06,0.9119422435760498,null,0.9119422435760498,2.0,null,2.0,3.08805775642395,null,3.08805775642395,3.9999966621398926,null,3.1080412554729264e-06,0.9136744737625122,null,0.9136744737625122,2.0,null,2.0,3.0863254070281982,null,3.0863254070281982,3.9999969005584717,null,2.9802631615893915e-06,0.9158082604408264,null,0.9158082604408264,2.0,null,2.0,3.0841917991638184,null,3.0841917991638184,3.9999969005584717,null,2.941494130936917e-06,0.9173462390899658,null,0.9173462390899658,2.0,null,2.0,3.082653760910034,null,3.082653760910034,3.999997138977051,null,3.268338105044677e-06,3.1080412554729264e-06,null,0.9119422435760498,0.9136744737625122,null,2.0,2.0,null,3.08805775642395,3.0863254070281982,null,3.9999966621398926,3.9999969005584717,null,3.1080412554729264e-06,2.9802631615893915e-06,null,0.9136744737625122,0.9158082604408264,null,2.0,2.0,null,3.0863254070281982,3.0841917991638184,null,3.9999969005584717,3.9999969005584717,null,2.9802631615893915e-06,2.941494130936917e-06,null,0.9158082604408264,0.9173462390899658,null,2.0,2.0,null,3.0841917991638184,3.082653760910034,null,3.9999969005584717,3.999997138977051,null],"y":[1.250402988262067e-06,-0.6697152256965637,null,-0.6697152256965637,-0.8914580941200256,null,-0.8914580941200256,-0.6697152256965637,null,-0.6697152256965637,1.2504197002272122e-06,null,-0.9999987483024597,-1.6629071235656738,null,-1.6629071235656738,-1.8840428590774536,null,-1.8840428590774536,-1.6629070043563843,null,-1.6629070043563843,-0.9999987483024597,null,-1.999998688697815,-2.6541433334350586,null,-2.6541433334350586,-2.873967170715332,null,-2.873967170715332,-2.6541433334350586,null,-2.6541433334350586,-1.999998688697815,null,-2.9999988079071045,-3.6475541591644287,null,-3.6475541591644287,-3.8660874366760254,null,-3.8660874366760254,-3.6475541591644287,null,-3.6475541591644287,-2.9999988079071045,null,1.250402988262067e-06,-0.9999987483024597,null,-0.6697152256965637,-1.6629071235656738,null,-0.8914580941200256,-1.8840428590774536,null,-0.6697152256965637,-1.6629070043563843,null,1.2504197002272122e-06,-0.9999987483024597,null,-0.9999987483024597,-1.999998688697815,null,-1.6629071235656738,-2.6541433334350586,null,-1.8840428590774536,-2.873967170715332,null,-1.6629070043563843,-2.6541433334350586,null,-0.9999987483024597,-1.999998688697815,null,-1.999998688697815,-2.9999988079071045,null,-2.6541433334350586,-3.6475541591644287,null,-2.873967170715332,-3.8660874366760254,null,-2.6541433334350586,-3.6475541591644287,null,-1.999998688697815,-2.9999988079071045,null],"type":"scatter"},{"marker":{"color":"crimson","size":12},"mode":"markers","x":[3.268338105044677e-06,3.9999966621398926,3.1080412554729264e-06,3.9999969005584717,2.9802631615893915e-06,3.9999969005584717,2.941494130936917e-06,3.999997138977051],"y":[1.250402988262067e-06,1.2504197002272122e-06,-0.9999987483024597,-0.9999987483024597,-1.999998688697815,-1.999998688697815,-2.9999988079071045,-2.9999988079071045],"type":"scatter"},{"marker":{"color":"steelblue","size":10},"mode":"markers","x":[0.9119422435760498,2.0,3.08805775642395,0.9136744737625122,2.0,3.0863254070281982,0.9158082604408264,2.0,3.0841917991638184,0.9173462390899658,2.0,3.082653760910034],"y":[-0.6697152256965637,-0.8914580941200256,-0.6697152256965637,-1.6629071235656738,-1.8840428590774536,-1.6629070043563843,-2.6541433334350586,-2.873967170715332,-2.6541433334350586,-3.6475541591644287,-3.8660874366760254,-3.6475541591644287],"type":"scatter"}],"name":"10"},{"data":[{"hoverinfo":"skip","line":{"color":"gray","width":2},"mode":"lines","x":[7.3030232670134865e-06,0.9078837037086487,null,0.9078837037086487,2.0,null,2.0,3.092116117477417,null,3.092116117477417,3.999992609024048,null,6.970567483222112e-06,0.9096266031265259,null,0.9096266031265259,2.0,null,2.0,3.0903732776641846,null,3.0903732776641846,3.999993085861206,null,6.624628895224305e-06,0.9120373129844666,null,0.9120373129844666,2.0,null,2.0,3.0879626274108887,null,3.0879626274108887,3.999993324279785,null,6.459241376433056e-06,0.9139725565910339,null,0.9139725565910339,2.0,null,2.0,3.0860273838043213,null,3.0860273838043213,3.9999935626983643,null,7.3030232670134865e-06,6.970567483222112e-06,null,0.9078837037086487,0.9096266031265259,null,2.0,2.0,null,3.092116117477417,3.0903732776641846,null,3.999992609024048,3.999993085861206,null,6.970567483222112e-06,6.624628895224305e-06,null,0.9096266031265259,0.9120373129844666,null,2.0,2.0,null,3.0903732776641846,3.0879626274108887,null,3.999993085861206,3.999993324279785,null,6.624628895224305e-06,6.459241376433056e-06,null,0.9120373129844666,0.9139725565910339,null,2.0,2.0,null,3.0879626274108887,3.0860273838043213,null,3.999993324279785,3.9999935626983643,null],"y":[2.2066207350235345e-07,-0.7074794173240662,null,-0.7074794173240662,-0.9684013724327087,null,-0.9684013724327087,-0.7074794173240662,null,-0.7074794173240662,2.2048642733807355e-07,null,-0.9999991059303284,-1.6998050212860107,null,-1.6998050212860107,-1.9591960906982422,null,-1.9591960906982422,-1.6998050212860107,null,-1.6998050212860107,-0.9999991059303284,null,-1.9999988079071045,-2.6896471977233887,null,-2.6896471977233887,-2.947112798690796,null,-2.947112798690796,-2.6896471977233887,null,-2.6896471977233887,-1.9999988079071045,null,-2.9999990463256836,-3.681777000427246,null,-3.681777000427246,-3.937964677810669,null,-3.937964677810669,-3.681777238845825,null,-3.681777238845825,-2.9999990463256836,null,2.2066207350235345e-07,-0.9999991059303284,null,-0.7074794173240662,-1.6998050212860107,null,-0.9684013724327087,-1.9591960906982422,null,-0.7074794173240662,-1.6998050212860107,null,2.2048642733807355e-07,-0.9999991059303284,null,-0.9999991059303284,-1.9999988079071045,null,-1.6998050212860107,-2.6896471977233887,null,-1.9591960906982422,-2.947112798690796,null,-1.6998050212860107,-2.6896471977233887,null,-0.9999991059303284,-1.9999988079071045,null,-1.9999988079071045,-2.9999990463256836,null,-2.6896471977233887,-3.681777000427246,null,-2.947112798690796,-3.937964677810669,null,-2.6896471977233887,-3.681777238845825,null,-1.9999988079071045,-2.9999990463256836,null],"type":"scatter"},{"marker":{"color":"crimson","size":12},"mode":"markers","x":[7.3030232670134865e-06,3.999992609024048,6.970567483222112e-06,3.999993085861206,6.624628895224305e-06,3.999993324279785,6.459241376433056e-06,3.9999935626983643],"y":[2.2066207350235345e-07,2.2048642733807355e-07,-0.9999991059303284,-0.9999991059303284,-1.9999988079071045,-1.9999988079071045,-2.9999990463256836,-2.9999990463256836],"type":"scatter"},{"marker":{"color":"steelblue","size":10},"mode":"markers","x":[0.9078837037086487,2.0,3.092116117477417,0.9096266031265259,2.0,3.0903732776641846,0.9120373129844666,2.0,3.0879626274108887,0.9139725565910339,2.0,3.0860273838043213],"y":[-0.7074794173240662,-0.9684013724327087,-0.7074794173240662,-1.6998050212860107,-1.9591960906982422,-1.6998050212860107,-2.6896471977233887,-2.947112798690796,-2.6896471977233887,-3.681777000427246,-3.937964677810669,-3.681777238845825],"type":"scatter"}],"name":"11"},{"data":[{"hoverinfo":"skip","line":{"color":"gray","width":2},"mode":"lines","x":[4.653745122595865e-07,0.9030538201332092,null,0.9030538201332092,2.0,null,2.0,3.0969460010528564,null,3.0969460010528564,3.999999523162842,null,4.284825934064429e-07,0.9051325917243958,null,0.9051325917243958,2.0,null,2.0,3.094867467880249,null,3.094867467880249,3.999999523162842,null,4.247031029080972e-07,0.9078519940376282,null,0.9078519940376282,2.0,null,2.0,3.0921480655670166,null,3.0921480655670166,3.999999523162842,null,4.46966708977925e-07,0.9099583625793457,null,0.9099583625793457,2.0,null,2.0,3.0900416374206543,null,3.0900416374206543,3.999999523162842,null,4.653745122595865e-07,4.284825934064429e-07,null,0.9030538201332092,0.9051325917243958,null,2.0,2.0,null,3.0969460010528564,3.094867467880249,null,3.999999523162842,3.999999523162842,null,4.284825934064429e-07,4.247031029080972e-07,null,0.9051325917243958,0.9078519940376282,null,2.0,2.0,null,3.094867467880249,3.0921480655670166,null,3.999999523162842,3.999999523162842,null,4.247031029080972e-07,4.46966708977925e-07,null,0.9078519940376282,0.9099583625793457,null,2.0,2.0,null,3.0921480655670166,3.0900416374206543,null,3.999999523162842,3.999999523162842,null],"y":[-1.596750053067808e-06,-0.745184600353241,null,-0.745184600353241,-1.0412147045135498,null,-1.0412147045135498,-0.745184600353241,null,-0.745184600353241,-1.5967469835231896e-06,null,-1.0000030994415283,-1.736272931098938,null,-1.736272931098938,-2.030444622039795,null,-2.030444622039795,-1.736272931098938,null,-1.736272931098938,-1.0000030994415283,null,-2.0000030994415283,-2.7246015071868896,null,-2.7246015071868896,-3.016282796859741,null,-3.016282796859741,-2.7246015071868896,null,-2.7246015071868896,-2.0000030994415283,null,-3.0000016689300537,-3.7156007289886475,null,-3.7156007289886475,-4.00554084777832,null,-4.00554084777832,-3.7156007289886475,null,-3.7156007289886475,-3.0000016689300537,null,-1.596750053067808e-06,-1.0000030994415283,null,-0.745184600353241,-1.736272931098938,null,-1.0412147045135498,-2.030444622039795,null,-0.745184600353241,-1.736272931098938,null,-1.5967469835231896e-06,-1.0000030994415283,null,-1.0000030994415283,-2.0000030994415283,null,-1.736272931098938,-2.7246015071868896,null,-2.030444622039795,-3.016282796859741,null,-1.736272931098938,-2.7246015071868896,null,-1.0000030994415283,-2.0000030994415283,null,-2.0000030994415283,-3.0000016689300537,null,-2.7246015071868896,-3.7156007289886475,null,-3.016282796859741,-4.00554084777832,null,-2.7246015071868896,-3.7156007289886475,null,-2.0000030994415283,-3.0000016689300537,null],"type":"scatter"},{"marker":{"color":"crimson","size":12},"mode":"markers","x":[4.653745122595865e-07,3.999999523162842,4.284825934064429e-07,3.999999523162842,4.247031029080972e-07,3.999999523162842,4.46966708977925e-07,3.999999523162842],"y":[-1.596750053067808e-06,-1.5967469835231896e-06,-1.0000030994415283,-1.0000030994415283,-2.0000030994415283,-2.0000030994415283,-3.0000016689300537,-3.0000016689300537],"type":"scatter"},{"marker":{"color":"steelblue","size":10},"mode":"markers","x":[0.9030538201332092,2.0,3.0969460010528564,0.9051325917243958,2.0,3.094867467880249,0.9078519940376282,2.0,3.0921480655670166,0.9099583625793457,2.0,3.0900416374206543],"y":[-0.745184600353241,-1.0412147045135498,-0.745184600353241,-1.736272931098938,-2.030444622039795,-1.736272931098938,-2.7246015071868896,-3.016282796859741,-2.7246015071868896,-3.7156007289886475,-4.00554084777832,-3.7156007289886475],"type":"scatter"}],"name":"12"},{"data":[{"hoverinfo":"skip","line":{"color":"gray","width":2},"mode":"lines","x":[6.7275750552653335e-06,0.894661545753479,null,0.894661545753479,2.0,null,2.0,3.1053383350372314,null,3.1053383350372314,3.999993324279785,null,6.439995559048839e-06,0.8972210884094238,null,0.8972210884094238,2.0,null,2.0,3.102778911590576,null,3.102778911590576,3.9999935626983643,null,6.147847216197988e-06,0.9002687335014343,null,0.9002687335014343,2.0,null,2.0,3.099731206893921,null,3.099731206893921,3.9999938011169434,null,6.0009783737768885e-06,0.9024661779403687,null,0.9024661779403687,2.0,null,2.0,3.097533941268921,null,3.097533941268921,3.9999940395355225,null,6.7275750552653335e-06,6.439995559048839e-06,null,0.894661545753479,0.8972210884094238,null,2.0,2.0,null,3.1053383350372314,3.102778911590576,null,3.999993324279785,3.9999935626983643,null,6.439995559048839e-06,6.147847216197988e-06,null,0.8972210884094238,0.9002687335014343,null,2.0,2.0,null,3.102778911590576,3.099731206893921,null,3.9999935626983643,3.9999938011169434,null,6.147847216197988e-06,6.0009783737768885e-06,null,0.9002687335014343,0.9024661779403687,null,2.0,2.0,null,3.099731206893921,3.097533941268921,null,3.9999938011169434,3.9999940395355225,null],"y":[-3.6380724850459956e-06,-0.7927122116088867,null,-0.7927122116088867,-1.1094841957092285,null,-1.1094841957092285,-0.7927122116088867,null,-0.7927122116088867,-3.6376650314196013e-06,null,-1.0000085830688477,-1.7820868492126465,null,-1.7820868492126465,-2.0980825424194336,null,-2.0980825424194336,-1.7820868492126465,null,-1.7820868492126465,-1.0000085830688477,null,-2.0000081062316895,-2.768826961517334,null,-2.768826961517334,-3.081724166870117,null,-3.081724166870117,-2.768827199935913,null,-2.768827199935913,-2.0000081062316895,null,-3.0000030994415283,-3.7589540481567383,null,-3.7589540481567383,-4.068417549133301,null,-4.068417549133301,-3.7589540481567383,null,-3.7589540481567383,-3.0000030994415283,null,-3.6380724850459956e-06,-1.0000085830688477,null,-0.7927122116088867,-1.7820868492126465,null,-1.1094841957092285,-2.0980825424194336,null,-0.7927122116088867,-1.7820868492126465,null,-3.6376650314196013e-06,-1.0000085830688477,null,-1.0000085830688477,-2.0000081062316895,null,-1.7820868492126465,-2.768826961517334,null,-2.0980825424194336,-3.081724166870117,null,-1.7820868492126465,-2.768827199935913,null,-1.0000085830688477,-2.0000081062316895,null,-2.0000081062316895,-3.0000030994415283,null,-2.768826961517334,-3.7589540481567383,null,-3.081724166870117,-4.068417549133301,null,-2.768827199935913,-3.7589540481567383,null,-2.0000081062316895,-3.0000030994415283,null],"type":"scatter"},{"marker":{"color":"crimson","size":12},"mode":"markers","x":[6.7275750552653335e-06,3.999993324279785,6.439995559048839e-06,3.9999935626983643,6.147847216197988e-06,3.9999938011169434,6.0009783737768885e-06,3.9999940395355225],"y":[-3.6380724850459956e-06,-3.6376650314196013e-06,-1.0000085830688477,-1.0000085830688477,-2.0000081062316895,-2.0000081062316895,-3.0000030994415283,-3.0000030994415283],"type":"scatter"},{"marker":{"color":"steelblue","size":10},"mode":"markers","x":[0.894661545753479,2.0,3.1053383350372314,0.8972210884094238,2.0,3.102778911590576,0.9002687335014343,2.0,3.099731206893921,0.9024661779403687,2.0,3.097533941268921],"y":[-0.7927122116088867,-1.1094841957092285,-0.7927122116088867,-1.7820868492126465,-2.0980825424194336,-1.7820868492126465,-2.768826961517334,-3.081724166870117,-2.768827199935913,-3.7589540481567383,-4.068417549133301,-3.7589540481567383],"type":"scatter"}],"name":"13"},{"data":[{"hoverinfo":"skip","line":{"color":"gray","width":2},"mode":"lines","x":[4.4163543861941434e-06,0.8864158391952515,null,0.8864158391952515,2.0,null,2.0,3.113584280014038,null,3.113584280014038,3.999995708465576,null,3.988673597632442e-06,0.8889625072479248,null,0.8889625072479248,2.0,null,2.0,3.111037492752075,null,3.111037492752075,3.9999959468841553,null,3.976957486884203e-06,0.8923513293266296,null,0.8923513293266296,2.0,null,2.0,3.1076486110687256,null,3.1076486110687256,3.9999959468841553,null,4.086093667865498e-06,0.8950450420379639,null,0.8950450420379639,2.0,null,2.0,3.104954957962036,null,3.104954957962036,3.9999959468841553,null,4.4163543861941434e-06,3.988673597632442e-06,null,0.8864158391952515,0.8889625072479248,null,2.0,2.0,null,3.113584280014038,3.111037492752075,null,3.999995708465576,3.9999959468841553,null,3.988673597632442e-06,3.976957486884203e-06,null,0.8889625072479248,0.8923513293266296,null,2.0,2.0,null,3.111037492752075,3.1076486110687256,null,3.9999959468841553,3.9999959468841553,null,3.976957486884203e-06,4.086093667865498e-06,null,0.8923513293266296,0.8950450420379639,null,2.0,2.0,null,3.1076486110687256,3.104954957962036,null,3.9999959468841553,3.9999959468841553,null],"y":[8.915603757486679e-06,-0.8312906622886658,null,-0.8312906622886658,-1.170115351676941,null,-1.170115351676941,-0.8312907218933105,null,-0.8312907218933105,8.915674698073417e-06,null,-0.9999909996986389,-1.8199410438537598,null,-1.8199410438537598,-2.155881881713867,null,-2.155881881713867,-1.8199410438537598,null,-1.8199410438537598,-0.9999909996986389,null,-1.999991536140442,-2.8050739765167236,null,-2.8050739765167236,-3.1372697353363037,null,-3.1372697353363037,-2.8050739765167236,null,-2.8050739765167236,-1.999991536140442,null,-2.9999918937683105,-3.793515920639038,null,-3.793515920639038,-4.123170852661133,null,-4.123170852661133,-3.793515920639038,null,-3.793515920639038,-2.9999918937683105,null,8.915603757486679e-06,-0.9999909996986389,null,-0.8312906622886658,-1.8199410438537598,null,-1.170115351676941,-2.155881881713867,null,-0.8312907218933105,-1.8199410438537598,null,8.915674698073417e-06,-0.9999909996986389,null,-0.9999909996986389,-1.999991536140442,null,-1.8199410438537598,-2.8050739765167236,null,-2.155881881713867,-3.1372697353363037,null,-1.8199410438537598,-2.8050739765167236,null,-0.9999909996986389,-1.999991536140442,null,-1.999991536140442,-2.9999918937683105,null,-2.8050739765167236,-3.793515920639038,null,-3.1372697353363037,-4.123170852661133,null,-2.8050739765167236,-3.793515920639038,null,-1.999991536140442,-2.9999918937683105,null],"type":"scatter"},{"marker":{"color":"crimson","size":12},"mode":"markers","x":[4.4163543861941434e-06,3.999995708465576,3.988673597632442e-06,3.9999959468841553,3.976957486884203e-06,3.9999959468841553,4.086093667865498e-06,3.9999959468841553],"y":[8.915603757486679e-06,8.915674698073417e-06,-0.9999909996986389,-0.9999909996986389,-1.999991536140442,-1.999991536140442,-2.9999918937683105,-2.9999918937683105],"type":"scatter"},{"marker":{"color":"steelblue","size":10},"mode":"markers","x":[0.8864158391952515,2.0,3.113584280014038,0.8889625072479248,2.0,3.111037492752075,0.8923513293266296,2.0,3.1076486110687256,0.8950450420379639,2.0,3.104954957962036],"y":[-0.8312906622886658,-1.170115351676941,-0.8312907218933105,-1.8199410438537598,-2.155881881713867,-1.8199410438537598,-2.8050739765167236,-3.1372697353363037,-2.8050739765167236,-3.793515920639038,-4.123170852661133,-3.793515920639038],"type":"scatter"}],"name":"14"},{"data":[{"hoverinfo":"skip","line":{"color":"gray","width":2},"mode":"lines","x":[-4.632476247934392e-06,0.8769042491912842,null,0.8769042491912842,2.0,null,2.0,3.123095750808716,null,3.123095750808716,4.000004768371582,null,-4.436950803210493e-06,0.8791572451591492,null,0.8791572451591492,2.0,null,2.0,3.120842695236206,null,3.120842695236206,4.000004291534424,null,-4.222263669362292e-06,0.882893979549408,null,0.882893979549408,2.0,null,2.0,3.1171059608459473,null,3.1171059608459473,4.000004291534424,null,-4.100189471500926e-06,0.8863444328308105,null,0.8863444328308105,2.0,null,2.0,3.1136555671691895,null,3.1136555671691895,4.000004291534424,null,-4.632476247934392e-06,-4.436950803210493e-06,null,0.8769042491912842,0.8791572451591492,null,2.0,2.0,null,3.123095750808716,3.120842695236206,null,4.000004768371582,4.000004291534424,null,-4.436950803210493e-06,-4.222263669362292e-06,null,0.8791572451591492,0.882893979549408,null,2.0,2.0,null,3.120842695236206,3.1171059608459473,null,4.000004291534424,4.000004291534424,null,-4.222263669362292e-06,-4.100189471500926e-06,null,0.882893979549408,0.8863444328308105,null,2.0,2.0,null,3.1171059608459473,3.1136555671691895,null,4.000004291534424,4.000004291534424,null],"y":[-4.605586127581773e-06,-0.8795680999755859,null,-0.8795680999755859,-1.2327563762664795,null,-1.2327563762664795,-0.8795680999755859,null,-0.8795680999755859,-4.605428330251016e-06,null,-1.0000079870224,-1.8680118322372437,null,-1.8680118322372437,-2.2161223888397217,null,-2.2161223888397217,-1.8680118322372437,null,-1.8680118322372437,-1.0000079870224,null,-2.0000076293945312,-2.8513896465301514,null,-2.8513896465301514,-3.195200204849243,null,-3.195200204849243,-2.8513894081115723,null,-2.8513894081115723,-2.0000076293945312,null,-3.0000040531158447,-3.8374340534210205,null,-3.8374340534210205,-4.179805278778076,null,-4.179805278778076,-3.8374340534210205,null,-3.8374340534210205,-3.0000040531158447,null,-4.605586127581773e-06,-1.0000079870224,null,-0.8795680999755859,-1.8680118322372437,null,-1.2327563762664795,-2.2161223888397217,null,-0.8795680999755859,-1.8680118322372437,null,-4.605428330251016e-06,-1.0000079870224,null,-1.0000079870224,-2.0000076293945312,null,-1.8680118322372437,-2.8513896465301514,null,-2.2161223888397217,-3.195200204849243,null,-1.8680118322372437,-2.8513894081115723,null,-1.0000079870224,-2.0000076293945312,null,-2.0000076293945312,-3.0000040531158447,null,-2.8513896465301514,-3.8374340534210205,null,-3.195200204849243,-4.179805278778076,null,-2.8513894081115723,-3.8374340534210205,null,-2.0000076293945312,-3.0000040531158447,null],"type":"scatter"},{"marker":{"color":"crimson","size":12},"mode":"markers","x":[-4.632476247934392e-06,4.000004768371582,-4.436950803210493e-06,4.000004291534424,-4.222263669362292e-06,4.000004291534424,-4.100189471500926e-06,4.000004291534424],"y":[-4.605586127581773e-06,-4.605428330251016e-06,-1.0000079870224,-1.0000079870224,-2.0000076293945312,-2.0000076293945312,-3.0000040531158447,-3.0000040531158447],"type":"scatter"},{"marker":{"color":"steelblue","size":10},"mode":"markers","x":[0.8769042491912842,2.0,3.123095750808716,0.8791572451591492,2.0,3.120842695236206,0.882893979549408,2.0,3.1171059608459473,0.8863444328308105,2.0,3.1136555671691895],"y":[-0.8795680999755859,-1.2327563762664795,-0.8795680999755859,-1.8680118322372437,-2.2161223888397217,-1.8680118322372437,-2.8513896465301514,-3.195200204849243,-2.8513894081115723,-3.8374340534210205,-4.179805278778076,-3.8374340534210205],"type":"scatter"}],"name":"15"},{"data":[{"hoverinfo":"skip","line":{"color":"gray","width":2},"mode":"lines","x":[-1.2316103266130085e-06,0.8696621656417847,null,0.8696621656417847,2.0,null,2.0,3.130337715148926,null,3.130337715148926,4.000001430511475,null,-1.2919050504933693e-06,0.8728380799293518,null,0.8728380799293518,2.0,null,2.0,3.127161741256714,null,3.127161741256714,4.000001430511475,null,-1.2839366263506236e-06,0.8769487142562866,null,0.8769487142562866,2.0,null,2.0,3.123051166534424,null,3.123051166534424,4.000001430511475,null,-1.215512952512654e-06,0.88013756275177,null,0.88013756275177,2.0,null,2.0,3.1198623180389404,null,3.1198623180389404,4.000001430511475,null,-1.2316103266130085e-06,-1.2919050504933693e-06,null,0.8696621656417847,0.8728380799293518,null,2.0,2.0,null,3.130337715148926,3.127161741256714,null,4.000001430511475,4.000001430511475,null,-1.2919050504933693e-06,-1.2839366263506236e-06,null,0.8728380799293518,0.8769487142562866,null,2.0,2.0,null,3.127161741256714,3.123051166534424,null,4.000001430511475,4.000001430511475,null,-1.2839366263506236e-06,-1.215512952512654e-06,null,0.8769487142562866,0.88013756275177,null,2.0,2.0,null,3.123051166534424,3.1198623180389404,null,4.000001430511475,4.000001430511475,null],"y":[-8.415585739385278e-07,-0.916885256767273,null,-0.916885256767273,-1.2931348085403442,null,-1.2931348085403442,-0.9168851375579834,null,-0.9168851375579834,-8.414241960963409e-07,null,-1.0000007152557373,-1.9027009010314941,null,-1.9027009010314941,-2.275346279144287,null,-2.275346279144287,-1.9027007818222046,null,-1.9027007818222046,-1.0000007152557373,null,-2.0000007152557373,-2.884286642074585,null,-2.884286642074585,-3.251966714859009,null,-3.251966714859009,-2.884286403656006,null,-2.884286403656006,-2.0000007152557373,null,-3.000000476837158,-3.870021343231201,null,-3.870021343231201,-4.234062671661377,null,-4.234062671661377,-3.870021343231201,null,-3.870021343231201,-3.000000476837158,null,-8.415585739385278e-07,-1.0000007152557373,null,-0.916885256767273,-1.9027009010314941,null,-1.2931348085403442,-2.275346279144287,null,-0.9168851375579834,-1.9027007818222046,null,-8.414241960963409e-07,-1.0000007152557373,null,-1.0000007152557373,-2.0000007152557373,null,-1.9027009010314941,-2.884286642074585,null,-2.275346279144287,-3.251966714859009,null,-1.9027007818222046,-2.884286403656006,null,-1.0000007152557373,-2.0000007152557373,null,-2.0000007152557373,-3.000000476837158,null,-2.884286642074585,-3.870021343231201,null,-3.251966714859009,-4.234062671661377,null,-2.884286403656006,-3.870021343231201,null,-2.0000007152557373,-3.000000476837158,null],"type":"scatter"},{"marker":{"color":"crimson","size":12},"mode":"markers","x":[-1.2316103266130085e-06,4.000001430511475,-1.2919050504933693e-06,4.000001430511475,-1.2839366263506236e-06,4.000001430511475,-1.215512952512654e-06,4.000001430511475],"y":[-8.415585739385278e-07,-8.414241960963409e-07,-1.0000007152557373,-1.0000007152557373,-2.0000007152557373,-2.0000007152557373,-3.000000476837158,-3.000000476837158],"type":"scatter"},{"marker":{"color":"steelblue","size":10},"mode":"markers","x":[0.8696621656417847,2.0,3.130337715148926,0.8728380799293518,2.0,3.127161741256714,0.8769487142562866,2.0,3.123051166534424,0.88013756275177,2.0,3.1198623180389404],"y":[-0.916885256767273,-1.2931348085403442,-0.9168851375579834,-1.9027009010314941,-2.275346279144287,-1.9027007818222046,-2.884286642074585,-3.251966714859009,-2.884286403656006,-3.870021343231201,-4.234062671661377,-3.870021343231201],"type":"scatter"}],"name":"16"},{"data":[{"hoverinfo":"skip","line":{"color":"gray","width":2},"mode":"lines","x":[6.375244993250817e-06,0.860838770866394,null,0.860838770866394,2.000000238418579,null,2.000000238418579,3.1391615867614746,null,3.1391615867614746,3.9999935626983643,null,6.339336778182769e-06,0.8641814589500427,null,0.8641814589500427,2.000000476837158,null,2.000000476837158,3.1358189582824707,null,3.1358189582824707,3.9999938011169434,null,6.363161446643062e-06,0.8684543967247009,null,0.8684543967247009,2.000000238418579,null,2.000000238418579,3.1315457820892334,null,3.1315457820892334,3.9999935626983643,null,6.169661446620012e-06,0.8718158602714539,null,0.8718158602714539,2.000000238418579,null,2.000000238418579,3.1281845569610596,null,3.1281845569610596,3.9999938011169434,null,6.375244993250817e-06,6.339336778182769e-06,null,0.860838770866394,0.8641814589500427,null,2.000000238418579,2.000000476837158,null,3.1391615867614746,3.1358189582824707,null,3.9999935626983643,3.9999938011169434,null,6.339336778182769e-06,6.363161446643062e-06,null,0.8641814589500427,0.8684543967247009,null,2.000000476837158,2.000000238418579,null,3.1358189582824707,3.1315457820892334,null,3.9999938011169434,3.9999935626983643,null,6.363161446643062e-06,6.169661446620012e-06,null,0.8684543967247009,0.8718158602714539,null,2.000000238418579,2.000000238418579,null,3.1315457820892334,3.1281845569610596,null,3.9999935626983643,3.9999938011169434,null],"y":[5.742820690102235e-07,-0.9604081511497498,null,-0.9604081511497498,-1.3540128469467163,null,-1.3540128469467163,-0.960408091545105,null,-0.960408091545105,5.737629180657677e-07,null,-0.9999992251396179,-1.9448902606964111,null,-1.9448902606964111,-2.3341495990753174,null,-2.3341495990753174,-1.9448902606964111,null,-1.9448902606964111,-0.9999992251396179,null,-1.9999990463256836,-2.9248180389404297,null,-2.9248180389404297,-3.3079867362976074,null,-3.3079867362976074,-2.9248180389404297,null,-2.9248180389404297,-1.9999990463256836,null,-2.9999990463256836,-3.9092278480529785,null,-3.9092278480529785,-4.287933826446533,null,-4.287933826446533,-3.9092278480529785,null,-3.9092278480529785,-2.9999990463256836,null,5.742820690102235e-07,-0.9999992251396179,null,-0.9604081511497498,-1.9448902606964111,null,-1.3540128469467163,-2.3341495990753174,null,-0.960408091545105,-1.9448902606964111,null,5.737629180657677e-07,-0.9999992251396179,null,-0.9999992251396179,-1.9999990463256836,null,-1.9448902606964111,-2.9248180389404297,null,-2.3341495990753174,-3.3079867362976074,null,-1.9448902606964111,-2.9248180389404297,null,-0.9999992251396179,-1.9999990463256836,null,-1.9999990463256836,-2.9999990463256836,null,-2.9248180389404297,-3.9092278480529785,null,-3.3079867362976074,-4.287933826446533,null,-2.9248180389404297,-3.9092278480529785,null,-1.9999990463256836,-2.9999990463256836,null],"type":"scatter"},{"marker":{"color":"crimson","size":12},"mode":"markers","x":[6.375244993250817e-06,3.9999935626983643,6.339336778182769e-06,3.9999938011169434,6.363161446643062e-06,3.9999935626983643,6.169661446620012e-06,3.9999938011169434],"y":[5.742820690102235e-07,5.737629180657677e-07,-0.9999992251396179,-0.9999992251396179,-1.9999990463256836,-1.9999990463256836,-2.9999990463256836,-2.9999990463256836],"type":"scatter"},{"marker":{"color":"steelblue","size":10},"mode":"markers","x":[0.860838770866394,2.000000238418579,3.1391615867614746,0.8641814589500427,2.000000476837158,3.1358189582824707,0.8684543967247009,2.000000238418579,3.1315457820892334,0.8718158602714539,2.000000238418579,3.1281845569610596],"y":[-0.9604081511497498,-1.3540128469467163,-0.960408091545105,-1.9448902606964111,-2.3341495990753174,-1.9448902606964111,-2.9248180389404297,-3.3079867362976074,-2.9248180389404297,-3.9092278480529785,-4.287933826446533,-3.9092278480529785],"type":"scatter"}],"name":"17"},{"data":[{"hoverinfo":"skip","line":{"color":"gray","width":2},"mode":"lines","x":[-1.1062095381930703e-06,0.8596066236495972,null,0.8596066236495972,2.000000238418579,null,2.000000238418579,3.140392780303955,null,3.140392780303955,4.000000953674316,null,-1.8812605731000076e-06,0.8628222346305847,null,0.8628222346305847,1.9999998807907104,null,1.9999998807907104,3.1371781826019287,null,3.1371781826019287,4.000001907348633,null,-1.7855712712844252e-06,0.8672340512275696,null,0.8672340512275696,2.000000238418579,null,2.000000238418579,3.132765531539917,null,3.132765531539917,4.000001907348633,null,-1.0313193570254953e-06,0.8709446787834167,null,0.8709446787834167,1.9999998807907104,null,1.9999998807907104,3.1290555000305176,null,3.1290555000305176,4.000000953674316,null,-1.1062095381930703e-06,-1.8812605731000076e-06,null,0.8596066236495972,0.8628222346305847,null,2.000000238418579,1.9999998807907104,null,3.140392780303955,3.1371781826019287,null,4.000000953674316,4.000001907348633,null,-1.8812605731000076e-06,-1.7855712712844252e-06,null,0.8628222346305847,0.8672340512275696,null,1.9999998807907104,2.000000238418579,null,3.1371781826019287,3.132765531539917,null,4.000001907348633,4.000001907348633,null,-1.7855712712844252e-06,-1.0313193570254953e-06,null,0.8672340512275696,0.8709446787834167,null,2.000000238418579,1.9999998807907104,null,3.132765531539917,3.1290555000305176,null,4.000001907348633,4.000000953674316,null],"y":[-1.6852796989041963e-06,-0.9958285093307495,null,-0.9958285093307495,-1.4264835119247437,null,-1.4264835119247437,-0.9958280920982361,null,-0.9958280920982361,-1.68541373568587e-06,null,-0.9999991059303284,-1.9793310165405273,null,-1.9793310165405273,-2.4042623043060303,null,-2.4042623043060303,-1.979331374168396,null,-1.979331374168396,-0.9999991059303284,null,-1.9999991655349731,-2.957318067550659,null,-2.957318067550659,-3.3753862380981445,null,-3.3753862380981445,-2.957317590713501,null,-2.957317590713501,-1.9999991655349731,null,-3.0000014305114746,-3.939758777618408,null,-3.939758777618408,-4.353347301483154,null,-4.353347301483154,-3.9397592544555664,null,-3.9397592544555664,-3.0000014305114746,null,-1.6852796989041963e-06,-0.9999991059303284,null,-0.9958285093307495,-1.9793310165405273,null,-1.4264835119247437,-2.4042623043060303,null,-0.9958280920982361,-1.979331374168396,null,-1.68541373568587e-06,-0.9999991059303284,null,-0.9999991059303284,-1.9999991655349731,null,-1.9793310165405273,-2.957318067550659,null,-2.4042623043060303,-3.3753862380981445,null,-1.979331374168396,-2.957317590713501,null,-0.9999991059303284,-1.9999991655349731,null,-1.9999991655349731,-3.0000014305114746,null,-2.957318067550659,-3.939758777618408,null,-3.3753862380981445,-4.353347301483154,null,-2.957317590713501,-3.9397592544555664,null,-1.9999991655349731,-3.0000014305114746,null],"type":"scatter"},{"marker":{"color":"crimson","size":12},"mode":"markers","x":[-1.1062095381930703e-06,4.000000953674316,-1.8812605731000076e-06,4.000001907348633,-1.7855712712844252e-06,4.000001907348633,-1.0313193570254953e-06,4.000000953674316],"y":[-1.6852796989041963e-06,-1.68541373568587e-06,-0.9999991059303284,-0.9999991059303284,-1.9999991655349731,-1.9999991655349731,-3.0000014305114746,-3.0000014305114746],"type":"scatter"},{"marker":{"color":"steelblue","size":10},"mode":"markers","x":[0.8596066236495972,2.000000238418579,3.140392780303955,0.8628222346305847,1.9999998807907104,3.1371781826019287,0.8672340512275696,2.000000238418579,3.132765531539917,0.8709446787834167,1.9999998807907104,3.1290555000305176],"y":[-0.9958285093307495,-1.4264835119247437,-0.9958280920982361,-1.9793310165405273,-2.4042623043060303,-1.979331374168396,-2.957318067550659,-3.3753862380981445,-2.957317590713501,-3.939758777618408,-4.353347301483154,-3.9397592544555664],"type":"scatter"}],"name":"18"},{"data":[{"hoverinfo":"skip","line":{"color":"gray","width":2},"mode":"lines","x":[1.2655395948968362e-06,0.8505436778068542,null,0.8505436778068542,2.0,null,2.0,3.149456024169922,null,3.149456024169922,3.9999988079071045,null,1.1403813005017582e-06,0.8548082709312439,null,0.8548082709312439,1.9999998807907104,null,1.9999998807907104,3.1451919078826904,null,3.1451919078826904,3.9999988079071045,null,1.0351205901315552e-06,0.8595936894416809,null,0.8595936894416809,2.0,null,2.0,3.1404061317443848,null,3.1404061317443848,3.9999990463256836,null,1.0298695087840315e-06,0.8629024028778076,null,0.8629024028778076,1.9999998807907104,null,1.9999998807907104,3.1370978355407715,null,3.1370978355407715,3.9999990463256836,null,1.2655395948968362e-06,1.1403813005017582e-06,null,0.8505436778068542,0.8548082709312439,null,2.0,1.9999998807907104,null,3.149456024169922,3.1451919078826904,null,3.9999988079071045,3.9999988079071045,null,1.1403813005017582e-06,1.0351205901315552e-06,null,0.8548082709312439,0.8595936894416809,null,1.9999998807907104,2.0,null,3.1451919078826904,3.1404061317443848,null,3.9999988079071045,3.9999990463256836,null,1.0351205901315552e-06,1.0298695087840315e-06,null,0.8595936894416809,0.8629024028778076,null,2.0,1.9999998807907104,null,3.1404061317443848,3.1370978355407715,null,3.9999990463256836,3.9999990463256836,null],"y":[1.9077219803875778e-06,-1.0436583757400513,null,-1.0436583757400513,-1.4903693199157715,null,-1.4903693199157715,-1.0436581373214722,null,-1.0436581373214722,1.9077219803875778e-06,null,-1.0000005960464478,-2.0239927768707275,null,-2.0239927768707275,-2.467442512512207,null,-2.467442512512207,-2.0239930152893066,null,-2.0239930152893066,-1.0000005960464478,null,-2.000000476837158,-2.9998884201049805,null,-2.9998884201049805,-3.4357664585113525,null,-3.4357664585113525,-2.9998881816864014,null,-2.9998881816864014,-2.000000476837158,null,-2.999998092651367,-3.982013463973999,null,-3.982013463973999,-4.410367488861084,null,-4.410367488861084,-3.982013702392578,null,-3.982013702392578,-2.999998092651367,null,1.9077219803875778e-06,-1.0000005960464478,null,-1.0436583757400513,-2.0239927768707275,null,-1.4903693199157715,-2.467442512512207,null,-1.0436581373214722,-2.0239930152893066,null,1.9077219803875778e-06,-1.0000005960464478,null,-1.0000005960464478,-2.000000476837158,null,-2.0239927768707275,-2.9998884201049805,null,-2.467442512512207,-3.4357664585113525,null,-2.0239930152893066,-2.9998881816864014,null,-1.0000005960464478,-2.000000476837158,null,-2.000000476837158,-2.999998092651367,null,-2.9998884201049805,-3.982013463973999,null,-3.4357664585113525,-4.410367488861084,null,-2.9998881816864014,-3.982013702392578,null,-2.000000476837158,-2.999998092651367,null],"type":"scatter"},{"marker":{"color":"crimson","size":12},"mode":"markers","x":[1.2655395948968362e-06,3.9999988079071045,1.1403813005017582e-06,3.9999988079071045,1.0351205901315552e-06,3.9999990463256836,1.0298695087840315e-06,3.9999990463256836],"y":[1.9077219803875778e-06,1.9077219803875778e-06,-1.0000005960464478,-1.0000005960464478,-2.000000476837158,-2.000000476837158,-2.999998092651367,-2.999998092651367],"type":"scatter"},{"marker":{"color":"steelblue","size":10},"mode":"markers","x":[0.8505436778068542,2.0,3.149456024169922,0.8548082709312439,1.9999998807907104,3.1451919078826904,0.8595936894416809,2.0,3.1404061317443848,0.8629024028778076,1.9999998807907104,3.1370978355407715],"y":[-1.0436583757400513,-1.4903693199157715,-1.0436581373214722,-2.0239927768707275,-2.467442512512207,-2.0239930152893066,-2.9998884201049805,-3.4357664585113525,-2.9998881816864014,-3.982013463973999,-4.410367488861084,-3.982013702392578],"type":"scatter"}],"name":"19"}]);
                        })                };            </script>        </div></div></div>
</div>
<p>The animation shows how the spring network relaxes as gravity is progressively applied. Starting from the regular grid (0% gravity), the interior points sag downward until reaching the final equilibrium (100% gravity).</p>
<p>When to use each construction approach:</p>
<ul class="simple">
<li><p>Naive: Simpler code, good for prototyping and small problems</p></li>
<li><p>Batched: Faster problem analysis, essential for large-scale problems</p></li>
</ul>
<p>For more details, see <a class="reference internal" href="../../../api/core/#jaxls.Var" title="jaxls.Var"><code class="xref py py-class docutils literal notranslate"><span class="pre">jaxls.Var</span></code></a>, <a class="reference internal" href="../../../api/core/#jaxls.Cost" title="jaxls.Cost"><code class="xref py py-class docutils literal notranslate"><span class="pre">jaxls.Cost</span></code></a>, and <a class="reference internal" href="../../../api/core/#jaxls.LeastSquaresProblem" title="jaxls.LeastSquaresProblem"><code class="xref py py-class docutils literal notranslate"><span class="pre">jaxls.LeastSquaresProblem</span></code></a>.</p>
</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Mechanics</p>
      </div>
    </a>
    <a class="right-next"
       href="../cloth_draping/"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Cloth draping</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#variables-and-costs">Variables and costs</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#problem-setup">Problem setup</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#approach-1-naive-construction">Approach 1: naive construction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#approach-2-batched-construction">Approach 2: batched construction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#solving">Solving</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#visualization">Visualization</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#relaxation-animation">Relaxation animation</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By brentyi
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2026.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>